<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Statistics &amp; Big Data 25-26 Labs</title>

    <meta name="author" content="Dr.¬†Niccol√≤ Salvini" />
  
   <meta name="description" content="<p>This is a minimal course website containing class materials for Statistics &amp; Big Data labs.<span class="citation"><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></span></p>" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Statistics &amp; Big Data 25-26 Labs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is a minimal course website containing class materials for Statistics &amp; Big Data labs.<span class="citation"><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></span></p>" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Statistics &amp; Big Data 25-26 Labs" />
  
  <meta name="twitter:description" content="<p>This is a minimal course website containing class materials for Statistics &amp; Big Data labs.<span class="citation"><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></span></p>" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.5.1/transition.js"></script>
    <script src="libs/bs3compat-0.5.1/tabs.js"></script>
    <script src="libs/bs3compat-0.5.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="shortcut icon" href="images/cattolica-logo-favicon.png" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Statistics &amp; Big Data 25-26 Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="about" class="section level1" number="1">
<h1><span class="header-section-number">1</span> ü´∂ About</h1>
<p><img src="images/cattolica-logo.png" class= "cover" width="250" height="250"/> This is the official course website for Statistics &amp; Big data<span class="citation"><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></span> 2025 - 2026 for laboratories. This website augments lecture topics and provides exercises for home and class assignments. Additional theory wrt slides and textbook will not be part of the exam, indeed they are for your growth and hopefully in the future as quicksilver resource to recover R proficiency from lethargy.</p>
<div id="logistics" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> üîß Logistics</h2>
<ul>
<li><strong>Lectures</strong>:
<ul>
<li>Mondays: 14:00 - 17:00 CET</li>
<li>Tuesdays: 10:00 - 13:00 CET</li>
</ul></li>
<li><strong>Location</strong>: Campus Gemelli, Room 20 (and optionally remote)</li>
<li><strong>Office hours</strong>:
<ul>
<li>Dr.¬†Niccol√≤ <strong>Salvini</strong>: Available via email and for questions before/after lectures</li>
<li>Prof.¬†Sophie <strong>Dabo-Niang</strong>: Available during intensive session (week of November 17th)</li>
</ul></li>
<li>here‚Äôs the <a href="https://drive.google.com/drive/folders/1e1HVjSYABJ8rLUErHWbQOhAhQ_OA_Xo9?usp=sharing">shared drive</a> (slides notebooks extra in class)</li>
</ul>
<!--- - **Grading**:
  one final project to build an ML application (65%). We'll have a demo day to showcase all students' final projects. See last year projects here two to three fun, short assignments (30%) discussion participation in class + EdStem + OHs (5%) --->
</div>
<div id="team" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> üë• Team</h2>
<style type="text/css">

.instructor {
    display: inline-block;
    width: 160px;
    text-align: center;
    margin-right: 20px;
    margin-bottom: 10px;
    font-size: 17px;
    vertical-align: top;
}


.instructorphoto img {
    width: 150px;
    border-radius: 140px;
    margin-bottom: 10px;
}

.col-md-2, .col-md-6 {
    position: relative;
    min-height: 1px;
    padding-right: 15px;
    padding-left: 15px;
}

</style>
<div class="row">
            <div class="col-md-3">
                <h3>Instructor</h3>
                <div class="instructor">
                    <a href="https://niccolosalvini.notion.site/Niccol-Salvini-PhD-2b09a3f0a7014b1182eb51578c058685">
                        <div class="instructorphoto"><img src="images/salvini.jpeg"></div>
                        <div>Dr. Niccol√≤ Salvini</div>
                    </a>
                </div>
            </div>
            <div class="col-md-3">
                <h3>Instructor</h3>
                <div class="instructor">
                    <a href="https://sites.google.com/view/sophie-dabo-niang/">
                        <div class="instructorphoto"><img src="images/dabo-niang.png"></div>
                        <div>Prof. Sophie Dabo-Niang</div>
                    </a>
                </div>
            </div>
        </div>
</div>
<div id="labs-content" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> üóí labs‚Äô contents</h2>
<div id="part-1-the-foundations-dr.-niccol√≤-salvini" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Part 1: The Foundations (Dr.¬†Niccol√≤ Salvini)</h3>
<ul>
<li>Introduction to the R ecosystem
<ul>
<li>Install R and RStudio</li>
<li>R tricks for research and professional life</li>
<li>Data wrangling with R</li>
</ul></li>
<li>Hypothesis Testing Fundamentals
<ul>
<li>Alternative hypothesis testing</li>
<li>How to calculate p-values</li>
<li>Hypothesis testing with null hypothesis</li>
<li>Hypothesis testing on averages</li>
</ul></li>
<li>Analysis of Variance (ANOVA)
<ul>
<li>Testing more than 2 means</li>
</ul></li>
<li>Chi-Square Tests
<ul>
<li>Testing more than 2 proportions</li>
</ul></li>
<li>Linear Regression Analysis
<ul>
<li>Simple linear regression</li>
<li>Multiple linear regression</li>
<li>Nonlinear regression</li>
<li>Regression with dummy variables</li>
</ul></li>
<li>Logistic Regression
<ul>
<li>Introduction to logistic regression</li>
</ul></li>
</ul>
</div>
<div id="part-2-advanced-modeling-prof.-sophie-dabo-niang" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Part 2: Advanced Modeling (Prof.¬†Sophie Dabo-Niang)</h3>
<ul>
<li>Factor Analysis</li>
<li>Cluster Analysis</li>
<li>Discrimination &amp; Classification</li>
<li>Binomial &amp; Multinomial Logistic Regression</li>
<li>Kernel Methods</li>
<li>General Additive Models</li>
<li>Other Supervised Models</li>
</ul>
<!---
- Other supervised classification models: outline of regression trees approach (CART), CHAID, C.5, Random Forest, and Gradient Boosting classification algorithms; Bagging, Boosting and other ensembling techniques; Approach to the evaluation criteria of a binary classification model. 
--->
</div>
</div>
<div id="exam" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Exam üìù</h2>
<p>The exam is going to be open and closed questions on theory and practice (coding part). You will be asked to provide results and sometimes code leading to these results. You can also be asked to directly provide code to solve for that exercise. The exam is going to take place in labs classroom, this means you are <strong>not</strong> going to have your laptop during the exam. We generally don‚Äôt provide assignment neither group works. Indeed we provide intermediate exams for those who want to try them.</p>
<p>we are going to have <strong>2 intermediate sessions</strong> exams on half of the whole content of the course. This means:
- <em>first intermediate</em>: will happen typically on <strong>November</strong> and will be on Part 1 content (Dr.¬†Salvini‚Äôs part)
- <em>second intermediate</em>: will happen in <strong>January/February</strong> on Part 2 content (Prof.¬†Dabo-Niang‚Äôs part)</p>
<p>you can take first intermediate and take the second on each exam date within the winter session, meaning you take part 1 in Nov and part 2 in either Jan and Feb.¬†You can <strong>not</strong> reject intermediates, that means if you take first part, try the second and did not perform well, you need to take the full. Grades may undergo to a review process before being official if they are particularly low. This has happened quite often, but it does not happen every time.</p>
</div>
<div id="suggested-reading" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> üìö Suggested reading list</h2>
<p>I am going to split resources by the expected level of their audience:</p>
<div id="minimal-or-0-knowledge-of-r" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Minimal or 0 knowledge of R</h3>
<ul>
<li>Everitt, B., Hothorn, T. (2011) An Introduction to Applied Multivariate Analysis with R, Springer-Verlag</li>
<li>James, G, Witten, D, Hastie, T and Tibshirani, R, (2015) An Introduction to Statistical Learning, with Applications in R</li>
<li>T. Timbers, T. Campbell, M. Lee Data Science: A First Introduction, Jul 2022 <a href="https://datasciencebook.ca/">online version</a></li>
<li>Wickham, H., Grolemund G. (2018) R for Data Science, O‚ÄôReilly. Freely available on-line at <a href="https://r4ds.had.co.nz/index.html" class="uri">https://r4ds.had.co.nz/index.html</a></li>
<li>R for non-programmers, Daniel Dauber 2022, <a href="https://bookdown.org/daniel_dauber_io/r4np_book/starting-your-r-projects.html">free book</a></li>
</ul>
</div>
<div id="advanced-knowledge-of-r-to-become-a-top-g" class="section level3" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Advanced knowledge of R to become a top G</h3>
<ul>
<li>Reproducible Medical Research with R,Peter D.R. Higgins, MD, PhD, MSc, 2022, <a href="https://bookdown.org/pdr_higgins/rmrwr/">free book</a></li>
<li>Fundamentals of Wrangling Healthcare Data with R, J. Kyle Armstrong 2022, <a href="https://bookdown.org/jkylearmstrong/jeff_data_wrangling/">free book</a> <strong>Advanced</strong></li>
<li>Wickham H. (2015). Advanced r. CRC Press <a href="https://adv-r.hadley.nz/">free book</a></li>
</ul>
</div>
</div>
<div id="honorcode" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> üìú Honor Code</h2>
<p>Permissive but strict. If unsure, please ask the course staff!</p>
<ul>
<li><span style="color: red;"><b>NOT OKAY</b></span> Pleeease, I am using ChatGPT and its derivatives on a daily basis. I understand, it‚Äôs awesome and we are not enforcing any rule against it a home. Don‚Äôt do that during the exam.</li>
<li><span style="color: green;"><b>OK</b></span> to search, ask in public about the systems we‚Äôre studying. Cite all the resources you reference.
E.g. if you read it in a paper, cite it. If you ask on Quora, include the link.</li>
<li><span style="color: red;"><b>NOT OKAY</b></span> to ask someone to do assignments/projects for you, we are monitoring freelancing websites, we have a plethora of bots doing this job daily.</li>
<li><span style="color: green;"><b>OK</b></span> to discuss questions with classmates. Disclose your discussion partners.</li>
<li><span style="color: red;"><b>NOT OKAY</b></span> to blindly copy solutions from classmates.</li>
<li><span style="color: green;"><b>OK</b></span> to use existing solutions as part of your projects/assignments. Clarify your contributions.</li>
<li><span style="color: red;"><b>NOT OKAY</b></span> to pretend that someone‚Äôs solution is yours.</li>
<li><span style="color: green;"><b>OK</b></span> to publish your final project after the course is over (we encourage that and if you need it I would love to help you!)</li>
<li><span style="color: red;"><b>NOT OKAY</b></span> to post your assignment solutions online.</li>
</ul>
</div>
<div id="qr-code-time" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> QR code time!</h2>
<p><img src="images/qr-code.png" width="100%" /></p>
</div>
<div id="intro-colophon" class="section level2" number="1.8">
<h2><span class="header-section-number">1.8</span> Colophon</h2>
<p>This book was authored using <a href="https://bookdown.org/">bookdown</a> inside <a href="https://www.rstudio.com/products/rstudio/">RStudio</a> with <a href="https://pkgs.rstudio.com/bookdown/reference/bs4_book.html">bs4 theme</a>
The <a href="sbd-labs-25-26.netlify.app">website</a> is hosted with <a href="https://www.netlify.com">Netlify</a>, and automatically updated after Netlify CI.
The complete source is available from <a href="https://github.com/NiccoloSalvini/sbd_25-26">GitHub</a>.</p>
<p>This version of the book was built with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; Caricamento del pacchetto richiesto: usethis</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(roxygen2)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(testthat)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; Caricamento pacchetto: &#39;testthat&#39;</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; Il seguente oggetto `e mascherato da &#39;package:devtools&#39;:</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt;     test_file</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; Il seguente oggetto `e mascherato da &#39;package:dplyr&#39;:</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt;     matches</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; - Session info -------------------------------------------</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt;  setting  value</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt;  version  R version 4.2.0 (2022-04-22)</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt;  os       macOS 15.6.1</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt;  system   aarch64, darwin20</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt;  ui       X11</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt;  language (EN)</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt;  collate  C</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt;  ctype    C</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt;  tz       Europe/Rome</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co">#&gt;  date     2025-12-02</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="co">#&gt;  pandoc   3.7.0.2 @ /opt/homebrew/bin/ (via rmarkdown)</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="co">#&gt; - Packages -----------------------------------------------</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="co">#&gt;  package      * version    date (UTC) lib source</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co">#&gt;  bookdown       0.29       2022-09-12 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="co">#&gt;  brio           1.1.3      2021-11-30 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="co">#&gt;  bslib          0.5.1      2023-08-11 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="co">#&gt;  cachem         1.0.8      2023-05-01 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="co">#&gt;  callr          3.7.3      2022-11-02 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="co">#&gt;  cli            3.6.2      2023-12-11 [1] CRAN (R 4.2.3)</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a><span class="co">#&gt;  crayon         1.5.2      2022-09-29 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="co">#&gt;  devtools     * 2.4.5      2022-10-11 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a><span class="co">#&gt;  dichromat      2.0-0.1    2022-05-02 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="co">#&gt;  digest         0.6.33     2023-07-07 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a><span class="co">#&gt;  downlit        0.4.2      2022-07-05 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a><span class="co">#&gt;  dplyr        * 1.1.4      2023-11-17 [1] CRAN (R 4.2.3)</span></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="co">#&gt;  ellipsis       0.3.2      2021-04-29 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a><span class="co">#&gt;  evaluate       1.0.3      2025-01-10 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="co">#&gt;  fansi          1.0.4      2023-01-22 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a><span class="co">#&gt;  farver         2.1.1      2022-07-06 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a><span class="co">#&gt;  fastmap        1.1.1      2023-02-24 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a><span class="co">#&gt;  fs             1.6.3      2023-07-20 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a><span class="co">#&gt;  generics       0.1.3      2022-07-05 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a><span class="co">#&gt;  glue         * 1.6.2      2022-02-24 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a><span class="co">#&gt;  htmltools      0.5.6.1    2023-10-06 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a><span class="co">#&gt;  htmlwidgets    1.6.2      2023-03-17 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a><span class="co">#&gt;  httpuv         1.6.6      2022-09-08 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a><span class="co">#&gt;  httr           1.4.6      2023-05-08 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a><span class="co">#&gt;  jquerylib      0.1.4      2021-04-26 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a><span class="co">#&gt;  jsonlite       1.8.7      2023-06-29 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a><span class="co">#&gt;  kableExtra   * 1.3.4.9000 2023-06-01 [1] Github (kupietz/kableExtra@3bf9b21)</span></span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a><span class="co">#&gt;  knitr        * 1.44       2023-09-11 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a><span class="co">#&gt;  later          1.3.0      2021-08-18 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a><span class="co">#&gt;  lifecycle      1.0.3      2022-10-07 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a><span class="co">#&gt;  lubridate    * 1.9.2      2023-02-10 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a><span class="co">#&gt;  magrittr       2.0.3      2022-03-30 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a><span class="co">#&gt;  memoise        2.0.1      2021-11-26 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a><span class="co">#&gt;  mime           0.12       2021-09-28 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a><span class="co">#&gt;  miniUI         0.1.1.1    2018-05-18 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-64"><a href="#cb1-64" tabindex="-1"></a><span class="co">#&gt;  pillar         1.9.0      2023-03-22 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-65"><a href="#cb1-65" tabindex="-1"></a><span class="co">#&gt;  pkgbuild       1.4.2      2023-06-26 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-66"><a href="#cb1-66" tabindex="-1"></a><span class="co">#&gt;  pkgconfig      2.0.3      2019-09-22 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-67"><a href="#cb1-67" tabindex="-1"></a><span class="co">#&gt;  pkgload        1.4.0      2024-06-28 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-68"><a href="#cb1-68" tabindex="-1"></a><span class="co">#&gt;  prettyunits    1.1.1      2020-01-24 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-69"><a href="#cb1-69" tabindex="-1"></a><span class="co">#&gt;  processx       3.8.4      2024-03-16 [1] CRAN (R 4.2.3)</span></span>
<span id="cb1-70"><a href="#cb1-70" tabindex="-1"></a><span class="co">#&gt;  profvis        0.3.8      2023-05-02 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-71"><a href="#cb1-71" tabindex="-1"></a><span class="co">#&gt;  promises       1.2.0.1    2021-02-11 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-72"><a href="#cb1-72" tabindex="-1"></a><span class="co">#&gt;  ps             1.7.5      2023-04-18 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-73"><a href="#cb1-73" tabindex="-1"></a><span class="co">#&gt;  purrr          1.0.2      2023-08-10 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-74"><a href="#cb1-74" tabindex="-1"></a><span class="co">#&gt;  R6             2.5.1      2021-08-19 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-75"><a href="#cb1-75" tabindex="-1"></a><span class="co">#&gt;  RColorBrewer   1.1-3      2022-04-03 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-76"><a href="#cb1-76" tabindex="-1"></a><span class="co">#&gt;  Rcpp           1.0.12     2024-01-09 [1] CRAN (R 4.2.3)</span></span>
<span id="cb1-77"><a href="#cb1-77" tabindex="-1"></a><span class="co">#&gt;  remotes        2.4.2      2021-11-30 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-78"><a href="#cb1-78" tabindex="-1"></a><span class="co">#&gt;  rlang          1.1.3      2024-01-10 [1] CRAN (R 4.2.3)</span></span>
<span id="cb1-79"><a href="#cb1-79" tabindex="-1"></a><span class="co">#&gt;  rmarkdown      2.25       2023-09-18 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-80"><a href="#cb1-80" tabindex="-1"></a><span class="co">#&gt;  roxygen2     * 7.3.1      2024-01-22 [1] CRAN (R 4.2.3)</span></span>
<span id="cb1-81"><a href="#cb1-81" tabindex="-1"></a><span class="co">#&gt;  rstudioapi     0.14       2022-08-22 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-82"><a href="#cb1-82" tabindex="-1"></a><span class="co">#&gt;  rvest          1.0.3      2022-08-19 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-83"><a href="#cb1-83" tabindex="-1"></a><span class="co">#&gt;  sass           0.4.6      2023-05-03 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-84"><a href="#cb1-84" tabindex="-1"></a><span class="co">#&gt;  scales         1.4.0      2025-04-24 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-85"><a href="#cb1-85" tabindex="-1"></a><span class="co">#&gt;  sessioninfo    1.2.2      2021-12-06 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-86"><a href="#cb1-86" tabindex="-1"></a><span class="co">#&gt;  shiny          1.7.2      2022-07-19 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-87"><a href="#cb1-87" tabindex="-1"></a><span class="co">#&gt;  stringi        1.7.12     2023-01-11 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-88"><a href="#cb1-88" tabindex="-1"></a><span class="co">#&gt;  stringr        1.5.0      2022-12-02 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-89"><a href="#cb1-89" tabindex="-1"></a><span class="co">#&gt;  svglite        2.1.1      2023-01-10 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-90"><a href="#cb1-90" tabindex="-1"></a><span class="co">#&gt;  systemfonts    1.0.4      2022-02-11 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-91"><a href="#cb1-91" tabindex="-1"></a><span class="co">#&gt;  testthat     * 3.2.1.1    2024-04-14 [1] CRAN (R 4.2.3)</span></span>
<span id="cb1-92"><a href="#cb1-92" tabindex="-1"></a><span class="co">#&gt;  tibble         3.2.1      2023-03-20 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-93"><a href="#cb1-93" tabindex="-1"></a><span class="co">#&gt;  tidyselect     1.2.0      2022-10-10 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-94"><a href="#cb1-94" tabindex="-1"></a><span class="co">#&gt;  timechange     0.2.0      2023-01-11 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-95"><a href="#cb1-95" tabindex="-1"></a><span class="co">#&gt;  urlchecker     1.0.1      2021-11-30 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-96"><a href="#cb1-96" tabindex="-1"></a><span class="co">#&gt;  usethis      * 2.1.6      2022-05-25 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-97"><a href="#cb1-97" tabindex="-1"></a><span class="co">#&gt;  utf8           1.2.3      2023-01-31 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-98"><a href="#cb1-98" tabindex="-1"></a><span class="co">#&gt;  vctrs          0.6.5      2023-12-01 [1] CRAN (R 4.2.3)</span></span>
<span id="cb1-99"><a href="#cb1-99" tabindex="-1"></a><span class="co">#&gt;  viridisLite    0.4.2      2023-05-02 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-100"><a href="#cb1-100" tabindex="-1"></a><span class="co">#&gt;  webexercises * 1.0.0      2021-09-15 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-101"><a href="#cb1-101" tabindex="-1"></a><span class="co">#&gt;  webshot        0.5.4      2022-09-26 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-102"><a href="#cb1-102" tabindex="-1"></a><span class="co">#&gt;  withr          3.0.2      2024-10-28 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-103"><a href="#cb1-103" tabindex="-1"></a><span class="co">#&gt;  xfun           0.40       2023-08-09 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-104"><a href="#cb1-104" tabindex="-1"></a><span class="co">#&gt;  xml2           1.3.4      2023-04-27 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-105"><a href="#cb1-105" tabindex="-1"></a><span class="co">#&gt;  xtable         1.8-4      2019-04-21 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-106"><a href="#cb1-106" tabindex="-1"></a><span class="co">#&gt;  yaml           2.3.7      2023-01-23 [1] CRAN (R 4.2.0)</span></span>
<span id="cb1-107"><a href="#cb1-107" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-108"><a href="#cb1-108" tabindex="-1"></a><span class="co">#&gt;  [1] /Users/niccolo/Library/R/arm64/4.2/library</span></span>
<span id="cb1-109"><a href="#cb1-109" tabindex="-1"></a><span class="co">#&gt;  [2] /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library</span></span>
<span id="cb1-110"><a href="#cb1-110" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-111"><a href="#cb1-111" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------------------------</span></span></code></pre></div>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="part-get-started" class="section level1 unnumbered">
<h1 class="unnumbered">(PART*) Get Started</h1>
</div>
<div id="prereq" class="section level1" number="2">
<h1><span class="header-section-number">2</span> ‚ú®Prerequisites</h1>
<div id="setting-up-r-and-rstudio" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Setting up R and RStudio</h2>
<p>To get started with R, you need to acquire your own copy. This appendix will show you how to download R as well as RStudio, a software application that makes R easier to use. You‚Äôll go from downloading R to opening your first R session. Use the menu on the right hand side of the page to select your OS and follow the correct installation.</p>
<p>Both R and RStudio are free and easy to download. <strong>If you feel more comfortable interacting with videos instead of reading</strong> please visit <ins> <a href="https://learnr-examples.shinyapps.io/ex-setup-r/">this interactive tutorials</a> </ins> that will guide you through the full R set up!</p>
</div>
<div id="how-to-download-and-install-r" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> How to Download and Install R</h2>
<p>R is maintained by an international team of developers who make the language available through the web page of The Comprehensive R Archive Network i.e.¬†CRAN. The top of the web page provides three links for downloading R. Follow the link that describes your operating system: Windows, Mac, or Linux.</p>
<div id="r-in-windows" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> <strong>R in Windows</strong></h3>
<p>To install R on Windows, click the ‚ÄúDownload R for Windows‚Äù link. Then click the ‚Äúbase‚Äù link. Next, click the first link at the top of the new page. This link should say something like ‚ÄúDownload R 3.0.3 for Windows,‚Äù except the 3.0.3 will be replaced by the most current version of R. The link downloads an installer program, which installs the most up-to-date version of R for Windows. Run this program and step through the installation wizard that appears. The wizard will install R into your program files folders and place a shortcut in your Start menu. Note that you‚Äôll need to have all of the appropriate administration privileges to install new software on your machine. (more detailed steps)</p>
</div>
<div id="r-in-mac" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> <strong>R in Mac</strong></h3>
<p>This is also my setup, feel free to reach me at <a href="mailto:niccolo.salvini27@gmail.com">my mail address</a> if something is messed up.</p>
<ol style="list-style-type: decimal">
<li>Go to <a href="www.r-project.org">www.r-project.org</a></li>
</ol>
<div class="figure">
<img src="images/cpt_1/00_r_project_page.png" alt="The R mirrors website" width="100%" />
<p class="caption">
(#fig:rproj-page)The R mirrors website
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Click on <code>CRAN</code> where it says <code>Download</code>.</p></li>
<li><p>Choose a server in your country (all of them work, but downloads will perform quicker if you choose your country or one that is close to where you are).</p></li>
</ol>
<div class="figure">
<img src="images/cpt_1/01_r_project_cran_mirror.png" alt="CRAN mirrors" width="100%" />
<p class="caption">
(#fig:cran-mirrors)CRAN mirrors
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Select the operating system for your computer, for example <code>Download R for macOS</code>.</li>
</ol>
<div class="figure">
<img src="images/cpt_1/02_r_project_os_choice.png" alt="OS choices available" width="100%" />
<p class="caption">
(#fig:os-choice)OS choices available
</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li>Select the version you want to install (I recommend the latest version)</li>
</ol>
<div class="figure">
<img src="images/cpt_1/03_r_project_version_choice.png" alt="R versions available" width="100%" />
<p class="caption">
(#fig:r-versions)R versions available
</p>
</div>
<ol start="6" style="list-style-type: decimal">
<li>Open the downloaded file and follow the installation instructions. I recommend leaving the suggested settings as they are.</li>
</ol>
<div class="note">
<p><strong>Binaries Versus Source</strong></p>
<p>R can be installed from precompiled binaries or built from source on any operating system. For Windows and Mac machines, installing R from binaries is extremely easy. The binary comes preloaded in its own installer. Although you can build R from source on these platforms, the process is much more complicated and won‚Äôt provide much benefit for most users. For Linux systems, the opposite is true. Precompiled binaries can be found for some systems, but it is much more common to build R from source files when installing on Linux. The download pages on CRAN‚Äôs website provide information about building R from source for the Windows, Mac, and Linux platforms.</p>
</div>
</div>
<div id="r-in-linux" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> <strong>R in Linux</strong></h3>
<p>R comes preinstalled on many Linux systems, but you‚Äôll want the newest version of R if yours is out of date. The CRAN website provides files to build R from source on Debian, Redhat, SUSE, and Ubuntu systems under the link ‚ÄúDownload R for Linux.‚Äù Click the link and then follow the directory trail to the version of Linux you wish to install on. The exact installation procedure will vary depending on the Linux system you use. CRAN guides the process by grouping each set of source files with documentation or README files that explain how to install on your system.</p>
<div class="note">
<p><strong>32-bit Versus 64-bit</strong></p>
<p>R comes in both 32-bit and 64-bit versions. Which should you use? In most cases, it won‚Äôt matter. Both versions use 32-bit integers, which means they compute numbers to the same numerical precision. The difference occurs in the way each version manages memory. 64-bit R uses 64-bit memory pointers, and 32-bit R uses 32-bit memory pointers. This means 64-bit R has a larger memory space to use (and search through).
As a rule of thumb, 32-bit builds of R are faster than 64-bit builds, though not always. On the other hand, 64-bit builds can handle larger files and data sets with fewer memory management problems. In either version, the maximum allowable vector size tops out at around 2 billion elements. If your operating system doesn‚Äôt support 64-bit programs, or your RAM is less than 4 GB, 32-bit R is for you. The Windows and Mac installers will automatically install both versions if your system supports 64-bit R.</p>
</div>
</div>
</div>
<div id="using-r" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Using R</h2>
<p>R isn‚Äôt a program that you can open and start using, like Microsoft Word or Internet Explorer. Instead, R is a computer language, like C, C++, or UNIX. You use R by writing commands in the R language and asking your computer to interpret them. In the old days, people ran R code in a UNIX terminal window‚Äîas if they were hackers in a movie from the 1980s. Now almost everyone uses R with an application called RStudio, and I recommend that you do, too.</p>
<div class="fyi">
<p><strong>R and UNIX</strong></p>
<p>You can still run R in a UNIX or BASH window (prompt or Powershell) by typing the command:
R
which opens an R interpreter. You can then do your work and close the interpreter by running <code>q()</code> when you are finished.</p>
</div>
</div>
<div id="using-rstudio" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Using RStudio</h2>
<p><em>R</em> by itself is just the ‚Äò<em>beating heart</em>‚Äô of <em>R</em> programming, but it has no particular user interface. You may have heard me saying stuff like: ‚ÄúR is the <strong>engine</strong> of the car, indeed RStudio is the <strong>car body</strong>, that‚Äôs true, you just don‚Äôt need an engine if you don‚Äôt have a car body. That is to say: if you want buttons to click and actually ‚Äò<em>see</em>‚Äô what you are doing, there is no better way than RStudio.
RStudio is an <em>integrated development environment</em> (IDE) and will be our primary tool to interact with <em>R</em>. It is the only software you need to do all the fun parts and, of course, to follow along with the examples of this book.
You may ask yourself what is Posit, fair question. Back in the days Posit, the company behind RStudio, was actually named RStudio (as their product). Then in 2023 they rebranded themselves as Posit to also include other languages like Python,</p>
<p>Howeveeeer to install RStudio perform the following steps:</p>
<ol style="list-style-type: decimal">
<li>Go to <a href="https://posit.co/" title="https://posit.co/">https://posit.co/</a></li>
</ol>
<div class="figure">
<img src="images/cpt_1/01_rstudio_main_page.png" alt="The Posit.co main page" width="100%" />
<p class="caption">
(#fig:rstudio-main)The Posit.co main page
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Go to <code>DOWNLOAD RSTUDIO</code> in the upper right corner (download R if you still haven‚Äôt).</p></li>
<li><p>Select <code>DOWNLOAD RSTUDIO</code>, just on the left of <code>DOWNLOAD RSTUDIO SERVER</code>.</p></li>
</ol>
<div class="figure">
<img src="images/cpt_1/03_rstudio_select_version.png" alt="Choose RStudio version" width="100%" />
<p class="caption">
(#fig:rstudio-select-version)Choose RStudio version
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>On this page, scroll down and select the Download (in the download column) corresponding to your OS (mind that different versions of the same OS, say macOS 11.2 or macOS 8.3 need different RStudio download installations).</li>
</ol>
<div class="figure">
<img src="images/cpt_1/04_rstudio_select_edition.png" alt="Choose RStudio version" width="100%" />
<p class="caption">
(#fig:rstudio-select-os-version)Choose RStudio version
</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li>Open the downloaded file and follow the installation instructions. Again, keep it to the default settings as much as possible.</li>
</ol>
<p>Congratulations, you are all set up to learn <em>R</em>. From now on you only need to start RStudio and not <em>R</em>. Of course, if you are the curious type, nothing shall stop you to try <em>R</em> without RStudio.</p>
</div>
<div id="when-you-first-start-rstudio" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> When you first start RStudio</h2>
<p>Before you start programming away, you might want to make some tweaks to your settings right away to have a better experience (in my humble opinion). To open the Rstudio settings you have to click on</p>
<ul>
<li><p><code>RStudio &gt; Preferences</code> or press <code>‚åò + ,</code> if you are on a Mac.</p></li>
<li><p><code>RStudio &gt; Tools &gt; Global Options</code> or press <code>Ctrl + ,</code> if you work on a Windows computer.</p></li>
</ul>
<p>I recommend to at least make the following changes to set yourself up for success right from the beginning:</p>
<ol style="list-style-type: decimal">
<li><p>Already on the first tab, i.e.¬†<code>General &gt; Basic</code>, we should make one of the most significant changes. Deactivate every option that starts with <code>Restore</code>. This will ensure that every time you start RStudio, you begin with a clean slate. At first sight, it might sound counter-intuitive not to restart everything where you left off, but it is essential to make all your projects easily reproducible. Furthermore, if you work together with others, not restoring your personal settings also ensures that your programming works across different computers. Therefore, I recommend having the following unticked:</p>
<ul>
<li><p><code>Restore most recently opened project at startup</code>,</p></li>
<li><p><code>Restore previsouly open source documents at startup</code>,</p></li>
<li><p><code>Restore .Rdata into workspace at startup</code></p></li>
</ul></li>
</ol>
<div class="figure">
<img src="images/cpt_1/00_rstudio_preferences_basic.png" alt="get your RStudio preferences" width="100%" />
<p class="caption">
(#fig:rstudio-preferences)get your RStudio preferences
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>In the same tab under <code>Workspace</code>, select <code>Never</code> for the setting <code>Save workspace to .RData on exit</code>. One might think it is wise to keep intermediary results stored from one R session to another. However, I often found myself fixing issues due to this lazy method, and my code became less reliable and, therefore, reproducible. With experience, you will find that this avoids many headaches.</p></li>
<li><p>In the <code>Code &gt; Editing</code> tab, make sure to have at least the first five options ticked, especially the <code>Auto-indent code after paste</code>. This setting will save time when trying to format your coding appropriately, making it easier to read. Indentation is the primary way of making your code look more readable and less like a series of characters that appear almost random.</p></li>
</ol>
<div class="figure">
<img src="images/cpt_1/01_rstudio_preferences_editing.png" alt="Pimp your RStudio IDE" width="100%" />
<p class="caption">
(#fig:rstudio-prefediting)Pimp your RStudio IDE
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>In the <code>Display</code> tab, you might want to have the first three options selected. In particular, <code>Highlight selected line</code> is helpful because, in more complicated code, it is helpful to see where your cursor is.</li>
</ol>
<div class="figure">
<img src="images/cpt_1/02_rstudio_preferences_display.png" alt="Edit your RStudio display preferences" width="100%" />
<p class="caption">
(#fig:rstudio-prefdisp)Edit your RStudio display preferences
</p>
</div>
<p>Of course, if you wish to customise your workspace further, you can do so. The visually most impactful way to alter the default appearance of RStudio is to select <code>Appearance</code> and pick a completely different colour theme. Feel free to browse through various options and see what you prefer. There is no right or wrong here. Just make it your own.</p>
<div class="figure">
<img src="images/cpt_1/03_rstudio_preferences_appearance.png" alt="This will get you instantly nerd" width="100%" />
<p class="caption">
(#fig:rstudio-prefappear)This will get you instantly nerd
</p>
</div>
</div>
<div id="updating-r-and-rstudio" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Updating R and RStudio: Living at the pulse of innovation</h2>
<p>While not strictly something that helps you become a better programmer, this advice might come in handy to avoid turning into a frustrated programmer. When you update your software, you need to update <em>R</em> and RStudio separately from each other. While both <em>R</em> and RStudio work closely with each other, they still constitute separate pieces of software. Thus, it is essential to keep in mind that updating RStudio will not automatically update R. This can become problematic if specific tools you installed via RStudio (like a fancy learning algorithm) might not be compatible with earlier versions of <em>R</em>. Also, additional <em>R</em> packages (see Chapter @ref(r-packages)) developed by other developers are separate pieces which require updating too, independently from <em>R</em> and RStudio.</p>
<p>I know what you are thinking: This already sounds complicated and cumbersome. However, rest assured, we take a look at how you can easily update all your packages with RStudio. Thus, all you need to remember is: <em>R</em> needs to be updated separately from everything else.</p>
<!--chapter:end:01-prerequisites.Rmd-->
</div>
</div>
<div id="r-packages" class="section level1" number="3">
<h1><span class="header-section-number">3</span> üì¶ R Packages</h1>
<p>Many of R‚Äôs most useful functions do not come preloaded when you start R, but reside in packages that can be installed on top of R. R packages are similar to libraries in C, C++, and Javascript, packages in Python, and gems in Ruby. An R package bundles together useful functions, help files, and data sets. You can use these functions within your own R code once you load the package they live in. Usually the contents of an R package are all related to a single type of task, which the package helps solve. R packages will let you take advantage of R‚Äôs most useful features: its large community of package writers (many of whom are active data scientists) and its prewritten routines for handling many common (and exotic) data-science tasks.</p>
<div class="fyi">
<p><strong>Base R</strong>
You may hear R users (or me) refer to ‚Äúbase R.‚Äù What is base R? It is just the collection of R functions that gets loaded every time you start R. These functions provide the basics of the language, and you don‚Äôt have to load a package before you can use them.</p>
</div>
<div id="installing-packages" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Installing Packages</h2>
<p>To use an R package, you must first install it on your computer and then load it in your current R session. The easiest way to install an R package is with the <code>install.packages</code> R function. Open R and type the following into the command line:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;&lt;package name&gt;&quot;</span>)</span></code></pre></div>
<p>This will search for the specified package in the collection of packages hosted on the CRAN site. When R finds the package, it will download it into a libraries folder on your computer. R can access the package here in future R sessions without reinstalling it. Anyone can write an R package and disseminate it as they like; however, almost all R packages are published through the CRAN website. CRAN tests each R package before publishing it. This doesn‚Äôt eliminate every bug inside a package, but it does mean that you can trust a package on CRAN to run in the current version of R on your OS.</p>
<p>You can install multiple packages at once by linking their names with R‚Äôs concatenate function, c.¬†For example, to install the ggplot2, reshape2, and dplyr packages, run:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;carData&quot;</span>, <span class="st">&quot;spdep&quot;</span>))</span></code></pre></div>
<p>If this is your first time installing a package, R will prompt you to choose an online mirror of to install from. Mirrors are listed by location. Your downloads should be quickest if you select a mirror that is close to you. If you want to download a new package, try the Austria mirror first. This is the main CRAN repository, and new packages can sometimes take a couple of days to make it around to all of the other mirrors.</p>
</div>
<div id="loading-packages" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Loading Packages</h2>
<p>Installing a package doesn‚Äôt immediately place its functions at your fingertips. It just places them on your computer. To use an R package, you next have to load it in your R session with the command:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;&lt;package name&gt;&quot;</span>)</span></code></pre></div>
<p>Notice that the quotation marks have disappeared. You can use them if you like, but quotation marks are optional for the <code>library</code> command. (This is not true for the <code>install.packages</code> command).</p>
<p><code>library</code> will make all of the package‚Äôs functions, data sets, and help files available to you until you close your current R session. The next time you begin an R session, you‚Äôll have to reload the package with <code>library</code> if you want to use it, but you won‚Äôt have to reinstall it. You only have to install each package once. After that, a copy of the package will live in your R library. To see which packages you currently have in your R library, run:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>()</span></code></pre></div>
<p><code>library()</code> also shows the path to your actual R library, which is the folder that contains your R packages. You may notice many packages that you don‚Äôt remember installing. This is because R automatically downloads a set of useful packages when you first install R.</p>
<div class="note">
<p><strong>Install packages from (almost) anywhere</strong></p>
<p>The devtools R package makes it easy to install packages from locations other than the CRAN website. devtools provides functions like install_github, install_gitorious, install_bitbucket, and install_url. These work similar to install.packages, but they search new locations for R packages. install_github is especially useful because many R developers provide development versions of their packages on GitHub. The development version of a package will contain a sneak peek of new functions and patches but may not be as stable or as bug free as the CRAN version.</p>
</div>
<p>Why does R make you bother with installing and loading packages? You can imagine an R where every package came preloaded, but this would be a very large and slow program. As of May 6, 2014, the CRAN website hosts 5,511 packages. It is simpler to only install and load the packages that you want to use when you want to use them. This keeps your copy of R fast because it has fewer functions and help pages to search through at any one time. The arrangement has other benefits as well. For example, it is possible to update your copy of an R package without updating your entire copy of R.</p>
<div class="fyi">
<p><strong>What‚Äôs the best way to learn about R packages?</strong></p>
<p>It is difficult to use an R package if you don‚Äôt know that it exists. You could go to the CRAN website and click the Packages link to see a list of available packages, but you‚Äôll have to wade through thousands of them. Moreover, many R packages do the same things.</p>
<p>How do you know which package does them best? The R-packages <a href="https://stat.ethz.ch/mailman/listinfo/r-packages">mailing list</a> is a place to start. It sends out announcements of new packages and maintains an archive of old announcements. Blogs that aggregate posts about R can also provide valuable leads. I recommend R-bloggers. RStudio maintains a list of some of the most useful R packages in the Getting Started section of <a href="http://support.rstudio.com" class="uri">http://support.rstudio.com</a>. Finally, CRAN groups together some of the most useful‚Äîand most respected‚Äîpackages by <a href="https://cran.r-project.org/web/views/">subject area</a>. This is an excellent place to learn about the packages designed for your area of work.</p>
</div>
</div>
<div id="updating-r-and-its-packages" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Updating R and Its Packages</h2>
<p>The R Core Development Team continuously hones the R language by catching bugs, improving performance, and updating R to work with new technologies. As a result, new versions of R are released several times a year. The easiest way to stay current with R is to periodically check the CRAN website. The website is updated for each new release and makes the release available for download. You‚Äôll have to install the new release. The process is the same as when you first installed R.</p>
<p>Don‚Äôt worry if you‚Äôre not interested in staying up-to-date on R Core‚Äôs doings. R changes only slightly between releases, and you‚Äôre not likely to notice the differences. However, updating to the current version of R is a good place to start if you ever encounter a bug that you can‚Äôt explain.</p>
<p>RStudio also constantly improves its product. You can acquire the newest updates just by downloading them from <a href="https://www.rstudio.com/products/rstudio/">RStudio</a>.</p>
<div id="r-packages-1" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> <strong>R Packages</strong></h3>
<p>Package authors occasionally release new versions of their packages to add functions, fix bugs, or improve performance. The <code>update.packages</code> command checks whether you have the most current version of a package and installs the most current version if you do not. The syntax for <code>update.packages</code> follows that of <code>install.packages</code>. If you already have <code>ggplot2</code>, <code>reshape2</code>, and <code>dplyr</code> on your computer, it‚Äôd be a good idea to check for updates before you use them:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">update.packages</span>(<span class="fu">c</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;carData&quot;</span>, <span class="st">&quot;spdep&quot;</span>))</span></code></pre></div>
<p>You should start a new R session after updating packages. If you have a package loaded when you update it, you‚Äôll have to close your R session and open a new one to begin using the updated version of the package.</p>
<!--chapter:end:02-rpackages.Rmd-->
</div>
</div>
</div>
<div id="nice-warm-up" class="section level1" number="4">
<h1><span class="header-section-number">4</span> üî• Nice warm-up</h1>
<p>Now we are going to cover some very basic operations and computer science concepts with R. Hopefully this will get you with a really cool starter pack of function that you might reuse throughout you R journey.</p>
<!-- Some other very insightful resources related to wrangling Healthcare data according to `{Tidyverse}` conventions may include (by proficiency level): -->
<!-- - Fundamentals of Wrangling Healthcare Data with R, J. Kyle Armstrong 2022, [free book](https://bookdown.org/jkylearmstrong/jeff_data_wrangling/) -->
<!-- -  -->
<!-- -  -->
<div id="starting-your-fresh-new-r-project" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Starting your fresh new R project</h2>
<p>Every fresh attempt is likely to pique your interest and pique your emotions. And it should. You will uncover the answers to your research questions, and you should become more knowledgeable as a consequence. However, you are likely to dislike certain aspects of data analysis. Two examples spring to mind:</p>
<ul>
<li><p><strong>A</strong> Keeping track of all the files generated by my project</p></li>
<li><p><strong>B</strong> Data manipulation</p></li>
</ul>
<p>While we will go into deeper detail on data manipulation in a later chapter, I‚Äôd like to share some ideas from my work that helped me stay organized and, as a result, less frustrated. The following is applicable to both small and large research projects, making it extremely useful regardless of the circumstance or size of the project.</p>
</div>
<div id="creating-an-r-project" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Creating an <em>R</em> Project file</h2>
<p>When working on a project, you likely create many different files for various purposes, especially <em>R</em> Scripts (<code>File &gt; New File &gt; R Script</code>). If you are not careful, this file is stored in your system‚Äôs default location, which might not be where you want them to be. RStudio allows you to manage your entire project intuitively and conveniently through <em>R</em> Project files. Using <em>R</em> Project files comes with a couple of perks, for example:</p>
<ul>
<li><p>All of the files you create are saved in the same location. Your data, coding, exported charts, reports, and so on are all in one location, so you don‚Äôt have to maintain the files manually. This is because RStudio sets the root directory to the folder where your project is stored.</p></li>
<li><p>If you wish to share your project, you may do so by sharing the entire folder, and others can rapidly replicate your study or assist in issue resolution. This is due to the fact that all file paths are relative rather than absolute.</p></li>
<li><p>You may utilize GitHub more readily for backups and so-called ‚Äòversion control‚Äô tools, which allows you to trace changes to your code over time. (btw this is really crucial in work envirnoments, if you would like to know more about that I dedicated a <a href="https://corso-git.netlify.app/">tutorial website</a> of git+GitHub+RStudio workflow and a set of slides to explain these concepts). This is <strong>not a requirement</strong> for the course and you can skip that. However let me clarify that: it is a nice-to-have skill whenever you are collaborating with someone. It could happen on the job, or while writing your thesis, you name it.</p></li>
</ul>
<p>For the time being, the most significant reason to make <em>R</em> Project files is the ease of file organization and the ability to readily share them with co-investigators, your supervisor, or your students.</p>
<p>To create an R Project, you need to perform the following steps:</p>
<ol style="list-style-type: decimal">
<li>Select <code>File &gt; New Project‚Ä¶</code> from the menu bar.</li>
</ol>
<div class="figure">
<img src="images/cpt_3/00_r_project_file_menu.png" alt="Get the R project" width="100%" />
<p class="caption">
(#fig:rproj-menu)Get the R project
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Select <code>New Directory</code> from the popup window.</li>
</ol>
<div class="figure">
<img src="images/cpt_3/01_r_project_new_directory.png" alt="New Project Wizard pop up menu" width="100%" />
<p class="caption">
(#fig:rproj-new-dir)New Project Wizard pop up menu
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Next, select <code>New Project</code>.</li>
</ol>
<div class="figure">
<img src="images/cpt_3/02_r_project_new_project.png" alt="The full set of project you can initialize through the RStudio IDE" width="100%" />
<p class="caption">
(#fig:rproj-open-new-dir)The full set of project you can initialize through the RStudio IDE
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Pick a meaningful name for your project folder, i.e.¬†the <code>Directory Name</code>. Ensure this project folder is created in the right place. You can change the <code>subdirectory</code> by clicking on <code>Browse‚Ä¶</code>. Ideally the subdirectory is a place where you usually store your research projects.</li>
</ol>
<div class="figure">
<img src="images/cpt_3/03_r_project_specs.png" alt="The RProject specifications" width="100%" />
<p class="caption">
(#fig:rproj-specs)The RProject specifications
</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li><p>You have the option to <code>Create a git repository</code>. This is only relevant if you already have a GitHub account and wish to use version control. For now, you can happily ignore it if you do not use GitHub.</p></li>
<li><p>Lastly, tick <code>Open in new session</code>. This will open your <em>R</em> Project in a new RStudio window.</p></li>
</ol>
<div class="figure">
<img src="images/cpt_3/04_r_project_directory_name.png" alt="Choose a directory name for your new project" width="100%" />
<p class="caption">
(#fig:rproj-dirname)Choose a directory name for your new project
</p>
</div>
<ol start="7" style="list-style-type: decimal">
<li>Once you are happy with your choices, you can click <code>Create Project</code>. This will open a new <em>R</em> Session, and you can start working on your project.</li>
</ol>
<div class="figure">
<img src="images/cpt_3/05_r_project_new_session.png" alt="A new RStudio Session will pop up just like magic!" width="100%" />
<p class="caption">
(#fig:rproj-open-new-session)A new RStudio Session will pop up just like magic!
</p>
</div>
<p>If you look carefully, you can see that your RStudio is now ‚Äòbranded‚Äô with your project name. At the top of the window, you see the project name, the files pane shows the root directory where all your files will be, and even the console shows on top the file path of your project. You could set all this up manually, but I would not recommend it, not the least because it is easy and swift to work with <em>R</em> Projects</p>
</div>
<div id="workdir" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Working Directory with <code>here</code></h2>
<p>When you bootstrap your RProject in that way, RStudio is going to take care of many headaches that any fresher and sophmore developer have in the beginning. As a matter of fact each time you double click on the RStudio project file (the one that finishes with .RProj) RStudio will link itself to the directory on your computer you specified during the creation of the project, in the previous case ‚Äútidy_tuesday_2021_08_03‚Äù. This is called the <strong>Working Directory</strong>.
What it is interesting it that this place is where R will look for files when you attempt to load them, and it is where R will save files when you save them. The location of your working directory will vary on different computers.
There is a <em>base</em> (rather vintage) way to look for the working directory.
To understrand which directory R is using as your working directory, run:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="do">## &quot;/Users/niccolo/Desktop/r_projects/sbd_22-23&quot;</span></span></code></pre></div>
<p>However since we live in 2022 we are going to use a very convenient package i.e.¬†<code>here</code> that does exactly the same thing but prettier and more intuitively.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;here&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">here</span>()</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="do">## &quot;/Users/niccolo/Desktop/r_projects/sbd_22-23&quot;</span></span></code></pre></div>
<p><code>here()</code> is going to look for the <code>.RProj</code> file and will the Working Directory exactly where it is placed.</p>
</div>
<div id="creating-an-r-script" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Creating an R Script</h2>
<p>Code may easily grow lengthy and complicated. As a result, writing it on the console is inconvenient. As an alternative, we may write code into a R Script. An R Script is a document that is recognized by RStudio as R programming code. Non-R Script files, such as <code>.txt</code>,<code>.rtf</code>, or <code>.md</code>, can also be opened in RStudio, but any code typed in them will not be immediately recognized.</p>
<p>When you open or create a new R script, it will appear in the Source pane. This window is sometimes referred to as the ‚Äòscript editor‚Äô. An R script begins with an empty file. Good coding etiquette requires us to put a comment # on the first line to describe what this file does. Here‚Äôs a ‚ÄòTidyTuesday‚Äô R Project sample.</p>
<div class="figure">
<img src="images/cpt_3/00_r_script.png" alt="Open an R Script and write some on it" width="100%" />
<p class="caption">
(#fig:rscript)Open an R Script and write some on it
</p>
</div>
<p>All of the examples in this tutorial are made to be copied and pasted into your own R script. However, you will need to install the R packages for certain code. Let‚Äôs give it a shot with the following code. The plot produced by this code displays which car company provides the most fuel-efficient vehicles. This code should be copied and pasted into your R script. Below there‚Äôs a simple script that generates a plot, copy and paste into your file, then execute it.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(manufacturer, <span class="fu">desc</span>(hwy), <span class="at">FUN =</span> median),</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                   <span class="at">y =</span> hwy,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                   <span class="at">fill =</span> manufacturer)) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Manufacturer&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Highway miles per gallon&quot;</span>)</span></code></pre></div>
<p><img src="03-nicewarmup_files/figure-html/R%20Script%20copy%20and%20paste%20examples-1.png" width="100%" /></p>
<p>You‚Äôre probably wondering what happened to your plot. Copying the code will not execute it in your <em>R</em> script. However, this is required in order to develop the plot. If you pressed <code>Return ‚Üµ</code>, you would just add a new line. Instead, choose the code you wish to run and hit <code>Ctrl+Return ‚Üµ</code> (PC) or <code>Cmd+Return ‚Üµ</code> (Mac). You may also use the <code>Run</code> command at the top of your source window, but the keyboard shortcut is far more convenient. Furthermore, you will rapidly remember this shortcut because we will need to utilize it frequently. If everything is in order, you should see the following:</p>
<p>As you can see, Honda automobiles appear to travel the furthest with the same quantity of fuel (a gallon) as other vehicles. As a result, if you‚Äôre seeking for cheap automobiles, you now know where to look at.</p>
<p>It‚Äôs worth noting that the R script editor includes some handy features for developing code. You‚Äôve undoubtedly noticed that part of the code we‚Äôve pasted is blue and others is green. Because they have a distinct significance, these colors aid in making your code more understandable. In the default settings, green represents any value in ‚Äú‚Äú, which often represents characters. Syntax highlighting refers to the automatic coloring of our programming code.</p>
</div>
<div id="using-r-markdown" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Using R Markdown</h2>
<p>There is too lot to say about R Markdown, so I‚Äôll just mention that it exists and highlight one feature that could persuade you to use it instead of plain R scripts: They appear to be <em>Word documents</em> (almost).</p>
<p>R Markdown files, as the name implies, are a mix of R scripts and ‚ÄòMarkdown.‚Äô ‚ÄòMarkdown‚Äô is a method of composing and formatting text documents without the use of software such as Microsoft Word. You instead write everything in plain text. Such plain text may be translated into a variety of document forms, including HTML webpages, PDF files, and Word documents. I recommend checking out the <a href="https://www.rstudio.com/resources/cheatsheets/">R Markdown Cheatsheet</a> to learn how it works. <code>Click File &gt; New File &gt; R Markdown</code> to create a R Markdown file.</p>
<p>An R Markdown file is the inverse of a R script. By default, a R script treats everything as code, and we can only use language to describe what the code does by commenting <code>#</code>. This is what you‚Äôve seen in all of the previous code examples. An R Markdown file, on the other hand, treats everything as text and requires us to declare what is code. We may accomplish this by injecting ‚Äòcode chunks.‚Äô As a result, using comments <code>#</code> in R Markdown files is less necessary because you may write about it. Another advantage of R Markdown files is that the results of your analysis are shown immediately underneath the code chunk rather than in the terminal. They are also sometimes called <strong>notebooks</strong> since they can display both code and text together, the Python equivalent for those that have been someway exposed to Python scripting in <strong>Jupyter</strong></p>
<!--chapter:end:03-nicewarmup.Rmd-->
</div>
</div>
<div id="syllabus" class="section level1" number="5">
<h1><span class="header-section-number">5</span> üóíÔ∏è Syllabus</h1>
<p>The lecture slides, notes, tutorials, and assignments will be posted on <ins> <a href="https://drive.google.com/drive/folders/1e1HVjSYABJ8rLUErHWbQOhAhQ_OA_Xo9?usp=sharing">this drive</a> </ins>, feel free to jump on it. please do not anticipate questions that we will address in class, instead <a href="mailto:niccolo.salvini27@gmail.com">drop me a mail</a> if you are not sure about something.</p>
<p>If for any reasons you have trouble accessing the G Drive, still please contact <a href="mailto:niccolo.salvini27@gmail.com">your teaching assistant</a>. One common issue students complain is that you may need to be authorization to access, because I may have forgotten to switch on the open to share option. If you see me, knock me on the shoulder!</p>
<p>This schedule is subject to change according to the pace of the class and we may schedule a further lab if you feel you are not really ready for the intermediate exam.</p>
<p>This is the updated edition of this course with Dr.¬†Niccol√≤ Salvini (Part 1) and Prof.¬†Sophie Dabo-Niang (Part 2).</p>
<div id="course-materials" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Course Materials</h2>
<p>All course materials are available in the <code>slides/</code> folder:</p>
<div id="part-1-the-foundations-dr.-niccol√≤-salvini-1" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Part 1: The Foundations (Dr.¬†Niccol√≤ Salvini)</h3>
<p><strong>Slides by Dr.¬†Niccol√≤ Salvini:</strong>
- <a href="slides/02_hypt_testing_null_hypo.pdf">Hypothesis Testing with Null Hypothesis</a>
- <a href="slides/03_hypt_testing_alternative_hypo.pdf">Hypothesis Testing with Alternative Hypothesis</a>
- <a href="slides/04_how_to_calculate_pvalues.pdf">How to Calculate P-values</a>
- <a href="slides/hypt_testing_on_avg.pdf">Hypothesis Testing on Averages</a>
- <a href="slides/05_hypt_testing_exeR.pdf">Exercises on Hypothesis Testing</a>
- <a href="slides/mlt_lin_reg.pdf">Multiple Linear Regression</a>
- <a href="slides/nonlinear_regression.pdf">Nonlinear Regression</a>
- <a href="slides/intro_linear_regr.pdf">Introduction to Linear Regression</a>
- <a href="slides/intro%20to%20logistic%20regression.pdf">Introduction to Logistic Regression</a></p>
<p><strong>Slides by Prof.¬†Vincenzo Nardelli:</strong>
- <a href="slides/linear_regression.pdf">Linear Regression</a></p>
<p><strong>Laboratori Modulo 2 (Dr.¬†Niccol√≤ Salvini):</strong>
- <a href="slides/module_2_PCA_CA.pdf">PCA &amp; Correspondence Analysis</a>
- <a href="slides/module_2_hierarchical_clustering.pdf">Hierarchical Clustering</a>
- <a href="slides/module_2_kmeans_clustering.pdf">K-Means Clustering</a></p>
</div>
<div id="part-2-advanced-modeling-prof.-sophie-dabo-niang-1" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Part 2: Advanced Modeling (Prof.¬†Sophie Dabo-Niang)</h3>
<ul>
<li>Materials will be provided during the intensive session (week of November 17th)</li>
</ul>
</div>
</div>
<div id="course-structure" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Course Structure</h2>
<p><strong>Part 1: The Foundations (Dr.¬†Niccol√≤ Salvini)</strong>
- 5 hours of integrated labs during regular lectures
- Mondays: 14:00 - 17:00 CET
- Tuesdays: 10:00 - 13:00 CET</p>
<p><strong>Part 2: Advanced Modeling (Prof.¬†Sophie Dabo-Niang)</strong>
- 5 hours intensive session during the week of November 17th</p>
<p>to be ready:</p>
<table style="width:100%;">
<colgroup>
<col width="6%" />
<col width="36%" />
<col width="46%" />
<col width="9%" />
</colgroup>
<thead>
<tr>
<th>Date</th>
<th>Description</th>
<th>Materials</th>
<th>Events</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sept 22-23</td>
<td>Introduction to RStudio + Hypothesis Testing Fundamentals</td>
<td><a href="slides/02_hypt_testing_null_hypo.pdf">Null Hypothesis Testing</a></td>
<td>Laboratory + Lecture</td>
</tr>
<tr>
<td>Sept 22-23</td>
<td>Alternative Hypothesis Testing + P-values Calculation</td>
<td><a href="slides/03_hypt_testing_alternative_hypo.pdf">Alternative Hypothesis</a></td>
<td>Laboratory + Lecture</td>
</tr>
<tr>
<td>Sept 22-23</td>
<td>How to Calculate P-values</td>
<td><a href="slides/04_how_to_calculate_pvalues.pdf">P-values Calculation</a></td>
<td>Laboratory + Lecture</td>
</tr>
<tr>
<td>[TBD]</td>
<td>Hypothesis Testing on Averages</td>
<td><a href="slides/hypt_testing_on_avg.pdf">Testing on Averages</a> and <a href="slides/05_hypt_testing_exeR.pdf">Exercises</a></td>
<td>Laboratory</td>
</tr>
<tr>
<td>[TBD]</td>
<td>Chi-Square Tests (more than 2 proportions)</td>
<td><a href="slides/hypt_testing_null_hypo.pdf">Null Hypothesis Testing</a></td>
<td>Laboratory</td>
</tr>
<tr>
<td>Sept 29-30, Oct 6-7</td>
<td>Simple Linear Regression</td>
<td><a href="slides/intro_linear_regr.pdf">Introduction to Linear Regression</a>, <a href="slides/linear_regression.pdf">Linear Regression</a></td>
<td>Laboratory + Theory</td>
</tr>
<tr>
<td>Sept 29-30, Oct 6-7</td>
<td>Multiple Linear Regression</td>
<td><a href="slides/mlt_lin_reg.pdf">Multiple Linear Regression</a></td>
<td>Laboratory + Theory</td>
</tr>
<tr>
<td>Sept 29-30, Oct 6-7</td>
<td>Nonlinear Regression + Dummy Variables</td>
<td><a href="slides/nonlinear_regression.pdf">Nonlinear Regression</a></td>
<td>Laboratory + Theory</td>
</tr>
<tr>
<td>Oct 7</td>
<td>Logistic Regression</td>
<td><a href="slides/intro%20to%20logistic%20regression.pdf">Introduction to Logistic Regression</a></td>
<td>Laboratory + Theory</td>
</tr>
<tr>
<td>[TBD]</td>
<td>First Intermediate Exam (Part 1)</td>
<td></td>
<td>Exam</td>
</tr>
<tr>
<td>Week of Nov 17th</td>
<td>Intensive Session - Advanced Modeling</td>
<td>Materials provided during session</td>
<td>Laboratory</td>
</tr>
<tr>
<td>[TBD]</td>
<td>Second Intermediate Exam (Part 2)</td>
<td></td>
<td>Exam</td>
</tr>
</tbody>
</table>
<!--chapter:end:04-syllabus.Rmd-->
</div>
</div>
<div id="part-part-1-the-foundations" class="section level1 unnumbered">
<h1 class="unnumbered">(PART*) Part 1: The Foundations</h1>
</div>
<div id="hypothesis-testing-fundamentals" class="section level1" number="6">
<h1><span class="header-section-number">6</span> üß™ Hypothesis Testing Fundamentals</h1>
<p>This chapter introduces the fundamental concepts of hypothesis testing, covering alternative hypothesis testing, p-value calculation, and hypothesis testing with null hypothesis.</p>
<div id="learning-objectives" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Learning Objectives</h2>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>Understand the concept of hypothesis testing</li>
<li>Formulate null and alternative hypotheses</li>
<li>Calculate and interpret p-values</li>
<li>Perform hypothesis tests on averages</li>
<li>Make statistical decisions based on test results</li>
</ul>
</div>
<div id="introduction-to-hypothesis-testing" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Introduction to Hypothesis Testing</h2>
<p>Hypothesis testing is a statistical method used to make decisions about population parameters based on sample data. It involves:</p>
<ol style="list-style-type: decimal">
<li><strong>Formulating hypotheses</strong>: Stating a null hypothesis (H‚ÇÄ) and an alternative hypothesis (H‚ÇÅ)</li>
<li><strong>Collecting data</strong>: Gathering sample data relevant to the hypothesis</li>
<li><strong>Calculating test statistics</strong>: Computing appropriate test statistics</li>
<li><strong>Making decisions</strong>: Comparing test statistics to critical values or p-values</li>
</ol>
</div>
<div id="null-and-alternative-hypotheses" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Null and Alternative Hypotheses</h2>
<div id="null-hypothesis-h‚ÇÄ" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Null Hypothesis (H‚ÇÄ)</h3>
<p>The null hypothesis represents the status quo or the claim we want to test. It typically states that there is no effect, no difference, or no relationship.</p>
<p><strong>Examples:</strong>
- H‚ÇÄ: Œº = 50 (population mean equals 50)
- H‚ÇÄ: Œº‚ÇÅ = Œº‚ÇÇ (two population means are equal)
- H‚ÇÄ: œÅ = 0 (no correlation between variables)</p>
</div>
<div id="alternative-hypothesis-h‚ÇÅ" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Alternative Hypothesis (H‚ÇÅ)</h3>
<p>The alternative hypothesis represents what we want to prove or the claim we‚Äôre testing for. It can be:</p>
<ul>
<li><strong>One-tailed</strong>: H‚ÇÅ: Œº &gt; 50 or H‚ÇÅ: Œº &lt; 50</li>
<li><strong>Two-tailed</strong>: H‚ÇÅ: Œº ‚â† 50</li>
</ul>
</div>
</div>
<div id="p-values-and-statistical-significance" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> P-values and Statistical Significance</h2>
<div id="what-is-a-p-value" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> What is a P-value?</h3>
<p>The p-value is the probability of observing a test statistic as extreme as, or more extreme than, the one calculated from the sample data, assuming the null hypothesis is true.</p>
</div>
<div id="interpreting-p-values" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Interpreting P-values</h3>
<ul>
<li><strong>p &lt; 0.05</strong>: Strong evidence against H‚ÇÄ (reject H‚ÇÄ)</li>
<li><strong>p &lt; 0.01</strong>: Very strong evidence against H‚ÇÄ (reject H‚ÇÄ)</li>
<li><strong>p &gt; 0.05</strong>: Weak evidence against H‚ÇÄ (fail to reject H‚ÇÄ)</li>
</ul>
</div>
<div id="common-misconceptions" class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Common Misconceptions</h3>
<ul>
<li>P-value is NOT the probability that H‚ÇÄ is true</li>
<li>P-value is NOT the probability that H‚ÇÅ is true</li>
<li>P-value is NOT the probability of making a Type I error</li>
</ul>
</div>
</div>
<div id="hypothesis-testing-on-averages" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Hypothesis Testing on Averages</h2>
<div id="one-sample-t-test" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> One-Sample t-test</h3>
<p>Used to test whether a population mean differs from a specified value.</p>
<p><strong>Assumptions:</strong>
- Data is normally distributed (or large sample size)
- Observations are independent
- Random sampling</p>
<p><strong>Test Statistic:</strong></p>
<pre><code>t = (xÃÑ - Œº‚ÇÄ) / (s/‚àön)</code></pre>
<p>Where:
- xÃÑ = sample mean
- Œº‚ÇÄ = hypothesized population mean
- s = sample standard deviation
- n = sample size</p>
</div>
<div id="two-sample-t-test" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Two-Sample t-test</h3>
<p>Used to compare means between two groups.</p>
<p><strong>Types:</strong>
- <strong>Independent samples</strong>: Two separate groups
- <strong>Paired samples</strong>: Same subjects measured twice</p>
</div>
</div>
<div id="practical-example" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Practical Example</h2>
<p>Let‚Äôs work through a practical example using R:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># Example: Testing if a new teaching method improves test scores</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co"># H‚ÇÄ: Œº_new = Œº_old (no difference in means)</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># H‚ÇÅ: Œº_new &gt; Œº_old (new method is better)</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>old_method <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">69</span>, <span class="dv">71</span>, <span class="dv">67</span>, <span class="dv">73</span>, <span class="dv">70</span>, <span class="dv">68</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>new_method <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">72</span>, <span class="dv">75</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">76</span>, <span class="dv">79</span>, <span class="dv">73</span>, <span class="dv">77</span>, <span class="dv">75</span>, <span class="dv">74</span>)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co"># Perform two-sample t-test</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(new_method, old_method, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="fu">print</span>(t_test_result)</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co"># Extract p-value</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>p.value</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co"># Make decision</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Reject H‚ÇÄ: New method significantly improves scores</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Fail to reject H‚ÇÄ: No significant improvement</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="type-i-and-type-ii-errors" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Type I and Type II Errors</h2>
<div id="type-i-error-Œ±" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Type I Error (Œ±)</h3>
<ul>
<li><strong>Definition</strong>: Rejecting H‚ÇÄ when it‚Äôs actually true</li>
<li><strong>Probability</strong>: Œ± (significance level, typically 0.05)</li>
<li><strong>Consequence</strong>: False positive</li>
</ul>
</div>
<div id="type-ii-error-Œ≤" class="section level3" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Type II Error (Œ≤)</h3>
<ul>
<li><strong>Definition</strong>: Failing to reject H‚ÇÄ when it‚Äôs actually false</li>
<li><strong>Probability</strong>: Œ≤</li>
<li><strong>Consequence</strong>: False negative</li>
</ul>
</div>
<div id="power-1---Œ≤" class="section level3" number="6.7.3">
<h3><span class="header-section-number">6.7.3</span> Power (1 - Œ≤)</h3>
<ul>
<li><strong>Definition</strong>: Probability of correctly rejecting H‚ÇÄ when it‚Äôs false</li>
<li><strong>Goal</strong>: Maximize power while controlling Type I error</li>
</ul>
</div>
</div>
<div id="best-practices" class="section level2" number="6.8">
<h2><span class="header-section-number">6.8</span> Best Practices</h2>
<ol style="list-style-type: decimal">
<li><strong>State hypotheses clearly</strong> before collecting data</li>
<li><strong>Choose appropriate significance level</strong> (usually Œ± = 0.05)</li>
<li><strong>Check assumptions</strong> before performing tests</li>
<li><strong>Report effect sizes</strong> along with p-values</li>
<li><strong>Avoid p-hacking</strong> (don‚Äôt change hypotheses after seeing results)</li>
<li><strong>Consider multiple comparisons</strong> when testing many hypotheses</li>
</ol>
</div>
<div id="summary" class="section level2" number="6.9">
<h2><span class="header-section-number">6.9</span> Summary</h2>
<p>Hypothesis testing is a powerful statistical tool for making data-driven decisions. Key points to remember:</p>
<ul>
<li>Always formulate clear null and alternative hypotheses</li>
<li>Understand what p-values represent and don‚Äôt represent</li>
<li>Consider both statistical and practical significance</li>
<li>Be aware of Type I and Type II errors</li>
<li>Follow best practices to ensure valid results</li>
</ul>
</div>
<div id="further-on" class="section level2" number="6.10">
<h2><span class="header-section-number">6.10</span> Further-on</h2>
<ul>
<li>Slides: <code>02_hypt_testing_null_hypo.pdf</code>, <code>03_hypt_testing_alternative_hypo.pdf</code>, <code>04_how_to_calculate_pvalues.pdf</code>, <code>hypt_testing_on_avg.pdf</code>, <code>05_hypt_testing_exeR.pdf</code></li>
<li>Additional resources available in the course drive</li>
</ul>
<!--chapter:end:05-hypothesis-testing-fundamentals.Rmd-->
</div>
</div>
<div id="linear-regression-analysis" class="section level1" number="7">
<h1><span class="header-section-number">7</span> üìà Linear Regression Analysis</h1>
<p>This chapter covers linear regression analysis, including simple linear regression, multiple linear regression, and nonlinear regression techniques.</p>
<div id="learning-objectives-1" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Learning Objectives</h2>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>Understand the principles of linear regression</li>
<li>Perform simple and multiple linear regression</li>
<li>Interpret regression coefficients and statistics</li>
<li>Assess model fit and assumptions</li>
<li>Handle nonlinear relationships</li>
<li>Use R for regression analysis</li>
</ul>
</div>
<div id="introduction-to-linear-regression" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Introduction to Linear Regression</h2>
<p>Linear regression is a statistical method used to model the relationship between a dependent variable (Y) and one or more independent variables (X). It assumes a linear relationship between the variables.</p>
<div id="simple-linear-regression" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Simple Linear Regression</h3>
<p>Simple linear regression models the relationship between two variables:</p>
<p><strong>Model</strong>: Y = Œ≤‚ÇÄ + Œ≤‚ÇÅX + Œµ</p>
<p>Where:
- Y = dependent variable (response)
- X = independent variable (predictor)
- Œ≤‚ÇÄ = intercept
- Œ≤‚ÇÅ = slope
- Œµ = error term</p>
</div>
<div id="multiple-linear-regression" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Multiple Linear Regression</h3>
<p>Multiple linear regression extends simple regression to include multiple predictors:</p>
<p><strong>Model</strong>: Y = Œ≤‚ÇÄ + Œ≤‚ÇÅX‚ÇÅ + Œ≤‚ÇÇX‚ÇÇ + ‚Ä¶ + Œ≤‚ÇñX‚Çñ + Œµ</p>
</div>
</div>
<div id="assumptions-of-linear-regression" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Assumptions of Linear Regression</h2>
<ol style="list-style-type: decimal">
<li><strong>Linearity</strong>: The relationship between X and Y is linear</li>
<li><strong>Independence</strong>: Observations are independent</li>
<li><strong>Homoscedasticity</strong>: Constant variance of errors</li>
<li><strong>Normality</strong>: Errors are normally distributed</li>
<li><strong>No multicollinearity</strong>: Independent variables are not highly correlated</li>
</ol>
</div>
<div id="model-evaluation-metrics" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Model Evaluation Metrics</h2>
<div id="r-squared-r¬≤" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> R-squared (R¬≤)</h3>
<ul>
<li><strong>Definition</strong>: Proportion of variance in Y explained by X</li>
<li><strong>Range</strong>: 0 to 1</li>
<li><strong>Interpretation</strong>: Higher values indicate better fit</li>
</ul>
</div>
<div id="adjusted-r-squared" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Adjusted R-squared</h3>
<ul>
<li><strong>Definition</strong>: R¬≤ adjusted for the number of predictors</li>
<li><strong>Use</strong>: Compare models with different numbers of predictors</li>
<li><strong>Formula</strong>: 1 - (1-R¬≤)(n-1)/(n-k-1)</li>
</ul>
</div>
<div id="root-mean-square-error-rmse" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Root Mean Square Error (RMSE)</h3>
<ul>
<li><strong>Definition</strong>: Standard deviation of residuals</li>
<li><strong>Interpretation</strong>: Lower values indicate better fit</li>
<li><strong>Units</strong>: Same as dependent variable</li>
</ul>
</div>
</div>
<div id="practical-example-simple-linear-regression" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Practical Example: Simple Linear Regression</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co"># Fit simple linear regression</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co"># View model summary</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co"># Extract key statistics</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>model_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> model_summary<span class="sc">$</span>r.squared</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>adj_r_squared <span class="ot">&lt;-</span> model_summary<span class="sc">$</span>adj.r.squared</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> model_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;R-squared:&quot;</span>, <span class="fu">round</span>(r_squared, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Adjusted R-squared:&quot;</span>, <span class="fu">round</span>(adj_r_squared, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value:&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Simple Linear Regression&quot;</span>,</span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Independent Variable (X)&quot;</span>,</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Dependent Variable (Y)&quot;</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
<div id="multiple-linear-regression-1" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Multiple Linear Regression</h2>
<div id="example-with-multiple-predictors" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Example with Multiple Predictors</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">library</span>(car)  <span class="co"># for VIF calculation</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Create sample data with multiple predictors</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">8</span>)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> x2 <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">*</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2, <span class="at">x3 =</span> x3, <span class="at">y =</span> y)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co"># Fit multiple linear regression</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co"># View model summary</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co"># Check for multicollinearity using VIF</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model)</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Variance Inflation Factors:&quot;</span>)</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="fu">print</span>(vif_values)</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co"># Interpretation guidelines:</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co"># VIF &lt; 5: No multicollinearity concern</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co"># VIF 5-10: Moderate multicollinearity</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co"># VIF &gt; 10: High multicollinearity</span></span></code></pre></div>
</div>
</div>
<div id="nonlinear-regression" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Nonlinear Regression</h2>
<p>When the relationship between variables is not linear, we can use nonlinear regression techniques.</p>
<div id="polynomial-regression" class="section level3" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> Polynomial Regression</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Create nonlinear data</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># Fit polynomial regression (quadratic)</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>model_poly <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> data)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co"># View model summary</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="fu">summary</span>(model_poly)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Polynomial Regression (Quadratic)&quot;</span>,</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Independent Variable (X)&quot;</span>,</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Dependent Variable (Y)&quot;</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
<div id="logarithmic-transformation" class="section level3" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> Logarithmic Transformation</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Create exponential data</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">0.5</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.1</span>))</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co"># Fit log-transformed model</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co"># View model summary</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="fu">summary</span>(model_log)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Log-transformed Regression&quot;</span>,</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Independent Variable (X)&quot;</span>,</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Dependent Variable (Y) - Log Scale&quot;</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
</div>
<div id="model-diagnostics" class="section level2" number="7.8">
<h2><span class="header-section-number">7.8</span> Model Diagnostics</h2>
<div id="residual-analysis" class="section level3" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> Residual Analysis</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># Get residuals and fitted values</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>model_data <span class="ot">&lt;-</span> <span class="fu">augment</span>(model)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co"># Residual plots</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co"># 1. Residuals vs Fitted Values</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="fu">ggplot</span>(model_data, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Residuals vs Fitted Values&quot;</span>,</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Fitted Values&quot;</span>,</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Residuals&quot;</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co"># 2. Q-Q Plot for normality</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="fu">ggplot</span>(model_data, <span class="fu">aes</span>(<span class="at">sample =</span> .resid)) <span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Q-Q Plot of Residuals&quot;</span>,</span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Theoretical Quantiles&quot;</span>,</span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Sample Quantiles&quot;</span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a><span class="co"># 3. Scale-Location Plot</span></span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a><span class="fu">ggplot</span>(model_data, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(.resid)))) <span class="sc">+</span></span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scale-Location Plot&quot;</span>,</span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Fitted Values&quot;</span>,</span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;‚àö|Standardized Residuals|&quot;</span></span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
</div>
<div id="best-practices-1" class="section level2" number="7.9">
<h2><span class="header-section-number">7.9</span> Best Practices</h2>
<ol style="list-style-type: decimal">
<li><strong>Check assumptions</strong> before interpreting results</li>
<li><strong>Use appropriate transformations</strong> for nonlinear relationships</li>
<li><strong>Avoid overfitting</strong> by not including too many predictors</li>
<li><strong>Consider interaction terms</strong> when theoretically justified</li>
<li><strong>Report confidence intervals</strong> for coefficients</li>
<li><strong>Validate models</strong> using cross-validation when possible</li>
</ol>
</div>
<div id="common-pitfalls" class="section level2" number="7.10">
<h2><span class="header-section-number">7.10</span> Common Pitfalls</h2>
<ol style="list-style-type: decimal">
<li><strong>Correlation vs Causation</strong>: Regression doesn‚Äôt imply causation</li>
<li><strong>Extrapolation</strong>: Be cautious when predicting outside the data range</li>
<li><strong>Outliers</strong>: Check for influential observations</li>
<li><strong>Missing data</strong>: Handle missing values appropriately</li>
<li><strong>Model selection</strong>: Use appropriate criteria for model comparison</li>
</ol>
</div>
<div id="summary-1" class="section level2" number="7.11">
<h2><span class="header-section-number">7.11</span> Summary</h2>
<p>Linear regression is a fundamental statistical technique for modeling relationships between variables. Key points:</p>
<ul>
<li>Understand the assumptions and check them</li>
<li>Use appropriate metrics to evaluate model fit</li>
<li>Consider nonlinear relationships when necessary</li>
<li>Perform thorough diagnostics</li>
<li>Interpret results carefully and avoid common pitfalls</li>
</ul>
</div>
<div id="further-on-1" class="section level2" number="7.12">
<h2><span class="header-section-number">7.12</span> Further-on</h2>
<ul>
<li>Slides: <code>linear_regression.pdf</code>, <code>mlt_lin_reg.pdf</code>, <code>nonlinear_regression.pdf</code></li>
<li>Additional resources available in the course drive</li>
</ul>
<!--chapter:end:06-linear-regression-analysis.Rmd-->
</div>
</div>
<div id="advanced-statistical-methods" class="section level1" number="8">
<h1><span class="header-section-number">8</span> üî¨ Advanced Statistical Methods</h1>
<p>This chapter covers advanced statistical methods including regression with dummy variables, logistic regression, factor analysis, and cluster analysis.</p>
<div id="learning-objectives-2" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Learning Objectives</h2>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>Understand and implement regression with dummy variables</li>
<li>Perform logistic regression for binary outcomes</li>
<li>Conduct factor analysis to reduce dimensionality</li>
<li>Apply cluster analysis techniques</li>
<li>Interpret results from advanced statistical methods</li>
<li>Use R for advanced statistical analysis</li>
</ul>
</div>
<div id="regression-with-dummy-variables" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Regression with Dummy Variables</h2>
<p>Dummy variables (also called indicator variables) are binary variables (0/1) used to represent categorical data in regression models.</p>
<div id="creating-dummy-variables" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Creating Dummy Variables</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">library</span>(fastDummies)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co"># Create sample data with categorical variable</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;High School&quot;</span>, <span class="st">&quot;Bachelor&quot;</span>, <span class="st">&quot;Master&quot;</span>, <span class="st">&quot;PhD&quot;</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>experience <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">30000</span> <span class="sc">+</span> <span class="dv">5000</span> <span class="sc">*</span> (education <span class="sc">==</span> <span class="st">&quot;Bachelor&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>          <span class="dv">8000</span> <span class="sc">*</span> (education <span class="sc">==</span> <span class="st">&quot;Master&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>          <span class="dv">12000</span> <span class="sc">*</span> (education <span class="sc">==</span> <span class="st">&quot;PhD&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>          <span class="dv">2000</span> <span class="sc">*</span> experience <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3000</span>)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">education =</span> education, <span class="at">experience =</span> experience, <span class="at">salary =</span> salary)</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co"># Create dummy variables</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>data_dummy <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(data, <span class="at">select_columns =</span> <span class="st">&quot;education&quot;</span>, <span class="at">remove_first_dummy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co"># View the data</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="fu">head</span>(data_dummy)</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co"># Fit regression with dummy variables</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> experience <span class="sc">+</span> education_Bachelor <span class="sc">+</span> education_Master <span class="sc">+</span> education_PhD, </span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>            <span class="at">data =</span> data_dummy)</span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co"># View model summary</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="co"># Alternative: R automatically creates dummy variables</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a>model_auto <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> experience <span class="sc">+</span> education, <span class="at">data =</span> data)</span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="fu">summary</span>(model_auto)</span></code></pre></div>
</div>
<div id="interpreting-dummy-variable-coefficients" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Interpreting Dummy Variable Coefficients</h3>
<ul>
<li><strong>Reference category</strong>: The category not included in the model (usually the first alphabetically)</li>
<li><strong>Coefficients</strong>: Represent the difference from the reference category</li>
<li><strong>Example</strong>: If ‚ÄúHigh School‚Äù is the reference, the coefficient for ‚ÄúBachelor‚Äù represents the additional salary for Bachelor‚Äôs degree holders</li>
</ul>
</div>
</div>
<div id="logistic-regression" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Logistic Regression</h2>
<p>Logistic regression is used when the dependent variable is binary (0/1, Yes/No, Success/Failure).</p>
<div id="binary-logistic-regression" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Binary Logistic Regression</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co"># Create sample data for logistic regression</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">35</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50000</span>, <span class="at">sd =</span> <span class="dv">15000</span>)</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>education_years <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">16</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co"># Create binary outcome (loan approval)</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>log_odds <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fl">0.0001</span> <span class="sc">*</span> income <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> education_years</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_odds) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(log_odds))</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>loan_approved <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob)</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> age, <span class="at">income =</span> income, <span class="at">education_years =</span> education_years, </span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>                   <span class="at">loan_approved =</span> loan_approved)</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co"># Fit logistic regression</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(loan_approved <span class="sc">~</span> age <span class="sc">+</span> income <span class="sc">+</span> education_years, </span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>             <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co"># View model summary</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co"># Extract coefficients and odds ratios</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="fu">print</span>(coef_summary)</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co"># Predict probabilities</span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>data<span class="sc">$</span>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> loan_approved)) <span class="sc">+</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Logistic Regression: Loan Approval vs Income&quot;</span>,</span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Income&quot;</span>,</span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Loan Approved (0/1)&quot;</span></span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
<div id="interpreting-logistic-regression-results" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Interpreting Logistic Regression Results</h3>
<ul>
<li><strong>Coefficients</strong>: Represent the change in log-odds</li>
<li><strong>Odds Ratios</strong>: e^(coefficient) represents the multiplicative change in odds</li>
<li><strong>Probabilities</strong>: Use the logistic function to convert log-odds to probabilities</li>
</ul>
</div>
</div>
<div id="factor-analysis" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Factor Analysis</h2>
<p>Factor analysis is used to identify underlying latent factors that explain the correlations among observed variables.</p>
<div id="exploratory-factor-analysis-efa" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Exploratory Factor Analysis (EFA)</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">library</span>(GPArotation)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co"># Create sample data with underlying factors</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co"># Factor 1: Math ability</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>math1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>math2 <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="sc">*</span> math1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.6</span>)</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>math3 <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="sc">*</span> math1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.7</span>)</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co"># Factor 2: Verbal ability</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>verbal1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>verbal2 <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> verbal1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.4</span>)</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>verbal3 <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="sc">*</span> verbal1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.6</span>)</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>  <span class="at">math_test1 =</span> math1,</span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a>  <span class="at">math_test2 =</span> math2,</span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>  <span class="at">math_test3 =</span> math3,</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>  <span class="at">verbal_test1 =</span> verbal1,</span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a>  <span class="at">verbal_test2 =</span> verbal2,</span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a>  <span class="at">verbal_test3 =</span> verbal3</span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a>)</span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a><span class="co"># Perform factor analysis</span></span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a><span class="co"># First, check if data is suitable for factor analysis</span></span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(data)</span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a><span class="co"># Determine number of factors</span></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="fu">fa.parallel</span>(data, <span class="at">fa =</span> <span class="st">&quot;fa&quot;</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a><span class="co"># Perform factor analysis</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">&quot;varimax&quot;</span>)</span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="fu">print</span>(fa_result)</span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="co"># Plot factor loadings</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a><span class="fu">fa.diagram</span>(fa_result)</span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a><span class="co"># Extract factor scores</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a>factor_scores <span class="ot">&lt;-</span> <span class="fu">factor.scores</span>(data, fa_result)</span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a>data<span class="sc">$</span>factor1 <span class="ot">&lt;-</span> factor_scores<span class="sc">$</span>scores[, <span class="dv">1</span>]</span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a>data<span class="sc">$</span>factor2 <span class="ot">&lt;-</span> factor_scores<span class="sc">$</span>scores[, <span class="dv">2</span>]</span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="co"># Visualize factor scores</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> factor1, <span class="at">y =</span> factor2)) <span class="sc">+</span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Factor Scores&quot;</span>,</span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Factor 1 (Math Ability)&quot;</span>,</span>
<span id="cb19-55"><a href="#cb19-55" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Factor 2 (Verbal Ability)&quot;</span></span>
<span id="cb19-56"><a href="#cb19-56" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-57"><a href="#cb19-57" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
</div>
<div id="cluster-analysis" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Cluster Analysis</h2>
<p>Cluster analysis groups similar observations together based on their characteristics.</p>
<div id="k-means-clustering" class="section level3" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> K-Means Clustering</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co"># Create sample data with clusters</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co"># Generate three clusters</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>cluster1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>  <span class="at">cluster =</span> <span class="dv">1</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>cluster2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>  <span class="at">cluster =</span> <span class="dv">2</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>)</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>cluster3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(n<span class="sc">/</span><span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>  <span class="at">cluster =</span> <span class="dv">3</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>)</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="co"># Combine clusters</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cluster1, cluster2, cluster3)</span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>cluster)</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co"># Perform K-means clustering</span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a>data<span class="sc">$</span>kmeans_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(kmeans_result<span class="sc">$</span>cluster)</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a><span class="co"># Visualize clusters</span></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> cluster)) <span class="sc">+</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;True Clusters&quot;</span>,</span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a></span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> kmeans_cluster)) <span class="sc">+</span></span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;K-means Clusters&quot;</span>,</span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a><span class="co"># Determine optimal number of clusters</span></span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], kmeans, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>)</span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], kmeans, <span class="at">method =</span> <span class="st">&quot;silhouette&quot;</span>)</span></code></pre></div>
</div>
<div id="hierarchical-clustering" class="section level3" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> Hierarchical Clustering</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Perform hierarchical clustering</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>hclust_result <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_matrix, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co"># Plot dendrogram</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="fu">plot</span>(hclust_result, <span class="at">main =</span> <span class="st">&quot;Hierarchical Clustering Dendrogram&quot;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co"># Cut tree to get clusters</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>hclust_clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hclust_result, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>data<span class="sc">$</span>hclust_cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(hclust_clusters)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co"># Visualize hierarchical clusters</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> hclust_cluster)) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Hierarchical Clusters&quot;</span>,</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
</div>
<div id="model-selection-and-validation" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Model Selection and Validation</h2>
<div id="cross-validation-for-logistic-regression" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Cross-Validation for Logistic Regression</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co"># Create binary outcome</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>log_odds <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> x2 <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> x3</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_odds) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(log_odds))</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x1, <span class="at">x2 =</span> x2, <span class="at">x3 =</span> x3, <span class="at">y =</span> y)</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co"># Set up cross-validation</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">classProbs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co"># Train logistic regression model</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">as.factor</span>(y) <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, </span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>               <span class="at">data =</span> data, </span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, </span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>               <span class="at">trControl =</span> ctrl)</span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co"># View results</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="fu">print</span>(model)</span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="fu">print</span>(model<span class="sc">$</span>results)</span></code></pre></div>
</div>
</div>
<div id="best-practices-2" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Best Practices</h2>
<ol style="list-style-type: decimal">
<li><strong>Check assumptions</strong> for each method</li>
<li><strong>Use appropriate sample sizes</strong> for reliable results</li>
<li><strong>Validate models</strong> using cross-validation</li>
<li><strong>Interpret results</strong> in context of the research question</li>
<li><strong>Consider multiple methods</strong> when appropriate</li>
<li><strong>Document decisions</strong> and rationale</li>
</ol>
</div>
<div id="common-pitfalls-1" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> Common Pitfalls</h2>
<ol style="list-style-type: decimal">
<li><strong>Overfitting</strong>: Including too many variables</li>
<li><strong>Multicollinearity</strong>: Highly correlated predictors</li>
<li><strong>Sample size</strong>: Insufficient data for reliable results</li>
<li><strong>Assumptions</strong>: Not checking method-specific assumptions</li>
<li><strong>Interpretation</strong>: Misunderstanding coefficients and results</li>
</ol>
</div>
<div id="summary-2" class="section level2" number="8.9">
<h2><span class="header-section-number">8.9</span> Summary</h2>
<p>Advanced statistical methods provide powerful tools for analyzing complex data. Key points:</p>
<ul>
<li>Choose appropriate methods based on research questions</li>
<li>Check assumptions and validate models</li>
<li>Interpret results carefully and in context</li>
<li>Use multiple methods when appropriate</li>
<li>Document all decisions and rationale</li>
</ul>
</div>
<div id="references" class="section level2" number="8.10">
<h2><span class="header-section-number">8.10</span> References</h2>
<ul>
<li>Slides: Available in the course drive</li>
<li>Additional resources and examples provided in class</li>
<li>R documentation for specific packages used</li>
</ul>
<!--chapter:end:07-advanced-statistical-methods.Rmd-->
</div>
</div>
<div id="part-part-2-advanced-modeling" class="section level1 unnumbered">
<h1 class="unnumbered">(PART*) Part 2: Advanced Modeling</h1>
</div>
<div id="advanced-modeling-techniques" class="section level1" number="9">
<h1><span class="header-section-number">9</span> üöÄ Advanced Modeling Techniques</h1>
<p>This chapter covers advanced modeling techniques taught by Prof.¬†Sophie Dabo-Niang during the intensive session. These methods extend beyond basic statistical analysis to include sophisticated machine learning and modeling approaches.</p>
<div id="learning-objectives-3" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Learning Objectives</h2>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>Understand and apply factor analysis techniques</li>
<li>Perform cluster analysis for data segmentation</li>
<li>Implement discrimination and classification methods</li>
<li>Use binomial and multinomial logistic regression</li>
<li>Apply kernel methods for non-linear relationships</li>
<li>Work with general additive models</li>
<li>Explore other supervised learning models</li>
</ul>
</div>
<div id="course-structure-1" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Course Structure</h2>
<p>This part of the course consists of <strong>5 hours of intensive sessions</strong> held during the week of November 17th. The sessions are designed to provide hands-on experience with advanced modeling techniques that build upon the foundations covered in Part 1.</p>
</div>
<div id="factor-analysis-1" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Factor Analysis</h2>
<p>Factor analysis is a statistical method used to identify underlying latent factors that explain the correlations among observed variables.</p>
<div id="key-concepts" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Key Concepts</h3>
<ul>
<li><strong>Exploratory Factor Analysis (EFA)</strong>: Discovering the underlying structure</li>
<li><strong>Confirmatory Factor Analysis (CFA)</strong>: Testing hypothesized structures</li>
<li><strong>Factor Loadings</strong>: Relationships between variables and factors</li>
<li><strong>Eigenvalues</strong>: Amount of variance explained by each factor</li>
</ul>
</div>
<div id="applications" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Applications</h3>
<ul>
<li>Psychometric testing</li>
<li>Market research</li>
<li>Social science research</li>
<li>Data reduction</li>
</ul>
</div>
</div>
<div id="cluster-analysis-1" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Cluster Analysis</h2>
<p>Cluster analysis groups similar observations together based on their characteristics, without prior knowledge of group membership.</p>
<div id="methods-covered" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Methods Covered</h3>
<ul>
<li><strong>K-means clustering</strong>: Partitioning data into k clusters</li>
<li><strong>Hierarchical clustering</strong>: Building clusters in a tree-like structure</li>
<li><strong>Density-based clustering</strong>: Finding clusters of arbitrary shape</li>
<li><strong>Model-based clustering</strong>: Using statistical models</li>
</ul>
</div>
<div id="applications-1" class="section level3" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Applications</h3>
<ul>
<li>Customer segmentation</li>
<li>Market research</li>
<li>Image segmentation</li>
<li>Gene expression analysis</li>
</ul>
</div>
</div>
<div id="discrimination-classification" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Discrimination &amp; Classification</h2>
<p>These methods aim to classify observations into predefined categories based on their characteristics.</p>
<div id="techniques" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Techniques</h3>
<ul>
<li><strong>Linear Discriminant Analysis (LDA)</strong>: Linear boundaries between classes</li>
<li><strong>Quadratic Discriminant Analysis (QDA)</strong>: Quadratic boundaries</li>
<li><strong>Naive Bayes</strong>: Probabilistic classification</li>
<li><strong>Support Vector Machines (SVM)</strong>: Finding optimal separating hyperplanes</li>
</ul>
</div>
</div>
<div id="logistic-regression-1" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Logistic Regression</h2>
<p>Logistic regression models the probability of categorical outcomes.</p>
<div id="types-covered" class="section level3" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Types Covered</h3>
<ul>
<li><strong>Binomial Logistic Regression</strong>: Binary outcomes (0/1, Yes/No)</li>
<li><strong>Multinomial Logistic Regression</strong>: Multiple categories</li>
<li><strong>Ordinal Logistic Regression</strong>: Ordered categories</li>
</ul>
</div>
<div id="key-concepts-1" class="section level3" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> Key Concepts</h3>
<ul>
<li><strong>Odds and Odds Ratios</strong>: Interpreting coefficients</li>
<li><strong>Maximum Likelihood Estimation</strong>: Parameter estimation</li>
<li><strong>Model Diagnostics</strong>: Assessing model fit</li>
<li><strong>Model Selection</strong>: Choosing appropriate predictors</li>
</ul>
</div>
</div>
<div id="kernel-methods" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Kernel Methods</h2>
<p>Kernel methods extend linear algorithms to handle non-linear relationships by mapping data to higher-dimensional spaces.</p>
<div id="applications-2" class="section level3" number="9.7.1">
<h3><span class="header-section-number">9.7.1</span> Applications</h3>
<ul>
<li><strong>Kernel SVM</strong>: Non-linear classification</li>
<li><strong>Kernel PCA</strong>: Non-linear dimensionality reduction</li>
<li><strong>Kernel Ridge Regression</strong>: Non-linear regression</li>
</ul>
</div>
</div>
<div id="general-additive-models-gams" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> General Additive Models (GAMs)</h2>
<p>GAMs extend linear models by allowing non-linear relationships between predictors and the response variable.</p>
<div id="features" class="section level3" number="9.8.1">
<h3><span class="header-section-number">9.8.1</span> Features</h3>
<ul>
<li><strong>Smooth functions</strong>: Flexible non-linear relationships</li>
<li><strong>Additive structure</strong>: Sum of smooth functions</li>
<li><strong>Interpretability</strong>: Maintains model interpretability</li>
<li><strong>Flexibility</strong>: Handles various data types</li>
</ul>
</div>
</div>
<div id="other-supervised-models" class="section level2" number="9.9">
<h2><span class="header-section-number">9.9</span> Other Supervised Models</h2>
<p>Additional supervised learning techniques for classification and regression.</p>
<div id="methods-covered-1" class="section level3" number="9.9.1">
<h3><span class="header-section-number">9.9.1</span> Methods Covered</h3>
<ul>
<li><strong>Random Forest</strong>: Ensemble of decision trees</li>
<li><strong>Gradient Boosting</strong>: Sequential ensemble method</li>
<li><strong>Neural Networks</strong>: Multi-layer perceptrons</li>
<li><strong>Ensemble Methods</strong>: Combining multiple models</li>
</ul>
</div>
</div>
<div id="practical-implementation" class="section level2" number="9.10">
<h2><span class="header-section-number">9.10</span> Practical Implementation</h2>
<p>All methods will be implemented using R with appropriate packages:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Load required packages for advanced modeling</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">library</span>(factoextra)      <span class="co"># Factor analysis</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">library</span>(cluster)         <span class="co"># Cluster analysis</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="fu">library</span>(MASS)           <span class="co"># LDA, QDA</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="fu">library</span>(e1071)          <span class="co"># SVM</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="fu">library</span>(mgcv)           <span class="co"># GAMs</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="fu">library</span>(randomForest)   <span class="co"># Random Forest</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="fu">library</span>(gbm)            <span class="co"># Gradient Boosting</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="fu">library</span>(nnet)           <span class="co"># Neural Networks</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="fu">library</span>(caret)          <span class="co"># Model training and validation</span></span></code></pre></div>
</div>
<div id="assessment-and-evaluation" class="section level2" number="9.11">
<h2><span class="header-section-number">9.11</span> Assessment and Evaluation</h2>
<div id="model-evaluation-metrics-1" class="section level3" number="9.11.1">
<h3><span class="header-section-number">9.11.1</span> Model Evaluation Metrics</h3>
<ul>
<li><strong>Classification</strong>: Accuracy, Precision, Recall, F1-score</li>
<li><strong>Regression</strong>: RMSE, MAE, R-squared</li>
<li><strong>Clustering</strong>: Silhouette score, Within-cluster sum of squares</li>
<li><strong>Cross-validation</strong>: Ensuring model generalizability</li>
</ul>
</div>
<div id="best-practices-3" class="section level3" number="9.11.2">
<h3><span class="header-section-number">9.11.2</span> Best Practices</h3>
<ol style="list-style-type: decimal">
<li><strong>Data Preprocessing</strong>: Handle missing values and outliers</li>
<li><strong>Feature Selection</strong>: Choose relevant predictors</li>
<li><strong>Model Validation</strong>: Use cross-validation techniques</li>
<li><strong>Hyperparameter Tuning</strong>: Optimize model parameters</li>
<li><strong>Model Comparison</strong>: Compare different approaches</li>
<li><strong>Interpretation</strong>: Understand and communicate results</li>
</ol>
</div>
</div>
<div id="intensive-session-schedule" class="section level2" number="9.12">
<h2><span class="header-section-number">9.12</span> Intensive Session Schedule</h2>
<p>The intensive session will cover:</p>
<p><strong>Day 1</strong>: Factor Analysis and Cluster Analysis
- Morning: Theory and concepts
- Afternoon: Hands-on implementation</p>
<p><strong>Day 2</strong>: Classification and Logistic Regression
- Morning: Discrimination methods
- Afternoon: Logistic regression applications</p>
<p><strong>Day 3</strong>: Advanced Methods
- Morning: Kernel methods and GAMs
- Afternoon: Ensemble methods and model comparison</p>
</div>
<div id="prerequisites" class="section level2" number="9.13">
<h2><span class="header-section-number">9.13</span> Prerequisites</h2>
<p>Students should be familiar with:
- Basic statistical concepts from Part 1
- R programming fundamentals
- Linear regression concepts
- Hypothesis testing</p>
</div>
<div id="resources" class="section level2" number="9.14">
<h2><span class="header-section-number">9.14</span> Resources</h2>
<ul>
<li>Course slides and materials will be provided during the intensive session</li>
<li>Additional resources available in the course drive</li>
<li>R documentation for specific packages</li>
<li>Practice datasets for hands-on exercises</li>
</ul>
</div>
<div id="summary-3" class="section level2" number="9.15">
<h2><span class="header-section-number">9.15</span> Summary</h2>
<p>This intensive session provides students with advanced modeling techniques essential for modern data analysis. The focus is on practical implementation and interpretation of results, building upon the statistical foundations established in Part 1 of the course.</p>
</div>
<div id="references-1" class="section level2" number="9.16">
<h2><span class="header-section-number">9.16</span> References</h2>
<ul>
<li>Slides and materials provided by Prof.¬†Sophie Dabo-Niang</li>
<li>Additional resources available in the course drive</li>
<li>R documentation for advanced modeling packages</li>
</ul>
<!--chapter:end:08-advanced-modeling-techniques.Rmd-->
</div>
</div>
<div id="pca" class="section level1" number="10">
<h1><span class="header-section-number">10</span> üíª PCA</h1>
<blockquote>
<p><strong>‚ö†Ô∏è Note on Slides</strong>: If you encounter broken links in the PDF slides (<code>module_2_PCA_&amp;_CA.pdf</code>), please refer to the ‚ÄúOnline Resources and References‚Äù section at the end of this chapter for updated and working links.</p>
</blockquote>
<div id="introduction-to-principal-component-analysis" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Introduction to Principal Component Analysis</h2>
<p>Principal Component Analysis (PCA) is a powerful dimensionality reduction technique used to transform a large set of variables into a smaller set of uncorrelated variables called principal components. These components capture the maximum variance in the data while reducing complexity.</p>
<div id="key-concepts-2" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Key Concepts</h3>
<ul>
<li><strong>Dimensionality Reduction</strong>: Reduce the number of variables while retaining most of the information</li>
<li><strong>Variance Preservation</strong>: Principal components are ordered by the amount of variance they explain</li>
<li><strong>Uncorrelated Components</strong>: Each principal component is orthogonal (uncorrelated) to the others</li>
<li><strong>Data Standardization</strong>: Often necessary when variables are on different scales</li>
</ul>
</div>
<div id="when-to-use-pca" class="section level3" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> When to Use PCA</h3>
<ul>
<li>When you have many correlated variables</li>
<li>To visualize high-dimensional data in 2D or 3D</li>
<li>To reduce noise in the data</li>
<li>Before applying other machine learning algorithms</li>
<li>To identify the most important features in your dataset</li>
</ul>
</div>
</div>
<div id="required-packages" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Required Packages</h2>
<p>We will use the following packages throughout this chapter:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)  <span class="co"># For PCA analysis</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">library</span>(factoextra)  <span class="co"># For visualization</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="fu">library</span>(ISLR2)       <span class="co"># For datasets</span></span></code></pre></div>
</div>
<div id="pca-with-factominer-package" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> 17.1 PCA with FactoMineR Package</h2>
<div id="example-1-simple-2d-dataset" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> 17.1.1 Example 1: Simple 2D Dataset</h3>
<p>Let‚Äôs start with a simple example to understand the fundamentals of PCA.</p>
<div id="step-1-create-and-explore-the-data" class="section level4" number="10.3.1.1">
<h4><span class="header-section-number">10.3.1.1</span> Step 1: Create and Explore the Data</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="at">Var1 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="at">Var2 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="fu">rownames</span>(X) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;i1&quot;</span>, <span class="st">&quot;i2&quot;</span>, <span class="st">&quot;i3&quot;</span>, <span class="st">&quot;i4&quot;</span>)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>X</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt;    Var1 Var2</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; i1    2    2</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt; i2    1   -1</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt; i3   -1    1</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt; i4   -2   -2</span></span></code></pre></div>
</div>
<div id="step-2-calculate-covariance-matrix-and-inertia" class="section level4" number="10.3.1.2">
<h4><span class="header-section-number">10.3.1.2</span> Step 2: Calculate Covariance Matrix and Inertia</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Calculate means</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">mean</span>(X[,<span class="dv">1</span>]) <span class="co"># mean of Var1</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="fu">mean</span>(X[,<span class="dv">2</span>]) <span class="co"># mean of Var2</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co"># Variance-covariance matrix</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co"># The constant (n-1)/n adjusts for the variance-covariance matrix used in lectures</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">var</span>(X) <span class="sc">*</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>S</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt;      Var1 Var2</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; Var1  2.5  1.5</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; Var2  1.5  2.5</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co"># Inertia (sum of diagonal elements = sum of variances)</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>Inertia <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(S))</span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>Inertia</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
</div>
<div id="step-3-eigen-analysis-on-covariance-matrix" class="section level4" number="10.3.1.3">
<h4><span class="header-section-number">10.3.1.3</span> Step 3: Eigen-analysis on Covariance Matrix</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">eigen</span>(S) <span class="co"># gives the eigen-values and eigen-vectors</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co">#&gt; eigen() decomposition</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#&gt; $values</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#&gt; [1] 4 1</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co">#&gt; $vectors</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co">#&gt;           [,1]       [,2]</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co">#&gt; [1,] 0.7071068 -0.7071068</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt; [2,] 0.7071068  0.7071068</span></span></code></pre></div>
</div>
<div id="step-4-eigen-analysis-on-correlation-matrix" class="section level4" number="10.3.1.4">
<h4><span class="header-section-number">10.3.1.4</span> Step 4: Eigen-analysis on Correlation Matrix</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">cor</span>(X)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>eigenan <span class="ot">&lt;-</span> <span class="fu">eigen</span>(R) <span class="co"># eigen analysis of R</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>eigenan</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co">#&gt; eigen() decomposition</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt; $values</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; [1] 1.6 0.4</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt; $vectors</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt;           [,1]       [,2]</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt; [1,] 0.7071068 -0.7071068</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt; [2,] 0.7071068  0.7071068</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co"># Sum of eigenvalues equals p (number of variables)</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="fu">sum</span>(eigenan<span class="sc">$</span>values)</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a><span class="co"># Normalized data (centered and scaled)</span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">scale</span>(X)</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="fu">var</span>(Z) <span class="co"># is the correlation matrix</span></span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="co">#&gt;      Var1 Var2</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a><span class="co">#&gt; Var1  1.0  0.6</span></span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a><span class="co">#&gt; Var2  0.6  1.0</span></span></code></pre></div>
</div>
<div id="step-5-perform-pca-on-covariance-matrix" class="section level4" number="10.3.1.5">
<h4><span class="header-section-number">10.3.1.5</span> Step 5: Perform PCA on Covariance Matrix</h4>
<p>PCA with the covariance matrix uses only centered data. For PCA on the correlation matrix (normed PCA), use <code>scale.unit = TRUE</code> (default option).</p>
<p><strong>Note on Correlation</strong>: The correlation between two variables <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> is:
<span class="math display">\[\rho = \frac{cov(X_1, X_2)}{\sigma_{X_1} \sigma_{X_2}}\]</span></p>
<p>where <span class="math inline">\(cov(X_1, X_2)\)</span> is the covariance, and <span class="math inline">\(\sigma_{X_1} = \sqrt{Var(X_1)}\)</span> is the standard deviation of <span class="math inline">\(X_1\)</span>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>res.pca.cov <span class="ot">&lt;-</span> <span class="fu">PCA</span>(X, <span class="at">scale.unit =</span> <span class="cn">FALSE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">print</span>(res.pca.cov)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co">#&gt; **Results for the Principal Component Analysis (PCA)**</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co">#&gt; The analysis was performed on 4 individuals, described by 2 variables</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="co">#&gt; *The results are available in the following objects:</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="co">#&gt;    name               description                          </span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co">#&gt; 1  &quot;$eig&quot;             &quot;eigenvalues&quot;                        </span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co">#&gt; 2  &quot;$var&quot;             &quot;results for the variables&quot;          </span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="co">#&gt; 3  &quot;$var$coord&quot;       &quot;coord. for the variables&quot;           </span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="co">#&gt; 4  &quot;$var$cor&quot;         &quot;correlations variables - dimensions&quot;</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co">#&gt; 5  &quot;$var$cos2&quot;        &quot;cos2 for the variables&quot;             </span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co">#&gt; 6  &quot;$var$contrib&quot;     &quot;contributions of the variables&quot;     </span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co">#&gt; 7  &quot;$ind&quot;             &quot;results for the individuals&quot;        </span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="co">#&gt; 8  &quot;$ind$coord&quot;       &quot;coord. for the individuals&quot;         </span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a><span class="co">#&gt; 9  &quot;$ind$cos2&quot;        &quot;cos2 for the individuals&quot;           </span></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a><span class="co">#&gt; 10 &quot;$ind$contrib&quot;     &quot;contributions of the individuals&quot;   </span></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a><span class="co">#&gt; 11 &quot;$call&quot;            &quot;summary statistics&quot;                 </span></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a><span class="co">#&gt; 12 &quot;$call$centre&quot;     &quot;mean of the variables&quot;              </span></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a><span class="co">#&gt; 13 &quot;$call$ecart.type&quot; &quot;standard error of the variables&quot;    </span></span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a><span class="co">#&gt; 14 &quot;$call$row.w&quot;      &quot;weights for the individuals&quot;        </span></span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a><span class="co">#&gt; 15 &quot;$call$col.w&quot;      &quot;weights for the variables&quot;</span></span></code></pre></div>
</div>
<div id="step-6-examine-eigenvalues" class="section level4" number="10.3.1.6">
<h4><span class="header-section-number">10.3.1.6</span> Step 6: Examine Eigenvalues</h4>
<p>We have <span class="math inline">\(p = 2 = min(n-1, p) = min(3, 2)\)</span> eigenvalues: 4 and 1. The inertia <span class="math inline">\(Inertia = 4 + 1 = 5\)</span> is the sum of the variances of the variables.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>res.pca.cov<span class="sc">$</span>eig</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co">#&gt;        eigenvalue percentage of variance</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="co">#&gt; comp 1          4                     80</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt; comp 2          1                     20</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co">#&gt;        cumulative percentage of variance</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co">#&gt; comp 1                                80</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co">#&gt; comp 2                               100</span></span></code></pre></div>
</div>
<div id="step-7-examine-variables-and-individuals" class="section level4" number="10.3.1.7">
<h4><span class="header-section-number">10.3.1.7</span> Step 7: Examine Variables and Individuals</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>res.pca.cov<span class="sc">$</span>var</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="co">#&gt; $coord</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="co">#&gt;         Dim.1      Dim.2</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="co">#&gt; Var1 1.414214 -0.7071068</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="co">#&gt; Var2 1.414214  0.7071068</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="co">#&gt; $cor</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="co">#&gt;          Dim.1      Dim.2</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="co">#&gt; Var1 0.8944272 -0.4472136</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="co">#&gt; Var2 0.8944272  0.4472136</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="co">#&gt; $cos2</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a><span class="co">#&gt;      Dim.1 Dim.2</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a><span class="co">#&gt; Var1   0.8   0.2</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a><span class="co">#&gt; Var2   0.8   0.2</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="co">#&gt; $contrib</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="co">#&gt;      Dim.1 Dim.2</span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a><span class="co">#&gt; Var1    50    50</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="co">#&gt; Var2    50    50</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>res.pca.cov<span class="sc">$</span>ind</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co">#&gt; $coord</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co">#&gt;                         Dim.1                       Dim.2</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co">#&gt; i1  2.82842712474619073503845 -0.000000000000000006357668</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="co">#&gt; i2  0.00000000000000001271534 -1.414213562373095367519227</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="co">#&gt; i3 -0.00000000000000040992080  1.414213562373094923430017</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co">#&gt; i4 -2.82842712474619029094924  0.000000000000000204960400</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="co">#&gt; $cos2</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="co">#&gt;                                          Dim.1</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co">#&gt; i1 1.00000000000000044408920985006261616945267</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="co">#&gt; i2 0.00000000000000000000000000000000008083988</span></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a><span class="co">#&gt; i3 0.00000000000000000000000000000008401753104</span></span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="co">#&gt; i4 1.00000000000000022204460492503130808472633</span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a><span class="co">#&gt;                                           Dim.2</span></span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a><span class="co">#&gt; i1 0.000000000000000000000000000000000005052492</span></span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a><span class="co">#&gt; i2 1.000000000000000444089209850062616169452667</span></span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a><span class="co">#&gt; i3 0.999999999999999777955395074968691915273666</span></span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a><span class="co">#&gt; i4 0.000000000000000000000000000000005251095690</span></span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a><span class="co">#&gt; $contrib</span></span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a><span class="co">#&gt;                                         Dim.1</span></span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a><span class="co">#&gt; i1 50.000000000000021316282072803005576133728</span></span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a><span class="co">#&gt; i2  0.000000000000000000000000000000001010498</span></span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a><span class="co">#&gt; i3  0.000000000000000000000000000001050219138</span></span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a><span class="co">#&gt; i4 50.000000000000014210854715202003717422485</span></span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a><span class="co">#&gt;                                         Dim.2</span></span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a><span class="co">#&gt; i1  0.000000000000000000000000000000001010498</span></span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a><span class="co">#&gt; i2 50.000000000000021316282072803005576133728</span></span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a><span class="co">#&gt; i3 49.999999999999985789145284797996282577515</span></span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a><span class="co">#&gt; i4  0.000000000000000000000000000001050219138</span></span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a><span class="co">#&gt; $dist</span></span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a><span class="co">#&gt;       i1       i2       i3       i4 </span></span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a><span class="co">#&gt; 2.828427 1.414214 1.414214 2.828427</span></span></code></pre></div>
</div>
</div>
<div id="example-2-student-grades-dataset" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> 17.1.2 Example 2: Student Grades Dataset</h3>
<p>Now let‚Äôs work with a more realistic example: student grades in three subjects.</p>
<div id="step-1-prepare-the-data" class="section level4" number="10.3.2.1">
<h4><span class="header-section-number">10.3.2.1</span> Step 1: Prepare the Data</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">15</span>,<span class="dv">10</span>), </span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>            <span class="at">nrow=</span><span class="dv">6</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>A</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="co">#&gt; [1,]    9   12   10</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="co">#&gt; [2,]   15    9   10</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="co">#&gt; [3,]    5   10    8</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="co">#&gt; [4,]   11   13   14</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="co">#&gt; [5,]   11   13    8</span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="co">#&gt; [6,]    3   15   10</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>Nframe <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(A)</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="co"># Set row and column names</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Alex&quot;</span>, <span class="st">&quot;Bea&quot;</span>, <span class="st">&quot;Claudio&quot;</span>, <span class="st">&quot;Damien&quot;</span>, <span class="st">&quot;Emilie&quot;</span>, <span class="st">&quot;Fran&quot;</span>)</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Biostatistics&quot;</span>, <span class="st">&quot;Economics&quot;</span>, <span class="st">&quot;English&quot;</span>)</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a><span class="fu">rownames</span>(A) <span class="ot">&lt;-</span> m1</span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="fu">colnames</span>(A) <span class="ot">&lt;-</span> m2</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a><span class="fu">head</span>(A)</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a><span class="co">#&gt;         Biostatistics Economics English</span></span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a><span class="co">#&gt; Alex                9        12      10</span></span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a><span class="co">#&gt; Bea                15         9      10</span></span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a><span class="co">#&gt; Claudio             5        10       8</span></span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a><span class="co">#&gt; Damien             11        13      14</span></span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a><span class="co">#&gt; Emilie             11        13       8</span></span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a><span class="co">#&gt; Fran                3        15      10</span></span></code></pre></div>
</div>
<div id="step-2-perform-pca-on-correlation-matrix" class="section level4" number="10.3.2.2">
<h4><span class="header-section-number">10.3.2.2</span> Step 2: Perform PCA on Correlation Matrix</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>res.pca.cor <span class="ot">&lt;-</span> <span class="fu">PCA</span>(A, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">print</span>(res.pca.cor)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co">#&gt; **Results for the Principal Component Analysis (PCA)**</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">#&gt; The analysis was performed on 6 individuals, described by 3 variables</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="co">#&gt; *The results are available in the following objects:</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co">#&gt;    name               description                          </span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="co">#&gt; 1  &quot;$eig&quot;             &quot;eigenvalues&quot;                        </span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="co">#&gt; 2  &quot;$var&quot;             &quot;results for the variables&quot;          </span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="co">#&gt; 3  &quot;$var$coord&quot;       &quot;coord. for the variables&quot;           </span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a><span class="co">#&gt; 4  &quot;$var$cor&quot;         &quot;correlations variables - dimensions&quot;</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="co">#&gt; 5  &quot;$var$cos2&quot;        &quot;cos2 for the variables&quot;             </span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="co">#&gt; 6  &quot;$var$contrib&quot;     &quot;contributions of the variables&quot;     </span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="co">#&gt; 7  &quot;$ind&quot;             &quot;results for the individuals&quot;        </span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="co">#&gt; 8  &quot;$ind$coord&quot;       &quot;coord. for the individuals&quot;         </span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a><span class="co">#&gt; 9  &quot;$ind$cos2&quot;        &quot;cos2 for the individuals&quot;           </span></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a><span class="co">#&gt; 10 &quot;$ind$contrib&quot;     &quot;contributions of the individuals&quot;   </span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a><span class="co">#&gt; 11 &quot;$call&quot;            &quot;summary statistics&quot;                 </span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a><span class="co">#&gt; 12 &quot;$call$centre&quot;     &quot;mean of the variables&quot;              </span></span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a><span class="co">#&gt; 13 &quot;$call$ecart.type&quot; &quot;standard error of the variables&quot;    </span></span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a><span class="co">#&gt; 14 &quot;$call$row.w&quot;      &quot;weights for the individuals&quot;        </span></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a><span class="co">#&gt; 15 &quot;$call$col.w&quot;      &quot;weights for the variables&quot;</span></span></code></pre></div>
</div>
<div id="step-3-examine-eigenvalues" class="section level4" number="10.3.2.3">
<h4><span class="header-section-number">10.3.2.3</span> Step 3: Examine Eigenvalues</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>eig</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="co">#&gt;        eigenvalue percentage of variance</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="co">#&gt; comp 1  1.5000000               50.00000</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="co">#&gt; comp 2  1.1830127               39.43376</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="co">#&gt; comp 3  0.3169873               10.56624</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="co">#&gt;        cumulative percentage of variance</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="co">#&gt; comp 1                          50.00000</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="co">#&gt; comp 2                          89.43376</span></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="co">#&gt; comp 3                         100.00000</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a><span class="fu">get_eigenvalue</span>(res.pca.cor)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a><span class="co">#&gt;       eigenvalue variance.percent</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a><span class="co">#&gt; Dim.1  1.5000000         50.00000</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a><span class="co">#&gt; Dim.2  1.1830127         39.43376</span></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="co">#&gt; Dim.3  0.3169873         10.56624</span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="co">#&gt;       cumulative.variance.percent</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a><span class="co">#&gt; Dim.1                    50.00000</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a><span class="co">#&gt; Dim.2                    89.43376</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="co">#&gt; Dim.3                   100.00000</span></span></code></pre></div>
<p><strong>Interpretation</strong>: Kaiser‚Äôs rule suggests <span class="math inline">\(q = 2\)</span> components because the eigenvalue mean is 1 (with 89% of explained variance). The rule of thumb gives <span class="math inline">\(q = 2\)</span> because the first 2 dimensions explain 89% of the variance/inertia.</p>
</div>
<div id="step-4-examine-variables" class="section level4" number="10.3.2.4">
<h4><span class="header-section-number">10.3.2.4</span> Step 4: Examine Variables</h4>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>var</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="co">#&gt; $coord</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="co">#&gt;                                  Dim.1     Dim.2      Dim.3</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="co">#&gt; Biostatistics -0.866025403784438041477 0.3535534  0.3535534</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="co">#&gt; Economics      0.866025403784439040678 0.3535534  0.3535534</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co">#&gt; English        0.000000000000001047394 0.9659258 -0.2588190</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="co">#&gt; $cor</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="co">#&gt;                                  Dim.1     Dim.2      Dim.3</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="co">#&gt; Biostatistics -0.866025403784438041477 0.3535534  0.3535534</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="co">#&gt; Economics      0.866025403784439151700 0.3535534  0.3535534</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="co">#&gt; English        0.000000000000001047394 0.9659258 -0.2588190</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="co">#&gt; $cos2</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="co">#&gt;                                                Dim.1</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a><span class="co">#&gt; Biostatistics 0.749999999999999000799277837359113619</span></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a><span class="co">#&gt; Economics     0.750000000000000888178419700125232339</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a><span class="co">#&gt; English       0.000000000000000000000000000001097035</span></span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a><span class="co">#&gt;                   Dim.2     Dim.3</span></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a><span class="co">#&gt; Biostatistics 0.1250000 0.1250000</span></span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a><span class="co">#&gt; Economics     0.1250000 0.1250000</span></span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a><span class="co">#&gt; English       0.9330127 0.0669873</span></span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a><span class="co">#&gt; $contrib</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a><span class="co">#&gt;                                                Dim.1</span></span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a><span class="co">#&gt; Biostatistics 49.99999999999993605115378159098327160</span></span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a><span class="co">#&gt; Economics     50.00000000000005684341886080801486969</span></span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a><span class="co">#&gt; English        0.00000000000000000000000000007313567</span></span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a><span class="co">#&gt;                  Dim.2    Dim.3</span></span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a><span class="co">#&gt; Biostatistics 10.56624 39.43376</span></span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a><span class="co">#&gt; Economics     10.56624 39.43376</span></span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a><span class="co">#&gt; English       78.86751 21.13249</span></span></code></pre></div>
</div>
<div id="step-5-correlations-between-variables-and-components" class="section level4" number="10.3.2.5">
<h4><span class="header-section-number">10.3.2.5</span> Step 5: Correlations Between Variables and Components</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>var<span class="sc">$</span>cor</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="co">#&gt;                                  Dim.1     Dim.2      Dim.3</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="co">#&gt; Biostatistics -0.866025403784438041477 0.3535534  0.3535534</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="co">#&gt; Economics      0.866025403784439151700 0.3535534  0.3535534</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="co">#&gt; English        0.000000000000001047394 0.9659258 -0.2588190</span></span></code></pre></div>
<p><strong>Interpretation</strong>: The first axis is correlated with Biostatistics (+0.86) and Economics (-0.86). The second axis is correlated to English (0.96). The two components are correlated with at least one variable, so <span class="math inline">\(q = 2\)</span> may be considered to reduce the dimension from <span class="math inline">\(p = 3\)</span>.</p>
</div>
<div id="step-6-coordinates-of-variables" class="section level4" number="10.3.2.6">
<h4><span class="header-section-number">10.3.2.6</span> Step 6: Coordinates of Variables</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>var<span class="sc">$</span>coord</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="co">#&gt;                                  Dim.1     Dim.2      Dim.3</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a><span class="co">#&gt; Biostatistics -0.866025403784438041477 0.3535534  0.3535534</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="co">#&gt; Economics      0.866025403784439040678 0.3535534  0.3535534</span></span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a><span class="co">#&gt; English        0.000000000000001047394 0.9659258 -0.2588190</span></span></code></pre></div>
</div>
<div id="step-7-quality-of-representation-cos¬≤" class="section level4" number="10.3.2.7">
<h4><span class="header-section-number">10.3.2.7</span> Step 7: Quality of Representation (cos¬≤)</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>var<span class="sc">$</span>cos2</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="co">#&gt;                                                Dim.1</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="co">#&gt; Biostatistics 0.749999999999999000799277837359113619</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co">#&gt; Economics     0.750000000000000888178419700125232339</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="co">#&gt; English       0.000000000000000000000000000001097035</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="co">#&gt;                   Dim.2     Dim.3</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="co">#&gt; Biostatistics 0.1250000 0.1250000</span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a><span class="co">#&gt; Economics     0.1250000 0.1250000</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a><span class="co">#&gt; English       0.9330127 0.0669873</span></span></code></pre></div>
<p><strong>Interpretation</strong>: Biostatistics and Economics are well represented in the first dimension (75%), while English is very well represented in the second axis (93%). In the first plane (Dim.1 and Dim.2), Biostatistics and Economics are well represented (75% + 12.5% = 87.5%), and English is very well represented (93% + 0% = 93%).</p>
</div>
<div id="step-8-contributions-of-variables" class="section level4" number="10.3.2.8">
<h4><span class="header-section-number">10.3.2.8</span> Step 8: Contributions of Variables</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>var<span class="sc">$</span>contrib</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="co">#&gt;                                                Dim.1</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="co">#&gt; Biostatistics 49.99999999999993605115378159098327160</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co">#&gt; Economics     50.00000000000005684341886080801486969</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="co">#&gt; English        0.00000000000000000000000000007313567</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a><span class="co">#&gt;                  Dim.2    Dim.3</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="co">#&gt; Biostatistics 10.56624 39.43376</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a><span class="co">#&gt; Economics     10.56624 39.43376</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a><span class="co">#&gt; English       78.86751 21.13249</span></span></code></pre></div>
<p><strong>Interpretation</strong>: Biostatistics and Economics contribute to the construction of the first dimension (50%), while English contributes highly to the construction of the second axis (78.8%). In the first plane, the contribution of Biostatistics and Economics is 50% + 10.5% = 60.5%, and that of English is 78.8%.</p>
</div>
<div id="step-9-description-of-dimensions" class="section level4" number="10.3.2.9">
<h4><span class="header-section-number">10.3.2.9</span> Step 9: Description of Dimensions</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">dimdesc</span>(res.pca.cor, <span class="at">axes =</span> <span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="co">#&gt; $Dim.1</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="co">#&gt; Link between the variable and the continuous variables (R-square)</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a><span class="co">#&gt; =================================================================================</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="co">#&gt;               correlation    p.value</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="co">#&gt; Economics       0.8660254 0.02572142</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="co">#&gt; Biostatistics  -0.8660254 0.02572142</span></span></code></pre></div>
</div>
<div id="step-10-contributions-of-first-two-dimensions" class="section level4" number="10.3.2.10">
<h4><span class="header-section-number">10.3.2.10</span> Step 10: Contributions of First Two Dimensions</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>var<span class="sc">$</span>contrib[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="co">#&gt;                                                Dim.1</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="co">#&gt; Biostatistics 49.99999999999993605115378159098327160</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="co">#&gt; Economics     50.00000000000005684341886080801486969</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="co">#&gt; English        0.00000000000000000000000000007313567</span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a><span class="co">#&gt;                  Dim.2</span></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a><span class="co">#&gt; Biostatistics 10.56624</span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a><span class="co">#&gt; Economics     10.56624</span></span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a><span class="co">#&gt; English       78.86751</span></span></code></pre></div>
</div>
</div>
<div id="visualizations" class="section level3" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> 17.1.3 Visualizations</h3>
<div id="variables-plot" class="section level4" number="10.3.3.1">
<h4><span class="header-section-number">10.3.3.1</span> Variables Plot</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.cor, <span class="at">col.var =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-vars-1.png" width="100%" /></p>
</div>
<div id="variables-plot-with-quality-of-representation" class="section level4" number="10.3.3.2">
<h4><span class="header-section-number">10.3.3.2</span> Variables Plot with Quality of Representation</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.cor, <span class="at">col.var =</span> <span class="st">&quot;cos2&quot;</span>,</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-vars-quality-1.png" width="100%" /></p>
</div>
<div id="variables-with-high-quality-of-representation-cos¬≤-0.6" class="section level4" number="10.3.3.3">
<h4><span class="header-section-number">10.3.3.3</span> Variables with High Quality of Representation (cos¬≤ &gt; 0.6)</h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.cor, <span class="at">select.var =</span> <span class="fu">list</span>(<span class="at">cos2 =</span> <span class="fl">0.6</span>))</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-vars-quality-filter-1.png" width="100%" /></p>
</div>
<div id="variables-plot-with-contributions" class="section level4" number="10.3.3.4">
<h4><span class="header-section-number">10.3.3.4</span> Variables Plot with Contributions</h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.cor, <span class="at">col.var =</span> <span class="st">&quot;contrib&quot;</span>,</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>))</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-vars-contrib-1.png" width="100%" /></p>
</div>
<div id="biplot-variables-and-individuals" class="section level4" number="10.3.3.5">
<h4><span class="header-section-number">10.3.3.5</span> Biplot: Variables and Individuals</h4>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(res.pca.cor, <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>                <span class="at">col.var =</span> <span class="st">&quot;#2E9FDF&quot;</span>, <span class="co"># Variables color</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>                <span class="at">col.ind =</span> <span class="st">&quot;#696969&quot;</span>  <span class="co"># Individuals color</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-biplot-1.png" width="100%" /></p>
</div>
</div>
<div id="analysis-of-individuals" class="section level3" number="10.3.4">
<h3><span class="header-section-number">10.3.4</span> 17.1.4 Analysis of Individuals</h3>
<div id="individuals-information" class="section level4" number="10.3.4.1">
<h4><span class="header-section-number">10.3.4.1</span> Individuals Information</h4>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>ind</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="co">#&gt; $coord</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="co">#&gt;                             Dim.1                    Dim.2</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a><span class="co">#&gt; Alex     0.0000000000000002653034 -0.000000000000000941663</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a><span class="co">#&gt; Bea     -2.1213203435596423851450  0.000000000000001237395</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a><span class="co">#&gt; Claudio -0.0000000000000022171779 -1.538189001320852344890</span></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a><span class="co">#&gt; Damien   0.0000000000000026937746  2.101205251626097503248</span></span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a><span class="co">#&gt; Emilie   0.0000000000000001895371 -0.563016250305248155961</span></span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a><span class="co">#&gt; Fran     2.1213203435596428292342 -0.000000000000002975084</span></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a><span class="co">#&gt;                              Dim.3</span></span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a><span class="co">#&gt; Alex    -0.00000000000000007994654</span></span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a><span class="co">#&gt; Bea      0.00000000000000015526499</span></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a><span class="co">#&gt; Claudio -0.79622521701812609684623</span></span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a><span class="co">#&gt; Damien  -0.29143865656241157990891</span></span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a><span class="co">#&gt; Emilie   1.08766387358053817635550</span></span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a><span class="co">#&gt; Fran     0.00000000000000002468473</span></span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a><span class="co">#&gt; $cos2</span></span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a><span class="co">#&gt;                                            Dim.1</span></span>
<span id="cb48-20"><a href="#cb48-20" tabindex="-1"></a><span class="co">#&gt; Alex    0.07137976857538211317155685264879139140</span></span>
<span id="cb48-21"><a href="#cb48-21" tabindex="-1"></a><span class="co">#&gt; Bea     1.00000000000000022204460492503130808473</span></span>
<span id="cb48-22"><a href="#cb48-22" tabindex="-1"></a><span class="co">#&gt; Claudio 0.00000000000000000000000000000163862588</span></span>
<span id="cb48-23"><a href="#cb48-23" tabindex="-1"></a><span class="co">#&gt; Damien  0.00000000000000000000000000000161253810</span></span>
<span id="cb48-24"><a href="#cb48-24" tabindex="-1"></a><span class="co">#&gt; Emilie  0.00000000000000000000000000000002394954</span></span>
<span id="cb48-25"><a href="#cb48-25" tabindex="-1"></a><span class="co">#&gt; Fran    0.99999999999999977795539507496869191527</span></span>
<span id="cb48-26"><a href="#cb48-26" tabindex="-1"></a><span class="co">#&gt;                                           Dim.2</span></span>
<span id="cb48-27"><a href="#cb48-27" tabindex="-1"></a><span class="co">#&gt; Alex    0.8992501752497785716400358069222420454</span></span>
<span id="cb48-28"><a href="#cb48-28" tabindex="-1"></a><span class="co">#&gt; Bea     0.0000000000000000000000000000003402549</span></span>
<span id="cb48-29"><a href="#cb48-29" tabindex="-1"></a><span class="co">#&gt; Claudio 0.7886751345948129765517364830884616822</span></span>
<span id="cb48-30"><a href="#cb48-30" tabindex="-1"></a><span class="co">#&gt; Damien  0.9811252243246878501636842884181533009</span></span>
<span id="cb48-31"><a href="#cb48-31" tabindex="-1"></a><span class="co">#&gt; Emilie  0.2113248654051877173376539076343760826</span></span>
<span id="cb48-32"><a href="#cb48-32" tabindex="-1"></a><span class="co">#&gt; Fran    0.0000000000000000000000000000019669168</span></span>
<span id="cb48-33"><a href="#cb48-33" tabindex="-1"></a><span class="co">#&gt;                                             Dim.3</span></span>
<span id="cb48-34"><a href="#cb48-34" tabindex="-1"></a><span class="co">#&gt; Alex    0.006481699860810073883510273873298501712</span></span>
<span id="cb48-35"><a href="#cb48-35" tabindex="-1"></a><span class="co">#&gt; Bea     0.000000000000000000000000000000005357159</span></span>
<span id="cb48-36"><a href="#cb48-36" tabindex="-1"></a><span class="co">#&gt; Claudio 0.211324865405187134470565979427192360163</span></span>
<span id="cb48-37"><a href="#cb48-37" tabindex="-1"></a><span class="co">#&gt; Damien  0.018874775675311854933324795524640649091</span></span>
<span id="cb48-38"><a href="#cb48-38" tabindex="-1"></a><span class="co">#&gt; Emilie  0.788675134594813309618643870635423809290</span></span>
<span id="cb48-39"><a href="#cb48-39" tabindex="-1"></a><span class="co">#&gt; Fran    0.000000000000000000000000000000000135408</span></span>
<span id="cb48-40"><a href="#cb48-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb48-41"><a href="#cb48-41" tabindex="-1"></a><span class="co">#&gt; $contrib</span></span>
<span id="cb48-42"><a href="#cb48-42" tabindex="-1"></a><span class="co">#&gt;                                            Dim.1</span></span>
<span id="cb48-43"><a href="#cb48-43" tabindex="-1"></a><span class="co">#&gt; Alex     0.0000000000000000000000000000007820654</span></span>
<span id="cb48-44"><a href="#cb48-44" tabindex="-1"></a><span class="co">#&gt; Bea     50.0000000000000000000000000000000000000</span></span>
<span id="cb48-45"><a href="#cb48-45" tabindex="-1"></a><span class="co">#&gt; Claudio  0.0000000000000000000000000000546208628</span></span>
<span id="cb48-46"><a href="#cb48-46" tabindex="-1"></a><span class="co">#&gt; Damien   0.0000000000000000000000000000806269052</span></span>
<span id="cb48-47"><a href="#cb48-47" tabindex="-1"></a><span class="co">#&gt; Emilie   0.0000000000000000000000000000003991590</span></span>
<span id="cb48-48"><a href="#cb48-48" tabindex="-1"></a><span class="co">#&gt; Fran    50.0000000000000213162820728030055761337</span></span>
<span id="cb48-49"><a href="#cb48-49" tabindex="-1"></a><span class="co">#&gt;                                          Dim.2</span></span>
<span id="cb48-50"><a href="#cb48-50" tabindex="-1"></a><span class="co">#&gt; Alex     0.00000000000000000000000000001249253</span></span>
<span id="cb48-51"><a href="#cb48-51" tabindex="-1"></a><span class="co">#&gt; Bea      0.00000000000000000000000000002157130</span></span>
<span id="cb48-52"><a href="#cb48-52" tabindex="-1"></a><span class="co">#&gt; Claudio 33.33333333333337833437326480634510517</span></span>
<span id="cb48-53"><a href="#cb48-53" tabindex="-1"></a><span class="co">#&gt; Damien  62.20084679281458051036679535172879696</span></span>
<span id="cb48-54"><a href="#cb48-54" tabindex="-1"></a><span class="co">#&gt; Emilie   4.46581987385206335972043234505690634</span></span>
<span id="cb48-55"><a href="#cb48-55" tabindex="-1"></a><span class="co">#&gt; Fran     0.00000000000000000000000000012469753</span></span>
<span id="cb48-56"><a href="#cb48-56" tabindex="-1"></a><span class="co">#&gt;                                             Dim.3</span></span>
<span id="cb48-57"><a href="#cb48-57" tabindex="-1"></a><span class="co">#&gt; Alex     0.00000000000000000000000000000033605182</span></span>
<span id="cb48-58"><a href="#cb48-58" tabindex="-1"></a><span class="co">#&gt; Bea      0.00000000000000000000000000000126751744</span></span>
<span id="cb48-59"><a href="#cb48-59" tabindex="-1"></a><span class="co">#&gt; Claudio 33.33333333333333570180911920033395290375</span></span>
<span id="cb48-60"><a href="#cb48-60" tabindex="-1"></a><span class="co">#&gt; Damien   4.46581987385203582618942164117470383644</span></span>
<span id="cb48-61"><a href="#cb48-61" tabindex="-1"></a><span class="co">#&gt; Emilie  62.20084679281465867006772896274924278259</span></span>
<span id="cb48-62"><a href="#cb48-62" tabindex="-1"></a><span class="co">#&gt; Fran     0.00000000000000000000000000000003203788</span></span>
<span id="cb48-63"><a href="#cb48-63" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb48-64"><a href="#cb48-64" tabindex="-1"></a><span class="co">#&gt; $dist</span></span>
<span id="cb48-65"><a href="#cb48-65" tabindex="-1"></a><span class="co">#&gt;                     Alex                      Bea </span></span>
<span id="cb48-66"><a href="#cb48-66" tabindex="-1"></a><span class="co">#&gt; 0.0000000000000009930137 2.1213203435596419410558 </span></span>
<span id="cb48-67"><a href="#cb48-67" tabindex="-1"></a><span class="co">#&gt;                  Claudio                   Damien </span></span>
<span id="cb48-68"><a href="#cb48-68" tabindex="-1"></a><span class="co">#&gt; 1.7320508075688780813550 2.1213203435596419410558 </span></span>
<span id="cb48-69"><a href="#cb48-69" tabindex="-1"></a><span class="co">#&gt;                   Emilie                     Fran </span></span>
<span id="cb48-70"><a href="#cb48-70" tabindex="-1"></a><span class="co">#&gt; 1.2247448713915896068016 2.1213203435596428292342</span></span></code></pre></div>
</div>
<div id="individuals-coordinates" class="section level4" number="10.3.4.2">
<h4><span class="header-section-number">10.3.4.2</span> Individuals: Coordinates</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>ind<span class="sc">$</span>coord</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="co">#&gt;                             Dim.1                    Dim.2</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="co">#&gt; Alex     0.0000000000000002653034 -0.000000000000000941663</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="co">#&gt; Bea     -2.1213203435596423851450  0.000000000000001237395</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a><span class="co">#&gt; Claudio -0.0000000000000022171779 -1.538189001320852344890</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a><span class="co">#&gt; Damien   0.0000000000000026937746  2.101205251626097503248</span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a><span class="co">#&gt; Emilie   0.0000000000000001895371 -0.563016250305248155961</span></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a><span class="co">#&gt; Fran     2.1213203435596428292342 -0.000000000000002975084</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a><span class="co">#&gt;                              Dim.3</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a><span class="co">#&gt; Alex    -0.00000000000000007994654</span></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a><span class="co">#&gt; Bea      0.00000000000000015526499</span></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a><span class="co">#&gt; Claudio -0.79622521701812609684623</span></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a><span class="co">#&gt; Damien  -0.29143865656241157990891</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a><span class="co">#&gt; Emilie   1.08766387358053817635550</span></span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a><span class="co">#&gt; Fran     0.00000000000000002468473</span></span></code></pre></div>
</div>
<div id="individuals-quality-of-representation" class="section level4" number="10.3.4.3">
<h4><span class="header-section-number">10.3.4.3</span> Individuals: Quality of Representation</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>ind<span class="sc">$</span>cos2</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="co">#&gt;                                            Dim.1</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a><span class="co">#&gt; Alex    0.07137976857538211317155685264879139140</span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a><span class="co">#&gt; Bea     1.00000000000000022204460492503130808473</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a><span class="co">#&gt; Claudio 0.00000000000000000000000000000163862588</span></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a><span class="co">#&gt; Damien  0.00000000000000000000000000000161253810</span></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a><span class="co">#&gt; Emilie  0.00000000000000000000000000000002394954</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a><span class="co">#&gt; Fran    0.99999999999999977795539507496869191527</span></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a><span class="co">#&gt;                                           Dim.2</span></span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a><span class="co">#&gt; Alex    0.8992501752497785716400358069222420454</span></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a><span class="co">#&gt; Bea     0.0000000000000000000000000000003402549</span></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a><span class="co">#&gt; Claudio 0.7886751345948129765517364830884616822</span></span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a><span class="co">#&gt; Damien  0.9811252243246878501636842884181533009</span></span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a><span class="co">#&gt; Emilie  0.2113248654051877173376539076343760826</span></span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a><span class="co">#&gt; Fran    0.0000000000000000000000000000019669168</span></span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a><span class="co">#&gt;                                             Dim.3</span></span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a><span class="co">#&gt; Alex    0.006481699860810073883510273873298501712</span></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a><span class="co">#&gt; Bea     0.000000000000000000000000000000005357159</span></span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a><span class="co">#&gt; Claudio 0.211324865405187134470565979427192360163</span></span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a><span class="co">#&gt; Damien  0.018874775675311854933324795524640649091</span></span>
<span id="cb50-21"><a href="#cb50-21" tabindex="-1"></a><span class="co">#&gt; Emilie  0.788675134594813309618643870635423809290</span></span>
<span id="cb50-22"><a href="#cb50-22" tabindex="-1"></a><span class="co">#&gt; Fran    0.000000000000000000000000000000000135408</span></span></code></pre></div>
</div>
<div id="individuals-contributions" class="section level4" number="10.3.4.4">
<h4><span class="header-section-number">10.3.4.4</span> Individuals: Contributions</h4>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>res.pca.cor<span class="sc">$</span>ind<span class="sc">$</span>contrib</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="co">#&gt;                                            Dim.1</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a><span class="co">#&gt; Alex     0.0000000000000000000000000000007820654</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="co">#&gt; Bea     50.0000000000000000000000000000000000000</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a><span class="co">#&gt; Claudio  0.0000000000000000000000000000546208628</span></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a><span class="co">#&gt; Damien   0.0000000000000000000000000000806269052</span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a><span class="co">#&gt; Emilie   0.0000000000000000000000000000003991590</span></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a><span class="co">#&gt; Fran    50.0000000000000213162820728030055761337</span></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="co">#&gt;                                          Dim.2</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a><span class="co">#&gt; Alex     0.00000000000000000000000000001249253</span></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="co">#&gt; Bea      0.00000000000000000000000000002157130</span></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a><span class="co">#&gt; Claudio 33.33333333333337833437326480634510517</span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a><span class="co">#&gt; Damien  62.20084679281458051036679535172879696</span></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a><span class="co">#&gt; Emilie   4.46581987385206335972043234505690634</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a><span class="co">#&gt; Fran     0.00000000000000000000000000012469753</span></span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a><span class="co">#&gt;                                             Dim.3</span></span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a><span class="co">#&gt; Alex     0.00000000000000000000000000000033605182</span></span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a><span class="co">#&gt; Bea      0.00000000000000000000000000000126751744</span></span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a><span class="co">#&gt; Claudio 33.33333333333333570180911920033395290375</span></span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a><span class="co">#&gt; Damien   4.46581987385203582618942164117470383644</span></span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a><span class="co">#&gt; Emilie  62.20084679281465867006772896274924278259</span></span>
<span id="cb51-22"><a href="#cb51-22" tabindex="-1"></a><span class="co">#&gt; Fran     0.00000000000000000000000000000003203788</span></span></code></pre></div>
</div>
<div id="individuals-plot-with-contributions" class="section level4" number="10.3.4.5">
<h4><span class="header-section-number">10.3.4.5</span> Individuals Plot with Contributions</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res.pca.cor, <span class="at">col.ind =</span> <span class="st">&quot;contrib&quot;</span>,</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>))</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-ind-contrib-1.png" width="100%" /></p>
</div>
<div id="individuals-plot-with-quality-of-representation" class="section level4" number="10.3.4.6">
<h4><span class="header-section-number">10.3.4.6</span> Individuals Plot with Quality of Representation</h4>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res.pca.cor, <span class="at">col.ind =</span> <span class="st">&quot;cos2&quot;</span>,</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-ind-quality-1.png" width="100%" /></p>
</div>
</div>
<div id="exporting-results" class="section level3" number="10.3.5">
<h3><span class="header-section-number">10.3.5</span> 17.1.5 Exporting Results</h3>
<div id="save-figures-as-pdf" class="section level4" number="10.3.5.1">
<h4><span class="header-section-number">10.3.5.1</span> Save Figures as PDF</h4>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;PCA.pdf&quot;</span>)</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.cor)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res.pca.cor)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="save-figures-as-png" class="section level4" number="10.3.5.2">
<h4><span class="header-section-number">10.3.5.2</span> Save Figures as PNG</h4>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;PCA%03d.png&quot;</span>, <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">600</span>)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.cor)</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res.pca.cor)</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="export-results-to-text-files" class="section level4" number="10.3.5.3">
<h4><span class="header-section-number">10.3.5.3</span> Export Results to Text Files</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">write.table</span>(res.pca.cor<span class="sc">$</span>eig, <span class="st">&quot;eigenvalues.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">write.table</span>(res.pca.cor<span class="sc">$</span>var<span class="sc">$</span>coord, <span class="st">&quot;variables_coordinates.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="fu">write.table</span>(res.pca.cor<span class="sc">$</span>ind<span class="sc">$</span>coord, <span class="st">&quot;individuals_coordinates.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="pca-with-base-r-prcomp-function" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> 17.2 PCA with Base R: prcomp() Function</h2>
<p>The <code>prcomp()</code> function is part of base R and provides an alternative way to perform PCA. Let‚Äôs use the <code>USArrests</code> dataset, which contains crime statistics for the 50 US states.</p>
<div id="data-exploration" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> 17.2.1 Data Exploration</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="co"># Load and examine the data</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="fu">head</span>(USArrests)</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a><span class="co">#&gt;            Murder Assault UrbanPop Rape</span></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="co">#&gt; Alabama      13.2     236       58 21.2</span></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a><span class="co">#&gt; Alaska       10.0     263       48 44.5</span></span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a><span class="co">#&gt; Arizona       8.1     294       80 31.0</span></span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a><span class="co">#&gt; Arkansas      8.8     190       50 19.5</span></span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a><span class="co">#&gt; California    9.0     276       91 40.6</span></span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a><span class="co">#&gt; Colorado      7.9     204       78 38.7</span></span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a><span class="fu">rownames</span>(USArrests)</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;Alabama&quot;        &quot;Alaska&quot;         &quot;Arizona&quot;       </span></span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a><span class="co">#&gt;  [4] &quot;Arkansas&quot;       &quot;California&quot;     &quot;Colorado&quot;      </span></span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;Connecticut&quot;    &quot;Delaware&quot;       &quot;Florida&quot;       </span></span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a><span class="co">#&gt; [10] &quot;Georgia&quot;        &quot;Hawaii&quot;         &quot;Idaho&quot;         </span></span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a><span class="co">#&gt; [13] &quot;Illinois&quot;       &quot;Indiana&quot;        &quot;Iowa&quot;          </span></span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a><span class="co">#&gt; [16] &quot;Kansas&quot;         &quot;Kentucky&quot;       &quot;Louisiana&quot;     </span></span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a><span class="co">#&gt; [19] &quot;Maine&quot;          &quot;Maryland&quot;       &quot;Massachusetts&quot; </span></span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a><span class="co">#&gt; [22] &quot;Michigan&quot;       &quot;Minnesota&quot;      &quot;Mississippi&quot;   </span></span>
<span id="cb57-19"><a href="#cb57-19" tabindex="-1"></a><span class="co">#&gt; [25] &quot;Missouri&quot;       &quot;Montana&quot;        &quot;Nebraska&quot;      </span></span>
<span id="cb57-20"><a href="#cb57-20" tabindex="-1"></a><span class="co">#&gt; [28] &quot;Nevada&quot;         &quot;New Hampshire&quot;  &quot;New Jersey&quot;    </span></span>
<span id="cb57-21"><a href="#cb57-21" tabindex="-1"></a><span class="co">#&gt; [31] &quot;New Mexico&quot;     &quot;New York&quot;       &quot;North Carolina&quot;</span></span>
<span id="cb57-22"><a href="#cb57-22" tabindex="-1"></a><span class="co">#&gt; [34] &quot;North Dakota&quot;   &quot;Ohio&quot;           &quot;Oklahoma&quot;      </span></span>
<span id="cb57-23"><a href="#cb57-23" tabindex="-1"></a><span class="co">#&gt; [37] &quot;Oregon&quot;         &quot;Pennsylvania&quot;   &quot;Rhode Island&quot;  </span></span>
<span id="cb57-24"><a href="#cb57-24" tabindex="-1"></a><span class="co">#&gt; [40] &quot;South Carolina&quot; &quot;South Dakota&quot;   &quot;Tennessee&quot;     </span></span>
<span id="cb57-25"><a href="#cb57-25" tabindex="-1"></a><span class="co">#&gt; [43] &quot;Texas&quot;          &quot;Utah&quot;           &quot;Vermont&quot;       </span></span>
<span id="cb57-26"><a href="#cb57-26" tabindex="-1"></a><span class="co">#&gt; [46] &quot;Virginia&quot;       &quot;Washington&quot;     &quot;West Virginia&quot; </span></span>
<span id="cb57-27"><a href="#cb57-27" tabindex="-1"></a><span class="co">#&gt; [49] &quot;Wisconsin&quot;      &quot;Wyoming&quot;</span></span></code></pre></div>
<p>The dataset contains four variables:</p>
<ul>
<li><strong>Murder</strong>: Murder arrests (per 100,000)</li>
<li><strong>Assault</strong>: Assault arrests (per 100,000)</li>
<li><strong>UrbanPop</strong>: Percent urban population</li>
<li><strong>Rape</strong>: Rape arrests (per 100,000)</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">colnames</span>(USArrests)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Murder&quot;   &quot;Assault&quot;  &quot;UrbanPop&quot; &quot;Rape&quot;</span></span></code></pre></div>
</div>
<div id="data-preprocessing-why-standardization-matters" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> 17.2.2 Data Preprocessing: Why Standardization Matters</h3>
<p>Notice that the variables have vastly different means. The <code>apply()</code> function with option <code>2</code> calculates statistics for each column (option <code>1</code> does it by row):</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">apply</span>(USArrests, <span class="dv">2</span>, mean)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="co">#&gt;   Murder  Assault UrbanPop     Rape </span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a><span class="co">#&gt;    7.788  170.760   65.540   21.232</span></span></code></pre></div>
<p>There are on average three times as many rapes as murders, and more than eight times as many assaults as rapes. Let‚Äôs examine the variances:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">apply</span>(USArrests, <span class="dv">2</span>, var)</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="co">#&gt;     Murder    Assault   UrbanPop       Rape </span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="co">#&gt;   18.97047 6945.16571  209.51878   87.72916</span></span></code></pre></div>
<p><strong>Important</strong>: The variables have very different variances. The <code>UrbanPop</code> variable (percentage) is not comparable to the number of arrests per 100,000. If we don‚Äôt scale the variables before performing PCA, most principal components would be driven by the <code>Assault</code> variable, since it has the largest mean and variance. <strong>It is crucial to standardize variables to have mean zero and standard deviation one before performing PCA.</strong></p>
</div>
<div id="performing-pca-with-prcomp" class="section level3" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> 17.2.3 Performing PCA with prcomp()</h3>
<p>The option <code>scale = TRUE</code> scales the variables to have standard deviation one.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>pr.out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(USArrests, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a><span class="fu">names</span>(pr.out)</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;</span></span></code></pre></div>
<p>The <code>center</code> and <code>scale</code> components correspond to the means and standard deviations used for scaling:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>pr.out<span class="sc">$</span>center</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="co">#&gt;   Murder  Assault UrbanPop     Rape </span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a><span class="co">#&gt;    7.788  170.760   65.540   21.232</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>pr.out<span class="sc">$</span>scale</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a><span class="co">#&gt;    Murder   Assault  UrbanPop      Rape </span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a><span class="co">#&gt;  4.355510 83.337661 14.474763  9.366385</span></span></code></pre></div>
</div>
<div id="principal-component-loadings" class="section level3" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> 17.2.4 Principal Component Loadings</h3>
<p>The rotation matrix provides the principal component loadings; each column contains the corresponding principal component loading vector.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="co">#&gt;                 PC1        PC2        PC3         PC4</span></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a><span class="co">#&gt; Murder   -0.5358995  0.4181809 -0.3412327  0.64922780</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a><span class="co">#&gt; Assault  -0.5831836  0.1879856 -0.2681484 -0.74340748</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a><span class="co">#&gt; UrbanPop -0.2781909 -0.8728062 -0.3780158  0.13387773</span></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a><span class="co">#&gt; Rape     -0.5434321 -0.1673186  0.8177779  0.08902432</span></span></code></pre></div>
<p>We see that there are four distinct principal components. This is expected because there are generally <span class="math inline">\(min(n-1, p)\)</span> informative principal components in a dataset with <span class="math inline">\(n\)</span> observations and <span class="math inline">\(p\)</span> variables.</p>
</div>
<div id="principal-component-scores" class="section level3" number="10.4.5">
<h3><span class="header-section-number">10.4.5</span> 17.2.5 Principal Component Scores</h3>
<p>Using <code>pr.out$x</code>, we have the <span class="math inline">\(50 \times 4\)</span> matrix of principal component score vectors. The <span class="math inline">\(k\)</span>th column is the <span class="math inline">\(k\)</span>th principal component score vector.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">dim</span>(pr.out<span class="sc">$</span>x)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="co">#&gt; [1] 50  4</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a><span class="fu">head</span>(pr.out<span class="sc">$</span>x)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a><span class="co">#&gt;                   PC1        PC2         PC3          PC4</span></span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a><span class="co">#&gt; Alabama    -0.9756604  1.1220012 -0.43980366  0.154696581</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a><span class="co">#&gt; Alaska     -1.9305379  1.0624269  2.01950027 -0.434175454</span></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a><span class="co">#&gt; Arizona    -1.7454429 -0.7384595  0.05423025 -0.826264240</span></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a><span class="co">#&gt; Arkansas    0.1399989  1.1085423  0.11342217 -0.180973554</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a><span class="co">#&gt; California -2.4986128 -1.5274267  0.59254100 -0.338559240</span></span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a><span class="co">#&gt; Colorado   -1.4993407 -0.9776297  1.08400162  0.001450164</span></span></code></pre></div>
</div>
<div id="visualizing-results" class="section level3" number="10.4.6">
<h3><span class="header-section-number">10.4.6</span> 17.2.6 Visualizing Results</h3>
<p>We can plot the first two principal components as follows:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-prcomp-1.png" width="100%" /></p>
<p>The <code>scale = 0</code> argument ensures that the arrows are scaled to represent the loadings; other values give slightly different biplots with different interpretations.</p>
<p><strong>Note</strong>: Principal components are only unique up to a sign change. We can reproduce the figure by changing signs:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>pr.out<span class="sc">$</span>rotation <span class="ot">&lt;-</span> <span class="sc">-</span>pr.out<span class="sc">$</span>rotation</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>pr.out<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="sc">-</span>pr.out<span class="sc">$</span>x</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a><span class="fu">biplot</span>(pr.out, <span class="at">scale =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="17-pca_files/figure-html/prcomp-sign-change-1.png" width="100%" /></p>
</div>
<div id="variance-explained" class="section level3" number="10.4.7">
<h3><span class="header-section-number">10.4.7</span> 17.2.7 Variance Explained</h3>
<p>The standard deviation (square root of the corresponding eigenvalue) of each principal component:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>pr.out<span class="sc">$</span>sdev</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="co">#&gt; [1] 1.5748783 0.9948694 0.5971291 0.4164494</span></span></code></pre></div>
<p>The variance explained by each principal component (corresponding eigenvalue) is obtained by squaring these:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>pr.var <span class="ot">&lt;-</span> pr.out<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>pr.var</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a><span class="co">#&gt; [1] 2.4802416 0.9897652 0.3565632 0.1734301</span></span></code></pre></div>
<p>Compute the proportion of variance explained by each principal component:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>pve <span class="ot">&lt;-</span> pr.var <span class="sc">/</span> <span class="fu">sum</span>(pr.var)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>pve</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.62006039 0.24744129 0.08914080 0.04335752</span></span></code></pre></div>
<p>We see that the first principal component explains 62.0% of the variance, and the next explains 24.7%. Let‚Äôs plot the PVE (Proportion of Variance Explained) and cumulative PVE:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="fu">plot</span>(pve, <span class="at">xlab =</span> <span class="st">&quot;Principal Component&quot;</span>, </span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Proportion of Variance Explained&quot;</span>, </span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(pve), <span class="at">xlab =</span> <span class="st">&quot;Principal Component&quot;</span>, </span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Cumulative Proportion of Variance Explained&quot;</span>, </span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="17-pca_files/figure-html/plot-pve-1.png" width="100%" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>The function <code>cumsum()</code> computes the cumulative sum of the elements of a numeric vector.</p>
</div>
</div>
<div id="practical-exercises" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> 17.3 Practical Exercises</h2>
<div id="exercise-1-us-cereals-dataset" class="section level3" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> Exercise 1: US Cereals Dataset</h3>
<p>Consider the <code>UScereal</code> dataset from the <code>MASS</code> package (65 rows and 11 columns), which contains nutritional and marketing information from the 1993 ASA Statistical Graphics Exposition. The data have been normalized to a portion of one American cup.</p>
<p><strong>Tasks:</strong></p>
<ol style="list-style-type: decimal">
<li>Load the dataset and examine its structure</li>
<li>Identify which variables are quantitative and suitable for PCA</li>
<li>Perform PCA on the quantitative variables</li>
<li>Interpret the results: how many components should be retained?</li>
<li>Create visualizations to understand the relationships between variables</li>
</ol>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="fu">data</span>(UScereal)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a><span class="co"># Note: Some variables are not quantitative</span></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a><span class="co"># Select only quantitative variables before performing PCA</span></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a><span class="co"># res.pca.cereal &lt;- PCA(UScereal[, quantitative_cols], scale.unit = TRUE, graph = FALSE)</span></span></code></pre></div>
</div>
<div id="exercise-2-nci-cancer-cell-line-data" class="section level3" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> Exercise 2: NCI Cancer Cell Line Data</h3>
<p>Consider the NCI cancer cell line microarray data from <code>ISLR2</code>, which consists of 6,830 gene expression measurements on 64 cancer cell lines.</p>
<p><strong>Tasks:</strong></p>
<ol style="list-style-type: decimal">
<li>Load the dataset</li>
<li>Perform PCA on the gene expression data</li>
<li>Visualize the first few principal components</li>
<li>Check if the cancer types (given in <code>nci.labs</code>) cluster together in the PCA space</li>
</ol>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="fu">data</span>(NCI60)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a><span class="co"># Each cell line is labeled with a cancer type, given in nci.labs</span></span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a><span class="co"># Perform PCA and check if cancer types cluster in the first two dimensions</span></span></code></pre></div>
</div>
<div id="exercise-3-wine-quality-analysis" class="section level3" number="10.5.3">
<h3><span class="header-section-number">10.5.3</span> Exercise 3: Wine Quality Analysis</h3>
<p>Consider the wine dataset from the <code>gclus</code> package, which contains chemical analyses of wines grown in the same region in Italy but derived from three different cultivars. The dataset has 13 variables and over 170 observations.</p>
<p><strong>Tasks:</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Perform PCA on the wine dataset. Remember to standardize the variables as they are on different scales.</li>
</ol>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">library</span>(gclus)</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="fu">data</span>(wine)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>res.pca.wine <span class="ot">&lt;-</span> <span class="fu">PCA</span>(wine, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Interpret the PCA results. Focus on:</li>
</ol>
<ul>
<li>Which chemical properties contribute most to the variance?</li>
<li>Do the wines cluster by cultivar?</li>
<li>How many principal components should be retained?</li>
</ul>
</div>
<div id="exercise-4-boston-housing-data" class="section level3" number="10.5.4">
<h3><span class="header-section-number">10.5.4</span> Exercise 4: Boston Housing Data</h3>
<p>Consider the Boston dataset from the <code>MASS</code> package, which contains information collected by the U.S. Census Service concerning housing in the area of Boston, Massachusetts. It has 506 rows and 14 columns.</p>
<p><strong>Tasks:</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Conduct PCA on the Boston housing dataset. Before performing PCA:</li>
</ol>
<ul>
<li>Assess which variables are most suitable for the analysis</li>
<li>Handle any missing values</li>
<li>Preprocess the data accordingly</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="fu">data</span>(Boston)</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a><span class="co"># Select appropriate variables and perform PCA</span></span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>res.pca.boston <span class="ot">&lt;-</span> <span class="fu">PCA</span>(Boston, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Interpret the results. Look for patterns indicating relationships between:</li>
</ol>
<ul>
<li>Crime rates</li>
<li>Property tax</li>
<li>Median value of owner-occupied homes</li>
<li>Other housing characteristics</li>
</ul>
</div>
<div id="general-guidelines-for-solving-exercises" class="section level3" number="10.5.5">
<h3><span class="header-section-number">10.5.5</span> General Guidelines for Solving Exercises</h3>
<ul>
<li><strong>Data Preprocessing</strong>: Before performing PCA, it‚Äôs crucial to:
<ul>
<li>Handle missing values appropriately</li>
<li>Standardize the data (especially when variables are on different scales)</li>
<li>Select relevant quantitative variables</li>
</ul></li>
<li><strong>PCA Interpretation</strong>: When interpreting results, focus on:
<ul>
<li>Eigenvalues and proportion of variance explained</li>
<li>Loadings of variables on principal components</li>
<li>Quality of representation (cos¬≤)</li>
<li>Contributions of variables and individuals</li>
</ul></li>
<li><strong>Visualization</strong>: Use plots to aid interpretation:
<ul>
<li>Scree plots (eigenvalues)</li>
<li>Biplots (variables and individuals together)</li>
<li>Variable plots (with contributions or quality)</li>
<li>Individual plots</li>
</ul></li>
<li><strong>Contextual Understanding</strong>: Understanding the domain context can significantly help in interpreting results meaningfully. Always relate statistical findings back to the real-world problem you‚Äôre solving.</li>
</ul>
</div>
</div>
<div id="online-resources-and-references" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> Online Resources and References</h2>
<div id="official-documentation" class="section level3" number="10.6.1">
<h3><span class="header-section-number">10.6.1</span> Official Documentation</h3>
<ul>
<li><strong>FactoMineR Package</strong>:
<ul>
<li><a href="https://cran.r-project.org/package=FactoMineR">CRAN page</a></li>
<li><a href="https://github.com/husson/FactoMineR">GitHub repository</a></li>
<li><a href="http://factominer.free.fr/">Official website</a></li>
</ul></li>
<li><strong>factoextra Package</strong>:
<ul>
<li><a href="https://cran.r-project.org/package=factoextra">CRAN page</a></li>
<li><a href="http://www.sthda.com/english/rpkgs/factoextra/">Documentation</a></li>
</ul></li>
</ul>
</div>
<div id="r-markdown-resources-as-mentioned-in-slides" class="section level3" number="10.6.2">
<h3><span class="header-section-number">10.6.2</span> R Markdown Resources (as mentioned in slides)</h3>
<ul>
<li><strong>R Markdown Cheat Sheet</strong>: <a href="https://www.rstudio.com/resources/cheatsheets/">RStudio Cheatsheets</a> - Download the R Markdown cheat sheet</li>
<li><strong>R Markdown Guide</strong>: <a href="https://bookdown.org/yihui/rmarkdown/">R Markdown: The Definitive Guide</a></li>
<li><strong>RStudio</strong>: <a href="https://www.rstudio.com/products/rstudio/download/">Download RStudio</a></li>
<li><strong>R Markdown Tutorial</strong>: <a href="https://rmarkdown.rstudio.com/lesson-1.html">R Markdown Tutorial</a></li>
</ul>
</div>
<div id="tutorials-and-guides" class="section level3" number="10.6.3">
<h3><span class="header-section-number">10.6.3</span> Tutorials and Guides</h3>
<ul>
<li><strong>PCA Tutorial</strong>: <a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/">STHDA - Principal Component Analysis in R</a></li>
<li><strong>CA Tutorial</strong>: <a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/113-ca-correspondence-analysis-in-r-the-essentials/">STHDA - Correspondence Analysis in R</a></li>
<li><strong>R-bloggers</strong>: Search for PCA and CA articles at <a href="https://www.r-bloggers.com/">R-bloggers.com</a></li>
</ul>
</div>
<div id="interactive-tools" class="section level3" number="10.6.4">
<h3><span class="header-section-number">10.6.4</span> Interactive Tools</h3>
<ul>
<li><strong>PCA Visualization</strong>: <a href="https://huygens.science.uva.nl/">PCA Explorer</a> - Interactive PCA visualization tool</li>
<li><strong>R Documentation</strong>: <a href="https://www.rdocumentation.org/">rdocumentation.org</a> - Search for PCA and CA functions</li>
</ul>
</div>
<div id="books-and-academic-resources" class="section level3" number="10.6.5">
<h3><span class="header-section-number">10.6.5</span> Books and Academic Resources</h3>
<ul>
<li><strong>An Introduction to Applied Multivariate Analysis with R</strong> by Everitt &amp; Hothorn</li>
<li><strong>Principal Component Analysis</strong> by Jolliffe (classic textbook)</li>
<li><strong>Correspondence Analysis in Practice</strong> by Greenacre</li>
</ul>
</div>
<div id="quick-reference" class="section level3" number="10.6.6">
<h3><span class="header-section-number">10.6.6</span> Quick Reference</h3>
<ul>
<li><strong>FactoMineR Help</strong>: Type <code>?PCA</code> or <code>?CA</code> in R console after loading the package</li>
<li><strong>factoextra Help</strong>: Type <code>?fviz_pca_var</code> or <code>?fviz_ca_biplot</code> in R console</li>
</ul>
<p><strong>‚ö†Ô∏è Important</strong>: If you encounter broken links in the PDF slides (<code>module_2_PCA_&amp;_CA.pdf</code>), all the links above are verified and working. Use this section as your reference for online resources.</p>
<!--chapter:end:17-pca.Rmd-->
</div>
</div>
</div>
<div id="lab-pca-ca" class="section level1" number="11">
<h1><span class="header-section-number">11</span> üíª Lab: PCA &amp; Correspondence Analysis</h1>
<blockquote>
<p><strong>‚ö†Ô∏è Note on Slides</strong>: If you encounter broken links in the PDF slides (<code>module_2_PCA_&amp;_CA.pdf</code>), please refer to the ‚ÄúAdditional Resources‚Äù section at the end of this lab for updated and working links.</p>
</blockquote>
<p>This is a hands-on laboratory session to practice Principal Component Analysis (PCA) and Correspondence Analysis (CA) after the theoretical lecture. Work through these exercises step by step, and don‚Äôt hesitate to ask questions!</p>
<div id="setup" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Setup</h2>
<p>First, load the required packages:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)  <span class="co"># For PCA and CA</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">library</span>(factoextra)  <span class="co"># For visualization</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a><span class="fu">library</span>(corrplot)    <span class="co"># For correlation plots</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)       <span class="co"># For data manipulation</span></span></code></pre></div>
</div>
<div id="part-1-principal-component-analysis-pca" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Part 1: Principal Component Analysis (PCA)</h2>
<div id="exercise-1.1-understanding-the-data---wine-dataset" class="section level3" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Exercise 1.1: Understanding the Data - Wine Dataset</h3>
<p>We‚Äôll work with the wine dataset from the <code>gclus</code> package, which contains chemical analyses of wines from three different cultivars.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co"># Load the wine dataset</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="fu">library</span>(gclus)</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a><span class="co">#&gt; Caricamento del pacchetto richiesto: cluster</span></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="fu">data</span>(wine)</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a><span class="co"># Examine the structure</span></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a><span class="fu">str</span>(wine)</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    178 obs. of  14 variables:</span></span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a><span class="co">#&gt;  $ Class          : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a><span class="co">#&gt;  $ Alcohol        : num  14.2 13.2 13.2 14.4 13.2 ...</span></span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a><span class="co">#&gt;  $ Malic          : num  1.71 1.78 2.36 1.95 2.59 1.76 1.87 2.15 1.64 1.35 ...</span></span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a><span class="co">#&gt;  $ Ash            : num  2.43 2.14 2.67 2.5 2.87 2.45 2.45 2.61 2.17 2.27 ...</span></span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a><span class="co">#&gt;  $ Alcalinity     : num  15.6 11.2 18.6 16.8 21 15.2 14.6 17.6 14 16 ...</span></span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a><span class="co">#&gt;  $ Magnesium      : num  127 100 101 113 118 112 96 121 97 98 ...</span></span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a><span class="co">#&gt;  $ Phenols        : num  2.8 2.65 2.8 3.85 2.8 3.27 2.5 2.6 2.8 2.98 ...</span></span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a><span class="co">#&gt;  $ Flavanoids     : num  3.06 2.76 3.24 3.49 2.69 3.39 2.52 2.51 2.98 3.15 ...</span></span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a><span class="co">#&gt;  $ Nonflavanoid   : num  0.28 0.26 0.3 0.24 0.39 0.34 0.3 0.31 0.29 0.22 ...</span></span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a><span class="co">#&gt;  $ Proanthocyanins: num  2.29 1.28 2.81 2.18 1.82 1.97 1.98 1.25 1.98 1.85 ...</span></span>
<span id="cb77-19"><a href="#cb77-19" tabindex="-1"></a><span class="co">#&gt;  $ Intensity      : num  5.64 4.38 5.68 7.8 4.32 6.75 5.25 5.05 5.2 7.22 ...</span></span>
<span id="cb77-20"><a href="#cb77-20" tabindex="-1"></a><span class="co">#&gt;  $ Hue            : num  1.04 1.05 1.03 0.86 1.04 1.05 1.02 1.06 1.08 1.01 ...</span></span>
<span id="cb77-21"><a href="#cb77-21" tabindex="-1"></a><span class="co">#&gt;  $ OD280          : num  3.92 3.4 3.17 3.45 2.93 2.85 3.58 3.58 2.85 3.55 ...</span></span>
<span id="cb77-22"><a href="#cb77-22" tabindex="-1"></a><span class="co">#&gt;  $ Proline        : num  1065 1050 1185 1480 735 ...</span></span>
<span id="cb77-23"><a href="#cb77-23" tabindex="-1"></a><span class="fu">head</span>(wine)</span>
<span id="cb77-24"><a href="#cb77-24" tabindex="-1"></a><span class="co">#&gt;   Class Alcohol Malic  Ash Alcalinity Magnesium Phenols</span></span>
<span id="cb77-25"><a href="#cb77-25" tabindex="-1"></a><span class="co">#&gt; 1     1   14.23  1.71 2.43       15.6       127    2.80</span></span>
<span id="cb77-26"><a href="#cb77-26" tabindex="-1"></a><span class="co">#&gt; 2     1   13.20  1.78 2.14       11.2       100    2.65</span></span>
<span id="cb77-27"><a href="#cb77-27" tabindex="-1"></a><span class="co">#&gt; 3     1   13.16  2.36 2.67       18.6       101    2.80</span></span>
<span id="cb77-28"><a href="#cb77-28" tabindex="-1"></a><span class="co">#&gt; 4     1   14.37  1.95 2.50       16.8       113    3.85</span></span>
<span id="cb77-29"><a href="#cb77-29" tabindex="-1"></a><span class="co">#&gt; 5     1   13.24  2.59 2.87       21.0       118    2.80</span></span>
<span id="cb77-30"><a href="#cb77-30" tabindex="-1"></a><span class="co">#&gt; 6     1   14.20  1.76 2.45       15.2       112    3.27</span></span>
<span id="cb77-31"><a href="#cb77-31" tabindex="-1"></a><span class="co">#&gt;   Flavanoids Nonflavanoid Proanthocyanins Intensity  Hue</span></span>
<span id="cb77-32"><a href="#cb77-32" tabindex="-1"></a><span class="co">#&gt; 1       3.06         0.28            2.29      5.64 1.04</span></span>
<span id="cb77-33"><a href="#cb77-33" tabindex="-1"></a><span class="co">#&gt; 2       2.76         0.26            1.28      4.38 1.05</span></span>
<span id="cb77-34"><a href="#cb77-34" tabindex="-1"></a><span class="co">#&gt; 3       3.24         0.30            2.81      5.68 1.03</span></span>
<span id="cb77-35"><a href="#cb77-35" tabindex="-1"></a><span class="co">#&gt; 4       3.49         0.24            2.18      7.80 0.86</span></span>
<span id="cb77-36"><a href="#cb77-36" tabindex="-1"></a><span class="co">#&gt; 5       2.69         0.39            1.82      4.32 1.04</span></span>
<span id="cb77-37"><a href="#cb77-37" tabindex="-1"></a><span class="co">#&gt; 6       3.39         0.34            1.97      6.75 1.05</span></span>
<span id="cb77-38"><a href="#cb77-38" tabindex="-1"></a><span class="co">#&gt;   OD280 Proline</span></span>
<span id="cb77-39"><a href="#cb77-39" tabindex="-1"></a><span class="co">#&gt; 1  3.92    1065</span></span>
<span id="cb77-40"><a href="#cb77-40" tabindex="-1"></a><span class="co">#&gt; 2  3.40    1050</span></span>
<span id="cb77-41"><a href="#cb77-41" tabindex="-1"></a><span class="co">#&gt; 3  3.17    1185</span></span>
<span id="cb77-42"><a href="#cb77-42" tabindex="-1"></a><span class="co">#&gt; 4  3.45    1480</span></span>
<span id="cb77-43"><a href="#cb77-43" tabindex="-1"></a><span class="co">#&gt; 5  2.93     735</span></span>
<span id="cb77-44"><a href="#cb77-44" tabindex="-1"></a><span class="co">#&gt; 6  2.85    1450</span></span>
<span id="cb77-45"><a href="#cb77-45" tabindex="-1"></a><span class="fu">dim</span>(wine)</span>
<span id="cb77-46"><a href="#cb77-46" tabindex="-1"></a><span class="co">#&gt; [1] 178  14</span></span>
<span id="cb77-47"><a href="#cb77-47" tabindex="-1"></a></span>
<span id="cb77-48"><a href="#cb77-48" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb77-49"><a href="#cb77-49" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wine))</span>
<span id="cb77-50"><a href="#cb77-50" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. How many observations and variables are in the dataset?
2. What types of variables do we have?
3. Are there any missing values?</p>
</div>
<div id="exercise-1.2-data-exploration-and-preprocessing" class="section level3" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Exercise 1.2: Data Exploration and Preprocessing</h3>
<p>Before performing PCA, let‚Äôs explore the data and understand why standardization is important.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="co"># Calculate means for each variable</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="fu">apply</span>(wine, <span class="dv">2</span>, mean)</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a><span class="co">#&gt;           Class         Alcohol           Malic </span></span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a><span class="co">#&gt;       1.9382022      13.0006180       2.3363483 </span></span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a><span class="co">#&gt;             Ash      Alcalinity       Magnesium </span></span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a><span class="co">#&gt;       2.3665169      19.4949438      99.7415730 </span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a><span class="co">#&gt;         Phenols      Flavanoids    Nonflavanoid </span></span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a><span class="co">#&gt;       2.2951124       2.0292697       0.3618539 </span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins       Intensity             Hue </span></span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a><span class="co">#&gt;       1.5908989       5.0580899       0.9574719 </span></span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a><span class="co">#&gt;           OD280         Proline </span></span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a><span class="co">#&gt;       2.6116854     746.8932584</span></span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a></span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a><span class="co"># Calculate variances for each variable</span></span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a><span class="fu">apply</span>(wine, <span class="dv">2</span>, var)</span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a><span class="co">#&gt;           Class         Alcohol           Malic </span></span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a><span class="co">#&gt;      0.60067924      0.65906233      1.24801540 </span></span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a><span class="co">#&gt;             Ash      Alcalinity       Magnesium </span></span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a><span class="co">#&gt;      0.07526464     11.15268616    203.98933536 </span></span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a><span class="co">#&gt;         Phenols      Flavanoids    Nonflavanoid </span></span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a><span class="co">#&gt;      0.39168954      0.99771867      0.01548863 </span></span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins       Intensity             Hue </span></span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a><span class="co">#&gt;      0.32759467      5.37444944      0.05224273 </span></span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a><span class="co">#&gt;           OD280         Proline </span></span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a><span class="co">#&gt;      0.50408641  99166.71735542</span></span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a></span>
<span id="cb78-27"><a href="#cb78-27" tabindex="-1"></a><span class="co"># Calculate standard deviations</span></span>
<span id="cb78-28"><a href="#cb78-28" tabindex="-1"></a><span class="fu">apply</span>(wine, <span class="dv">2</span>, sd)</span>
<span id="cb78-29"><a href="#cb78-29" tabindex="-1"></a><span class="co">#&gt;           Class         Alcohol           Malic </span></span>
<span id="cb78-30"><a href="#cb78-30" tabindex="-1"></a><span class="co">#&gt;       0.7750350       0.8118265       1.1171461 </span></span>
<span id="cb78-31"><a href="#cb78-31" tabindex="-1"></a><span class="co">#&gt;             Ash      Alcalinity       Magnesium </span></span>
<span id="cb78-32"><a href="#cb78-32" tabindex="-1"></a><span class="co">#&gt;       0.2743440       3.3395638      14.2824835 </span></span>
<span id="cb78-33"><a href="#cb78-33" tabindex="-1"></a><span class="co">#&gt;         Phenols      Flavanoids    Nonflavanoid </span></span>
<span id="cb78-34"><a href="#cb78-34" tabindex="-1"></a><span class="co">#&gt;       0.6258510       0.9988587       0.1244533 </span></span>
<span id="cb78-35"><a href="#cb78-35" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins       Intensity             Hue </span></span>
<span id="cb78-36"><a href="#cb78-36" tabindex="-1"></a><span class="co">#&gt;       0.5723589       2.3182859       0.2285667 </span></span>
<span id="cb78-37"><a href="#cb78-37" tabindex="-1"></a><span class="co">#&gt;           OD280         Proline </span></span>
<span id="cb78-38"><a href="#cb78-38" tabindex="-1"></a><span class="co">#&gt;       0.7099904     314.9074743</span></span>
<span id="cb78-39"><a href="#cb78-39" tabindex="-1"></a></span>
<span id="cb78-40"><a href="#cb78-40" tabindex="-1"></a><span class="co"># Create a correlation matrix</span></span>
<span id="cb78-41"><a href="#cb78-41" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(wine)</span>
<span id="cb78-42"><a href="#cb78-42" tabindex="-1"></a>cor_matrix</span>
<span id="cb78-43"><a href="#cb78-43" tabindex="-1"></a><span class="co">#&gt;                       Class     Alcohol       Malic</span></span>
<span id="cb78-44"><a href="#cb78-44" tabindex="-1"></a><span class="co">#&gt; Class            1.00000000 -0.32822194  0.43777620</span></span>
<span id="cb78-45"><a href="#cb78-45" tabindex="-1"></a><span class="co">#&gt; Alcohol         -0.32822194  1.00000000  0.09439694</span></span>
<span id="cb78-46"><a href="#cb78-46" tabindex="-1"></a><span class="co">#&gt; Malic            0.43777620  0.09439694  1.00000000</span></span>
<span id="cb78-47"><a href="#cb78-47" tabindex="-1"></a><span class="co">#&gt; Ash             -0.04964322  0.21154460  0.16404547</span></span>
<span id="cb78-48"><a href="#cb78-48" tabindex="-1"></a><span class="co">#&gt; Alcalinity       0.51785911 -0.31023514  0.28850040</span></span>
<span id="cb78-49"><a href="#cb78-49" tabindex="-1"></a><span class="co">#&gt; Magnesium       -0.20917939  0.27079823 -0.05457510</span></span>
<span id="cb78-50"><a href="#cb78-50" tabindex="-1"></a><span class="co">#&gt; Phenols         -0.71916334  0.28910112 -0.33516700</span></span>
<span id="cb78-51"><a href="#cb78-51" tabindex="-1"></a><span class="co">#&gt; Flavanoids      -0.84749754  0.23681493 -0.41100659</span></span>
<span id="cb78-52"><a href="#cb78-52" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid     0.48910916 -0.15592947  0.29297713</span></span>
<span id="cb78-53"><a href="#cb78-53" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins -0.49912982  0.13669791 -0.22074619</span></span>
<span id="cb78-54"><a href="#cb78-54" tabindex="-1"></a><span class="co">#&gt; Intensity        0.26566757  0.54636419  0.24898534</span></span>
<span id="cb78-55"><a href="#cb78-55" tabindex="-1"></a><span class="co">#&gt; Hue             -0.61737454 -0.07183528 -0.56137198</span></span>
<span id="cb78-56"><a href="#cb78-56" tabindex="-1"></a><span class="co">#&gt; OD280           -0.78822959  0.07234319 -0.36871043</span></span>
<span id="cb78-57"><a href="#cb78-57" tabindex="-1"></a><span class="co">#&gt; Proline         -0.63371678  0.64372004 -0.19201056</span></span>
<span id="cb78-58"><a href="#cb78-58" tabindex="-1"></a><span class="co">#&gt;                          Ash  Alcalinity   Magnesium</span></span>
<span id="cb78-59"><a href="#cb78-59" tabindex="-1"></a><span class="co">#&gt; Class           -0.049643221  0.51785911 -0.20917939</span></span>
<span id="cb78-60"><a href="#cb78-60" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.211544596 -0.31023514  0.27079823</span></span>
<span id="cb78-61"><a href="#cb78-61" tabindex="-1"></a><span class="co">#&gt; Malic            0.164045470  0.28850040 -0.05457510</span></span>
<span id="cb78-62"><a href="#cb78-62" tabindex="-1"></a><span class="co">#&gt; Ash              1.000000000  0.44336719  0.28658669</span></span>
<span id="cb78-63"><a href="#cb78-63" tabindex="-1"></a><span class="co">#&gt; Alcalinity       0.443367187  1.00000000 -0.08333309</span></span>
<span id="cb78-64"><a href="#cb78-64" tabindex="-1"></a><span class="co">#&gt; Magnesium        0.286586691 -0.08333309  1.00000000</span></span>
<span id="cb78-65"><a href="#cb78-65" tabindex="-1"></a><span class="co">#&gt; Phenols          0.128979538 -0.32111332  0.21440123</span></span>
<span id="cb78-66"><a href="#cb78-66" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.115077279 -0.35136986  0.19578377</span></span>
<span id="cb78-67"><a href="#cb78-67" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid     0.186230446  0.36192172 -0.25629405</span></span>
<span id="cb78-68"><a href="#cb78-68" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.009651935 -0.19732684  0.23644061</span></span>
<span id="cb78-69"><a href="#cb78-69" tabindex="-1"></a><span class="co">#&gt; Intensity        0.258887257  0.01873198  0.19995000</span></span>
<span id="cb78-70"><a href="#cb78-70" tabindex="-1"></a><span class="co">#&gt; Hue             -0.074724894 -0.27393429  0.05542194</span></span>
<span id="cb78-71"><a href="#cb78-71" tabindex="-1"></a><span class="co">#&gt; OD280            0.003911231 -0.27676855  0.06600394</span></span>
<span id="cb78-72"><a href="#cb78-72" tabindex="-1"></a><span class="co">#&gt; Proline          0.223626264 -0.44059693  0.39335085</span></span>
<span id="cb78-73"><a href="#cb78-73" tabindex="-1"></a><span class="co">#&gt;                     Phenols Flavanoids Nonflavanoid</span></span>
<span id="cb78-74"><a href="#cb78-74" tabindex="-1"></a><span class="co">#&gt; Class           -0.71916334 -0.8474975    0.4891092</span></span>
<span id="cb78-75"><a href="#cb78-75" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.28910112  0.2368149   -0.1559295</span></span>
<span id="cb78-76"><a href="#cb78-76" tabindex="-1"></a><span class="co">#&gt; Malic           -0.33516700 -0.4110066    0.2929771</span></span>
<span id="cb78-77"><a href="#cb78-77" tabindex="-1"></a><span class="co">#&gt; Ash              0.12897954  0.1150773    0.1862304</span></span>
<span id="cb78-78"><a href="#cb78-78" tabindex="-1"></a><span class="co">#&gt; Alcalinity      -0.32111332 -0.3513699    0.3619217</span></span>
<span id="cb78-79"><a href="#cb78-79" tabindex="-1"></a><span class="co">#&gt; Magnesium        0.21440123  0.1957838   -0.2562940</span></span>
<span id="cb78-80"><a href="#cb78-80" tabindex="-1"></a><span class="co">#&gt; Phenols          1.00000000  0.8645635   -0.4499353</span></span>
<span id="cb78-81"><a href="#cb78-81" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.86456350  1.0000000   -0.5378996</span></span>
<span id="cb78-82"><a href="#cb78-82" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.44993530 -0.5378996    1.0000000</span></span>
<span id="cb78-83"><a href="#cb78-83" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.61241308  0.6526918   -0.3658451</span></span>
<span id="cb78-84"><a href="#cb78-84" tabindex="-1"></a><span class="co">#&gt; Intensity       -0.05513642 -0.1723794    0.1390570</span></span>
<span id="cb78-85"><a href="#cb78-85" tabindex="-1"></a><span class="co">#&gt; Hue              0.43350181  0.5433903   -0.2626388</span></span>
<span id="cb78-86"><a href="#cb78-86" tabindex="-1"></a><span class="co">#&gt; OD280            0.69994936  0.7871939   -0.5032696</span></span>
<span id="cb78-87"><a href="#cb78-87" tabindex="-1"></a><span class="co">#&gt; Proline          0.49811488  0.4941931   -0.3113852</span></span>
<span id="cb78-88"><a href="#cb78-88" tabindex="-1"></a><span class="co">#&gt;                 Proanthocyanins   Intensity         Hue</span></span>
<span id="cb78-89"><a href="#cb78-89" tabindex="-1"></a><span class="co">#&gt; Class              -0.499129824  0.26566757 -0.61737454</span></span>
<span id="cb78-90"><a href="#cb78-90" tabindex="-1"></a><span class="co">#&gt; Alcohol             0.136697912  0.54636419 -0.07183528</span></span>
<span id="cb78-91"><a href="#cb78-91" tabindex="-1"></a><span class="co">#&gt; Malic              -0.220746187  0.24898534 -0.56137198</span></span>
<span id="cb78-92"><a href="#cb78-92" tabindex="-1"></a><span class="co">#&gt; Ash                 0.009651935  0.25888726 -0.07472489</span></span>
<span id="cb78-93"><a href="#cb78-93" tabindex="-1"></a><span class="co">#&gt; Alcalinity         -0.197326836  0.01873198 -0.27393429</span></span>
<span id="cb78-94"><a href="#cb78-94" tabindex="-1"></a><span class="co">#&gt; Magnesium           0.236440610  0.19995000  0.05542194</span></span>
<span id="cb78-95"><a href="#cb78-95" tabindex="-1"></a><span class="co">#&gt; Phenols             0.612413084 -0.05513642  0.43350181</span></span>
<span id="cb78-96"><a href="#cb78-96" tabindex="-1"></a><span class="co">#&gt; Flavanoids          0.652691769 -0.17237940  0.54339029</span></span>
<span id="cb78-97"><a href="#cb78-97" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid       -0.365845099  0.13905701 -0.26263878</span></span>
<span id="cb78-98"><a href="#cb78-98" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins     1.000000000 -0.02524993  0.29552796</span></span>
<span id="cb78-99"><a href="#cb78-99" tabindex="-1"></a><span class="co">#&gt; Intensity          -0.025249935  1.00000000 -0.52191000</span></span>
<span id="cb78-100"><a href="#cb78-100" tabindex="-1"></a><span class="co">#&gt; Hue                 0.295527964 -0.52191000  1.00000000</span></span>
<span id="cb78-101"><a href="#cb78-101" tabindex="-1"></a><span class="co">#&gt; OD280               0.519067096 -0.42881494  0.56537014</span></span>
<span id="cb78-102"><a href="#cb78-102" tabindex="-1"></a><span class="co">#&gt; Proline             0.330416700  0.31610011  0.23622715</span></span>
<span id="cb78-103"><a href="#cb78-103" tabindex="-1"></a><span class="co">#&gt;                        OD280    Proline</span></span>
<span id="cb78-104"><a href="#cb78-104" tabindex="-1"></a><span class="co">#&gt; Class           -0.788229589 -0.6337168</span></span>
<span id="cb78-105"><a href="#cb78-105" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.072343187  0.6437200</span></span>
<span id="cb78-106"><a href="#cb78-106" tabindex="-1"></a><span class="co">#&gt; Malic           -0.368710428 -0.1920106</span></span>
<span id="cb78-107"><a href="#cb78-107" tabindex="-1"></a><span class="co">#&gt; Ash              0.003911231  0.2236263</span></span>
<span id="cb78-108"><a href="#cb78-108" tabindex="-1"></a><span class="co">#&gt; Alcalinity      -0.276768549 -0.4405969</span></span>
<span id="cb78-109"><a href="#cb78-109" tabindex="-1"></a><span class="co">#&gt; Magnesium        0.066003936  0.3933508</span></span>
<span id="cb78-110"><a href="#cb78-110" tabindex="-1"></a><span class="co">#&gt; Phenols          0.699949365  0.4981149</span></span>
<span id="cb78-111"><a href="#cb78-111" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.787193902  0.4941931</span></span>
<span id="cb78-112"><a href="#cb78-112" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.503269596 -0.3113852</span></span>
<span id="cb78-113"><a href="#cb78-113" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.519067096  0.3304167</span></span>
<span id="cb78-114"><a href="#cb78-114" tabindex="-1"></a><span class="co">#&gt; Intensity       -0.428814943  0.3161001</span></span>
<span id="cb78-115"><a href="#cb78-115" tabindex="-1"></a><span class="co">#&gt; Hue              0.565370143  0.2362272</span></span>
<span id="cb78-116"><a href="#cb78-116" tabindex="-1"></a><span class="co">#&gt; OD280            1.000000000  0.3127611</span></span>
<span id="cb78-117"><a href="#cb78-117" tabindex="-1"></a><span class="co">#&gt; Proline          0.312761075  1.0000000</span></span>
<span id="cb78-118"><a href="#cb78-118" tabindex="-1"></a></span>
<span id="cb78-119"><a href="#cb78-119" tabindex="-1"></a><span class="co"># Visualize correlations</span></span>
<span id="cb78-120"><a href="#cb78-120" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">&quot;circle&quot;</span>, <span class="at">type =</span> <span class="st">&quot;upper&quot;</span>, </span>
<span id="cb78-121"><a href="#cb78-121" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="at">tl.cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex1-2-explore-1.png" width="100%" /></p>
<p><strong>Questions:</strong>
1. Do the variables have similar scales? Why is this important for PCA?
2. Which variables are highly correlated? What does this suggest?
3. Should we standardize the data? Why or why not?</p>
</div>
<div id="exercise-1.3-perform-pca" class="section level3" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Exercise 1.3: Perform PCA</h3>
<p>Now let‚Äôs perform PCA on the wine dataset.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="co"># Perform PCA with standardization</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>res.pca.wine <span class="ot">&lt;-</span> <span class="fu">PCA</span>(wine, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a><span class="fu">print</span>(res.pca.wine)</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a><span class="co">#&gt; **Results for the Principal Component Analysis (PCA)**</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a><span class="co">#&gt; The analysis was performed on 178 individuals, described by 14 variables</span></span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a><span class="co">#&gt; *The results are available in the following objects:</span></span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a><span class="co">#&gt;    name               description                          </span></span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a><span class="co">#&gt; 1  &quot;$eig&quot;             &quot;eigenvalues&quot;                        </span></span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a><span class="co">#&gt; 2  &quot;$var&quot;             &quot;results for the variables&quot;          </span></span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a><span class="co">#&gt; 3  &quot;$var$coord&quot;       &quot;coord. for the variables&quot;           </span></span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a><span class="co">#&gt; 4  &quot;$var$cor&quot;         &quot;correlations variables - dimensions&quot;</span></span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a><span class="co">#&gt; 5  &quot;$var$cos2&quot;        &quot;cos2 for the variables&quot;             </span></span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a><span class="co">#&gt; 6  &quot;$var$contrib&quot;     &quot;contributions of the variables&quot;     </span></span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a><span class="co">#&gt; 7  &quot;$ind&quot;             &quot;results for the individuals&quot;        </span></span>
<span id="cb79-18"><a href="#cb79-18" tabindex="-1"></a><span class="co">#&gt; 8  &quot;$ind$coord&quot;       &quot;coord. for the individuals&quot;         </span></span>
<span id="cb79-19"><a href="#cb79-19" tabindex="-1"></a><span class="co">#&gt; 9  &quot;$ind$cos2&quot;        &quot;cos2 for the individuals&quot;           </span></span>
<span id="cb79-20"><a href="#cb79-20" tabindex="-1"></a><span class="co">#&gt; 10 &quot;$ind$contrib&quot;     &quot;contributions of the individuals&quot;   </span></span>
<span id="cb79-21"><a href="#cb79-21" tabindex="-1"></a><span class="co">#&gt; 11 &quot;$call&quot;            &quot;summary statistics&quot;                 </span></span>
<span id="cb79-22"><a href="#cb79-22" tabindex="-1"></a><span class="co">#&gt; 12 &quot;$call$centre&quot;     &quot;mean of the variables&quot;              </span></span>
<span id="cb79-23"><a href="#cb79-23" tabindex="-1"></a><span class="co">#&gt; 13 &quot;$call$ecart.type&quot; &quot;standard error of the variables&quot;    </span></span>
<span id="cb79-24"><a href="#cb79-24" tabindex="-1"></a><span class="co">#&gt; 14 &quot;$call$row.w&quot;      &quot;weights for the individuals&quot;        </span></span>
<span id="cb79-25"><a href="#cb79-25" tabindex="-1"></a><span class="co">#&gt; 15 &quot;$call$col.w&quot;      &quot;weights for the variables&quot;</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. How many principal components were created?
2. Why is this number equal to the number of variables (or n-1)?</p>
</div>
<div id="exercise-1.4-examine-eigenvalues" class="section level3" number="11.2.4">
<h3><span class="header-section-number">11.2.4</span> Exercise 1.4: Examine Eigenvalues</h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co"># Get eigenvalues</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> <span class="fu">get_eigenvalue</span>(res.pca.wine)</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>eigenvalues</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a><span class="co">#&gt;        eigenvalue variance.percent</span></span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a><span class="co">#&gt; Dim.1  5.53588574       39.5420410</span></span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a><span class="co">#&gt; Dim.2  2.49713353       17.8366681</span></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a><span class="co">#&gt; Dim.3  1.44606409       10.3290292</span></span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a><span class="co">#&gt; Dim.4  0.92800966        6.6286404</span></span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a><span class="co">#&gt; Dim.5  0.87749595        6.2678282</span></span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a><span class="co">#&gt; Dim.6  0.67277837        4.8055598</span></span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a><span class="co">#&gt; Dim.7  0.55380907        3.9557791</span></span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a><span class="co">#&gt; Dim.8  0.35009358        2.5006684</span></span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a><span class="co">#&gt; Dim.9  0.29448553        2.1034681</span></span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a><span class="co">#&gt; Dim.10 0.26225251        1.8732322</span></span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a><span class="co">#&gt; Dim.11 0.22584552        1.6131823</span></span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a><span class="co">#&gt; Dim.12 0.16877391        1.2055279</span></span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a><span class="co">#&gt; Dim.13 0.12956002        0.9254287</span></span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a><span class="co">#&gt; Dim.14 0.05781251        0.4129465</span></span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a><span class="co">#&gt;        cumulative.variance.percent</span></span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a><span class="co">#&gt; Dim.1                     39.54204</span></span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a><span class="co">#&gt; Dim.2                     57.37871</span></span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a><span class="co">#&gt; Dim.3                     67.70774</span></span>
<span id="cb80-23"><a href="#cb80-23" tabindex="-1"></a><span class="co">#&gt; Dim.4                     74.33638</span></span>
<span id="cb80-24"><a href="#cb80-24" tabindex="-1"></a><span class="co">#&gt; Dim.5                     80.60421</span></span>
<span id="cb80-25"><a href="#cb80-25" tabindex="-1"></a><span class="co">#&gt; Dim.6                     85.40977</span></span>
<span id="cb80-26"><a href="#cb80-26" tabindex="-1"></a><span class="co">#&gt; Dim.7                     89.36555</span></span>
<span id="cb80-27"><a href="#cb80-27" tabindex="-1"></a><span class="co">#&gt; Dim.8                     91.86621</span></span>
<span id="cb80-28"><a href="#cb80-28" tabindex="-1"></a><span class="co">#&gt; Dim.9                     93.96968</span></span>
<span id="cb80-29"><a href="#cb80-29" tabindex="-1"></a><span class="co">#&gt; Dim.10                    95.84291</span></span>
<span id="cb80-30"><a href="#cb80-30" tabindex="-1"></a><span class="co">#&gt; Dim.11                    97.45610</span></span>
<span id="cb80-31"><a href="#cb80-31" tabindex="-1"></a><span class="co">#&gt; Dim.12                    98.66162</span></span>
<span id="cb80-32"><a href="#cb80-32" tabindex="-1"></a><span class="co">#&gt; Dim.13                    99.58705</span></span>
<span id="cb80-33"><a href="#cb80-33" tabindex="-1"></a><span class="co">#&gt; Dim.14                   100.00000</span></span>
<span id="cb80-34"><a href="#cb80-34" tabindex="-1"></a></span>
<span id="cb80-35"><a href="#cb80-35" tabindex="-1"></a><span class="co"># Alternative way</span></span>
<span id="cb80-36"><a href="#cb80-36" tabindex="-1"></a>res.pca.wine<span class="sc">$</span>eig</span>
<span id="cb80-37"><a href="#cb80-37" tabindex="-1"></a><span class="co">#&gt;         eigenvalue percentage of variance</span></span>
<span id="cb80-38"><a href="#cb80-38" tabindex="-1"></a><span class="co">#&gt; comp 1  5.53588574             39.5420410</span></span>
<span id="cb80-39"><a href="#cb80-39" tabindex="-1"></a><span class="co">#&gt; comp 2  2.49713353             17.8366681</span></span>
<span id="cb80-40"><a href="#cb80-40" tabindex="-1"></a><span class="co">#&gt; comp 3  1.44606409             10.3290292</span></span>
<span id="cb80-41"><a href="#cb80-41" tabindex="-1"></a><span class="co">#&gt; comp 4  0.92800966              6.6286404</span></span>
<span id="cb80-42"><a href="#cb80-42" tabindex="-1"></a><span class="co">#&gt; comp 5  0.87749595              6.2678282</span></span>
<span id="cb80-43"><a href="#cb80-43" tabindex="-1"></a><span class="co">#&gt; comp 6  0.67277837              4.8055598</span></span>
<span id="cb80-44"><a href="#cb80-44" tabindex="-1"></a><span class="co">#&gt; comp 7  0.55380907              3.9557791</span></span>
<span id="cb80-45"><a href="#cb80-45" tabindex="-1"></a><span class="co">#&gt; comp 8  0.35009358              2.5006684</span></span>
<span id="cb80-46"><a href="#cb80-46" tabindex="-1"></a><span class="co">#&gt; comp 9  0.29448553              2.1034681</span></span>
<span id="cb80-47"><a href="#cb80-47" tabindex="-1"></a><span class="co">#&gt; comp 10 0.26225251              1.8732322</span></span>
<span id="cb80-48"><a href="#cb80-48" tabindex="-1"></a><span class="co">#&gt; comp 11 0.22584552              1.6131823</span></span>
<span id="cb80-49"><a href="#cb80-49" tabindex="-1"></a><span class="co">#&gt; comp 12 0.16877391              1.2055279</span></span>
<span id="cb80-50"><a href="#cb80-50" tabindex="-1"></a><span class="co">#&gt; comp 13 0.12956002              0.9254287</span></span>
<span id="cb80-51"><a href="#cb80-51" tabindex="-1"></a><span class="co">#&gt; comp 14 0.05781251              0.4129465</span></span>
<span id="cb80-52"><a href="#cb80-52" tabindex="-1"></a><span class="co">#&gt;         cumulative percentage of variance</span></span>
<span id="cb80-53"><a href="#cb80-53" tabindex="-1"></a><span class="co">#&gt; comp 1                           39.54204</span></span>
<span id="cb80-54"><a href="#cb80-54" tabindex="-1"></a><span class="co">#&gt; comp 2                           57.37871</span></span>
<span id="cb80-55"><a href="#cb80-55" tabindex="-1"></a><span class="co">#&gt; comp 3                           67.70774</span></span>
<span id="cb80-56"><a href="#cb80-56" tabindex="-1"></a><span class="co">#&gt; comp 4                           74.33638</span></span>
<span id="cb80-57"><a href="#cb80-57" tabindex="-1"></a><span class="co">#&gt; comp 5                           80.60421</span></span>
<span id="cb80-58"><a href="#cb80-58" tabindex="-1"></a><span class="co">#&gt; comp 6                           85.40977</span></span>
<span id="cb80-59"><a href="#cb80-59" tabindex="-1"></a><span class="co">#&gt; comp 7                           89.36555</span></span>
<span id="cb80-60"><a href="#cb80-60" tabindex="-1"></a><span class="co">#&gt; comp 8                           91.86621</span></span>
<span id="cb80-61"><a href="#cb80-61" tabindex="-1"></a><span class="co">#&gt; comp 9                           93.96968</span></span>
<span id="cb80-62"><a href="#cb80-62" tabindex="-1"></a><span class="co">#&gt; comp 10                          95.84291</span></span>
<span id="cb80-63"><a href="#cb80-63" tabindex="-1"></a><span class="co">#&gt; comp 11                          97.45610</span></span>
<span id="cb80-64"><a href="#cb80-64" tabindex="-1"></a><span class="co">#&gt; comp 12                          98.66162</span></span>
<span id="cb80-65"><a href="#cb80-65" tabindex="-1"></a><span class="co">#&gt; comp 13                          99.58705</span></span>
<span id="cb80-66"><a href="#cb80-66" tabindex="-1"></a><span class="co">#&gt; comp 14                         100.00000</span></span>
<span id="cb80-67"><a href="#cb80-67" tabindex="-1"></a></span>
<span id="cb80-68"><a href="#cb80-68" tabindex="-1"></a><span class="co"># Plot scree plot</span></span>
<span id="cb80-69"><a href="#cb80-69" tabindex="-1"></a><span class="fu">fviz_eig</span>(res.pca.wine, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>))</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex1-4-eigenvalues-1.png" width="100%" /></p>
<p><strong>Questions:</strong>
1. What is the total inertia? What does it represent?
2. How much variance is explained by the first principal component?
3. How many components would you retain based on:
- Kaiser‚Äôs criterion (eigenvalue &gt; 1)?
- The scree plot (elbow method)?
- Cumulative variance &gt; 80%?</p>
</div>
<div id="exercise-1.5-analyze-variables" class="section level3" number="11.2.5">
<h3><span class="header-section-number">11.2.5</span> Exercise 1.5: Analyze Variables</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="co"># Variable information</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>res.pca.wine<span class="sc">$</span>var</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="co">#&gt; $coord</span></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a><span class="co">#&gt;                        Dim.1        Dim.2        Dim.3</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a><span class="co">#&gt; Class           -0.926254970  0.008995743  0.001455532</span></span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.320745006  0.765081878 -0.249423714</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a><span class="co">#&gt; Malic           -0.523938968  0.353343308  0.106768927</span></span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a><span class="co">#&gt; Ash              0.005303332  0.499123855  0.752893873</span></span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a><span class="co">#&gt; Alcalinity      -0.527745510 -0.018353364  0.735934715</span></span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a><span class="co">#&gt; Magnesium        0.293243046  0.474914593  0.157519754</span></span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a><span class="co">#&gt; Phenols          0.845280435  0.106103229  0.176179003</span></span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.919283947 -0.002053931  0.181545346</span></span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.628222111  0.042643790  0.204378005</span></span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.656597046  0.065150511  0.180252480</span></span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a><span class="co">#&gt; Intensity       -0.210165463  0.837179737 -0.165085135</span></span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a><span class="co">#&gt; Hue              0.651277342 -0.439230962  0.102553090</span></span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a><span class="co">#&gt; OD280            0.824731333 -0.257193550  0.199875561</span></span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a><span class="co">#&gt; Proline          0.634141134  0.578427201 -0.152345199</span></span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a><span class="co">#&gt;                       Dim.4       Dim.5</span></span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a><span class="co">#&gt; Class            0.11784862 -0.14774871</span></span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a><span class="co">#&gt; Alcohol         -0.07872296  0.23506271</span></span>
<span id="cb81-22"><a href="#cb81-22" tabindex="-1"></a><span class="co">#&gt; Malic            0.45274250  0.17621343</span></span>
<span id="cb81-23"><a href="#cb81-23" tabindex="-1"></a><span class="co">#&gt; Ash             -0.24061340  0.08784040</span></span>
<span id="cb81-24"><a href="#cb81-24" tabindex="-1"></a><span class="co">#&gt; Alcalinity       0.06927337 -0.04367510</span></span>
<span id="cb81-25"><a href="#cb81-25" tabindex="-1"></a><span class="co">#&gt; Magnesium       -0.15789854 -0.72897375</span></span>
<span id="cb81-26"><a href="#cb81-26" tabindex="-1"></a><span class="co">#&gt; Phenols          0.18416119  0.13536468</span></span>
<span id="cb81-27"><a href="#cb81-27" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.13942393  0.10481942</span></span>
<span id="cb81-28"><a href="#cb81-28" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.31562431  0.40549009</span></span>
<span id="cb81-29"><a href="#cb81-29" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.44562282 -0.08620346</span></span>
<span id="cb81-30"><a href="#cb81-30" tabindex="-1"></a><span class="co">#&gt; Intensity        0.06949662  0.04324534</span></span>
<span id="cb81-31"><a href="#cb81-31" tabindex="-1"></a><span class="co">#&gt; Hue             -0.41878540  0.02822330</span></span>
<span id="cb81-32"><a href="#cb81-32" tabindex="-1"></a><span class="co">#&gt; OD280            0.15113759  0.13497146</span></span>
<span id="cb81-33"><a href="#cb81-33" tabindex="-1"></a><span class="co">#&gt; Proline         -0.24640695  0.07928732</span></span>
<span id="cb81-34"><a href="#cb81-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb81-35"><a href="#cb81-35" tabindex="-1"></a><span class="co">#&gt; $cor</span></span>
<span id="cb81-36"><a href="#cb81-36" tabindex="-1"></a><span class="co">#&gt;                        Dim.1        Dim.2        Dim.3</span></span>
<span id="cb81-37"><a href="#cb81-37" tabindex="-1"></a><span class="co">#&gt; Class           -0.926254970  0.008995743  0.001455532</span></span>
<span id="cb81-38"><a href="#cb81-38" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.320745006  0.765081878 -0.249423714</span></span>
<span id="cb81-39"><a href="#cb81-39" tabindex="-1"></a><span class="co">#&gt; Malic           -0.523938968  0.353343308  0.106768927</span></span>
<span id="cb81-40"><a href="#cb81-40" tabindex="-1"></a><span class="co">#&gt; Ash              0.005303332  0.499123855  0.752893873</span></span>
<span id="cb81-41"><a href="#cb81-41" tabindex="-1"></a><span class="co">#&gt; Alcalinity      -0.527745510 -0.018353364  0.735934715</span></span>
<span id="cb81-42"><a href="#cb81-42" tabindex="-1"></a><span class="co">#&gt; Magnesium        0.293243046  0.474914593  0.157519754</span></span>
<span id="cb81-43"><a href="#cb81-43" tabindex="-1"></a><span class="co">#&gt; Phenols          0.845280435  0.106103229  0.176179003</span></span>
<span id="cb81-44"><a href="#cb81-44" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.919283947 -0.002053931  0.181545346</span></span>
<span id="cb81-45"><a href="#cb81-45" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.628222111  0.042643790  0.204378005</span></span>
<span id="cb81-46"><a href="#cb81-46" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.656597046  0.065150511  0.180252480</span></span>
<span id="cb81-47"><a href="#cb81-47" tabindex="-1"></a><span class="co">#&gt; Intensity       -0.210165463  0.837179737 -0.165085135</span></span>
<span id="cb81-48"><a href="#cb81-48" tabindex="-1"></a><span class="co">#&gt; Hue              0.651277342 -0.439230962  0.102553090</span></span>
<span id="cb81-49"><a href="#cb81-49" tabindex="-1"></a><span class="co">#&gt; OD280            0.824731333 -0.257193550  0.199875561</span></span>
<span id="cb81-50"><a href="#cb81-50" tabindex="-1"></a><span class="co">#&gt; Proline          0.634141134  0.578427201 -0.152345199</span></span>
<span id="cb81-51"><a href="#cb81-51" tabindex="-1"></a><span class="co">#&gt;                       Dim.4       Dim.5</span></span>
<span id="cb81-52"><a href="#cb81-52" tabindex="-1"></a><span class="co">#&gt; Class            0.11784862 -0.14774871</span></span>
<span id="cb81-53"><a href="#cb81-53" tabindex="-1"></a><span class="co">#&gt; Alcohol         -0.07872296  0.23506271</span></span>
<span id="cb81-54"><a href="#cb81-54" tabindex="-1"></a><span class="co">#&gt; Malic            0.45274250  0.17621343</span></span>
<span id="cb81-55"><a href="#cb81-55" tabindex="-1"></a><span class="co">#&gt; Ash             -0.24061340  0.08784040</span></span>
<span id="cb81-56"><a href="#cb81-56" tabindex="-1"></a><span class="co">#&gt; Alcalinity       0.06927337 -0.04367510</span></span>
<span id="cb81-57"><a href="#cb81-57" tabindex="-1"></a><span class="co">#&gt; Magnesium       -0.15789854 -0.72897375</span></span>
<span id="cb81-58"><a href="#cb81-58" tabindex="-1"></a><span class="co">#&gt; Phenols          0.18416119  0.13536468</span></span>
<span id="cb81-59"><a href="#cb81-59" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.13942393  0.10481942</span></span>
<span id="cb81-60"><a href="#cb81-60" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.31562431  0.40549009</span></span>
<span id="cb81-61"><a href="#cb81-61" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.44562282 -0.08620346</span></span>
<span id="cb81-62"><a href="#cb81-62" tabindex="-1"></a><span class="co">#&gt; Intensity        0.06949662  0.04324534</span></span>
<span id="cb81-63"><a href="#cb81-63" tabindex="-1"></a><span class="co">#&gt; Hue             -0.41878540  0.02822330</span></span>
<span id="cb81-64"><a href="#cb81-64" tabindex="-1"></a><span class="co">#&gt; OD280            0.15113759  0.13497146</span></span>
<span id="cb81-65"><a href="#cb81-65" tabindex="-1"></a><span class="co">#&gt; Proline         -0.24640695  0.07928732</span></span>
<span id="cb81-66"><a href="#cb81-66" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb81-67"><a href="#cb81-67" tabindex="-1"></a><span class="co">#&gt; $cos2</span></span>
<span id="cb81-68"><a href="#cb81-68" tabindex="-1"></a><span class="co">#&gt;                         Dim.1          Dim.2          Dim.3</span></span>
<span id="cb81-69"><a href="#cb81-69" tabindex="-1"></a><span class="co">#&gt; Class           0.85794827007 0.000080923388 0.000002118574</span></span>
<span id="cb81-70"><a href="#cb81-70" tabindex="-1"></a><span class="co">#&gt; Alcohol         0.10287735901 0.585350279703 0.062212189281</span></span>
<span id="cb81-71"><a href="#cb81-71" tabindex="-1"></a><span class="co">#&gt; Malic           0.27451204195 0.124851492966 0.011399603795</span></span>
<span id="cb81-72"><a href="#cb81-72" tabindex="-1"></a><span class="co">#&gt; Ash             0.00002812534 0.249124623086 0.566849183514</span></span>
<span id="cb81-73"><a href="#cb81-73" tabindex="-1"></a><span class="co">#&gt; Alcalinity      0.27851532381 0.000336845964 0.541599904721</span></span>
<span id="cb81-74"><a href="#cb81-74" tabindex="-1"></a><span class="co">#&gt; Magnesium       0.08599148401 0.225543870497 0.024812473034</span></span>
<span id="cb81-75"><a href="#cb81-75" tabindex="-1"></a><span class="co">#&gt; Phenols         0.71449901365 0.011257895239 0.031039041140</span></span>
<span id="cb81-76"><a href="#cb81-76" tabindex="-1"></a><span class="co">#&gt; Flavanoids      0.84508297442 0.000004218634 0.032958712515</span></span>
<span id="cb81-77"><a href="#cb81-77" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    0.39466302098 0.001818492852 0.041770369089</span></span>
<span id="cb81-78"><a href="#cb81-78" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins 0.43111968072 0.004244589103 0.032490956713</span></span>
<span id="cb81-79"><a href="#cb81-79" tabindex="-1"></a><span class="co">#&gt; Intensity       0.04416952174 0.700869911687 0.027253101873</span></span>
<span id="cb81-80"><a href="#cb81-80" tabindex="-1"></a><span class="co">#&gt; Hue             0.42416217601 0.192923838123 0.010517136189</span></span>
<span id="cb81-81"><a href="#cb81-81" tabindex="-1"></a><span class="co">#&gt; OD280           0.68018177233 0.066148521925 0.039950240054</span></span>
<span id="cb81-82"><a href="#cb81-82" tabindex="-1"></a><span class="co">#&gt; Proline         0.40213497811 0.334578026779 0.023209059516</span></span>
<span id="cb81-83"><a href="#cb81-83" tabindex="-1"></a><span class="co">#&gt;                       Dim.4        Dim.5</span></span>
<span id="cb81-84"><a href="#cb81-84" tabindex="-1"></a><span class="co">#&gt; Class           0.013888297 0.0218296819</span></span>
<span id="cb81-85"><a href="#cb81-85" tabindex="-1"></a><span class="co">#&gt; Alcohol         0.006197305 0.0552544793</span></span>
<span id="cb81-86"><a href="#cb81-86" tabindex="-1"></a><span class="co">#&gt; Malic           0.204975773 0.0310511715</span></span>
<span id="cb81-87"><a href="#cb81-87" tabindex="-1"></a><span class="co">#&gt; Ash             0.057894807 0.0077159357</span></span>
<span id="cb81-88"><a href="#cb81-88" tabindex="-1"></a><span class="co">#&gt; Alcalinity      0.004798799 0.0019075141</span></span>
<span id="cb81-89"><a href="#cb81-89" tabindex="-1"></a><span class="co">#&gt; Magnesium       0.024931950 0.5314027288</span></span>
<span id="cb81-90"><a href="#cb81-90" tabindex="-1"></a><span class="co">#&gt; Phenols         0.033915344 0.0183235956</span></span>
<span id="cb81-91"><a href="#cb81-91" tabindex="-1"></a><span class="co">#&gt; Flavanoids      0.019439032 0.0109871115</span></span>
<span id="cb81-92"><a href="#cb81-92" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    0.099618708 0.1644222095</span></span>
<span id="cb81-93"><a href="#cb81-93" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins 0.198579697 0.0074310367</span></span>
<span id="cb81-94"><a href="#cb81-94" tabindex="-1"></a><span class="co">#&gt; Intensity       0.004829780 0.0018701596</span></span>
<span id="cb81-95"><a href="#cb81-95" tabindex="-1"></a><span class="co">#&gt; Hue             0.175381215 0.0007965545</span></span>
<span id="cb81-96"><a href="#cb81-96" tabindex="-1"></a><span class="co">#&gt; OD280           0.022842570 0.0182172962</span></span>
<span id="cb81-97"><a href="#cb81-97" tabindex="-1"></a><span class="co">#&gt; Proline         0.060716384 0.0062864784</span></span>
<span id="cb81-98"><a href="#cb81-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb81-99"><a href="#cb81-99" tabindex="-1"></a><span class="co">#&gt; $contrib</span></span>
<span id="cb81-100"><a href="#cb81-100" tabindex="-1"></a><span class="co">#&gt;                         Dim.1         Dim.2         Dim.3</span></span>
<span id="cb81-101"><a href="#cb81-101" tabindex="-1"></a><span class="co">#&gt; Class           15.4979403483  0.0032406512  0.0001465063</span></span>
<span id="cb81-102"><a href="#cb81-102" tabindex="-1"></a><span class="co">#&gt; Alcohol          1.8583721522 23.4408882298  4.3021737218</span></span>
<span id="cb81-103"><a href="#cb81-103" tabindex="-1"></a><span class="co">#&gt; Malic            4.9587736225  4.9997924207  0.7883194025</span></span>
<span id="cb81-104"><a href="#cb81-104" tabindex="-1"></a><span class="co">#&gt; Ash              0.0005080548  9.9764237714 39.1994509394</span></span>
<span id="cb81-105"><a href="#cb81-105" tabindex="-1"></a><span class="co">#&gt; Alcalinity       5.0310887324  0.0134893053 37.4533818012</span></span>
<span id="cb81-106"><a href="#cb81-106" tabindex="-1"></a><span class="co">#&gt; Magnesium        1.5533464384  9.0321109301  1.7158626098</span></span>
<span id="cb81-107"><a href="#cb81-107" tabindex="-1"></a><span class="co">#&gt; Phenols         12.9066792006  0.4508327290  2.1464498949</span></span>
<span id="cb81-108"><a href="#cb81-108" tabindex="-1"></a><span class="co">#&gt; Flavanoids      15.2655422056  0.0001689391  2.2792013675</span></span>
<span id="cb81-109"><a href="#cb81-109" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid     7.1291756977  0.0728232123  2.8885558654</span></span>
<span id="cb81-110"><a href="#cb81-110" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  7.7877272185  0.1699784594  2.2468545438</span></span>
<span id="cb81-111"><a href="#cb81-111" tabindex="-1"></a><span class="co">#&gt; Intensity        0.7978763254 28.0669777279  1.8846399728</span></span>
<span id="cb81-112"><a href="#cb81-112" tabindex="-1"></a><span class="co">#&gt; Hue              7.6620471550  7.7258118482  0.7272939188</span></span>
<span id="cb81-113"><a href="#cb81-113" tabindex="-1"></a><span class="co">#&gt; OD280           12.2867740414  2.6489781636  2.7626880669</span></span>
<span id="cb81-114"><a href="#cb81-114" tabindex="-1"></a><span class="co">#&gt; Proline          7.2641488073 13.3984836120  1.6049813889</span></span>
<span id="cb81-115"><a href="#cb81-115" tabindex="-1"></a><span class="co">#&gt;                      Dim.4       Dim.5</span></span>
<span id="cb81-116"><a href="#cb81-116" tabindex="-1"></a><span class="co">#&gt; Class            1.4965681  2.48772450</span></span>
<span id="cb81-117"><a href="#cb81-117" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.6678061  6.29683580</span></span>
<span id="cb81-118"><a href="#cb81-118" tabindex="-1"></a><span class="co">#&gt; Malic           22.0876767  3.53861136</span></span>
<span id="cb81-119"><a href="#cb81-119" tabindex="-1"></a><span class="co">#&gt; Ash              6.2385996  0.87931297</span></span>
<span id="cb81-120"><a href="#cb81-120" tabindex="-1"></a><span class="co">#&gt; Alcalinity       0.5171066  0.21738153</span></span>
<span id="cb81-121"><a href="#cb81-121" tabindex="-1"></a><span class="co">#&gt; Magnesium        2.6866046 60.55899480</span></span>
<span id="cb81-122"><a href="#cb81-122" tabindex="-1"></a><span class="co">#&gt; Phenols          3.6546326  2.08816867</span></span>
<span id="cb81-123"><a href="#cb81-123" tabindex="-1"></a><span class="co">#&gt; Flavanoids       2.0947014  1.25209826</span></span>
<span id="cb81-124"><a href="#cb81-124" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    10.7346628 18.73766015</span></span>
<span id="cb81-125"><a href="#cb81-125" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins 21.3984515  0.84684570</span></span>
<span id="cb81-126"><a href="#cb81-126" tabindex="-1"></a><span class="co">#&gt; Intensity        0.5204450  0.21312459</span></span>
<span id="cb81-127"><a href="#cb81-127" tabindex="-1"></a><span class="co">#&gt; Hue             18.8986411  0.09077586</span></span>
<span id="cb81-128"><a href="#cb81-128" tabindex="-1"></a><span class="co">#&gt; OD280            2.4614582  2.07605472</span></span>
<span id="cb81-129"><a href="#cb81-129" tabindex="-1"></a><span class="co">#&gt; Proline          6.5426457  0.71641110</span></span>
<span id="cb81-130"><a href="#cb81-130" tabindex="-1"></a></span>
<span id="cb81-131"><a href="#cb81-131" tabindex="-1"></a><span class="co"># Correlations between variables and components</span></span>
<span id="cb81-132"><a href="#cb81-132" tabindex="-1"></a>res.pca.wine<span class="sc">$</span>var<span class="sc">$</span>cor</span>
<span id="cb81-133"><a href="#cb81-133" tabindex="-1"></a><span class="co">#&gt;                        Dim.1        Dim.2        Dim.3</span></span>
<span id="cb81-134"><a href="#cb81-134" tabindex="-1"></a><span class="co">#&gt; Class           -0.926254970  0.008995743  0.001455532</span></span>
<span id="cb81-135"><a href="#cb81-135" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.320745006  0.765081878 -0.249423714</span></span>
<span id="cb81-136"><a href="#cb81-136" tabindex="-1"></a><span class="co">#&gt; Malic           -0.523938968  0.353343308  0.106768927</span></span>
<span id="cb81-137"><a href="#cb81-137" tabindex="-1"></a><span class="co">#&gt; Ash              0.005303332  0.499123855  0.752893873</span></span>
<span id="cb81-138"><a href="#cb81-138" tabindex="-1"></a><span class="co">#&gt; Alcalinity      -0.527745510 -0.018353364  0.735934715</span></span>
<span id="cb81-139"><a href="#cb81-139" tabindex="-1"></a><span class="co">#&gt; Magnesium        0.293243046  0.474914593  0.157519754</span></span>
<span id="cb81-140"><a href="#cb81-140" tabindex="-1"></a><span class="co">#&gt; Phenols          0.845280435  0.106103229  0.176179003</span></span>
<span id="cb81-141"><a href="#cb81-141" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.919283947 -0.002053931  0.181545346</span></span>
<span id="cb81-142"><a href="#cb81-142" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.628222111  0.042643790  0.204378005</span></span>
<span id="cb81-143"><a href="#cb81-143" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.656597046  0.065150511  0.180252480</span></span>
<span id="cb81-144"><a href="#cb81-144" tabindex="-1"></a><span class="co">#&gt; Intensity       -0.210165463  0.837179737 -0.165085135</span></span>
<span id="cb81-145"><a href="#cb81-145" tabindex="-1"></a><span class="co">#&gt; Hue              0.651277342 -0.439230962  0.102553090</span></span>
<span id="cb81-146"><a href="#cb81-146" tabindex="-1"></a><span class="co">#&gt; OD280            0.824731333 -0.257193550  0.199875561</span></span>
<span id="cb81-147"><a href="#cb81-147" tabindex="-1"></a><span class="co">#&gt; Proline          0.634141134  0.578427201 -0.152345199</span></span>
<span id="cb81-148"><a href="#cb81-148" tabindex="-1"></a><span class="co">#&gt;                       Dim.4       Dim.5</span></span>
<span id="cb81-149"><a href="#cb81-149" tabindex="-1"></a><span class="co">#&gt; Class            0.11784862 -0.14774871</span></span>
<span id="cb81-150"><a href="#cb81-150" tabindex="-1"></a><span class="co">#&gt; Alcohol         -0.07872296  0.23506271</span></span>
<span id="cb81-151"><a href="#cb81-151" tabindex="-1"></a><span class="co">#&gt; Malic            0.45274250  0.17621343</span></span>
<span id="cb81-152"><a href="#cb81-152" tabindex="-1"></a><span class="co">#&gt; Ash             -0.24061340  0.08784040</span></span>
<span id="cb81-153"><a href="#cb81-153" tabindex="-1"></a><span class="co">#&gt; Alcalinity       0.06927337 -0.04367510</span></span>
<span id="cb81-154"><a href="#cb81-154" tabindex="-1"></a><span class="co">#&gt; Magnesium       -0.15789854 -0.72897375</span></span>
<span id="cb81-155"><a href="#cb81-155" tabindex="-1"></a><span class="co">#&gt; Phenols          0.18416119  0.13536468</span></span>
<span id="cb81-156"><a href="#cb81-156" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.13942393  0.10481942</span></span>
<span id="cb81-157"><a href="#cb81-157" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.31562431  0.40549009</span></span>
<span id="cb81-158"><a href="#cb81-158" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.44562282 -0.08620346</span></span>
<span id="cb81-159"><a href="#cb81-159" tabindex="-1"></a><span class="co">#&gt; Intensity        0.06949662  0.04324534</span></span>
<span id="cb81-160"><a href="#cb81-160" tabindex="-1"></a><span class="co">#&gt; Hue             -0.41878540  0.02822330</span></span>
<span id="cb81-161"><a href="#cb81-161" tabindex="-1"></a><span class="co">#&gt; OD280            0.15113759  0.13497146</span></span>
<span id="cb81-162"><a href="#cb81-162" tabindex="-1"></a><span class="co">#&gt; Proline         -0.24640695  0.07928732</span></span>
<span id="cb81-163"><a href="#cb81-163" tabindex="-1"></a></span>
<span id="cb81-164"><a href="#cb81-164" tabindex="-1"></a><span class="co"># Coordinates of variables</span></span>
<span id="cb81-165"><a href="#cb81-165" tabindex="-1"></a>res.pca.wine<span class="sc">$</span>var<span class="sc">$</span>coord</span>
<span id="cb81-166"><a href="#cb81-166" tabindex="-1"></a><span class="co">#&gt;                        Dim.1        Dim.2        Dim.3</span></span>
<span id="cb81-167"><a href="#cb81-167" tabindex="-1"></a><span class="co">#&gt; Class           -0.926254970  0.008995743  0.001455532</span></span>
<span id="cb81-168"><a href="#cb81-168" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.320745006  0.765081878 -0.249423714</span></span>
<span id="cb81-169"><a href="#cb81-169" tabindex="-1"></a><span class="co">#&gt; Malic           -0.523938968  0.353343308  0.106768927</span></span>
<span id="cb81-170"><a href="#cb81-170" tabindex="-1"></a><span class="co">#&gt; Ash              0.005303332  0.499123855  0.752893873</span></span>
<span id="cb81-171"><a href="#cb81-171" tabindex="-1"></a><span class="co">#&gt; Alcalinity      -0.527745510 -0.018353364  0.735934715</span></span>
<span id="cb81-172"><a href="#cb81-172" tabindex="-1"></a><span class="co">#&gt; Magnesium        0.293243046  0.474914593  0.157519754</span></span>
<span id="cb81-173"><a href="#cb81-173" tabindex="-1"></a><span class="co">#&gt; Phenols          0.845280435  0.106103229  0.176179003</span></span>
<span id="cb81-174"><a href="#cb81-174" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.919283947 -0.002053931  0.181545346</span></span>
<span id="cb81-175"><a href="#cb81-175" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.628222111  0.042643790  0.204378005</span></span>
<span id="cb81-176"><a href="#cb81-176" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.656597046  0.065150511  0.180252480</span></span>
<span id="cb81-177"><a href="#cb81-177" tabindex="-1"></a><span class="co">#&gt; Intensity       -0.210165463  0.837179737 -0.165085135</span></span>
<span id="cb81-178"><a href="#cb81-178" tabindex="-1"></a><span class="co">#&gt; Hue              0.651277342 -0.439230962  0.102553090</span></span>
<span id="cb81-179"><a href="#cb81-179" tabindex="-1"></a><span class="co">#&gt; OD280            0.824731333 -0.257193550  0.199875561</span></span>
<span id="cb81-180"><a href="#cb81-180" tabindex="-1"></a><span class="co">#&gt; Proline          0.634141134  0.578427201 -0.152345199</span></span>
<span id="cb81-181"><a href="#cb81-181" tabindex="-1"></a><span class="co">#&gt;                       Dim.4       Dim.5</span></span>
<span id="cb81-182"><a href="#cb81-182" tabindex="-1"></a><span class="co">#&gt; Class            0.11784862 -0.14774871</span></span>
<span id="cb81-183"><a href="#cb81-183" tabindex="-1"></a><span class="co">#&gt; Alcohol         -0.07872296  0.23506271</span></span>
<span id="cb81-184"><a href="#cb81-184" tabindex="-1"></a><span class="co">#&gt; Malic            0.45274250  0.17621343</span></span>
<span id="cb81-185"><a href="#cb81-185" tabindex="-1"></a><span class="co">#&gt; Ash             -0.24061340  0.08784040</span></span>
<span id="cb81-186"><a href="#cb81-186" tabindex="-1"></a><span class="co">#&gt; Alcalinity       0.06927337 -0.04367510</span></span>
<span id="cb81-187"><a href="#cb81-187" tabindex="-1"></a><span class="co">#&gt; Magnesium       -0.15789854 -0.72897375</span></span>
<span id="cb81-188"><a href="#cb81-188" tabindex="-1"></a><span class="co">#&gt; Phenols          0.18416119  0.13536468</span></span>
<span id="cb81-189"><a href="#cb81-189" tabindex="-1"></a><span class="co">#&gt; Flavanoids       0.13942393  0.10481942</span></span>
<span id="cb81-190"><a href="#cb81-190" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    -0.31562431  0.40549009</span></span>
<span id="cb81-191"><a href="#cb81-191" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  0.44562282 -0.08620346</span></span>
<span id="cb81-192"><a href="#cb81-192" tabindex="-1"></a><span class="co">#&gt; Intensity        0.06949662  0.04324534</span></span>
<span id="cb81-193"><a href="#cb81-193" tabindex="-1"></a><span class="co">#&gt; Hue             -0.41878540  0.02822330</span></span>
<span id="cb81-194"><a href="#cb81-194" tabindex="-1"></a><span class="co">#&gt; OD280            0.15113759  0.13497146</span></span>
<span id="cb81-195"><a href="#cb81-195" tabindex="-1"></a><span class="co">#&gt; Proline         -0.24640695  0.07928732</span></span>
<span id="cb81-196"><a href="#cb81-196" tabindex="-1"></a></span>
<span id="cb81-197"><a href="#cb81-197" tabindex="-1"></a><span class="co"># Quality of representation (cos¬≤)</span></span>
<span id="cb81-198"><a href="#cb81-198" tabindex="-1"></a>res.pca.wine<span class="sc">$</span>var<span class="sc">$</span>cos2</span>
<span id="cb81-199"><a href="#cb81-199" tabindex="-1"></a><span class="co">#&gt;                         Dim.1          Dim.2          Dim.3</span></span>
<span id="cb81-200"><a href="#cb81-200" tabindex="-1"></a><span class="co">#&gt; Class           0.85794827007 0.000080923388 0.000002118574</span></span>
<span id="cb81-201"><a href="#cb81-201" tabindex="-1"></a><span class="co">#&gt; Alcohol         0.10287735901 0.585350279703 0.062212189281</span></span>
<span id="cb81-202"><a href="#cb81-202" tabindex="-1"></a><span class="co">#&gt; Malic           0.27451204195 0.124851492966 0.011399603795</span></span>
<span id="cb81-203"><a href="#cb81-203" tabindex="-1"></a><span class="co">#&gt; Ash             0.00002812534 0.249124623086 0.566849183514</span></span>
<span id="cb81-204"><a href="#cb81-204" tabindex="-1"></a><span class="co">#&gt; Alcalinity      0.27851532381 0.000336845964 0.541599904721</span></span>
<span id="cb81-205"><a href="#cb81-205" tabindex="-1"></a><span class="co">#&gt; Magnesium       0.08599148401 0.225543870497 0.024812473034</span></span>
<span id="cb81-206"><a href="#cb81-206" tabindex="-1"></a><span class="co">#&gt; Phenols         0.71449901365 0.011257895239 0.031039041140</span></span>
<span id="cb81-207"><a href="#cb81-207" tabindex="-1"></a><span class="co">#&gt; Flavanoids      0.84508297442 0.000004218634 0.032958712515</span></span>
<span id="cb81-208"><a href="#cb81-208" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    0.39466302098 0.001818492852 0.041770369089</span></span>
<span id="cb81-209"><a href="#cb81-209" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins 0.43111968072 0.004244589103 0.032490956713</span></span>
<span id="cb81-210"><a href="#cb81-210" tabindex="-1"></a><span class="co">#&gt; Intensity       0.04416952174 0.700869911687 0.027253101873</span></span>
<span id="cb81-211"><a href="#cb81-211" tabindex="-1"></a><span class="co">#&gt; Hue             0.42416217601 0.192923838123 0.010517136189</span></span>
<span id="cb81-212"><a href="#cb81-212" tabindex="-1"></a><span class="co">#&gt; OD280           0.68018177233 0.066148521925 0.039950240054</span></span>
<span id="cb81-213"><a href="#cb81-213" tabindex="-1"></a><span class="co">#&gt; Proline         0.40213497811 0.334578026779 0.023209059516</span></span>
<span id="cb81-214"><a href="#cb81-214" tabindex="-1"></a><span class="co">#&gt;                       Dim.4        Dim.5</span></span>
<span id="cb81-215"><a href="#cb81-215" tabindex="-1"></a><span class="co">#&gt; Class           0.013888297 0.0218296819</span></span>
<span id="cb81-216"><a href="#cb81-216" tabindex="-1"></a><span class="co">#&gt; Alcohol         0.006197305 0.0552544793</span></span>
<span id="cb81-217"><a href="#cb81-217" tabindex="-1"></a><span class="co">#&gt; Malic           0.204975773 0.0310511715</span></span>
<span id="cb81-218"><a href="#cb81-218" tabindex="-1"></a><span class="co">#&gt; Ash             0.057894807 0.0077159357</span></span>
<span id="cb81-219"><a href="#cb81-219" tabindex="-1"></a><span class="co">#&gt; Alcalinity      0.004798799 0.0019075141</span></span>
<span id="cb81-220"><a href="#cb81-220" tabindex="-1"></a><span class="co">#&gt; Magnesium       0.024931950 0.5314027288</span></span>
<span id="cb81-221"><a href="#cb81-221" tabindex="-1"></a><span class="co">#&gt; Phenols         0.033915344 0.0183235956</span></span>
<span id="cb81-222"><a href="#cb81-222" tabindex="-1"></a><span class="co">#&gt; Flavanoids      0.019439032 0.0109871115</span></span>
<span id="cb81-223"><a href="#cb81-223" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    0.099618708 0.1644222095</span></span>
<span id="cb81-224"><a href="#cb81-224" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins 0.198579697 0.0074310367</span></span>
<span id="cb81-225"><a href="#cb81-225" tabindex="-1"></a><span class="co">#&gt; Intensity       0.004829780 0.0018701596</span></span>
<span id="cb81-226"><a href="#cb81-226" tabindex="-1"></a><span class="co">#&gt; Hue             0.175381215 0.0007965545</span></span>
<span id="cb81-227"><a href="#cb81-227" tabindex="-1"></a><span class="co">#&gt; OD280           0.022842570 0.0182172962</span></span>
<span id="cb81-228"><a href="#cb81-228" tabindex="-1"></a><span class="co">#&gt; Proline         0.060716384 0.0062864784</span></span>
<span id="cb81-229"><a href="#cb81-229" tabindex="-1"></a></span>
<span id="cb81-230"><a href="#cb81-230" tabindex="-1"></a><span class="co"># Contributions</span></span>
<span id="cb81-231"><a href="#cb81-231" tabindex="-1"></a>res.pca.wine<span class="sc">$</span>var<span class="sc">$</span>contrib</span>
<span id="cb81-232"><a href="#cb81-232" tabindex="-1"></a><span class="co">#&gt;                         Dim.1         Dim.2         Dim.3</span></span>
<span id="cb81-233"><a href="#cb81-233" tabindex="-1"></a><span class="co">#&gt; Class           15.4979403483  0.0032406512  0.0001465063</span></span>
<span id="cb81-234"><a href="#cb81-234" tabindex="-1"></a><span class="co">#&gt; Alcohol          1.8583721522 23.4408882298  4.3021737218</span></span>
<span id="cb81-235"><a href="#cb81-235" tabindex="-1"></a><span class="co">#&gt; Malic            4.9587736225  4.9997924207  0.7883194025</span></span>
<span id="cb81-236"><a href="#cb81-236" tabindex="-1"></a><span class="co">#&gt; Ash              0.0005080548  9.9764237714 39.1994509394</span></span>
<span id="cb81-237"><a href="#cb81-237" tabindex="-1"></a><span class="co">#&gt; Alcalinity       5.0310887324  0.0134893053 37.4533818012</span></span>
<span id="cb81-238"><a href="#cb81-238" tabindex="-1"></a><span class="co">#&gt; Magnesium        1.5533464384  9.0321109301  1.7158626098</span></span>
<span id="cb81-239"><a href="#cb81-239" tabindex="-1"></a><span class="co">#&gt; Phenols         12.9066792006  0.4508327290  2.1464498949</span></span>
<span id="cb81-240"><a href="#cb81-240" tabindex="-1"></a><span class="co">#&gt; Flavanoids      15.2655422056  0.0001689391  2.2792013675</span></span>
<span id="cb81-241"><a href="#cb81-241" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid     7.1291756977  0.0728232123  2.8885558654</span></span>
<span id="cb81-242"><a href="#cb81-242" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins  7.7877272185  0.1699784594  2.2468545438</span></span>
<span id="cb81-243"><a href="#cb81-243" tabindex="-1"></a><span class="co">#&gt; Intensity        0.7978763254 28.0669777279  1.8846399728</span></span>
<span id="cb81-244"><a href="#cb81-244" tabindex="-1"></a><span class="co">#&gt; Hue              7.6620471550  7.7258118482  0.7272939188</span></span>
<span id="cb81-245"><a href="#cb81-245" tabindex="-1"></a><span class="co">#&gt; OD280           12.2867740414  2.6489781636  2.7626880669</span></span>
<span id="cb81-246"><a href="#cb81-246" tabindex="-1"></a><span class="co">#&gt; Proline          7.2641488073 13.3984836120  1.6049813889</span></span>
<span id="cb81-247"><a href="#cb81-247" tabindex="-1"></a><span class="co">#&gt;                      Dim.4       Dim.5</span></span>
<span id="cb81-248"><a href="#cb81-248" tabindex="-1"></a><span class="co">#&gt; Class            1.4965681  2.48772450</span></span>
<span id="cb81-249"><a href="#cb81-249" tabindex="-1"></a><span class="co">#&gt; Alcohol          0.6678061  6.29683580</span></span>
<span id="cb81-250"><a href="#cb81-250" tabindex="-1"></a><span class="co">#&gt; Malic           22.0876767  3.53861136</span></span>
<span id="cb81-251"><a href="#cb81-251" tabindex="-1"></a><span class="co">#&gt; Ash              6.2385996  0.87931297</span></span>
<span id="cb81-252"><a href="#cb81-252" tabindex="-1"></a><span class="co">#&gt; Alcalinity       0.5171066  0.21738153</span></span>
<span id="cb81-253"><a href="#cb81-253" tabindex="-1"></a><span class="co">#&gt; Magnesium        2.6866046 60.55899480</span></span>
<span id="cb81-254"><a href="#cb81-254" tabindex="-1"></a><span class="co">#&gt; Phenols          3.6546326  2.08816867</span></span>
<span id="cb81-255"><a href="#cb81-255" tabindex="-1"></a><span class="co">#&gt; Flavanoids       2.0947014  1.25209826</span></span>
<span id="cb81-256"><a href="#cb81-256" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    10.7346628 18.73766015</span></span>
<span id="cb81-257"><a href="#cb81-257" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins 21.3984515  0.84684570</span></span>
<span id="cb81-258"><a href="#cb81-258" tabindex="-1"></a><span class="co">#&gt; Intensity        0.5204450  0.21312459</span></span>
<span id="cb81-259"><a href="#cb81-259" tabindex="-1"></a><span class="co">#&gt; Hue             18.8986411  0.09077586</span></span>
<span id="cb81-260"><a href="#cb81-260" tabindex="-1"></a><span class="co">#&gt; OD280            2.4614582  2.07605472</span></span>
<span id="cb81-261"><a href="#cb81-261" tabindex="-1"></a><span class="co">#&gt; Proline          6.5426457  0.71641110</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. Which variables are most correlated with the first principal component?
2. Which variables contribute most to the first dimension?
3. Which variables are well represented in the first two dimensions (cos¬≤ &gt; 0.5)?</p>
</div>
<div id="exercise-1.6-visualize-variables" class="section level3" number="11.2.6">
<h3><span class="header-section-number">11.2.6</span> Exercise 1.6: Visualize Variables</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co"># Basic variable plot</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.wine, <span class="at">col.var =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex1-6-plot-vars-1.png" width="100%" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="co"># Variables colored by quality of representation</span></span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.wine, <span class="at">col.var =</span> <span class="st">&quot;cos2&quot;</span>,</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex1-6-plot-vars-2.png" width="100%" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a><span class="co"># Variables colored by contributions</span></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.pca.wine, <span class="at">col.var =</span> <span class="st">&quot;contrib&quot;</span>,</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex1-6-plot-vars-3.png" width="100%" /></p>
<p><strong>Questions:</strong>
1. What do the arrows represent in the variable plot?
2. What does the length of an arrow indicate?
3. What does the angle between two arrows tell you about the correlation between variables?</p>
</div>
<div id="exercise-1.7-analyze-individuals" class="section level3" number="11.2.7">
<h3><span class="header-section-number">11.2.7</span> Exercise 1.7: Analyze Individuals</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co"># Individual information</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>res.pca.wine<span class="sc">$</span>ind</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a><span class="co">#&gt; $coord</span></span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a><span class="co">#&gt;            Dim.1       Dim.2        Dim.3           Dim.4</span></span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a><span class="co">#&gt; 1    3.522918024  1.45311867 -0.164772369 -0.013926256309</span></span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a><span class="co">#&gt; 2    2.528847526 -0.32999903 -2.026697043 -0.416667812490</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a><span class="co">#&gt; 3    2.785007148  1.03697906  0.983264785  0.664373920551</span></span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a><span class="co">#&gt; 4    3.922570237  2.76829806 -0.174937730  0.565415182346</span></span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a><span class="co">#&gt; 5    1.407474906  0.86779758  2.025818285 -0.441145568025</span></span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a><span class="co">#&gt; 6    3.288108428  2.13017591 -0.629015963 -0.605056582516</span></span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a><span class="co">#&gt; 7    2.750561100  1.17918568 -0.977347561 -0.352717758232</span></span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a><span class="co">#&gt; 8    2.392844659  1.61125983  0.145704264 -1.245777972022</span></span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a><span class="co">#&gt; 9    2.795235652  0.92319068 -1.770949667 -0.156056378845</span></span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a><span class="co">#&gt; 10   3.005576356  0.79634006 -0.983728735  0.270841737770</span></span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a><span class="co">#&gt; 11   3.678663918  1.31249164 -0.421876929  0.002039556136</span></span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a><span class="co">#&gt; 12   2.109617169  0.61292670 -1.191610706 -1.098132793011</span></span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a><span class="co">#&gt; 13   2.438433322  0.67850437 -0.865549463 -0.657896417360</span></span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a><span class="co">#&gt; 14   3.673459480  1.14011683 -1.203831869 -0.229927298528</span></span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a><span class="co">#&gt; 15   4.441551027  2.11031094 -1.262480181  0.204510749383</span></span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a><span class="co">#&gt; 16   2.608885294  1.66635097  0.217554034 -1.518471831413</span></span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a><span class="co">#&gt; 17   2.475402186  2.33086927  0.831571622 -0.897632785058</span></span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a><span class="co">#&gt; 18   2.226198712  1.63356578  0.794509929 -1.150203812077</span></span>
<span id="cb85-23"><a href="#cb85-23" tabindex="-1"></a><span class="co">#&gt; 19   3.742235824  2.52836126 -0.484902514 -1.054210285615</span></span>
<span id="cb85-24"><a href="#cb85-24" tabindex="-1"></a><span class="co">#&gt; 20   2.394389854  1.06458639 -0.164684915  0.566957738763</span></span>
<span id="cb85-25"><a href="#cb85-25" tabindex="-1"></a><span class="co">#&gt; 21   3.336546971  0.79604355 -0.363831481  0.245993076967</span></span>
<span id="cb85-26"><a href="#cb85-26" tabindex="-1"></a><span class="co">#&gt; 22   1.481371313  0.24014421  0.936244720  0.899853157412</span></span>
<span id="cb85-27"><a href="#cb85-27" tabindex="-1"></a><span class="co">#&gt; 23   2.828047560 -0.08683042 -0.311959826 -0.206442226612</span></span>
<span id="cb85-28"><a href="#cb85-28" tabindex="-1"></a><span class="co">#&gt; 24   2.007694727 -0.51560048  0.143263270 -0.577870366709</span></span>
<span id="cb85-29"><a href="#cb85-29" tabindex="-1"></a><span class="co">#&gt; 25   2.114606195 -0.31588971  0.889721704 -0.331014695515</span></span>
<span id="cb85-30"><a href="#cb85-30" tabindex="-1"></a><span class="co">#&gt; 26   1.397496000  0.93820161  3.819815976 -1.347993684779</span></span>
<span id="cb85-31"><a href="#cb85-31" tabindex="-1"></a><span class="co">#&gt; 27   2.133470441  0.68715566 -0.087451244 -0.574878222594</span></span>
<span id="cb85-32"><a href="#cb85-32" tabindex="-1"></a><span class="co">#&gt; 28   1.629698090 -0.09119739 -1.387811890 -0.674076101573</span></span>
<span id="cb85-33"><a href="#cb85-33" tabindex="-1"></a><span class="co">#&gt; 29   2.507562173  0.69274094  1.394115208 -0.986467655274</span></span>
<span id="cb85-34"><a href="#cb85-34" tabindex="-1"></a><span class="co">#&gt; 30   2.559467329  0.19550527 -1.092667881  0.132383587928</span></span>
<span id="cb85-35"><a href="#cb85-35" tabindex="-1"></a><span class="co">#&gt; 31   2.772412896  1.24633503  1.386231386 -0.446487436226</span></span>
<span id="cb85-36"><a href="#cb85-36" tabindex="-1"></a><span class="co">#&gt; 32   2.935118156  1.47826152 -0.331854355 -0.321188592884</span></span>
<span id="cb85-37"><a href="#cb85-37" tabindex="-1"></a><span class="co">#&gt; 33   1.991220330  0.05320941 -0.167859145 -0.933901583246</span></span>
<span id="cb85-38"><a href="#cb85-38" tabindex="-1"></a><span class="co">#&gt; 34   2.245672360  1.63458672  1.171302514 -2.355848725794</span></span>
<span id="cb85-39"><a href="#cb85-39" tabindex="-1"></a><span class="co">#&gt; 35   1.786966008  0.69744752  0.478942465 -1.100686266672</span></span>
<span id="cb85-40"><a href="#cb85-40" tabindex="-1"></a><span class="co">#&gt; 36   2.227614790  0.17933442  0.450741651  0.202344151093</span></span>
<span id="cb85-41"><a href="#cb85-41" tabindex="-1"></a><span class="co">#&gt; 37   1.768001103  0.65785833  0.457489360 -1.386791557466</span></span>
<span id="cb85-42"><a href="#cb85-42" tabindex="-1"></a><span class="co">#&gt; 38   1.523158040  0.11219285 -0.040133237 -1.099178499752</span></span>
<span id="cb85-43"><a href="#cb85-43" tabindex="-1"></a><span class="co">#&gt; 39   1.872350633 -0.76934180 -1.426833311 -0.845227013710</span></span>
<span id="cb85-44"><a href="#cb85-44" tabindex="-1"></a><span class="co">#&gt; 40   2.797090511  1.80889925 -0.342619705  1.343216049323</span></span>
<span id="cb85-45"><a href="#cb85-45" tabindex="-1"></a><span class="co">#&gt; 41   2.840916446  0.78623506 -0.117743376  0.601278338096</span></span>
<span id="cb85-46"><a href="#cb85-46" tabindex="-1"></a><span class="co">#&gt; 42   1.105551874  0.16595498 -0.784551968  0.978955102017</span></span>
<span id="cb85-47"><a href="#cb85-47" tabindex="-1"></a><span class="co">#&gt; 43   3.306878987  1.16405408 -0.312155721  0.454650276704</span></span>
<span id="cb85-48"><a href="#cb85-48" tabindex="-1"></a><span class="co">#&gt; 44   0.904775408  0.32617794 -0.202549074  1.250427540974</span></span>
<span id="cb85-49"><a href="#cb85-49" tabindex="-1"></a><span class="co">#&gt; 45   2.396828265 -0.06681908 -0.655418561  0.840769963831</span></span>
<span id="cb85-50"><a href="#cb85-50" tabindex="-1"></a><span class="co">#&gt; 46   1.537782793  1.77514833  0.027663137  0.446173159986</span></span>
<span id="cb85-51"><a href="#cb85-51" tabindex="-1"></a><span class="co">#&gt; 47   2.991183721  1.19769630 -0.539468583  1.167086205149</span></span>
<span id="cb85-52"><a href="#cb85-52" tabindex="-1"></a><span class="co">#&gt; 48   3.059304804  0.65390980 -1.154706807  0.997424851524</span></span>
<span id="cb85-53"><a href="#cb85-53" tabindex="-1"></a><span class="co">#&gt; 49   2.318745488  1.25024762 -0.057311669  0.139415862876</span></span>
<span id="cb85-54"><a href="#cb85-54" tabindex="-1"></a><span class="co">#&gt; 50   2.959443594  1.75860262 -0.642687006 -0.145556586359</span></span>
<span id="cb85-55"><a href="#cb85-55" tabindex="-1"></a><span class="co">#&gt; 51   3.412171503  0.17693942 -1.972247667  1.205357522972</span></span>
<span id="cb85-56"><a href="#cb85-56" tabindex="-1"></a><span class="co">#&gt; 52   3.116351685  0.75208225  0.004972309 -0.366222301627</span></span>
<span id="cb85-57"><a href="#cb85-57" tabindex="-1"></a><span class="co">#&gt; 53   3.700183236  1.62315920 -0.519870174  0.039826980905</span></span>
<span id="cb85-58"><a href="#cb85-58" tabindex="-1"></a><span class="co">#&gt; 54   2.537518381  1.87849370  0.339130859 -1.330818167782</span></span>
<span id="cb85-59"><a href="#cb85-59" tabindex="-1"></a><span class="co">#&gt; 55   2.444783767  1.02074113 -0.957532313 -0.058927476567</span></span>
<span id="cb85-60"><a href="#cb85-60" tabindex="-1"></a><span class="co">#&gt; 56   2.722800840  1.33527318  0.514232404  0.507816922262</span></span>
<span id="cb85-61"><a href="#cb85-61" tabindex="-1"></a><span class="co">#&gt; 57   2.985299567  1.44369364 -0.611767379  0.332163476572</span></span>
<span id="cb85-62"><a href="#cb85-62" tabindex="-1"></a><span class="co">#&gt; 58   2.488120327  1.21550134  0.261472497 -0.680110072401</span></span>
<span id="cb85-63"><a href="#cb85-63" tabindex="-1"></a><span class="co">#&gt; 59   3.351275971  1.74066764 -0.284691036  0.315764384011</span></span>
<span id="cb85-64"><a href="#cb85-64" tabindex="-1"></a><span class="co">#&gt; 60  -0.874923506 -3.07776508 -4.585651475 -0.959203519966</span></span>
<span id="cb85-65"><a href="#cb85-65" tabindex="-1"></a><span class="co">#&gt; 61  -1.414697443 -1.39006863 -0.876591591 -3.099592771276</span></span>
<span id="cb85-66"><a href="#cb85-66" tabindex="-1"></a><span class="co">#&gt; 62  -1.713906251 -0.83888496 -1.607134490 -1.521529500895</span></span>
<span id="cb85-67"><a href="#cb85-67" tabindex="-1"></a><span class="co">#&gt; 63   0.012264892 -1.26275166 -1.784675940 -1.253874698452</span></span>
<span id="cb85-68"><a href="#cb85-68" tabindex="-1"></a><span class="co">#&gt; 64   1.833060109 -1.91331687 -0.005299173  0.897387099618</span></span>
<span id="cb85-69"><a href="#cb85-69" tabindex="-1"></a><span class="co">#&gt; 65  -0.574586722 -1.91126123  0.678573508 -2.111807610124</span></span>
<span id="cb85-70"><a href="#cb85-70" tabindex="-1"></a><span class="co">#&gt; 66   0.791438409 -0.75874544  0.574170996 -0.555872993625</span></span>
<span id="cb85-71"><a href="#cb85-71" tabindex="-1"></a><span class="co">#&gt; 67   2.020004353 -1.87204562 -2.029678832  1.428241960032</span></span>
<span id="cb85-72"><a href="#cb85-72" tabindex="-1"></a><span class="co">#&gt; 68   0.143252297 -2.42572107 -1.069518855  0.040165191987</span></span>
<span id="cb85-73"><a href="#cb85-73" tabindex="-1"></a><span class="co">#&gt; 69  -0.751534609 -0.22526038 -0.708228071 -2.591053825474</span></span>
<span id="cb85-74"><a href="#cb85-74" tabindex="-1"></a><span class="co">#&gt; 70   1.740331083 -1.39112032 -1.235538486  0.039068672956</span></span>
<span id="cb85-75"><a href="#cb85-75" tabindex="-1"></a><span class="co">#&gt; 71  -1.471439977 -0.89718602 -0.628427567 -0.988141665576</span></span>
<span id="cb85-76"><a href="#cb85-76" tabindex="-1"></a><span class="co">#&gt; 72   1.491915521 -0.94790641  1.953781747  0.098574608933</span></span>
<span id="cb85-77"><a href="#cb85-77" tabindex="-1"></a><span class="co">#&gt; 73  -0.693995613 -1.06683281  0.079855830 -0.155179627430</span></span>
<span id="cb85-78"><a href="#cb85-78" tabindex="-1"></a><span class="co">#&gt; 74   2.299416093  0.27432413  3.376821913 -0.298256092532</span></span>
<span id="cb85-79"><a href="#cb85-79" tabindex="-1"></a><span class="co">#&gt; 75   1.634117569 -1.27732363  0.460261134  0.558016383438</span></span>
<span id="cb85-80"><a href="#cb85-80" tabindex="-1"></a><span class="co">#&gt; 76  -0.829023350 -2.44776670 -1.563736486 -0.663736199569</span></span>
<span id="cb85-81"><a href="#cb85-81" tabindex="-1"></a><span class="co">#&gt; 77   0.300409802 -2.15108078 -2.448756951 -0.004978565189</span></span>
<span id="cb85-82"><a href="#cb85-82" tabindex="-1"></a><span class="co">#&gt; 78  -1.361197617 -1.39035146 -0.228301605 -0.565960852175</span></span>
<span id="cb85-83"><a href="#cb85-83" tabindex="-1"></a><span class="co">#&gt; 79   1.096056532 -0.76270658 -1.182313542 -0.113826485462</span></span>
<span id="cb85-84"><a href="#cb85-84" tabindex="-1"></a><span class="co">#&gt; 80   0.319163039 -1.02471772  1.794789911  0.893377696157</span></span>
<span id="cb85-85"><a href="#cb85-85" tabindex="-1"></a><span class="co">#&gt; 81   0.671218081 -3.37053621 -0.356728629 -0.291128734738</span></span>
<span id="cb85-86"><a href="#cb85-86" tabindex="-1"></a><span class="co">#&gt; 82   0.924081966 -1.44508906 -0.362171117  0.290344185286</span></span>
<span id="cb85-87"><a href="#cb85-87" tabindex="-1"></a><span class="co">#&gt; 83  -0.467533679 -2.38381074  1.335086204 -1.243193954847</span></span>
<span id="cb85-88"><a href="#cb85-88" tabindex="-1"></a><span class="co">#&gt; 84  -2.352456493 -0.10009045  0.472208786  0.303199333284</span></span>
<span id="cb85-89"><a href="#cb85-89" tabindex="-1"></a><span class="co">#&gt; 85   0.718223070 -1.46801633  0.611456423  0.887862534258</span></span>
<span id="cb85-90"><a href="#cb85-90" tabindex="-1"></a><span class="co">#&gt; 86   0.698267141 -2.02225187 -0.254076524 -0.654741954248</span></span>
<span id="cb85-91"><a href="#cb85-91" tabindex="-1"></a><span class="co">#&gt; 87  -0.764614511 -2.23757347  0.772209534 -1.053428568007</span></span>
<span id="cb85-92"><a href="#cb85-92" tabindex="-1"></a><span class="co">#&gt; 88  -0.528298761 -2.37574381  2.306992109 -1.131988339156</span></span>
<span id="cb85-93"><a href="#cb85-93" tabindex="-1"></a><span class="co">#&gt; 89  -1.037882647 -1.80784436  0.958255703 -0.556799710056</span></span>
<span id="cb85-94"><a href="#cb85-94" tabindex="-1"></a><span class="co">#&gt; 90  -0.521454457 -2.66034115  0.848508573 -0.333890062869</span></span>
<span id="cb85-95"><a href="#cb85-95" tabindex="-1"></a><span class="co">#&gt; 91  -1.253385943 -2.12476709 -0.048831395 -0.716748514566</span></span>
<span id="cb85-96"><a href="#cb85-96" tabindex="-1"></a><span class="co">#&gt; 92  -1.460737746 -1.85970760  0.779915804 -0.751206591727</span></span>
<span id="cb85-97"><a href="#cb85-97" tabindex="-1"></a><span class="co">#&gt; 93  -1.791269332 -1.56916686 -0.090891613 -0.848499440696</span></span>
<span id="cb85-98"><a href="#cb85-98" tabindex="-1"></a><span class="co">#&gt; 94   0.653267701 -2.30832502  0.115578330  1.291404235650</span></span>
<span id="cb85-99"><a href="#cb85-99" tabindex="-1"></a><span class="co">#&gt; 95   0.836110472 -2.21749637  0.143675225  0.598449579199</span></span>
<span id="cb85-100"><a href="#cb85-100" tabindex="-1"></a><span class="co">#&gt; 96   2.260607925  0.18420714  0.791778051  0.107223958898</span></span>
<span id="cb85-101"><a href="#cb85-101" tabindex="-1"></a><span class="co">#&gt; 97  -0.555475848 -0.37017528  1.309299852 -0.500762885462</span></span>
<span id="cb85-102"><a href="#cb85-102" tabindex="-1"></a><span class="co">#&gt; 98   0.914966608 -2.55962010 -1.085374266  0.320159081868</span></span>
<span id="cb85-103"><a href="#cb85-103" tabindex="-1"></a><span class="co">#&gt; 99   2.020956911 -1.42012011 -0.228006470  1.065188559812</span></span>
<span id="cb85-104"><a href="#cb85-104" tabindex="-1"></a><span class="co">#&gt; 100  1.265369320 -2.15846340  0.750084481  1.101680411018</span></span>
<span id="cb85-105"><a href="#cb85-105" tabindex="-1"></a><span class="co">#&gt; 101  0.701408366 -2.37224214 -1.567252507  0.162531212051</span></span>
<span id="cb85-106"><a href="#cb85-106" tabindex="-1"></a><span class="co">#&gt; 102 -0.530878379 -2.29536665 -1.499153846 -0.245322464454</span></span>
<span id="cb85-107"><a href="#cb85-107" tabindex="-1"></a><span class="co">#&gt; 103 -0.176180924 -1.16467140  1.003815322  0.666258772024</span></span>
<span id="cb85-108"><a href="#cb85-108" tabindex="-1"></a><span class="co">#&gt; 104 -0.642757821 -2.68222523 -0.764965455  0.489624432343</span></span>
<span id="cb85-109"><a href="#cb85-109" tabindex="-1"></a><span class="co">#&gt; 105  0.337684658 -2.09634737 -0.471464417  0.373210178737</span></span>
<span id="cb85-110"><a href="#cb85-110" tabindex="-1"></a><span class="co">#&gt; 106 -1.637243635 -1.72628691  0.945496724 -0.112048754597</span></span>
<span id="cb85-111"><a href="#cb85-111" tabindex="-1"></a><span class="co">#&gt; 107 -0.358792560 -2.17077498 -0.481497360  0.267832752044</span></span>
<span id="cb85-112"><a href="#cb85-112" tabindex="-1"></a><span class="co">#&gt; 108 -1.513137651 -1.36332666  0.286015956 -0.222574288009</span></span>
<span id="cb85-113"><a href="#cb85-113" tabindex="-1"></a><span class="co">#&gt; 109  0.030085767 -2.30440977 -0.462843182  1.015552058557</span></span>
<span id="cb85-114"><a href="#cb85-114" tabindex="-1"></a><span class="co">#&gt; 110  1.409384663 -1.45302142  1.781306223  0.808846799143</span></span>
<span id="cb85-115"><a href="#cb85-115" tabindex="-1"></a><span class="co">#&gt; 111  1.218241291 -1.40802222  0.142033338  3.980861651997</span></span>
<span id="cb85-116"><a href="#cb85-116" tabindex="-1"></a><span class="co">#&gt; 112 -0.288339800 -1.93112525  0.078799001  0.921339147101</span></span>
<span id="cb85-117"><a href="#cb85-117" tabindex="-1"></a><span class="co">#&gt; 113 -1.196150183 -0.77050190  1.997955246 -1.955769508799</span></span>
<span id="cb85-118"><a href="#cb85-118" tabindex="-1"></a><span class="co">#&gt; 114 -0.451648526 -2.27099330  1.061175579 -0.824900104449</span></span>
<span id="cb85-119"><a href="#cb85-119" tabindex="-1"></a><span class="co">#&gt; 115 -0.471872764 -1.94128941  1.323493045 -0.271742861692</span></span>
<span id="cb85-120"><a href="#cb85-120" tabindex="-1"></a><span class="co">#&gt; 116  0.423335647 -3.86908307  1.344504539 -0.981581626116</span></span>
<span id="cb85-121"><a href="#cb85-121" tabindex="-1"></a><span class="co">#&gt; 117 -0.264386608 -2.82185500 -0.302410448  0.530207298139</span></span>
<span id="cb85-122"><a href="#cb85-122" tabindex="-1"></a><span class="co">#&gt; 118 -0.137480398 -1.92843774  0.690521366  0.000003777304</span></span>
<span id="cb85-123"><a href="#cb85-123" tabindex="-1"></a><span class="co">#&gt; 119 -2.250493332 -1.26924005 -1.904889359  0.521247520695</span></span>
<span id="cb85-124"><a href="#cb85-124" tabindex="-1"></a><span class="co">#&gt; 120 -0.530762515 -2.22434284 -0.356373349  1.281102040255</span></span>
<span id="cb85-125"><a href="#cb85-125" tabindex="-1"></a><span class="co">#&gt; 121  0.641269477 -1.40417218  1.126394008  1.314097940594</span></span>
<span id="cb85-126"><a href="#cb85-126" tabindex="-1"></a><span class="co">#&gt; 122  1.184313109  0.26109499  5.346739245  0.424255737293</span></span>
<span id="cb85-127"><a href="#cb85-127" tabindex="-1"></a><span class="co">#&gt; 123 -1.106989025 -0.66940397  3.009473590  1.049444710996</span></span>
<span id="cb85-128"><a href="#cb85-128" tabindex="-1"></a><span class="co">#&gt; 124 -0.458685486 -0.61969330  0.483528490  3.340328691512</span></span>
<span id="cb85-129"><a href="#cb85-129" tabindex="-1"></a><span class="co">#&gt; 125  0.846080621 -1.43888467  1.482895360  3.812233406981</span></span>
<span id="cb85-130"><a href="#cb85-130" tabindex="-1"></a><span class="co">#&gt; 126 -0.116562375 -2.10977446  0.435006063  0.940511428521</span></span>
<span id="cb85-131"><a href="#cb85-131" tabindex="-1"></a><span class="co">#&gt; 127 -0.007104989 -1.26534660  0.688125194  1.216000486737</span></span>
<span id="cb85-132"><a href="#cb85-132" tabindex="-1"></a><span class="co">#&gt; 128 -1.495350135 -1.21563545  3.360056786 -0.405213961113</span></span>
<span id="cb85-133"><a href="#cb85-133" tabindex="-1"></a><span class="co">#&gt; 129 -0.478624084 -1.94018917  1.296591584  0.671430006317</span></span>
<span id="cb85-134"><a href="#cb85-134" tabindex="-1"></a><span class="co">#&gt; 130 -1.664175709 -1.15908430  0.781458268  1.124477941226</span></span>
<span id="cb85-135"><a href="#cb85-135" tabindex="-1"></a><span class="co">#&gt; 131 -1.778943684  0.17228098 -1.178839590 -0.811122551453</span></span>
<span id="cb85-136"><a href="#cb85-136" tabindex="-1"></a><span class="co">#&gt; 132 -2.741937196  0.37086548 -0.723644039  0.007978757817</span></span>
<span id="cb85-137"><a href="#cb85-137" tabindex="-1"></a><span class="co">#&gt; 133 -3.254310403  0.25758026 -0.167772216 -0.136230480148</span></span>
<span id="cb85-138"><a href="#cb85-138" tabindex="-1"></a><span class="co">#&gt; 134 -2.530388335  0.36600160 -0.452791227  0.446222088451</span></span>
<span id="cb85-139"><a href="#cb85-139" tabindex="-1"></a><span class="co">#&gt; 135 -2.713045332 -0.46385329 -1.101657507 -0.975228943525</span></span>
<span id="cb85-140"><a href="#cb85-140" tabindex="-1"></a><span class="co">#&gt; 136 -3.349016441  0.34557115 -1.099962707 -0.872689425080</span></span>
<span id="cb85-141"><a href="#cb85-141" tabindex="-1"></a><span class="co">#&gt; 137 -4.117202383  0.14198595  0.220163264 -0.262019929513</span></span>
<span id="cb85-142"><a href="#cb85-142" tabindex="-1"></a><span class="co">#&gt; 138 -4.144188872  0.64725279  1.710611538  0.243564793427</span></span>
<span id="cb85-143"><a href="#cb85-143" tabindex="-1"></a><span class="co">#&gt; 139 -3.365967328  0.34042878 -1.027933346 -0.378232282634</span></span>
<span id="cb85-144"><a href="#cb85-144" tabindex="-1"></a><span class="co">#&gt; 140 -2.712726623  0.28748293  1.241490172 -0.819120395687</span></span>
<span id="cb85-145"><a href="#cb85-145" tabindex="-1"></a><span class="co">#&gt; 141 -3.071680894  0.27982578  0.608754978 -1.036780148849</span></span>
<span id="cb85-146"><a href="#cb85-146" tabindex="-1"></a><span class="co">#&gt; 142 -2.626166752  0.36826427 -0.972006044 -0.463214345208</span></span>
<span id="cb85-147"><a href="#cb85-147" tabindex="-1"></a><span class="co">#&gt; 143 -3.260445573  0.48108190  0.945777489 -1.224089680201</span></span>
<span id="cb85-148"><a href="#cb85-148" tabindex="-1"></a><span class="co">#&gt; 144 -2.704101752  0.47749459 -0.253449336  0.411957890958</span></span>
<span id="cb85-149"><a href="#cb85-149" tabindex="-1"></a><span class="co">#&gt; 145 -2.590861219  1.15752557 -1.244609569  0.708157077476</span></span>
<span id="cb85-150"><a href="#cb85-150" tabindex="-1"></a><span class="co">#&gt; 146 -2.954020852  0.55788774 -0.856127602  0.377083744097</span></span>
<span id="cb85-151"><a href="#cb85-151" tabindex="-1"></a><span class="co">#&gt; 147 -4.459981559  0.63554443 -1.459954363  0.796730909228</span></span>
<span id="cb85-152"><a href="#cb85-152" tabindex="-1"></a><span class="co">#&gt; 148 -3.829287610  1.26243010 -0.111881921  0.787547685624</span></span>
<span id="cb85-153"><a href="#cb85-153" tabindex="-1"></a><span class="co">#&gt; 149 -3.133679945  1.56472907 -0.472756720  0.573132232904</span></span>
<span id="cb85-154"><a href="#cb85-154" tabindex="-1"></a><span class="co">#&gt; 150 -3.234739627  2.03537390 -0.495858512  0.795513733990</span></span>
<span id="cb85-155"><a href="#cb85-155" tabindex="-1"></a><span class="co">#&gt; 151 -2.712586051  2.35391168  0.438405959  0.525586720303</span></span>
<span id="cb85-156"><a href="#cb85-156" tabindex="-1"></a><span class="co">#&gt; 152 -2.930956654  2.04205722 -0.311521488  0.900358039242</span></span>
<span id="cb85-157"><a href="#cb85-157" tabindex="-1"></a><span class="co">#&gt; 153 -2.250596974  1.52801594  1.363790357  0.375871613090</span></span>
<span id="cb85-158"><a href="#cb85-158" tabindex="-1"></a><span class="co">#&gt; 154 -3.097551711  2.13354943 -0.964742195  0.617163741854</span></span>
<span id="cb85-159"><a href="#cb85-159" tabindex="-1"></a><span class="co">#&gt; 155 -3.077061476  0.40481612 -1.190315380 -0.421982081968</span></span>
<span id="cb85-160"><a href="#cb85-160" tabindex="-1"></a><span class="co">#&gt; 156 -3.856200626  1.79216205 -0.095077401  1.004947457457</span></span>
<span id="cb85-161"><a href="#cb85-161" tabindex="-1"></a><span class="co">#&gt; 157 -3.208428815  1.91892539 -0.782669567  1.148803410016</span></span>
<span id="cb85-162"><a href="#cb85-162" tabindex="-1"></a><span class="co">#&gt; 158 -3.658532777  1.30261252  1.601038597 -0.624064644708</span></span>
<span id="cb85-163"><a href="#cb85-163" tabindex="-1"></a><span class="co">#&gt; 159 -1.553028400  3.51920834  1.161564432  1.008796841684</span></span>
<span id="cb85-164"><a href="#cb85-164" tabindex="-1"></a><span class="co">#&gt; 160 -2.058323722  2.40765703  0.549547794  0.751773271073</span></span>
<span id="cb85-165"><a href="#cb85-165" tabindex="-1"></a><span class="co">#&gt; 161 -3.438586574  0.73065802 -0.091486383  0.842493585950</span></span>
<span id="cb85-166"><a href="#cb85-166" tabindex="-1"></a><span class="co">#&gt; 162 -2.584536514  1.17128882 -0.101889526 -1.204679422191</span></span>
<span id="cb85-167"><a href="#cb85-167" tabindex="-1"></a><span class="co">#&gt; 163 -3.144502558  0.54902947  0.803394762 -0.964981063827</span></span>
<span id="cb85-168"><a href="#cb85-168" tabindex="-1"></a><span class="co">#&gt; 164 -2.925312657  0.69267412 -0.885201944 -0.131319821967</span></span>
<span id="cb85-169"><a href="#cb85-169" tabindex="-1"></a><span class="co">#&gt; 165 -3.261861712  1.54861450 -0.983862644 -0.039040516391</span></span>
<span id="cb85-170"><a href="#cb85-170" tabindex="-1"></a><span class="co">#&gt; 166 -3.777633103  0.87233703 -0.467215210  0.314181929664</span></span>
<span id="cb85-171"><a href="#cb85-171" tabindex="-1"></a><span class="co">#&gt; 167 -2.774690234  2.58869214  0.428315610 -0.008883452551</span></span>
<span id="cb85-172"><a href="#cb85-172" tabindex="-1"></a><span class="co">#&gt; 168 -3.242652681  1.26788019 -1.213773958  0.240500463334</span></span>
<span id="cb85-173"><a href="#cb85-173" tabindex="-1"></a><span class="co">#&gt; 169 -2.563777659  2.07491544  0.764034442 -0.207218518733</span></span>
<span id="cb85-174"><a href="#cb85-174" tabindex="-1"></a><span class="co">#&gt; 170 -2.748775899  2.58514396  1.418234806  0.808481977825</span></span>
<span id="cb85-175"><a href="#cb85-175" tabindex="-1"></a><span class="co">#&gt; 171 -3.491213954 -0.25942579 -0.847744623 -0.124978958578</span></span>
<span id="cb85-176"><a href="#cb85-176" tabindex="-1"></a><span class="co">#&gt; 172 -3.929162637  0.83744474 -1.340388581 -0.231244399843</span></span>
<span id="cb85-177"><a href="#cb85-177" tabindex="-1"></a><span class="co">#&gt; 173 -2.815329157  2.18938428 -0.918984300 -0.080588573166</span></span>
<span id="cb85-178"><a href="#cb85-178" tabindex="-1"></a><span class="co">#&gt; 174 -3.628044277  2.20668032 -0.343744501  0.752446911509</span></span>
<span id="cb85-179"><a href="#cb85-179" tabindex="-1"></a><span class="co">#&gt; 175 -2.942765014  1.75229589  0.207438633  0.399123143134</span></span>
<span id="cb85-180"><a href="#cb85-180" tabindex="-1"></a><span class="co">#&gt; 176 -3.027298525  2.75606589 -0.940832565  0.606660438947</span></span>
<span id="cb85-181"><a href="#cb85-181" tabindex="-1"></a><span class="co">#&gt; 177 -2.755240485  2.29379266 -0.550497752 -0.392512052691</span></span>
<span id="cb85-182"><a href="#cb85-182" tabindex="-1"></a><span class="co">#&gt; 178 -3.496390966  2.76068615  1.013070513  0.350429769737</span></span>
<span id="cb85-183"><a href="#cb85-183" tabindex="-1"></a><span class="co">#&gt;            Dim.5</span></span>
<span id="cb85-184"><a href="#cb85-184" tabindex="-1"></a><span class="co">#&gt; 1   -0.737323391</span></span>
<span id="cb85-185"><a href="#cb85-185" tabindex="-1"></a><span class="co">#&gt; 2    0.283643924</span></span>
<span id="cb85-186"><a href="#cb85-186" tabindex="-1"></a><span class="co">#&gt; 3    0.386990929</span></span>
<span id="cb85-187"><a href="#cb85-187" tabindex="-1"></a><span class="co">#&gt; 4    0.323943110</span></span>
<span id="cb85-188"><a href="#cb85-188" tabindex="-1"></a><span class="co">#&gt; 5   -0.227517055</span></span>
<span id="cb85-189"><a href="#cb85-189" tabindex="-1"></a><span class="co">#&gt; 6    0.410148340</span></span>
<span id="cb85-190"><a href="#cb85-190" tabindex="-1"></a><span class="co">#&gt; 7    1.024613744</span></span>
<span id="cb85-191"><a href="#cb85-191" tabindex="-1"></a><span class="co">#&gt; 8   -0.206295854</span></span>
<span id="cb85-192"><a href="#cb85-192" tabindex="-1"></a><span class="co">#&gt; 9    0.858541111</span></span>
<span id="cb85-193"><a href="#cb85-193" tabindex="-1"></a><span class="co">#&gt; 10   0.471657012</span></span>
<span id="cb85-194"><a href="#cb85-194" tabindex="-1"></a><span class="co">#&gt; 11   0.259699455</span></span>
<span id="cb85-195"><a href="#cb85-195" tabindex="-1"></a><span class="co">#&gt; 12   0.558828290</span></span>
<span id="cb85-196"><a href="#cb85-196" tabindex="-1"></a><span class="co">#&gt; 13   1.088276889</span></span>
<span id="cb85-197"><a href="#cb85-197" tabindex="-1"></a><span class="co">#&gt; 14   1.822655142</span></span>
<span id="cb85-198"><a href="#cb85-198" tabindex="-1"></a><span class="co">#&gt; 15   0.844212099</span></span>
<span id="cb85-199"><a href="#cb85-199" tabindex="-1"></a><span class="co">#&gt; 16   0.100892900</span></span>
<span id="cb85-200"><a href="#cb85-200" tabindex="-1"></a><span class="co">#&gt; 17  -0.210265249</span></span>
<span id="cb85-201"><a href="#cb85-201" tabindex="-1"></a><span class="co">#&gt; 18   0.131484326</span></span>
<span id="cb85-202"><a href="#cb85-202" tabindex="-1"></a><span class="co">#&gt; 19   0.723193967</span></span>
<span id="cb85-203"><a href="#cb85-203" tabindex="-1"></a><span class="co">#&gt; 20  -0.537541332</span></span>
<span id="cb85-204"><a href="#cb85-204" tabindex="-1"></a><span class="co">#&gt; 21  -0.968868318</span></span>
<span id="cb85-205"><a href="#cb85-205" tabindex="-1"></a><span class="co">#&gt; 22   0.209048350</span></span>
<span id="cb85-206"><a href="#cb85-206" tabindex="-1"></a><span class="co">#&gt; 23   0.487810262</span></span>
<span id="cb85-207"><a href="#cb85-207" tabindex="-1"></a><span class="co">#&gt; 24   0.377283258</span></span>
<span id="cb85-208"><a href="#cb85-208" tabindex="-1"></a><span class="co">#&gt; 25   0.624309150</span></span>
<span id="cb85-209"><a href="#cb85-209" tabindex="-1"></a><span class="co">#&gt; 26  -0.341365748</span></span>
<span id="cb85-210"><a href="#cb85-210" tabindex="-1"></a><span class="co">#&gt; 27   1.131067011</span></span>
<span id="cb85-211"><a href="#cb85-211" tabindex="-1"></a><span class="co">#&gt; 28   0.375394077</span></span>
<span id="cb85-212"><a href="#cb85-212" tabindex="-1"></a><span class="co">#&gt; 29   0.632318904</span></span>
<span id="cb85-213"><a href="#cb85-213" tabindex="-1"></a><span class="co">#&gt; 30   0.574806483</span></span>
<span id="cb85-214"><a href="#cb85-214" tabindex="-1"></a><span class="co">#&gt; 31   0.410905993</span></span>
<span id="cb85-215"><a href="#cb85-215" tabindex="-1"></a><span class="co">#&gt; 32  -0.057358996</span></span>
<span id="cb85-216"><a href="#cb85-216" tabindex="-1"></a><span class="co">#&gt; 33   0.488402862</span></span>
<span id="cb85-217"><a href="#cb85-217" tabindex="-1"></a><span class="co">#&gt; 34  -0.349402029</span></span>
<span id="cb85-218"><a href="#cb85-218" tabindex="-1"></a><span class="co">#&gt; 35  -0.222978993</span></span>
<span id="cb85-219"><a href="#cb85-219" tabindex="-1"></a><span class="co">#&gt; 36   0.272882427</span></span>
<span id="cb85-220"><a href="#cb85-220" tabindex="-1"></a><span class="co">#&gt; 37   0.001395361</span></span>
<span id="cb85-221"><a href="#cb85-221" tabindex="-1"></a><span class="co">#&gt; 38   0.205623377</span></span>
<span id="cb85-222"><a href="#cb85-222" tabindex="-1"></a><span class="co">#&gt; 39   0.066339885</span></span>
<span id="cb85-223"><a href="#cb85-223" tabindex="-1"></a><span class="co">#&gt; 40  -0.742345225</span></span>
<span id="cb85-224"><a href="#cb85-224" tabindex="-1"></a><span class="co">#&gt; 41  -0.324826083</span></span>
<span id="cb85-225"><a href="#cb85-225" tabindex="-1"></a><span class="co">#&gt; 42   0.971115608</span></span>
<span id="cb85-226"><a href="#cb85-226" tabindex="-1"></a><span class="co">#&gt; 43   0.449752734</span></span>
<span id="cb85-227"><a href="#cb85-227" tabindex="-1"></a><span class="co">#&gt; 44   0.385982834</span></span>
<span id="cb85-228"><a href="#cb85-228" tabindex="-1"></a><span class="co">#&gt; 45  -0.249037726</span></span>
<span id="cb85-229"><a href="#cb85-229" tabindex="-1"></a><span class="co">#&gt; 46   0.537857656</span></span>
<span id="cb85-230"><a href="#cb85-230" tabindex="-1"></a><span class="co">#&gt; 47   0.920943379</span></span>
<span id="cb85-231"><a href="#cb85-231" tabindex="-1"></a><span class="co">#&gt; 48   0.201025005</span></span>
<span id="cb85-232"><a href="#cb85-232" tabindex="-1"></a><span class="co">#&gt; 49   0.404392512</span></span>
<span id="cb85-233"><a href="#cb85-233" tabindex="-1"></a><span class="co">#&gt; 50   0.341456879</span></span>
<span id="cb85-234"><a href="#cb85-234" tabindex="-1"></a><span class="co">#&gt; 51   0.104318822</span></span>
<span id="cb85-235"><a href="#cb85-235" tabindex="-1"></a><span class="co">#&gt; 52   0.636970440</span></span>
<span id="cb85-236"><a href="#cb85-236" tabindex="-1"></a><span class="co">#&gt; 53   0.492816782</span></span>
<span id="cb85-237"><a href="#cb85-237" tabindex="-1"></a><span class="co">#&gt; 54   0.277707075</span></span>
<span id="cb85-238"><a href="#cb85-238" tabindex="-1"></a><span class="co">#&gt; 55  -0.837065241</span></span>
<span id="cb85-239"><a href="#cb85-239" tabindex="-1"></a><span class="co">#&gt; 56  -0.860204322</span></span>
<span id="cb85-240"><a href="#cb85-240" tabindex="-1"></a><span class="co">#&gt; 57  -0.394865003</span></span>
<span id="cb85-241"><a href="#cb85-241" tabindex="-1"></a><span class="co">#&gt; 58   0.568334604</span></span>
<span id="cb85-242"><a href="#cb85-242" tabindex="-1"></a><span class="co">#&gt; 59  -0.113148447</span></span>
<span id="cb85-243"><a href="#cb85-243" tabindex="-1"></a><span class="co">#&gt; 60  -0.628510026</span></span>
<span id="cb85-244"><a href="#cb85-244" tabindex="-1"></a><span class="co">#&gt; 61   0.277964474</span></span>
<span id="cb85-245"><a href="#cb85-245" tabindex="-1"></a><span class="co">#&gt; 62  -0.045816489</span></span>
<span id="cb85-246"><a href="#cb85-246" tabindex="-1"></a><span class="co">#&gt; 63   0.062319939</span></span>
<span id="cb85-247"><a href="#cb85-247" tabindex="-1"></a><span class="co">#&gt; 64  -0.037583818</span></span>
<span id="cb85-248"><a href="#cb85-248" tabindex="-1"></a><span class="co">#&gt; 65  -0.477048892</span></span>
<span id="cb85-249"><a href="#cb85-249" tabindex="-1"></a><span class="co">#&gt; 66  -0.229480101</span></span>
<span id="cb85-250"><a href="#cb85-250" tabindex="-1"></a><span class="co">#&gt; 67   0.717201861</span></span>
<span id="cb85-251"><a href="#cb85-251" tabindex="-1"></a><span class="co">#&gt; 68   0.477479733</span></span>
<span id="cb85-252"><a href="#cb85-252" tabindex="-1"></a><span class="co">#&gt; 69  -0.020857116</span></span>
<span id="cb85-253"><a href="#cb85-253" tabindex="-1"></a><span class="co">#&gt; 70  -4.449208881</span></span>
<span id="cb85-254"><a href="#cb85-254" tabindex="-1"></a><span class="co">#&gt; 71  -1.114792520</span></span>
<span id="cb85-255"><a href="#cb85-255" tabindex="-1"></a><span class="co">#&gt; 72   0.602798498</span></span>
<span id="cb85-256"><a href="#cb85-256" tabindex="-1"></a><span class="co">#&gt; 73   0.204118007</span></span>
<span id="cb85-257"><a href="#cb85-257" tabindex="-1"></a><span class="co">#&gt; 74  -2.342893243</span></span>
<span id="cb85-258"><a href="#cb85-258" tabindex="-1"></a><span class="co">#&gt; 75  -1.102485083</span></span>
<span id="cb85-259"><a href="#cb85-259" tabindex="-1"></a><span class="co">#&gt; 76  -0.845959276</span></span>
<span id="cb85-260"><a href="#cb85-260" tabindex="-1"></a><span class="co">#&gt; 77  -0.255926169</span></span>
<span id="cb85-261"><a href="#cb85-261" tabindex="-1"></a><span class="co">#&gt; 78  -0.979319399</span></span>
<span id="cb85-262"><a href="#cb85-262" tabindex="-1"></a><span class="co">#&gt; 79  -2.927608020</span></span>
<span id="cb85-263"><a href="#cb85-263" tabindex="-1"></a><span class="co">#&gt; 80   0.418980632</span></span>
<span id="cb85-264"><a href="#cb85-264" tabindex="-1"></a><span class="co">#&gt; 81  -0.082937999</span></span>
<span id="cb85-265"><a href="#cb85-265" tabindex="-1"></a><span class="co">#&gt; 82   0.267399853</span></span>
<span id="cb85-266"><a href="#cb85-266" tabindex="-1"></a><span class="co">#&gt; 83   0.697470861</span></span>
<span id="cb85-267"><a href="#cb85-267" tabindex="-1"></a><span class="co">#&gt; 84   1.463920234</span></span>
<span id="cb85-268"><a href="#cb85-268" tabindex="-1"></a><span class="co">#&gt; 85  -0.855763132</span></span>
<span id="cb85-269"><a href="#cb85-269" tabindex="-1"></a><span class="co">#&gt; 86  -0.533834919</span></span>
<span id="cb85-270"><a href="#cb85-270" tabindex="-1"></a><span class="co">#&gt; 87   0.013784273</span></span>
<span id="cb85-271"><a href="#cb85-271" tabindex="-1"></a><span class="co">#&gt; 88   0.209184145</span></span>
<span id="cb85-272"><a href="#cb85-272" tabindex="-1"></a><span class="co">#&gt; 89   0.685214943</span></span>
<span id="cb85-273"><a href="#cb85-273" tabindex="-1"></a><span class="co">#&gt; 90   1.279858920</span></span>
<span id="cb85-274"><a href="#cb85-274" tabindex="-1"></a><span class="co">#&gt; 91   0.783467330</span></span>
<span id="cb85-275"><a href="#cb85-275" tabindex="-1"></a><span class="co">#&gt; 92   0.374992140</span></span>
<span id="cb85-276"><a href="#cb85-276" tabindex="-1"></a><span class="co">#&gt; 93   1.040657338</span></span>
<span id="cb85-277"><a href="#cb85-277" tabindex="-1"></a><span class="co">#&gt; 94   0.053214661</span></span>
<span id="cb85-278"><a href="#cb85-278" tabindex="-1"></a><span class="co">#&gt; 95  -0.895966897</span></span>
<span id="cb85-279"><a href="#cb85-279" tabindex="-1"></a><span class="co">#&gt; 96  -4.078060769</span></span>
<span id="cb85-280"><a href="#cb85-280" tabindex="-1"></a><span class="co">#&gt; 97  -3.393171649</span></span>
<span id="cb85-281"><a href="#cb85-281" tabindex="-1"></a><span class="co">#&gt; 98   0.098100704</span></span>
<span id="cb85-282"><a href="#cb85-282" tabindex="-1"></a><span class="co">#&gt; 99   0.144774597</span></span>
<span id="cb85-283"><a href="#cb85-283" tabindex="-1"></a><span class="co">#&gt; 100  0.822637255</span></span>
<span id="cb85-284"><a href="#cb85-284" tabindex="-1"></a><span class="co">#&gt; 101 -0.648601021</span></span>
<span id="cb85-285"><a href="#cb85-285" tabindex="-1"></a><span class="co">#&gt; 102 -0.350899187</span></span>
<span id="cb85-286"><a href="#cb85-286" tabindex="-1"></a><span class="co">#&gt; 103 -0.045402401</span></span>
<span id="cb85-287"><a href="#cb85-287" tabindex="-1"></a><span class="co">#&gt; 104 -0.025544183</span></span>
<span id="cb85-288"><a href="#cb85-288" tabindex="-1"></a><span class="co">#&gt; 105  0.372891825</span></span>
<span id="cb85-289"><a href="#cb85-289" tabindex="-1"></a><span class="co">#&gt; 106  1.175100971</span></span>
<span id="cb85-290"><a href="#cb85-290" tabindex="-1"></a><span class="co">#&gt; 107  0.548536786</span></span>
<span id="cb85-291"><a href="#cb85-291" tabindex="-1"></a><span class="co">#&gt; 108  0.599287649</span></span>
<span id="cb85-292"><a href="#cb85-292" tabindex="-1"></a><span class="co">#&gt; 109 -0.206093088</span></span>
<span id="cb85-293"><a href="#cb85-293" tabindex="-1"></a><span class="co">#&gt; 110 -0.315624213</span></span>
<span id="cb85-294"><a href="#cb85-294" tabindex="-1"></a><span class="co">#&gt; 111 -1.396107944</span></span>
<span id="cb85-295"><a href="#cb85-295" tabindex="-1"></a><span class="co">#&gt; 112  0.049819834</span></span>
<span id="cb85-296"><a href="#cb85-296" tabindex="-1"></a><span class="co">#&gt; 113  0.407657677</span></span>
<span id="cb85-297"><a href="#cb85-297" tabindex="-1"></a><span class="co">#&gt; 114 -0.007586959</span></span>
<span id="cb85-298"><a href="#cb85-298" tabindex="-1"></a><span class="co">#&gt; 115  0.796580957</span></span>
<span id="cb85-299"><a href="#cb85-299" tabindex="-1"></a><span class="co">#&gt; 116  0.492734780</span></span>
<span id="cb85-300"><a href="#cb85-300" tabindex="-1"></a><span class="co">#&gt; 117 -0.233233266</span></span>
<span id="cb85-301"><a href="#cb85-301" tabindex="-1"></a><span class="co">#&gt; 118 -1.093626855</span></span>
<span id="cb85-302"><a href="#cb85-302" tabindex="-1"></a><span class="co">#&gt; 119  0.946268623</span></span>
<span id="cb85-303"><a href="#cb85-303" tabindex="-1"></a><span class="co">#&gt; 120  0.271573407</span></span>
<span id="cb85-304"><a href="#cb85-304" tabindex="-1"></a><span class="co">#&gt; 121 -0.157209361</span></span>
<span id="cb85-305"><a href="#cb85-305" tabindex="-1"></a><span class="co">#&gt; 122 -0.351421221</span></span>
<span id="cb85-306"><a href="#cb85-306" tabindex="-1"></a><span class="co">#&gt; 123  0.207936048</span></span>
<span id="cb85-307"><a href="#cb85-307" tabindex="-1"></a><span class="co">#&gt; 124  1.012235685</span></span>
<span id="cb85-308"><a href="#cb85-308" tabindex="-1"></a><span class="co">#&gt; 125  0.465310820</span></span>
<span id="cb85-309"><a href="#cb85-309" tabindex="-1"></a><span class="co">#&gt; 126  0.571575372</span></span>
<span id="cb85-310"><a href="#cb85-310" tabindex="-1"></a><span class="co">#&gt; 127  0.551441476</span></span>
<span id="cb85-311"><a href="#cb85-311" tabindex="-1"></a><span class="co">#&gt; 128  0.584910716</span></span>
<span id="cb85-312"><a href="#cb85-312" tabindex="-1"></a><span class="co">#&gt; 129  0.191939831</span></span>
<span id="cb85-313"><a href="#cb85-313" tabindex="-1"></a><span class="co">#&gt; 130  1.109843388</span></span>
<span id="cb85-314"><a href="#cb85-314" tabindex="-1"></a><span class="co">#&gt; 131 -2.677819004</span></span>
<span id="cb85-315"><a href="#cb85-315" tabindex="-1"></a><span class="co">#&gt; 132 -1.318550609</span></span>
<span id="cb85-316"><a href="#cb85-316" tabindex="-1"></a><span class="co">#&gt; 133 -1.136642981</span></span>
<span id="cb85-317"><a href="#cb85-317" tabindex="-1"></a><span class="co">#&gt; 134 -1.589463531</span></span>
<span id="cb85-318"><a href="#cb85-318" tabindex="-1"></a><span class="co">#&gt; 135  0.624115280</span></span>
<span id="cb85-319"><a href="#cb85-319" tabindex="-1"></a><span class="co">#&gt; 136  0.467430159</span></span>
<span id="cb85-320"><a href="#cb85-320" tabindex="-1"></a><span class="co">#&gt; 137  0.573555564</span></span>
<span id="cb85-321"><a href="#cb85-321" tabindex="-1"></a><span class="co">#&gt; 138  0.861947883</span></span>
<span id="cb85-322"><a href="#cb85-322" tabindex="-1"></a><span class="co">#&gt; 139  1.060044947</span></span>
<span id="cb85-323"><a href="#cb85-323" tabindex="-1"></a><span class="co">#&gt; 140  0.200126475</span></span>
<span id="cb85-324"><a href="#cb85-324" tabindex="-1"></a><span class="co">#&gt; 141  0.379583579</span></span>
<span id="cb85-325"><a href="#cb85-325" tabindex="-1"></a><span class="co">#&gt; 142  0.266203811</span></span>
<span id="cb85-326"><a href="#cb85-326" tabindex="-1"></a><span class="co">#&gt; 143  0.411069487</span></span>
<span id="cb85-327"><a href="#cb85-327" tabindex="-1"></a><span class="co">#&gt; 144  0.902940787</span></span>
<span id="cb85-328"><a href="#cb85-328" tabindex="-1"></a><span class="co">#&gt; 145 -1.504851571</span></span>
<span id="cb85-329"><a href="#cb85-329" tabindex="-1"></a><span class="co">#&gt; 146 -0.478943995</span></span>
<span id="cb85-330"><a href="#cb85-330" tabindex="-1"></a><span class="co">#&gt; 147  0.919530173</span></span>
<span id="cb85-331"><a href="#cb85-331" tabindex="-1"></a><span class="co">#&gt; 148  0.901470026</span></span>
<span id="cb85-332"><a href="#cb85-332" tabindex="-1"></a><span class="co">#&gt; 149  0.355067798</span></span>
<span id="cb85-333"><a href="#cb85-333" tabindex="-1"></a><span class="co">#&gt; 150 -1.241496895</span></span>
<span id="cb85-334"><a href="#cb85-334" tabindex="-1"></a><span class="co">#&gt; 151 -2.186602621</span></span>
<span id="cb85-335"><a href="#cb85-335" tabindex="-1"></a><span class="co">#&gt; 152 -1.779940143</span></span>
<span id="cb85-336"><a href="#cb85-336" tabindex="-1"></a><span class="co">#&gt; 153 -1.906691765</span></span>
<span id="cb85-337"><a href="#cb85-337" tabindex="-1"></a><span class="co">#&gt; 154  0.480674109</span></span>
<span id="cb85-338"><a href="#cb85-338" tabindex="-1"></a><span class="co">#&gt; 155 -0.778515638</span></span>
<span id="cb85-339"><a href="#cb85-339" tabindex="-1"></a><span class="co">#&gt; 156  0.994703553</span></span>
<span id="cb85-340"><a href="#cb85-340" tabindex="-1"></a><span class="co">#&gt; 157  0.861865624</span></span>
<span id="cb85-341"><a href="#cb85-341" tabindex="-1"></a><span class="co">#&gt; 158  0.489125606</span></span>
<span id="cb85-342"><a href="#cb85-342" tabindex="-1"></a><span class="co">#&gt; 159  0.615135593</span></span>
<span id="cb85-343"><a href="#cb85-343" tabindex="-1"></a><span class="co">#&gt; 160  0.742014747</span></span>
<span id="cb85-344"><a href="#cb85-344" tabindex="-1"></a><span class="co">#&gt; 161  0.637352140</span></span>
<span id="cb85-345"><a href="#cb85-345" tabindex="-1"></a><span class="co">#&gt; 162 -0.017023996</span></span>
<span id="cb85-346"><a href="#cb85-346" tabindex="-1"></a><span class="co">#&gt; 163  0.061936001</span></span>
<span id="cb85-347"><a href="#cb85-347" tabindex="-1"></a><span class="co">#&gt; 164 -0.722816090</span></span>
<span id="cb85-348"><a href="#cb85-348" tabindex="-1"></a><span class="co">#&gt; 165  0.289898075</span></span>
<span id="cb85-349"><a href="#cb85-349" tabindex="-1"></a><span class="co">#&gt; 166  0.897780625</span></span>
<span id="cb85-350"><a href="#cb85-350" tabindex="-1"></a><span class="co">#&gt; 167 -0.564900315</span></span>
<span id="cb85-351"><a href="#cb85-351" tabindex="-1"></a><span class="co">#&gt; 168  0.291597025</span></span>
<span id="cb85-352"><a href="#cb85-352" tabindex="-1"></a><span class="co">#&gt; 169 -0.563390938</span></span>
<span id="cb85-353"><a href="#cb85-353" tabindex="-1"></a><span class="co">#&gt; 170 -0.865848227</span></span>
<span id="cb85-354"><a href="#cb85-354" tabindex="-1"></a><span class="co">#&gt; 171 -0.548793467</span></span>
<span id="cb85-355"><a href="#cb85-355" tabindex="-1"></a><span class="co">#&gt; 172  0.398204711</span></span>
<span id="cb85-356"><a href="#cb85-356" tabindex="-1"></a><span class="co">#&gt; 173  0.560024117</span></span>
<span id="cb85-357"><a href="#cb85-357" tabindex="-1"></a><span class="co">#&gt; 174  1.003241669</span></span>
<span id="cb85-358"><a href="#cb85-358" tabindex="-1"></a><span class="co">#&gt; 175 -0.154695420</span></span>
<span id="cb85-359"><a href="#cb85-359" tabindex="-1"></a><span class="co">#&gt; 176 -1.128844821</span></span>
<span id="cb85-360"><a href="#cb85-360" tabindex="-1"></a><span class="co">#&gt; 177 -1.066773471</span></span>
<span id="cb85-361"><a href="#cb85-361" tabindex="-1"></a><span class="co">#&gt; 178  1.004719829</span></span>
<span id="cb85-362"><a href="#cb85-362" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb85-363"><a href="#cb85-363" tabindex="-1"></a><span class="co">#&gt; $cos2</span></span>
<span id="cb85-364"><a href="#cb85-364" tabindex="-1"></a><span class="co">#&gt;              Dim.1        Dim.2          Dim.3</span></span>
<span id="cb85-365"><a href="#cb85-365" tabindex="-1"></a><span class="co">#&gt; 1   0.710132531677 0.1208193508 0.001553470838</span></span>
<span id="cb85-366"><a href="#cb85-366" tabindex="-1"></a><span class="co">#&gt; 2   0.494663065848 0.0084234406 0.317718031367</span></span>
<span id="cb85-367"><a href="#cb85-367" tabindex="-1"></a><span class="co">#&gt; 3   0.620093143078 0.0859694752 0.077293909029</span></span>
<span id="cb85-368"><a href="#cb85-368" tabindex="-1"></a><span class="co">#&gt; 4   0.614376885232 0.3059983651 0.001221969551</span></span>
<span id="cb85-369"><a href="#cb85-369" tabindex="-1"></a><span class="co">#&gt; 5   0.230576205622 0.0876536563 0.477676790684</span></span>
<span id="cb85-370"><a href="#cb85-370" tabindex="-1"></a><span class="co">#&gt; 6   0.634513636960 0.2663051950 0.023220524968</span></span>
<span id="cb85-371"><a href="#cb85-371" tabindex="-1"></a><span class="co">#&gt; 7   0.585355713819 0.1075825081 0.073905257766</span></span>
<span id="cb85-372"><a href="#cb85-372" tabindex="-1"></a><span class="co">#&gt; 8   0.451539842647 0.2047378917 0.001674216386</span></span>
<span id="cb85-373"><a href="#cb85-373" tabindex="-1"></a><span class="co">#&gt; 9   0.561323589111 0.0612292949 0.225314362042</span></span>
<span id="cb85-374"><a href="#cb85-374" tabindex="-1"></a><span class="co">#&gt; 10  0.740835777254 0.0520072091 0.079362827272</span></span>
<span id="cb85-375"><a href="#cb85-375" tabindex="-1"></a><span class="co">#&gt; 11  0.751708646894 0.0956890875 0.009886461341</span></span>
<span id="cb85-376"><a href="#cb85-376" tabindex="-1"></a><span class="co">#&gt; 12  0.469958771741 0.0396706707 0.149941292604</span></span>
<span id="cb85-377"><a href="#cb85-377" tabindex="-1"></a><span class="co">#&gt; 13  0.603840463055 0.0467525975 0.076082403751</span></span>
<span id="cb85-378"><a href="#cb85-378" tabindex="-1"></a><span class="co">#&gt; 14  0.531596271531 0.0512070940 0.057090400707</span></span>
<span id="cb85-379"><a href="#cb85-379" tabindex="-1"></a><span class="co">#&gt; 15  0.657953445043 0.1485315637 0.053158778335</span></span>
<span id="cb85-380"><a href="#cb85-380" tabindex="-1"></a><span class="co">#&gt; 16  0.516467915988 0.2107008727 0.003591432085</span></span>
<span id="cb85-381"><a href="#cb85-381" tabindex="-1"></a><span class="co">#&gt; 17  0.447818728892 0.3970512305 0.050537067015</span></span>
<span id="cb85-382"><a href="#cb85-382" tabindex="-1"></a><span class="co">#&gt; 18  0.464208736268 0.2499532040 0.059126764320</span></span>
<span id="cb85-383"><a href="#cb85-383" tabindex="-1"></a><span class="co">#&gt; 19  0.564779875675 0.2578072718 0.009482563979</span></span>
<span id="cb85-384"><a href="#cb85-384" tabindex="-1"></a><span class="co">#&gt; 20  0.517235782902 0.1022493727 0.002446845099</span></span>
<span id="cb85-385"><a href="#cb85-385" tabindex="-1"></a><span class="co">#&gt; 21  0.724910449533 0.0412632594 0.008619665678</span></span>
<span id="cb85-386"><a href="#cb85-386" tabindex="-1"></a><span class="co">#&gt; 22  0.286983680336 0.0075417754 0.114632589635</span></span>
<span id="cb85-387"><a href="#cb85-387" tabindex="-1"></a><span class="co">#&gt; 23  0.785535019758 0.0007405186 0.009558493980</span></span>
<span id="cb85-388"><a href="#cb85-388" tabindex="-1"></a><span class="co">#&gt; 24  0.581256740793 0.0383353352 0.002959663704</span></span>
<span id="cb85-389"><a href="#cb85-389" tabindex="-1"></a><span class="co">#&gt; 25  0.569311415845 0.0127046249 0.100785780270</span></span>
<span id="cb85-390"><a href="#cb85-390" tabindex="-1"></a><span class="co">#&gt; 26  0.095458191292 0.0430233674 0.713176355361</span></span>
<span id="cb85-391"><a href="#cb85-391" tabindex="-1"></a><span class="co">#&gt; 27  0.528168949315 0.0547910794 0.000887424865</span></span>
<span id="cb85-392"><a href="#cb85-392" tabindex="-1"></a><span class="co">#&gt; 28  0.359024138746 0.0011242791 0.260357770324</span></span>
<span id="cb85-393"><a href="#cb85-393" tabindex="-1"></a><span class="co">#&gt; 29  0.578527026880 0.0441531756 0.178820606139</span></span>
<span id="cb85-394"><a href="#cb85-394" tabindex="-1"></a><span class="co">#&gt; 30  0.699635016498 0.0040821532 0.127511311276</span></span>
<span id="cb85-395"><a href="#cb85-395" tabindex="-1"></a><span class="co">#&gt; 31  0.539192658813 0.1089676921 0.134803014865</span></span>
<span id="cb85-396"><a href="#cb85-396" tabindex="-1"></a><span class="co">#&gt; 32  0.636187594580 0.1613751146 0.008132593430</span></span>
<span id="cb85-397"><a href="#cb85-397" tabindex="-1"></a><span class="co">#&gt; 33  0.607191864575 0.0004335750 0.004314965428</span></span>
<span id="cb85-398"><a href="#cb85-398" tabindex="-1"></a><span class="co">#&gt; 34  0.298279656321 0.1580326335 0.081146351387</span></span>
<span id="cb85-399"><a href="#cb85-399" tabindex="-1"></a><span class="co">#&gt; 35  0.514170607507 0.0783245178 0.036935276385</span></span>
<span id="cb85-400"><a href="#cb85-400" tabindex="-1"></a><span class="co">#&gt; 36  0.788021067083 0.0051072246 0.032263614871</span></span>
<span id="cb85-401"><a href="#cb85-401" tabindex="-1"></a><span class="co">#&gt; 37  0.371655276973 0.0514564704 0.024884976584</span></span>
<span id="cb85-402"><a href="#cb85-402" tabindex="-1"></a><span class="co">#&gt; 38  0.454579477222 0.0024663248 0.000315593658</span></span>
<span id="cb85-403"><a href="#cb85-403" tabindex="-1"></a><span class="co">#&gt; 39  0.467192411295 0.0788787590 0.271311308255</span></span>
<span id="cb85-404"><a href="#cb85-404" tabindex="-1"></a><span class="co">#&gt; 40  0.386477053732 0.1616364970 0.005798762854</span></span>
<span id="cb85-405"><a href="#cb85-405" tabindex="-1"></a><span class="co">#&gt; 41  0.707557771654 0.0541938238 0.001215396415</span></span>
<span id="cb85-406"><a href="#cb85-406" tabindex="-1"></a><span class="co">#&gt; 42  0.168635121521 0.0037998840 0.084924541686</span></span>
<span id="cb85-407"><a href="#cb85-407" tabindex="-1"></a><span class="co">#&gt; 43  0.700775197479 0.0868337254 0.006244313726</span></span>
<span id="cb85-408"><a href="#cb85-408" tabindex="-1"></a><span class="co">#&gt; 44  0.140506822341 0.0182610194 0.007041681243</span></span>
<span id="cb85-409"><a href="#cb85-409" tabindex="-1"></a><span class="co">#&gt; 45  0.704461286640 0.0005475002 0.052676967898</span></span>
<span id="cb85-410"><a href="#cb85-410" tabindex="-1"></a><span class="co">#&gt; 46  0.217645225589 0.2900203338 0.000070430702</span></span>
<span id="cb85-411"><a href="#cb85-411" tabindex="-1"></a><span class="co">#&gt; 47  0.608529116944 0.0975637768 0.019793723612</span></span>
<span id="cb85-412"><a href="#cb85-412" tabindex="-1"></a><span class="co">#&gt; 48  0.732371557395 0.0334596709 0.104334856754</span></span>
<span id="cb85-413"><a href="#cb85-413" tabindex="-1"></a><span class="co">#&gt; 49  0.641159312892 0.1864025556 0.000391693089</span></span>
<span id="cb85-414"><a href="#cb85-414" tabindex="-1"></a><span class="co">#&gt; 50  0.607553089322 0.2145356803 0.028652540704</span></span>
<span id="cb85-415"><a href="#cb85-415" tabindex="-1"></a><span class="co">#&gt; 51  0.555176308935 0.0014928577 0.185477880299</span></span>
<span id="cb85-416"><a href="#cb85-416" tabindex="-1"></a><span class="co">#&gt; 52  0.717872594698 0.0418104772 0.000001827556</span></span>
<span id="cb85-417"><a href="#cb85-417" tabindex="-1"></a><span class="co">#&gt; 53  0.700756747290 0.1348475500 0.013832816934</span></span>
<span id="cb85-418"><a href="#cb85-418" tabindex="-1"></a><span class="co">#&gt; 54  0.514802881215 0.2821253190 0.009195115640</span></span>
<span id="cb85-419"><a href="#cb85-419" tabindex="-1"></a><span class="co">#&gt; 55  0.617075222875 0.1075693226 0.094659472382</span></span>
<span id="cb85-420"><a href="#cb85-420" tabindex="-1"></a><span class="co">#&gt; 56  0.646662522232 0.1555199804 0.023065603357</span></span>
<span id="cb85-421"><a href="#cb85-421" tabindex="-1"></a><span class="co">#&gt; 57  0.695171719811 0.1625797104 0.029193683238</span></span>
<span id="cb85-422"><a href="#cb85-422" tabindex="-1"></a><span class="co">#&gt; 58  0.624724184088 0.1490927217 0.006899181800</span></span>
<span id="cb85-423"><a href="#cb85-423" tabindex="-1"></a><span class="co">#&gt; 59  0.688459710817 0.1857333337 0.004968276196</span></span>
<span id="cb85-424"><a href="#cb85-424" tabindex="-1"></a><span class="co">#&gt; 60  0.022301601510 0.2759731423 0.612629590060</span></span>
<span id="cb85-425"><a href="#cb85-425" tabindex="-1"></a><span class="co">#&gt; 61  0.116450526529 0.1124311892 0.044710437512</span></span>
<span id="cb85-426"><a href="#cb85-426" tabindex="-1"></a><span class="co">#&gt; 62  0.252826117182 0.0605693106 0.222306546634</span></span>
<span id="cb85-427"><a href="#cb85-427" tabindex="-1"></a><span class="co">#&gt; 63  0.000016487434 0.1747678501 0.349095608259</span></span>
<span id="cb85-428"><a href="#cb85-428" tabindex="-1"></a><span class="co">#&gt; 64  0.261885498698 0.2853197528 0.000002188640</span></span>
<span id="cb85-429"><a href="#cb85-429" tabindex="-1"></a><span class="co">#&gt; 65  0.028757949734 0.3181902362 0.040108881360</span></span>
<span id="cb85-430"><a href="#cb85-430" tabindex="-1"></a><span class="co">#&gt; 66  0.130082854120 0.1195578227 0.068464952590</span></span>
<span id="cb85-431"><a href="#cb85-431" tabindex="-1"></a><span class="co">#&gt; 67  0.227036608087 0.1949952951 0.229216524663</span></span>
<span id="cb85-432"><a href="#cb85-432" tabindex="-1"></a><span class="co">#&gt; 68  0.001885878850 0.5407447631 0.105120518171</span></span>
<span id="cb85-433"><a href="#cb85-433" tabindex="-1"></a><span class="co">#&gt; 69  0.048322487508 0.0043413116 0.042913860462</span></span>
<span id="cb85-434"><a href="#cb85-434" tabindex="-1"></a><span class="co">#&gt; 70  0.098160217261 0.0627192916 0.049474830286</span></span>
<span id="cb85-435"><a href="#cb85-435" tabindex="-1"></a><span class="co">#&gt; 71  0.251516992879 0.0935076679 0.045876754296</span></span>
<span id="cb85-436"><a href="#cb85-436" tabindex="-1"></a><span class="co">#&gt; 72  0.143530978068 0.0579412823 0.246155347915</span></span>
<span id="cb85-437"><a href="#cb85-437" tabindex="-1"></a><span class="co">#&gt; 73  0.071516166218 0.1689987538 0.000946899804</span></span>
<span id="cb85-438"><a href="#cb85-438" tabindex="-1"></a><span class="co">#&gt; 74  0.182421941045 0.0025963901 0.393421648760</span></span>
<span id="cb85-439"><a href="#cb85-439" tabindex="-1"></a><span class="co">#&gt; 75  0.240386558136 0.1468741871 0.019070065568</span></span>
<span id="cb85-440"><a href="#cb85-440" tabindex="-1"></a><span class="co">#&gt; 76  0.057438402581 0.5007360637 0.204360033962</span></span>
<span id="cb85-441"><a href="#cb85-441" tabindex="-1"></a><span class="co">#&gt; 77  0.006849338315 0.3511833025 0.455105185824</span></span>
<span id="cb85-442"><a href="#cb85-442" tabindex="-1"></a><span class="co">#&gt; 78  0.227652344459 0.2375083915 0.006403946518</span></span>
<span id="cb85-443"><a href="#cb85-443" tabindex="-1"></a><span class="co">#&gt; 79  0.065019168743 0.0314840425 0.075655556674</span></span>
<span id="cb85-444"><a href="#cb85-444" tabindex="-1"></a><span class="co">#&gt; 80  0.012086668797 0.1245919350 0.382215835841</span></span>
<span id="cb85-445"><a href="#cb85-445" tabindex="-1"></a><span class="co">#&gt; 81  0.032822654417 0.8276455797 0.009270909373</span></span>
<span id="cb85-446"><a href="#cb85-446" tabindex="-1"></a><span class="co">#&gt; 82  0.196256369278 0.4799455805 0.030146048544</span></span>
<span id="cb85-447"><a href="#cb85-447" tabindex="-1"></a><span class="co">#&gt; 83  0.018804988117 0.4888670943 0.153343679041</span></span>
<span id="cb85-448"><a href="#cb85-448" tabindex="-1"></a><span class="co">#&gt; 84  0.521852403472 0.0009446910 0.021026772401</span></span>
<span id="cb85-449"><a href="#cb85-449" tabindex="-1"></a><span class="co">#&gt; 85  0.051042940992 0.2132449531 0.036995424146</span></span>
<span id="cb85-450"><a href="#cb85-450" tabindex="-1"></a><span class="co">#&gt; 86  0.075691727721 0.6348566853 0.010021535889</span></span>
<span id="cb85-451"><a href="#cb85-451" tabindex="-1"></a><span class="co">#&gt; 87  0.065385446574 0.5599517787 0.066690863535</span></span>
<span id="cb85-452"><a href="#cb85-452" tabindex="-1"></a><span class="co">#&gt; 88  0.019066663201 0.3855802002 0.363586483486</span></span>
<span id="cb85-453"><a href="#cb85-453" tabindex="-1"></a><span class="co">#&gt; 89  0.149415225348 0.4533362307 0.127368248790</span></span>
<span id="cb85-454"><a href="#cb85-454" tabindex="-1"></a><span class="co">#&gt; 90  0.023048282860 0.5999022225 0.061026473680</span></span>
<span id="cb85-455"><a href="#cb85-455" tabindex="-1"></a><span class="co">#&gt; 91  0.173081180783 0.4973966695 0.000262711129</span></span>
<span id="cb85-456"><a href="#cb85-456" tabindex="-1"></a><span class="co">#&gt; 92  0.243344826109 0.3944272802 0.069370217335</span></span>
<span id="cb85-457"><a href="#cb85-457" tabindex="-1"></a><span class="co">#&gt; 93  0.306876545938 0.2354941751 0.000790113604</span></span>
<span id="cb85-458"><a href="#cb85-458" tabindex="-1"></a><span class="co">#&gt; 94  0.047889004888 0.5979258908 0.001499016010</span></span>
<span id="cb85-459"><a href="#cb85-459" tabindex="-1"></a><span class="co">#&gt; 95  0.066075041640 0.4647677173 0.001951074668</span></span>
<span id="cb85-460"><a href="#cb85-460" tabindex="-1"></a><span class="co">#&gt; 96  0.160702341273 0.0010670496 0.019714175985</span></span>
<span id="cb85-461"><a href="#cb85-461" tabindex="-1"></a><span class="co">#&gt; 97  0.017763359350 0.0078887750 0.098689961283</span></span>
<span id="cb85-462"><a href="#cb85-462" tabindex="-1"></a><span class="co">#&gt; 98  0.085195212903 0.6667387984 0.119884695326</span></span>
<span id="cb85-463"><a href="#cb85-463" tabindex="-1"></a><span class="co">#&gt; 99  0.336545139630 0.1661802363 0.004283744464</span></span>
<span id="cb85-464"><a href="#cb85-464" tabindex="-1"></a><span class="co">#&gt; 100 0.099154041358 0.2885128730 0.034841446709</span></span>
<span id="cb85-465"><a href="#cb85-465" tabindex="-1"></a><span class="co">#&gt; 101 0.043867623765 0.5017879877 0.219018183505</span></span>
<span id="cb85-466"><a href="#cb85-466" tabindex="-1"></a><span class="co">#&gt; 102 0.030215923780 0.5648718503 0.240956255847</span></span>
<span id="cb85-467"><a href="#cb85-467" tabindex="-1"></a><span class="co">#&gt; 103 0.006139976749 0.2683216900 0.199322625247</span></span>
<span id="cb85-468"><a href="#cb85-468" tabindex="-1"></a><span class="co">#&gt; 104 0.042368428175 0.7377990645 0.060011054593</span></span>
<span id="cb85-469"><a href="#cb85-469" tabindex="-1"></a><span class="co">#&gt; 105 0.016586670727 0.6392387026 0.032332136644</span></span>
<span id="cb85-470"><a href="#cb85-470" tabindex="-1"></a><span class="co">#&gt; 106 0.211992248617 0.2356781463 0.070699023808</span></span>
<span id="cb85-471"><a href="#cb85-471" tabindex="-1"></a><span class="co">#&gt; 107 0.019112465248 0.6996155668 0.034420539338</span></span>
<span id="cb85-472"><a href="#cb85-472" tabindex="-1"></a><span class="co">#&gt; 108 0.321546222032 0.2610275750 0.011488598688</span></span>
<span id="cb85-473"><a href="#cb85-473" tabindex="-1"></a><span class="co">#&gt; 109 0.000102423659 0.6008935225 0.024240738544</span></span>
<span id="cb85-474"><a href="#cb85-474" tabindex="-1"></a><span class="co">#&gt; 110 0.172632171269 0.1834875845 0.275765429459</span></span>
<span id="cb85-475"><a href="#cb85-475" tabindex="-1"></a><span class="co">#&gt; 111 0.054931779675 0.0733797209 0.000746685346</span></span>
<span id="cb85-476"><a href="#cb85-476" tabindex="-1"></a><span class="co">#&gt; 112 0.012295188821 0.5515017626 0.000918263749</span></span>
<span id="cb85-477"><a href="#cb85-477" tabindex="-1"></a><span class="co">#&gt; 113 0.102850475756 0.0426758632 0.286950109478</span></span>
<span id="cb85-478"><a href="#cb85-478" tabindex="-1"></a><span class="co">#&gt; 114 0.020991536670 0.5307313509 0.115882413417</span></span>
<span id="cb85-479"><a href="#cb85-479" tabindex="-1"></a><span class="co">#&gt; 115 0.025716380349 0.4352518150 0.202303476470</span></span>
<span id="cb85-480"><a href="#cb85-480" tabindex="-1"></a><span class="co">#&gt; 116 0.007281768669 0.6082516655 0.073449990658</span></span>
<span id="cb85-481"><a href="#cb85-481" tabindex="-1"></a><span class="co">#&gt; 117 0.007061562801 0.8044356457 0.009238798641</span></span>
<span id="cb85-482"><a href="#cb85-482" tabindex="-1"></a><span class="co">#&gt; 118 0.002891609318 0.5689437086 0.072947816510</span></span>
<span id="cb85-483"><a href="#cb85-483" tabindex="-1"></a><span class="co">#&gt; 119 0.372542355956 0.1184971033 0.266906842473</span></span>
<span id="cb85-484"><a href="#cb85-484" tabindex="-1"></a><span class="co">#&gt; 120 0.030811372097 0.5411454420 0.013890599477</span></span>
<span id="cb85-485"><a href="#cb85-485" tabindex="-1"></a><span class="co">#&gt; 121 0.050964078673 0.2443564280 0.157240241830</span></span>
<span id="cb85-486"><a href="#cb85-486" tabindex="-1"></a><span class="co">#&gt; 122 0.036873530210 0.0017921680 0.751553072276</span></span>
<span id="cb85-487"><a href="#cb85-487" tabindex="-1"></a><span class="co">#&gt; 123 0.085528334000 0.0312751897 0.632127166456</span></span>
<span id="cb85-488"><a href="#cb85-488" tabindex="-1"></a><span class="co">#&gt; 124 0.012280323386 0.0224147249 0.013646583713</span></span>
<span id="cb85-489"><a href="#cb85-489" tabindex="-1"></a><span class="co">#&gt; 125 0.034442591681 0.0996148982 0.105801869011</span></span>
<span id="cb85-490"><a href="#cb85-490" tabindex="-1"></a><span class="co">#&gt; 126 0.001837000014 0.6018169937 0.025584857807</span></span>
<span id="cb85-491"><a href="#cb85-491" tabindex="-1"></a><span class="co">#&gt; 127 0.000006625347 0.2101361756 0.062146508657</span></span>
<span id="cb85-492"><a href="#cb85-492" tabindex="-1"></a><span class="co">#&gt; 128 0.130643669496 0.0863394531 0.659623039150</span></span>
<span id="cb85-493"><a href="#cb85-493" tabindex="-1"></a><span class="co">#&gt; 129 0.028579918060 0.4696345451 0.209738558591</span></span>
<span id="cb85-494"><a href="#cb85-494" tabindex="-1"></a><span class="co">#&gt; 130 0.290253072127 0.1408019001 0.064001484786</span></span>
<span id="cb85-495"><a href="#cb85-495" tabindex="-1"></a><span class="co">#&gt; 131 0.212207889430 0.0019902692 0.093185116361</span></span>
<span id="cb85-496"><a href="#cb85-496" tabindex="-1"></a><span class="co">#&gt; 132 0.598214811335 0.0109439721 0.041666990525</span></span>
<span id="cb85-497"><a href="#cb85-497" tabindex="-1"></a><span class="co">#&gt; 133 0.676934917127 0.0042408619 0.001799156943</span></span>
<span id="cb85-498"><a href="#cb85-498" tabindex="-1"></a><span class="co">#&gt; 134 0.463895162733 0.0097053558 0.014853934274</span></span>
<span id="cb85-499"><a href="#cb85-499" tabindex="-1"></a><span class="co">#&gt; 135 0.504546699806 0.0147485237 0.083191789299</span></span>
<span id="cb85-500"><a href="#cb85-500" tabindex="-1"></a><span class="co">#&gt; 136 0.713344931210 0.0075952133 0.076952182741</span></span>
<span id="cb85-501"><a href="#cb85-501" tabindex="-1"></a><span class="co">#&gt; 137 0.786323507264 0.0009351635 0.002248467111</span></span>
<span id="cb85-502"><a href="#cb85-502" tabindex="-1"></a><span class="co">#&gt; 138 0.690578438493 0.0168454182 0.117662135971</span></span>
<span id="cb85-503"><a href="#cb85-503" tabindex="-1"></a><span class="co">#&gt; 139 0.761680827911 0.0077912256 0.071036759422</span></span>
<span id="cb85-504"><a href="#cb85-504" tabindex="-1"></a><span class="co">#&gt; 140 0.645251329450 0.0072467118 0.135146069906</span></span>
<span id="cb85-505"><a href="#cb85-505" tabindex="-1"></a><span class="co">#&gt; 141 0.738342305585 0.0061274672 0.028999506774</span></span>
<span id="cb85-506"><a href="#cb85-506" tabindex="-1"></a><span class="co">#&gt; 142 0.610495281204 0.0120048537 0.083632608935</span></span>
<span id="cb85-507"><a href="#cb85-507" tabindex="-1"></a><span class="co">#&gt; 143 0.681032565989 0.0148269563 0.057304920643</span></span>
<span id="cb85-508"><a href="#cb85-508" tabindex="-1"></a><span class="co">#&gt; 144 0.564510184772 0.0176020248 0.004959159048</span></span>
<span id="cb85-509"><a href="#cb85-509" tabindex="-1"></a><span class="co">#&gt; 145 0.444713990395 0.0887674363 0.102626321549</span></span>
<span id="cb85-510"><a href="#cb85-510" tabindex="-1"></a><span class="co">#&gt; 146 0.678052433350 0.0241840928 0.056952548645</span></span>
<span id="cb85-511"><a href="#cb85-511" tabindex="-1"></a><span class="co">#&gt; 147 0.704093072627 0.0142973577 0.075447092114</span></span>
<span id="cb85-512"><a href="#cb85-512" tabindex="-1"></a><span class="co">#&gt; 148 0.785799621696 0.0854064208 0.000670804042</span></span>
<span id="cb85-513"><a href="#cb85-513" tabindex="-1"></a><span class="co">#&gt; 149 0.724345371742 0.1805987402 0.016485868606</span></span>
<span id="cb85-514"><a href="#cb85-514" tabindex="-1"></a><span class="co">#&gt; 150 0.572924649990 0.2268335298 0.013462769066</span></span>
<span id="cb85-515"><a href="#cb85-515" tabindex="-1"></a><span class="co">#&gt; 151 0.349576229164 0.2632419941 0.009131197642</span></span>
<span id="cb85-516"><a href="#cb85-516" tabindex="-1"></a><span class="co">#&gt; 152 0.411786494939 0.1998891048 0.004651888806</span></span>
<span id="cb85-517"><a href="#cb85-517" tabindex="-1"></a><span class="co">#&gt; 153 0.293178851586 0.1351428100 0.107654554609</span></span>
<span id="cb85-518"><a href="#cb85-518" tabindex="-1"></a><span class="co">#&gt; 154 0.471870987819 0.2238677645 0.045772927908</span></span>
<span id="cb85-519"><a href="#cb85-519" tabindex="-1"></a><span class="co">#&gt; 155 0.586236261182 0.0101464925 0.087725211116</span></span>
<span id="cb85-520"><a href="#cb85-520" tabindex="-1"></a><span class="co">#&gt; 156 0.657662796061 0.1420491324 0.000399796174</span></span>
<span id="cb85-521"><a href="#cb85-521" tabindex="-1"></a><span class="co">#&gt; 157 0.588094251098 0.2103673298 0.034996048657</span></span>
<span id="cb85-522"><a href="#cb85-522" tabindex="-1"></a><span class="co">#&gt; 158 0.634330376237 0.0804140811 0.121480119970</span></span>
<span id="cb85-523"><a href="#cb85-523" tabindex="-1"></a><span class="co">#&gt; 159 0.076303030269 0.3918076829 0.042684441211</span></span>
<span id="cb85-524"><a href="#cb85-524" tabindex="-1"></a><span class="co">#&gt; 160 0.192364399326 0.2632004245 0.013712236005</span></span>
<span id="cb85-525"><a href="#cb85-525" tabindex="-1"></a><span class="co">#&gt; 161 0.760254107050 0.0343263127 0.000538160432</span></span>
<span id="cb85-526"><a href="#cb85-526" tabindex="-1"></a><span class="co">#&gt; 162 0.591241987377 0.1214305389 0.000918880450</span></span>
<span id="cb85-527"><a href="#cb85-527" tabindex="-1"></a><span class="co">#&gt; 163 0.758165143134 0.0231127284 0.049490050917</span></span>
<span id="cb85-528"><a href="#cb85-528" tabindex="-1"></a><span class="co">#&gt; 164 0.745439293148 0.0417951245 0.068257820856</span></span>
<span id="cb85-529"><a href="#cb85-529" tabindex="-1"></a><span class="co">#&gt; 165 0.652473082064 0.1470679875 0.059360896592</span></span>
<span id="cb85-530"><a href="#cb85-530" tabindex="-1"></a><span class="co">#&gt; 166 0.791587064578 0.0422112055 0.012108576292</span></span>
<span id="cb85-531"><a href="#cb85-531" tabindex="-1"></a><span class="co">#&gt; 167 0.452106085510 0.3935248405 0.010773061693</span></span>
<span id="cb85-532"><a href="#cb85-532" tabindex="-1"></a><span class="co">#&gt; 168 0.653920755042 0.0999725304 0.091622024512</span></span>
<span id="cb85-533"><a href="#cb85-533" tabindex="-1"></a><span class="co">#&gt; 169 0.476170993825 0.3118911298 0.042289065914</span></span>
<span id="cb85-534"><a href="#cb85-534" tabindex="-1"></a><span class="co">#&gt; 170 0.367624981840 0.3251590266 0.097863924201</span></span>
<span id="cb85-535"><a href="#cb85-535" tabindex="-1"></a><span class="co">#&gt; 171 0.842712124624 0.0046532097 0.049688558793</span></span>
<span id="cb85-536"><a href="#cb85-536" tabindex="-1"></a><span class="co">#&gt; 172 0.731995652083 0.0332522324 0.085186333972</span></span>
<span id="cb85-537"><a href="#cb85-537" tabindex="-1"></a><span class="co">#&gt; 173 0.495867010383 0.2998823115 0.052835161978</span></span>
<span id="cb85-538"><a href="#cb85-538" tabindex="-1"></a><span class="co">#&gt; 174 0.596902474236 0.2208193191 0.005358333504</span></span>
<span id="cb85-539"><a href="#cb85-539" tabindex="-1"></a><span class="co">#&gt; 175 0.690828787196 0.2449481376 0.003432721280</span></span>
<span id="cb85-540"><a href="#cb85-540" tabindex="-1"></a><span class="co">#&gt; 176 0.444100826745 0.3680868277 0.042893922796</span></span>
<span id="cb85-541"><a href="#cb85-541" tabindex="-1"></a><span class="co">#&gt; 177 0.454626098370 0.3150965584 0.018148738368</span></span>
<span id="cb85-542"><a href="#cb85-542" tabindex="-1"></a><span class="co">#&gt; 178 0.532260921975 0.3318323144 0.044685225360</span></span>
<span id="cb85-543"><a href="#cb85-543" tabindex="-1"></a><span class="co">#&gt;                   Dim.4           Dim.5</span></span>
<span id="cb85-544"><a href="#cb85-544" tabindex="-1"></a><span class="co">#&gt; 1   0.00001109693650833 0.0311064433257</span></span>
<span id="cb85-545"><a href="#cb85-545" tabindex="-1"></a><span class="co">#&gt; 2   0.01342901319222555 0.0062231628265</span></span>
<span id="cb85-546"><a href="#cb85-546" tabindex="-1"></a><span class="co">#&gt; 3   0.03528819568321861 0.0119730796585</span></span>
<span id="cb85-547"><a href="#cb85-547" tabindex="-1"></a><span class="co">#&gt; 4   0.01276522111679494 0.0041901628670</span></span>
<span id="cb85-548"><a href="#cb85-548" tabindex="-1"></a><span class="co">#&gt; 5   0.02265150214418492 0.0060250559009</span></span>
<span id="cb85-549"><a href="#cb85-549" tabindex="-1"></a><span class="co">#&gt; 6   0.02148526328629995 0.0098725789473</span></span>
<span id="cb85-550"><a href="#cb85-550" tabindex="-1"></a><span class="co">#&gt; 7   0.00962569108770850 0.0812264781382</span></span>
<span id="cb85-551"><a href="#cb85-551" tabindex="-1"></a><span class="co">#&gt; 8   0.12239068373766034 0.0033562017862</span></span>
<span id="cb85-552"><a href="#cb85-552" tabindex="-1"></a><span class="co">#&gt; 9   0.00174960290077589 0.0529539830093</span></span>
<span id="cb85-553"><a href="#cb85-553" tabindex="-1"></a><span class="co">#&gt; 10  0.00601585831958939 0.0182439556099</span></span>
<span id="cb85-554"><a href="#cb85-554" tabindex="-1"></a><span class="co">#&gt; 11  0.00000023106844788 0.0037463763085</span></span>
<span id="cb85-555"><a href="#cb85-555" tabindex="-1"></a><span class="co">#&gt; 12  0.12733921823221608 0.0329768542178</span></span>
<span id="cb85-556"><a href="#cb85-556" tabindex="-1"></a><span class="co">#&gt; 13  0.04395572882146736 0.1202760772866</span></span>
<span id="cb85-557"><a href="#cb85-557" tabindex="-1"></a><span class="co">#&gt; 14  0.00208263178524840 0.1308700984289</span></span>
<span id="cb85-558"><a href="#cb85-558" tabindex="-1"></a><span class="co">#&gt; 15  0.00139494836961541 0.0237699899155</span></span>
<span id="cb85-559"><a href="#cb85-559" tabindex="-1"></a><span class="co">#&gt; 16  0.17496325832725160 0.0007724219125</span></span>
<span id="cb85-560"><a href="#cb85-560" tabindex="-1"></a><span class="co">#&gt; 17  0.05888546721890082 0.0032310651492</span></span>
<span id="cb85-561"><a href="#cb85-561" tabindex="-1"></a><span class="co">#&gt; 18  0.12391818973454741 0.0016193227863</span></span>
<span id="cb85-562"><a href="#cb85-562" tabindex="-1"></a><span class="co">#&gt; 19  0.04481995415564418 0.0210924242879</span></span>
<span id="cb85-563"><a href="#cb85-563" tabindex="-1"></a><span class="co">#&gt; 20  0.02900014773970389 0.0260688912734</span></span>
<span id="cb85-564"><a href="#cb85-564" tabindex="-1"></a><span class="co">#&gt; 21  0.00394035765864483 0.0611250719105</span></span>
<span id="cb85-565"><a href="#cb85-565" tabindex="-1"></a><span class="co">#&gt; 22  0.10589431131417362 0.0057150867587</span></span>
<span id="cb85-566"><a href="#cb85-566" tabindex="-1"></a><span class="co">#&gt; 23  0.00418590340722596 0.0233718988769</span></span>
<span id="cb85-567"><a href="#cb85-567" tabindex="-1"></a><span class="co">#&gt; 24  0.04815412485318474 0.0205261601627</span></span>
<span id="cb85-568"><a href="#cb85-568" tabindex="-1"></a><span class="co">#&gt; 25  0.01395036085989178 0.0496238313990</span></span>
<span id="cb85-569"><a href="#cb85-569" tabindex="-1"></a><span class="co">#&gt; 26  0.08881529642911046 0.0056957633762</span></span>
<span id="cb85-570"><a href="#cb85-570" tabindex="-1"></a><span class="co">#&gt; 27  0.03834875947203876 0.1484486584563</span></span>
<span id="cb85-571"><a href="#cb85-571" tabindex="-1"></a><span class="co">#&gt; 28  0.06142245859358510 0.0190495257408</span></span>
<span id="cb85-572"><a href="#cb85-572" tabindex="-1"></a><span class="co">#&gt; 29  0.08953357644968295 0.0367868469029</span></span>
<span id="cb85-573"><a href="#cb85-573" tabindex="-1"></a><span class="co">#&gt; 30  0.00187171901298384 0.0352870760402</span></span>
<span id="cb85-574"><a href="#cb85-574" tabindex="-1"></a><span class="co">#&gt; 31  0.01398449008397998 0.0118444009409</span></span>
<span id="cb85-575"><a href="#cb85-575" tabindex="-1"></a><span class="co">#&gt; 32  0.00761823287486043 0.0002429612954</span></span>
<span id="cb85-576"><a href="#cb85-576" tabindex="-1"></a><span class="co">#&gt; 33  0.13356403534286462 0.0365294984364</span></span>
<span id="cb85-577"><a href="#cb85-577" tabindex="-1"></a><span class="co">#&gt; 34  0.32826580608851064 0.0072207397484</span></span>
<span id="cb85-578"><a href="#cb85-578" tabindex="-1"></a><span class="co">#&gt; 35  0.19507506457245094 0.0080057599707</span></span>
<span id="cb85-579"><a href="#cb85-579" tabindex="-1"></a><span class="co">#&gt; 36  0.00650188005514974 0.0118252077505</span></span>
<span id="cb85-580"><a href="#cb85-580" tabindex="-1"></a><span class="co">#&gt; 37  0.22866390627543945 0.0000002314987</span></span>
<span id="cb85-581"><a href="#cb85-581" tabindex="-1"></a><span class="co">#&gt; 38  0.23673165828411211 0.0082844725969</span></span>
<span id="cb85-582"><a href="#cb85-582" tabindex="-1"></a><span class="co">#&gt; 39  0.09520684063262400 0.0005865038189</span></span>
<span id="cb85-583"><a href="#cb85-583" tabindex="-1"></a><span class="co">#&gt; 40  0.08912559011109496 0.0272221556127</span></span>
<span id="cb85-584"><a href="#cb85-584" tabindex="-1"></a><span class="co">#&gt; 41  0.03169538999207772 0.0092501073692</span></span>
<span id="cb85-585"><a href="#cb85-585" tabindex="-1"></a><span class="co">#&gt; 42  0.13222553340314033 0.1301162829453</span></span>
<span id="cb85-586"><a href="#cb85-586" tabindex="-1"></a><span class="co">#&gt; 43  0.01324637473423403 0.0129625290325</span></span>
<span id="cb85-587"><a href="#cb85-587" tabindex="-1"></a><span class="co">#&gt; 44  0.26836933970597032 0.0255712417162</span></span>
<span id="cb85-588"><a href="#cb85-588" tabindex="-1"></a><span class="co">#&gt; 45  0.08668374646598651 0.0076052514806</span></span>
<span id="cb85-589"><a href="#cb85-589" tabindex="-1"></a><span class="co">#&gt; 46  0.01832171119524590 0.0266252601722</span></span>
<span id="cb85-590"><a href="#cb85-590" tabindex="-1"></a><span class="co">#&gt; 47  0.09264053569553868 0.0576847541967</span></span>
<span id="cb85-591"><a href="#cb85-591" tabindex="-1"></a><span class="co">#&gt; 48  0.07784779963274134 0.0031621767132</span></span>
<span id="cb85-592"><a href="#cb85-592" tabindex="-1"></a><span class="co">#&gt; 49  0.00231784384054796 0.0195014095302</span></span>
<span id="cb85-593"><a href="#cb85-593" tabindex="-1"></a><span class="co">#&gt; 50  0.00146969705335166 0.0080879011141</span></span>
<span id="cb85-594"><a href="#cb85-594" tabindex="-1"></a><span class="co">#&gt; 51  0.06927890064211002 0.0005189130182</span></span>
<span id="cb85-595"><a href="#cb85-595" tabindex="-1"></a><span class="co">#&gt; 52  0.00991388837444574 0.0299911421743</span></span>
<span id="cb85-596"><a href="#cb85-596" tabindex="-1"></a><span class="co">#&gt; 53  0.00008118496306662 0.0124305917217</span></span>
<span id="cb85-597"><a href="#cb85-597" tabindex="-1"></a><span class="co">#&gt; 54  0.14159894487254510 0.0061658998179</span></span>
<span id="cb85-598"><a href="#cb85-598" tabindex="-1"></a><span class="co">#&gt; 55  0.00035850307894080 0.0723395526174</span></span>
<span id="cb85-599"><a href="#cb85-599" tabindex="-1"></a><span class="co">#&gt; 56  0.02249366785765629 0.0645430048658</span></span>
<span id="cb85-600"><a href="#cb85-600" tabindex="-1"></a><span class="co">#&gt; 57  0.00860637004084596 0.0121622394001</span></span>
<span id="cb85-601"><a href="#cb85-601" tabindex="-1"></a><span class="co">#&gt; 58  0.04667711157756211 0.0325952081808</span></span>
<span id="cb85-602"><a href="#cb85-602" tabindex="-1"></a><span class="co">#&gt; 59  0.00611201527575084 0.0007847933901</span></span>
<span id="cb85-603"><a href="#cb85-603" tabindex="-1"></a><span class="co">#&gt; 60  0.02680509862245115 0.0115085418660</span></span>
<span id="cb85-604"><a href="#cb85-604" tabindex="-1"></a><span class="co">#&gt; 61  0.55901517604552187 0.0044956542738</span></span>
<span id="cb85-605"><a href="#cb85-605" tabindex="-1"></a><span class="co">#&gt; 62  0.19925469533252499 0.0001806722377</span></span>
<span id="cb85-606"><a href="#cb85-606" tabindex="-1"></a><span class="co">#&gt; 63  0.17231930148241656 0.0004256765064</span></span>
<span id="cb85-607"><a href="#cb85-607" tabindex="-1"></a><span class="co">#&gt; 64  0.06276502152701216 0.0001100930323</span></span>
<span id="cb85-608"><a href="#cb85-608" tabindex="-1"></a><span class="co">#&gt; 65  0.38846817848702886 0.0198231437769</span></span>
<span id="cb85-609"><a href="#cb85-609" tabindex="-1"></a><span class="co">#&gt; 66  0.06417072719031389 0.0109364374865</span></span>
<span id="cb85-610"><a href="#cb85-610" tabindex="-1"></a><span class="co">#&gt; 67  0.11349973693384666 0.0286202942569</span></span>
<span id="cb85-611"><a href="#cb85-611" tabindex="-1"></a><span class="co">#&gt; 68  0.00014825532339528 0.0209517588368</span></span>
<span id="cb85-612"><a href="#cb85-612" tabindex="-1"></a><span class="co">#&gt; 69  0.57438644477778311 0.0000372185832</span></span>
<span id="cb85-613"><a href="#cb85-613" tabindex="-1"></a><span class="co">#&gt; 70  0.00004946853815352 0.6415601023622</span></span>
<span id="cb85-614"><a href="#cb85-614" tabindex="-1"></a><span class="co">#&gt; 71  0.11342809901073035 0.1443677945594</span></span>
<span id="cb85-615"><a href="#cb85-615" tabindex="-1"></a><span class="co">#&gt; 72  0.00062659554887642 0.0234315761770</span></span>
<span id="cb85-616"><a href="#cb85-616" tabindex="-1"></a><span class="co">#&gt; 73  0.00357569266822635 0.0061866195918</span></span>
<span id="cb85-617"><a href="#cb85-617" tabindex="-1"></a><span class="co">#&gt; 74  0.00306916747389197 0.1893855933585</span></span>
<span id="cb85-618"><a href="#cb85-618" tabindex="-1"></a><span class="co">#&gt; 75  0.02803092831398564 0.1094180635999</span></span>
<span id="cb85-619"><a href="#cb85-619" tabindex="-1"></a><span class="co">#&gt; 76  0.03681796967138246 0.0598091652635</span></span>
<span id="cb85-620"><a href="#cb85-620" tabindex="-1"></a><span class="co">#&gt; 77  0.00000188117334660 0.0049710692255</span></span>
<span id="cb85-621"><a href="#cb85-621" tabindex="-1"></a><span class="co">#&gt; 78  0.03935523867067940 0.1178361328611</span></span>
<span id="cb85-622"><a href="#cb85-622" tabindex="-1"></a><span class="co">#&gt; 79  0.00070123269479112 0.4638754190846</span></span>
<span id="cb85-623"><a href="#cb85-623" tabindex="-1"></a><span class="co">#&gt; 80  0.09470036415226095 0.0208290437855</span></span>
<span id="cb85-624"><a href="#cb85-624" tabindex="-1"></a><span class="co">#&gt; 81  0.00617470981739513 0.0005011335870</span></span>
<span id="cb85-625"><a href="#cb85-625" tabindex="-1"></a><span class="co">#&gt; 82  0.01937443453030504 0.0164333119119</span></span>
<span id="cb85-626"><a href="#cb85-626" tabindex="-1"></a><span class="co">#&gt; 83  0.13296123538263963 0.0418503793951</span></span>
<span id="cb85-627"><a href="#cb85-627" tabindex="-1"></a><span class="co">#&gt; 84  0.00866883968662255 0.2020874365091</span></span>
<span id="cb85-628"><a href="#cb85-628" tabindex="-1"></a><span class="co">#&gt; 85  0.07800248662088959 0.0724643050404</span></span>
<span id="cb85-629"><a href="#cb85-629" tabindex="-1"></a><span class="co">#&gt; 86  0.06654961512685414 0.0442404121155</span></span>
<span id="cb85-630"><a href="#cb85-630" tabindex="-1"></a><span class="co">#&gt; 87  0.12410983714721587 0.0000212502371</span></span>
<span id="cb85-631"><a href="#cb85-631" tabindex="-1"></a><span class="co">#&gt; 88  0.08753856392638300 0.0029893243505</span></span>
<span id="cb85-632"><a href="#cb85-632" tabindex="-1"></a><span class="co">#&gt; 89  0.04300276226271264 0.0651256398673</span></span>
<span id="cb85-633"><a href="#cb85-633" tabindex="-1"></a><span class="co">#&gt; 90  0.00944958627814416 0.1388449235976</span></span>
<span id="cb85-634"><a href="#cb85-634" tabindex="-1"></a><span class="co">#&gt; 91  0.05659965880392803 0.0676272913494</span></span>
<span id="cb85-635"><a href="#cb85-635" tabindex="-1"></a><span class="co">#&gt; 92  0.06435708931235659 0.0160369562417</span></span>
<span id="cb85-636"><a href="#cb85-636" tabindex="-1"></a><span class="co">#&gt; 93  0.06885651480823600 0.1035755906019</span></span>
<span id="cb85-637"><a href="#cb85-637" tabindex="-1"></a><span class="co">#&gt; 94  0.18714483819574232 0.0003177722979</span></span>
<span id="cb85-638"><a href="#cb85-638" tabindex="-1"></a><span class="co">#&gt; 95  0.03385051278906828 0.0758741866359</span></span>
<span id="cb85-639"><a href="#cb85-639" tabindex="-1"></a><span class="co">#&gt; 96  0.00036153919665383 0.5229727965244</span></span>
<span id="cb85-640"><a href="#cb85-640" tabindex="-1"></a><span class="co">#&gt; 97  0.01443640334109459 0.6628364768094</span></span>
<span id="cb85-641"><a href="#cb85-641" tabindex="-1"></a><span class="co">#&gt; 98  0.01043125002817501 0.0009793748545</span></span>
<span id="cb85-642"><a href="#cb85-642" tabindex="-1"></a><span class="co">#&gt; 99  0.09349366867665626 0.0017270859288</span></span>
<span id="cb85-643"><a href="#cb85-643" tabindex="-1"></a><span class="co">#&gt; 100 0.07516005236117716 0.0419075784525</span></span>
<span id="cb85-644"><a href="#cb85-644" tabindex="-1"></a><span class="co">#&gt; 101 0.00235546022241677 0.0375108997898</span></span>
<span id="cb85-645"><a href="#cb85-645" tabindex="-1"></a><span class="co">#&gt; 102 0.00645238744311888 0.0132011122193</span></span>
<span id="cb85-646"><a href="#cb85-646" tabindex="-1"></a><span class="co">#&gt; 103 0.08780815216481934 0.0004077618653</span></span>
<span id="cb85-647"><a href="#cb85-647" tabindex="-1"></a><span class="co">#&gt; 104 0.02458520163437106 0.0000669162589</span></span>
<span id="cb85-648"><a href="#cb85-648" tabindex="-1"></a><span class="co">#&gt; 105 0.02026019048826954 0.0202256407176</span></span>
<span id="cb85-649"><a href="#cb85-649" tabindex="-1"></a><span class="co">#&gt; 106 0.00099290438261822 0.1092053035308</span></span>
<span id="cb85-650"><a href="#cb85-650" tabindex="-1"></a><span class="co">#&gt; 107 0.01065018664058786 0.0446726140745</span></span>
<span id="cb85-651"><a href="#cb85-651" tabindex="-1"></a><span class="co">#&gt; 108 0.00695723256294992 0.0504379224158</span></span>
<span id="cb85-652"><a href="#cb85-652" tabindex="-1"></a><span class="co">#&gt; 109 0.11670312560827135 0.0048062345067</span></span>
<span id="cb85-653"><a href="#cb85-653" tabindex="-1"></a><span class="co">#&gt; 110 0.05685847314074523 0.0086577147942</span></span>
<span id="cb85-654"><a href="#cb85-654" tabindex="-1"></a><span class="co">#&gt; 111 0.58655833171542249 0.0721431391013</span></span>
<span id="cb85-655"><a href="#cb85-655" tabindex="-1"></a><span class="co">#&gt; 112 0.12553506944909990 0.0003670545097</span></span>
<span id="cb85-656"><a href="#cb85-656" tabindex="-1"></a><span class="co">#&gt; 113 0.27496044698175942 0.0119460996520</span></span>
<span id="cb85-657"><a href="#cb85-657" tabindex="-1"></a><span class="co">#&gt; 114 0.07002381279720386 0.0000059235018</span></span>
<span id="cb85-658"><a href="#cb85-658" tabindex="-1"></a><span class="co">#&gt; 115 0.00852857176867321 0.0732858043619</span></span>
<span id="cb85-659"><a href="#cb85-659" tabindex="-1"></a><span class="co">#&gt; 116 0.03914894292372700 0.0098649215586</span></span>
<span id="cb85-660"><a href="#cb85-660" tabindex="-1"></a><span class="co">#&gt; 117 0.02839967187191638 0.0054954455174</span></span>
<span id="cb85-661"><a href="#cb85-661" tabindex="-1"></a><span class="co">#&gt; 118 0.00000000000218284 0.1829769513177</span></span>
<span id="cb85-662"><a href="#cb85-662" tabindex="-1"></a><span class="co">#&gt; 119 0.01998518626885830 0.0658641476086</span></span>
<span id="cb85-663"><a href="#cb85-663" tabindex="-1"></a><span class="co">#&gt; 120 0.17950559836899024 0.0080664980364</span></span>
<span id="cb85-664"><a href="#cb85-664" tabindex="-1"></a><span class="co">#&gt; 121 0.21401218918840612 0.0030629495752</span></span>
<span id="cb85-665"><a href="#cb85-665" tabindex="-1"></a><span class="co">#&gt; 122 0.00473191673022276 0.0032466660007</span></span>
<span id="cb85-666"><a href="#cb85-666" tabindex="-1"></a><span class="co">#&gt; 123 0.07686745606495253 0.0030177478834</span></span>
<span id="cb85-667"><a href="#cb85-667" tabindex="-1"></a><span class="co">#&gt; 124 0.65126571293913638 0.0598057710487</span></span>
<span id="cb85-668"><a href="#cb85-668" tabindex="-1"></a><span class="co">#&gt; 125 0.69924809668294785 0.0104173829785</span></span>
<span id="cb85-669"><a href="#cb85-669" tabindex="-1"></a><span class="co">#&gt; 126 0.11959707030174392 0.0441712207471</span></span>
<span id="cb85-670"><a href="#cb85-670" tabindex="-1"></a><span class="co">#&gt; 127 0.19406593803191921 0.0399099031496</span></span>
<span id="cb85-671"><a href="#cb85-671" tabindex="-1"></a><span class="co">#&gt; 128 0.00959337413272963 0.0199885705862</span></span>
<span id="cb85-672"><a href="#cb85-672" tabindex="-1"></a><span class="co">#&gt; 129 0.05624363410478354 0.0045962336408</span></span>
<span id="cb85-673"><a href="#cb85-673" tabindex="-1"></a><span class="co">#&gt; 130 0.13251967095526504 0.1290927541391</span></span>
<span id="cb85-674"><a href="#cb85-674" tabindex="-1"></a><span class="co">#&gt; 131 0.04411741713511243 0.4808388669989</span></span>
<span id="cb85-675"><a href="#cb85-675" tabindex="-1"></a><span class="co">#&gt; 132 0.00000506538804751 0.1383361748837</span></span>
<span id="cb85-676"><a href="#cb85-676" tabindex="-1"></a><span class="co">#&gt; 133 0.00118625359520107 0.0825804253586</span></span>
<span id="cb85-677"><a href="#cb85-677" tabindex="-1"></a><span class="co">#&gt; 134 0.01442605618700882 0.1830402608851</span></span>
<span id="cb85-678"><a href="#cb85-678" tabindex="-1"></a><span class="co">#&gt; 135 0.06519291993793436 0.0267003466703</span></span>
<span id="cb85-679"><a href="#cb85-679" tabindex="-1"></a><span class="co">#&gt; 136 0.04843780419723102 0.0138962775745</span></span>
<span id="cb85-680"><a href="#cb85-680" tabindex="-1"></a><span class="co">#&gt; 137 0.00318467764331492 0.0152597641671</span></span>
<span id="cb85-681"><a href="#cb85-681" tabindex="-1"></a><span class="co">#&gt; 138 0.00238540958048503 0.0298741769097</span></span>
<span id="cb85-682"><a href="#cb85-682" tabindex="-1"></a><span class="co">#&gt; 139 0.00961768213139881 0.0755443158532</span></span>
<span id="cb85-683"><a href="#cb85-683" tabindex="-1"></a><span class="co">#&gt; 140 0.05883182604950421 0.0035117689979</span></span>
<span id="cb85-684"><a href="#cb85-684" tabindex="-1"></a><span class="co">#&gt; 141 0.08411605708906489 0.0112750997726</span></span>
<span id="cb85-685"><a href="#cb85-685" tabindex="-1"></a><span class="co">#&gt; 142 0.01899335628935885 0.0062728694929</span></span>
<span id="cb85-686"><a href="#cb85-686" tabindex="-1"></a><span class="co">#&gt; 143 0.09599319417202373 0.0108254124592</span></span>
<span id="cb85-687"><a href="#cb85-687" tabindex="-1"></a><span class="co">#&gt; 144 0.01310181234236750 0.0629425400993</span></span>
<span id="cb85-688"><a href="#cb85-688" tabindex="-1"></a><span class="co">#&gt; 145 0.03322398266346774 0.1500305922923</span></span>
<span id="cb85-689"><a href="#cb85-689" tabindex="-1"></a><span class="co">#&gt; 146 0.01104871539819135 0.0178240187702</span></span>
<span id="cb85-690"><a href="#cb85-690" tabindex="-1"></a><span class="co">#&gt; 147 0.02246918278864736 0.0299292555671</span></span>
<span id="cb85-691"><a href="#cb85-691" tabindex="-1"></a><span class="co">#&gt; 148 0.03323759269151649 0.0435490237744</span></span>
<span id="cb85-692"><a href="#cb85-692" tabindex="-1"></a><span class="co">#&gt; 149 0.02422959085855231 0.0092994868843</span></span>
<span id="cb85-693"><a href="#cb85-693" tabindex="-1"></a><span class="co">#&gt; 150 0.03465087566363823 0.0843937191048</span></span>
<span id="cb85-694"><a href="#cb85-694" tabindex="-1"></a><span class="co">#&gt; 151 0.01312392114506781 0.2271509584259</span></span>
<span id="cb85-695"><a href="#cb85-695" tabindex="-1"></a><span class="co">#&gt; 152 0.03885830039301581 0.1518672411801</span></span>
<span id="cb85-696"><a href="#cb85-696" tabindex="-1"></a><span class="co">#&gt; 153 0.00817741867206889 0.2104253991370</span></span>
<span id="cb85-697"><a href="#cb85-697" tabindex="-1"></a><span class="co">#&gt; 154 0.01873212093149925 0.0113628586887</span></span>
<span id="cb85-698"><a href="#cb85-698" tabindex="-1"></a><span class="co">#&gt; 155 0.01102524763814177 0.0375262366788</span></span>
<span id="cb85-699"><a href="#cb85-699" tabindex="-1"></a><span class="co">#&gt; 156 0.04466535030819204 0.0437594012565</span></span>
<span id="cb85-700"><a href="#cb85-700" tabindex="-1"></a><span class="co">#&gt; 157 0.07539691040408766 0.0424366639802</span></span>
<span id="cb85-701"><a href="#cb85-701" tabindex="-1"></a><span class="co">#&gt; 158 0.01845698531374349 0.0113381554150</span></span>
<span id="cb85-702"><a href="#cb85-702" tabindex="-1"></a><span class="co">#&gt; 159 0.03219514743028885 0.0119708421435</span></span>
<span id="cb85-703"><a href="#cb85-703" tabindex="-1"></a><span class="co">#&gt; 160 0.02566085385511868 0.0249989872847</span></span>
<span id="cb85-704"><a href="#cb85-704" tabindex="-1"></a><span class="co">#&gt; 161 0.04563857282303965 0.0261190722028</span></span>
<span id="cb85-705"><a href="#cb85-705" tabindex="-1"></a><span class="co">#&gt; 162 0.12845260251365931 0.0000256521008</span></span>
<span id="cb85-706"><a href="#cb85-706" tabindex="-1"></a><span class="co">#&gt; 163 0.07139988152054805 0.0002941346756</span></span>
<span id="cb85-707"><a href="#cb85-707" tabindex="-1"></a><span class="co">#&gt; 164 0.00150220177691864 0.0455117278476</span></span>
<span id="cb85-708"><a href="#cb85-708" tabindex="-1"></a><span class="co">#&gt; 165 0.00009346792825272 0.0051537360382</span></span>
<span id="cb85-709"><a href="#cb85-709" tabindex="-1"></a><span class="co">#&gt; 166 0.00547547175956725 0.0447094775950</span></span>
<span id="cb85-710"><a href="#cb85-710" tabindex="-1"></a><span class="co">#&gt; 167 0.00000463420152465 0.0187393695084</span></span>
<span id="cb85-711"><a href="#cb85-711" tabindex="-1"></a><span class="co">#&gt; 168 0.00359712962659061 0.0052879876205</span></span>
<span id="cb85-712"><a href="#cb85-712" tabindex="-1"></a><span class="co">#&gt; 169 0.00311070873614421 0.0229943921786</span></span>
<span id="cb85-713"><a href="#cb85-713" tabindex="-1"></a><span class="co">#&gt; 170 0.03180292274323286 0.0364762255040</span></span>
<span id="cb85-714"><a href="#cb85-714" tabindex="-1"></a><span class="co">#&gt; 171 0.00107994121469193 0.0208230421414</span></span>
<span id="cb85-715"><a href="#cb85-715" tabindex="-1"></a><span class="co">#&gt; 172 0.00253542599173078 0.0075183281634</span></span>
<span id="cb85-716"><a href="#cb85-716" tabindex="-1"></a><span class="co">#&gt; 173 0.00040630652122582 0.0196209630308</span></span>
<span id="cb85-717"><a href="#cb85-717" tabindex="-1"></a><span class="co">#&gt; 174 0.02567497029694061 0.0456424917532</span></span>
<span id="cb85-718"><a href="#cb85-718" tabindex="-1"></a><span class="co">#&gt; 175 0.01270787927737341 0.0019090362294</span></span>
<span id="cb85-719"><a href="#cb85-719" tabindex="-1"></a><span class="co">#&gt; 176 0.01783456139200576 0.0617503711853</span></span>
<span id="cb85-720"><a href="#cb85-720" tabindex="-1"></a><span class="co">#&gt; 177 0.00922659238776173 0.0681521804040</span></span>
<span id="cb85-721"><a href="#cb85-721" tabindex="-1"></a><span class="co">#&gt; 178 0.00534670951352632 0.0439515858925</span></span>
<span id="cb85-722"><a href="#cb85-722" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb85-723"><a href="#cb85-723" tabindex="-1"></a><span class="co">#&gt; $contrib</span></span>
<span id="cb85-724"><a href="#cb85-724" tabindex="-1"></a><span class="co">#&gt;              Dim.1        Dim.2          Dim.3</span></span>
<span id="cb85-725"><a href="#cb85-725" tabindex="-1"></a><span class="co">#&gt; 1   1.259499371073 0.4750511746  0.01054778401</span></span>
<span id="cb85-726"><a href="#cb85-726" tabindex="-1"></a><span class="co">#&gt; 2   0.648990245573 0.0244998573  1.59576936679</span></span>
<span id="cb85-727"><a href="#cb85-727" tabindex="-1"></a><span class="co">#&gt; 3   0.787128265755 0.2419235832  0.37560678373</span></span>
<span id="cb85-728"><a href="#cb85-728" tabindex="-1"></a><span class="co">#&gt; 4   1.561472490234 1.7241058575  0.01188938609</span></span>
<span id="cb85-729"><a href="#cb85-729" tabindex="-1"></a><span class="co">#&gt; 5   0.201036169653 0.1694240664  1.59438584387</span></span>
<span id="cb85-730"><a href="#cb85-730" tabindex="-1"></a><span class="co">#&gt; 6   1.097198335948 1.0208670117  0.15371483753</span></span>
<span id="cb85-731"><a href="#cb85-731" tabindex="-1"></a><span class="co">#&gt; 7   0.767777662860 0.3128258461  0.37109963183</span></span>
<span id="cb85-732"><a href="#cb85-732" tabindex="-1"></a><span class="co">#&gt; 8   0.581061218932 0.5840760415  0.00824777829</span></span>
<span id="cb85-733"><a href="#cb85-733" tabindex="-1"></a><span class="co">#&gt; 9   0.792920659753 0.1917436764  1.21844208804</span></span>
<span id="cb85-734"><a href="#cb85-734" tabindex="-1"></a><span class="co">#&gt; 10  0.916744706875 0.1426708878  0.37596132453</span></span>
<span id="cb85-735"><a href="#cb85-735" tabindex="-1"></a><span class="co">#&gt; 11  1.373324300798 0.3875531972  0.06914551377</span></span>
<span id="cb85-736"><a href="#cb85-736" tabindex="-1"></a><span class="co">#&gt; 12  0.451648094501 0.0845191883  0.55164698530</span></span>
<span id="cb85-737"><a href="#cb85-737" tabindex="-1"></a><span class="co">#&gt; 13  0.603412980932 0.1035722791  0.29105578716</span></span>
<span id="cb85-738"><a href="#cb85-738" tabindex="-1"></a><span class="co">#&gt; 14  1.369441192225 0.2924401132  0.56302039689</span></span>
<span id="cb85-739"><a href="#cb85-739" tabindex="-1"></a><span class="co">#&gt; 15  2.001991326330 1.0019155832  0.61921517998</span></span>
<span id="cb85-740"><a href="#cb85-740" tabindex="-1"></a><span class="co">#&gt; 16  0.690721300621 0.6246995423  0.01838767150</span></span>
<span id="cb85-741"><a href="#cb85-741" tabindex="-1"></a><span class="co">#&gt; 17  0.621848255151 1.2222894558  0.26865305103</span></span>
<span id="cb85-742"><a href="#cb85-742" tabindex="-1"></a><span class="co">#&gt; 18  0.502945276939 0.6003596345  0.24523989089</span></span>
<span id="cb85-743"><a href="#cb85-743" tabindex="-1"></a><span class="co">#&gt; 19  1.421199950267 1.4381907296  0.09134848062</span></span>
<span id="cb85-744"><a href="#cb85-744" tabindex="-1"></a><span class="co">#&gt; 20  0.581811909429 0.2549764373  0.01053659040</span></span>
<span id="cb85-745"><a href="#cb85-745" tabindex="-1"></a><span class="co">#&gt; 21  1.129763048100 0.1425646615  0.05142721474</span></span>
<span id="cb85-746"><a href="#cb85-746" tabindex="-1"></a><span class="co">#&gt; 22  0.222700268161 0.0129742567  0.34054242102</span></span>
<span id="cb85-747"><a href="#cb85-747" tabindex="-1"></a><span class="co">#&gt; 23  0.811645336093 0.0016962196  0.03780853014</span></span>
<span id="cb85-748"><a href="#cb85-748" tabindex="-1"></a><span class="co">#&gt; 24  0.409061151362 0.0598087671  0.00797374195</span></span>
<span id="cb85-749"><a href="#cb85-749" tabindex="-1"></a><span class="co">#&gt; 25  0.453786822256 0.0224496299  0.30753944518</span></span>
<span id="cb85-750"><a href="#cb85-750" tabindex="-1"></a><span class="co">#&gt; 26  0.198195608095 0.1980298127  5.66861991096</span></span>
<span id="cb85-751"><a href="#cb85-751" tabindex="-1"></a><span class="co">#&gt; 27  0.461919333652 0.1062303183  0.00297114908</span></span>
<span id="cb85-752"><a href="#cb85-752" tabindex="-1"></a><span class="co">#&gt; 28  0.269530050589 0.0018711260  0.74826195425</span></span>
<span id="cb85-753"><a href="#cb85-753" tabindex="-1"></a><span class="co">#&gt; 29  0.638111100219 0.1079642428  0.75507446913</span></span>
<span id="cb85-754"><a href="#cb85-754" tabindex="-1"></a><span class="co">#&gt; 30  0.664801606458 0.0085991432  0.46384065463</span></span>
<span id="cb85-755"><a href="#cb85-755" tabindex="-1"></a><span class="co">#&gt; 31  0.780025320243 0.3494683378  0.74655861538</span></span>
<span id="cb85-756"><a href="#cb85-756" tabindex="-1"></a><span class="co">#&gt; 32  0.874266942916 0.4916327174  0.04278460226</span></span>
<span id="cb85-757"><a href="#cb85-757" tabindex="-1"></a><span class="co">#&gt; 33  0.402375486994 0.0006369643  0.01094668115</span></span>
<span id="cb85-758"><a href="#cb85-758" tabindex="-1"></a><span class="co">#&gt; 34  0.511782777755 0.6011102897  0.53300417010</span></span>
<span id="cb85-759"><a href="#cb85-759" tabindex="-1"></a><span class="co">#&gt; 35  0.324060026093 0.1094362739  0.08911671015</span></span>
<span id="cb85-760"><a href="#cb85-760" tabindex="-1"></a><span class="co">#&gt; 36  0.503585324074 0.0072354499  0.07893104238</span></span>
<span id="cb85-761"><a href="#cb85-761" tabindex="-1"></a><span class="co">#&gt; 37  0.317218088045 0.0973650260  0.08131196427</span></span>
<span id="cb85-762"><a href="#cb85-762" tabindex="-1"></a><span class="co">#&gt; 38  0.235441390527 0.0028318393  0.00062574996</span></span>
<span id="cb85-763"><a href="#cb85-763" tabindex="-1"></a><span class="co">#&gt; 39  0.355768295856 0.1331609499  0.79093161544</span></span>
<span id="cb85-764"><a href="#cb85-764" tabindex="-1"></a><span class="co">#&gt; 40  0.793973339484 0.7361511377  0.04560549046</span></span>
<span id="cb85-765"><a href="#cb85-765" tabindex="-1"></a><span class="co">#&gt; 41  0.819048843682 0.1390730704  0.00538598852</span></span>
<span id="cb85-766"><a href="#cb85-766" tabindex="-1"></a><span class="co">#&gt; 42  0.124036964759 0.0061961053  0.23913100476</span></span>
<span id="cb85-767"><a href="#cb85-767" tabindex="-1"></a><span class="co">#&gt; 43  1.109761067323 0.3048488407  0.03785602882</span></span>
<span id="cb85-768"><a href="#cb85-768" tabindex="-1"></a><span class="co">#&gt; 44  0.083075785297 0.0239357705  0.01593870313</span></span>
<span id="cb85-769"><a href="#cb85-769" tabindex="-1"></a><span class="co">#&gt; 45  0.582997529997 0.0010044752  0.16688985161</span></span>
<span id="cb85-770"><a href="#cb85-770" tabindex="-1"></a><span class="co">#&gt; 46  0.239984323876 0.7089368138  0.00029730028</span></span>
<span id="cb85-771"><a href="#cb85-771" tabindex="-1"></a><span class="co">#&gt; 47  0.907985800368 0.3227242866  0.11306411087</span></span>
<span id="cb85-772"><a href="#cb85-772" tabindex="-1"></a><span class="co">#&gt; 48  0.949813585404 0.0961997458  0.51800733348</span></span>
<span id="cb85-773"><a href="#cb85-773" tabindex="-1"></a><span class="co">#&gt; 49  0.545631008623 0.3516659363  0.00127608197</span></span>
<span id="cb85-774"><a href="#cb85-774" tabindex="-1"></a><span class="co">#&gt; 50  0.888818352622 0.6957827599  0.16046912872</span></span>
<span id="cb85-775"><a href="#cb85-775" tabindex="-1"></a><span class="co">#&gt; 51  1.181556743210 0.0070434821  1.51117708121</span></span>
<span id="cb85-776"><a href="#cb85-776" tabindex="-1"></a><span class="co">#&gt; 52  0.985566208660 0.1272532570  0.00000960525</span></span>
<span id="cb85-777"><a href="#cb85-777" tabindex="-1"></a><span class="co">#&gt; 53  1.389438543248 0.5927348550  0.10499829815</span></span>
<span id="cb85-778"><a href="#cb85-778" tabindex="-1"></a><span class="co">#&gt; 54  0.653448361794 0.7938852254  0.04468143129</span></span>
<span id="cb85-779"><a href="#cb85-779" tabindex="-1"></a><span class="co">#&gt; 55  0.606560026836 0.2344063988  0.35620444405</span></span>
<span id="cb85-780"><a href="#cb85-780" tabindex="-1"></a><span class="co">#&gt; 56  0.752358152969 0.4011238494  0.10273332294</span></span>
<span id="cb85-781"><a href="#cb85-781" tabindex="-1"></a><span class="co">#&gt; 57  0.904416997237 0.4689087283  0.14540022792</span></span>
<span id="cb85-782"><a href="#cb85-782" tabindex="-1"></a><span class="co">#&gt; 58  0.628254543649 0.3323908915  0.02656100388</span></span>
<span id="cb85-783"><a href="#cb85-783" tabindex="-1"></a><span class="co">#&gt; 59  1.139759616166 0.6816633438  0.03148763500</span></span>
<span id="cb85-784"><a href="#cb85-784" tabindex="-1"></a><span class="co">#&gt; 60  0.077684262919 2.1311261999  8.16948244480</span></span>
<span id="cb85-785"><a href="#cb85-785" tabindex="-1"></a><span class="co">#&gt; 61  0.203104720310 0.4347210964  0.29852936451</span></span>
<span id="cb85-786"><a href="#cb85-786" tabindex="-1"></a><span class="co">#&gt; 62  0.298103452059 0.1583226509  1.00345268419</span></span>
<span id="cb85-787"><a href="#cb85-787" tabindex="-1"></a><span class="co">#&gt; 63  0.000015265826 0.3587353114  1.23740308369</span></span>
<span id="cb85-788"><a href="#cb85-788" tabindex="-1"></a><span class="co">#&gt; 64  0.340993650917 0.8235918354  0.00001090960</span></span>
<span id="cb85-789"><a href="#cb85-789" tabindex="-1"></a><span class="co">#&gt; 65  0.033504570266 0.8218230775  0.17889007981</span></span>
<span id="cb85-790"><a href="#cb85-790" tabindex="-1"></a><span class="co">#&gt; 66  0.063566328205 0.1295180860  0.12807812380</span></span>
<span id="cb85-791"><a href="#cb85-791" tabindex="-1"></a><span class="co">#&gt; 67  0.414092620075 0.7884444225  1.60046838913</span></span>
<span id="cb85-792"><a href="#cb85-792" tabindex="-1"></a><span class="co">#&gt; 68  0.002082553023 1.3237926079  0.44439518745</span></span>
<span id="cb85-793"><a href="#cb85-793" tabindex="-1"></a><span class="co">#&gt; 69  0.057317976474 0.0114158400  0.19486719267</span></span>
<span id="cb85-794"><a href="#cb85-794" tabindex="-1"></a><span class="co">#&gt; 70  0.307366572065 0.4353791420  0.59306871107</span></span>
<span id="cb85-795"><a href="#cb85-795" tabindex="-1"></a><span class="co">#&gt; 71  0.219724245613 0.1810936522  0.15342739497</span></span>
<span id="cb85-796"><a href="#cb85-796" tabindex="-1"></a><span class="co">#&gt; 72  0.225881854261 0.2021478629  1.48301161338</span></span>
<span id="cb85-797"><a href="#cb85-797" tabindex="-1"></a><span class="co">#&gt; 73  0.048877201324 0.2560536432  0.00247745462</span></span>
<span id="cb85-798"><a href="#cb85-798" tabindex="-1"></a><span class="co">#&gt; 74  0.536572008435 0.0169303617  4.43005145936</span></span>
<span id="cb85-799"><a href="#cb85-799" tabindex="-1"></a><span class="co">#&gt; 75  0.270993877095 0.3670625919  0.08230023246</span></span>
<span id="cb85-800"><a href="#cb85-800" tabindex="-1"></a><span class="co">#&gt; 76  0.069747140329 1.3479639438  0.94999122862</span></span>
<span id="cb85-801"><a href="#cb85-801" tabindex="-1"></a><span class="co">#&gt; 77  0.009158430991 1.0410022533  2.32961320764</span></span>
<span id="cb85-802"><a href="#cb85-802" tabindex="-1"></a><span class="co">#&gt; 78  0.188033504406 0.4348980128  0.02024931730</span></span>
<span id="cb85-803"><a href="#cb85-803" tabindex="-1"></a><span class="co">#&gt; 79  0.121915462108 0.1308739525  0.54307246540</span></span>
<span id="cb85-804"><a href="#cb85-804" tabindex="-1"></a><span class="co">#&gt; 80  0.010337560492 0.2362363505  1.25146784513</span></span>
<span id="cb85-805"><a href="#cb85-805" tabindex="-1"></a><span class="co">#&gt; 81  0.045721468752 2.5558550773  0.04943885286</span></span>
<span id="cb85-806"><a href="#cb85-806" tabindex="-1"></a><span class="co">#&gt; 82  0.086659039226 0.4698156271  0.05095890416</span></span>
<span id="cb85-807"><a href="#cb85-807" tabindex="-1"></a><span class="co">#&gt; 83  0.022182918356 1.2784441939  0.69248611951</span></span>
<span id="cb85-808"><a href="#cb85-808" tabindex="-1"></a><span class="co">#&gt; 84  0.561611613763 0.0022538423  0.08662845769</span></span>
<span id="cb85-809"><a href="#cb85-809" tabindex="-1"></a><span class="co">#&gt; 85  0.052349384765 0.4848417450  0.14525245442</span></span>
<span id="cb85-810"><a href="#cb85-810" tabindex="-1"></a><span class="co">#&gt; 86  0.049480729140 0.9200442624  0.02507965366</span></span>
<span id="cb85-811"><a href="#cb85-811" tabindex="-1"></a><span class="co">#&gt; 87  0.059330492302 1.1264005090  0.23166625334</span></span>
<span id="cb85-812"><a href="#cb85-812" tabindex="-1"></a><span class="co">#&gt; 88  0.028323835500 1.2698062038  2.06768641552</span></span>
<span id="cb85-813"><a href="#cb85-813" tabindex="-1"></a><span class="co">#&gt; 89  0.109317422085 0.7352927919  0.35674285334</span></span>
<span id="cb85-814"><a href="#cb85-814" tabindex="-1"></a><span class="co">#&gt; 90  0.027594698171 1.5922560057  0.27970802393</span></span>
<span id="cb85-815"><a href="#cb85-815" tabindex="-1"></a><span class="co">#&gt; 91  0.159427236844 1.0156893402  0.00092638330</span></span>
<span id="cb85-816"><a href="#cb85-816" tabindex="-1"></a><span class="co">#&gt; 92  0.216539626318 0.7780859312  0.23631315458</span></span>
<span id="cb85-817"><a href="#cb85-817" tabindex="-1"></a><span class="co">#&gt; 93  0.325622690833 0.5539575485  0.00320951995</span></span>
<span id="cb85-818"><a href="#cb85-818" tabindex="-1"></a><span class="co">#&gt; 94  0.043308710454 1.1987597455  0.00518973626</span></span>
<span id="cb85-819"><a href="#cb85-819" tabindex="-1"></a><span class="co">#&gt; 95  0.070944740598 1.1062774648  0.00801966498</span></span>
<span id="cb85-820"><a href="#cb85-820" tabindex="-1"></a><span class="co">#&gt; 96  0.518612967011 0.0076339820  0.24355630283</span></span>
<span id="cb85-821"><a href="#cb85-821" tabindex="-1"></a><span class="co">#&gt; 97  0.031312896351 0.0308285474  0.66599457862</span></span>
<span id="cb85-822"><a href="#cb85-822" tabindex="-1"></a><span class="co">#&gt; 98  0.084957821732 1.4739720762  0.45766899996</span></span>
<span id="cb85-823"><a href="#cb85-823" tabindex="-1"></a><span class="co">#&gt; 99  0.414483252991 0.4537204862  0.02019699684</span></span>
<span id="cb85-824"><a href="#cb85-824" tabindex="-1"></a><span class="co">#&gt; 100 0.162490314943 1.0481600619  0.21858120541</span></span>
<span id="cb85-825"><a href="#cb85-825" tabindex="-1"></a><span class="co">#&gt; 101 0.049926918643 1.2660657658  0.95426809198</span></span>
<span id="cb85-826"><a href="#cb85-826" tabindex="-1"></a><span class="co">#&gt; 102 0.028601114488 1.1853384292  0.87314196699</span></span>
<span id="cb85-827"><a href="#cb85-827" tabindex="-1"></a><span class="co">#&gt; 103 0.003150000686 0.3051722603  0.39147145221</span></span>
<span id="cb85-828"><a href="#cb85-828" tabindex="-1"></a><span class="co">#&gt; 104 0.041926404478 1.6185596873  0.22734012931</span></span>
<span id="cb85-829"><a href="#cb85-829" tabindex="-1"></a><span class="co">#&gt; 105 0.011572189548 0.9887004425  0.08635555852</span></span>
<span id="cb85-830"><a href="#cb85-830" tabindex="-1"></a><span class="co">#&gt; 106 0.272031690992 0.6704465884  0.34730618171</span></span>
<span id="cb85-831"><a href="#cb85-831" tabindex="-1"></a><span class="co">#&gt; 107 0.013064107261 1.0601512864  0.09007002353</span></span>
<span id="cb85-832"><a href="#cb85-832" tabindex="-1"></a><span class="co">#&gt; 108 0.232353787232 0.4181557614  0.03178139676</span></span>
<span id="cb85-833"><a href="#cb85-833" tabindex="-1"></a><span class="co">#&gt; 109 0.000091857592 1.1946966555  0.08322622525</span></span>
<span id="cb85-834"><a href="#cb85-834" tabindex="-1"></a><span class="co">#&gt; 110 0.201582098485 0.4749875914  1.23273471611</span></span>
<span id="cb85-835"><a href="#cb85-835" tabindex="-1"></a><span class="co">#&gt; 111 0.150611977436 0.4460229937  0.00783741865</span></span>
<span id="cb85-836"><a href="#cb85-836" tabindex="-1"></a><span class="co">#&gt; 112 0.008437272274 0.8389945082  0.00241231422</span></span>
<span id="cb85-837"><a href="#cb85-837" tabindex="-1"></a><span class="co">#&gt; 113 0.145199226110 0.1335628454  1.55082919413</span></span>
<span id="cb85-838"><a href="#cb85-838" tabindex="-1"></a><span class="co">#&gt; 114 0.020701131040 1.1602990508  0.43748881125</span></span>
<span id="cb85-839"><a href="#cb85-839" tabindex="-1"></a><span class="co">#&gt; 115 0.022596579346 0.8478495678  0.68051199228</span></span>
<span id="cb85-840"><a href="#cb85-840" tabindex="-1"></a><span class="co">#&gt; 116 0.018187062467 3.3678623986  0.70229083672</span></span>
<span id="cb85-841"><a href="#cb85-841" tabindex="-1"></a><span class="co">#&gt; 117 0.007093683148 1.7914620747  0.03552924989</span></span>
<span id="cb85-842"><a href="#cb85-842" tabindex="-1"></a><span class="co">#&gt; 118 0.001918114113 0.8366609056  0.18524508703</span></span>
<span id="cb85-843"><a href="#cb85-843" tabindex="-1"></a><span class="co">#&gt; 119 0.513982509683 0.3624313608  1.40971710056</span></span>
<span id="cb85-844"><a href="#cb85-844" tabindex="-1"></a><span class="co">#&gt; 120 0.028588631483 1.1131192265  0.04934042581</span></span>
<span id="cb85-845"><a href="#cb85-845" tabindex="-1"></a><span class="co">#&gt; 121 0.041732463004 0.4435871526  0.49291623109</span></span>
<span id="cb85-846"><a href="#cb85-846" tabindex="-1"></a><span class="co">#&gt; 122 0.142339669339 0.0153368192 11.10632723619</span></span>
<span id="cb85-847"><a href="#cb85-847" tabindex="-1"></a><span class="co">#&gt; 123 0.124359655487 0.1008125968  3.51862941736</span></span>
<span id="cb85-848"><a href="#cb85-848" tabindex="-1"></a><span class="co">#&gt; 124 0.021351228901 0.0863956422  0.09083152236</span></span>
<span id="cb85-849"><a href="#cb85-849" tabindex="-1"></a><span class="co">#&gt; 125 0.072646781035 0.4657900421  0.85430602372</span></span>
<span id="cb85-850"><a href="#cb85-850" tabindex="-1"></a><span class="co">#&gt; 126 0.001378826599 1.0014062364  0.07351620449</span></span>
<span id="cb85-851"><a href="#cb85-851" tabindex="-1"></a><span class="co">#&gt; 127 0.000005122945 0.3602112209  0.18396168266</span></span>
<span id="cb85-852"><a href="#cb85-852" tabindex="-1"></a><span class="co">#&gt; 128 0.226923079262 0.3324642428  4.38617232663</span></span>
<span id="cb85-853"><a href="#cb85-853" tabindex="-1"></a><span class="co">#&gt; 129 0.023247806218 0.8468887902  0.65312882782</span></span>
<span id="cb85-854"><a href="#cb85-854" tabindex="-1"></a><span class="co">#&gt; 130 0.281054948799 0.3022513707  0.23724880711</span></span>
<span id="cb85-855"><a href="#cb85-855" tabindex="-1"></a><span class="co">#&gt; 131 0.321156916453 0.0066774850  0.53988577129</span></span>
<span id="cb85-856"><a href="#cb85-856" tabindex="-1"></a><span class="co">#&gt; 132 0.762970745250 0.0309436154  0.20344285167</span></span>
<span id="cb85-857"><a href="#cb85-857" tabindex="-1"></a><span class="co">#&gt; 133 1.074758352254 0.0149266859  0.01093534624</span></span>
<span id="cb85-858"><a href="#cb85-858" tabindex="-1"></a><span class="co">#&gt; 134 0.649781336928 0.0301372902  0.07965049219</span></span>
<span id="cb85-859"><a href="#cb85-859" tabindex="-1"></a><span class="co">#&gt; 135 0.746976571494 0.0484060351  0.47150429432</span></span>
<span id="cb85-860"><a href="#cb85-860" tabindex="-1"></a><span class="co">#&gt; 136 1.138223214250 0.0268666294  0.47005467758</span></span>
<span id="cb85-861"><a href="#cb85-861" tabindex="-1"></a><span class="co">#&gt; 137 1.720272753217 0.0045355395  0.01883138088</span></span>
<span id="cb85-862"><a href="#cb85-862" tabindex="-1"></a><span class="co">#&gt; 138 1.742897954196 0.0942510278  1.13682927859</span></span>
<span id="cb85-863"><a href="#cb85-863" tabindex="-1"></a><span class="co">#&gt; 139 1.149774498722 0.0260729865  0.41050870009</span></span>
<span id="cb85-864"><a href="#cb85-864" tabindex="-1"></a><span class="co">#&gt; 140 0.746801082714 0.0185935524  0.59879618972</span></span>
<span id="cb85-865"><a href="#cb85-865" tabindex="-1"></a><span class="co">#&gt; 141 0.957513867403 0.0176162582  0.14397182406</span></span>
<span id="cb85-866"><a href="#cb85-866" tabindex="-1"></a><span class="co">#&gt; 142 0.699902391011 0.0305110667  0.36705435996</span></span>
<span id="cb85-867"><a href="#cb85-867" tabindex="-1"></a><span class="co">#&gt; 143 1.078814536269 0.0520686443  0.34751247685</span></span>
<span id="cb85-868"><a href="#cb85-868" tabindex="-1"></a><span class="co">#&gt; 144 0.742059858136 0.0512950121  0.02495598815</span></span>
<span id="cb85-869"><a href="#cb85-869" tabindex="-1"></a><span class="co">#&gt; 145 0.681210259999 0.3014389839  0.60180906797</span></span>
<span id="cb85-870"><a href="#cb85-870" tabindex="-1"></a><span class="co">#&gt; 146 0.885564080998 0.0700215736  0.28475375139</span></span>
<span id="cb85-871"><a href="#cb85-871" tabindex="-1"></a><span class="co">#&gt; 147 2.018640609786 0.0908719963  0.82807756163</span></span>
<span id="cb85-872"><a href="#cb85-872" tabindex="-1"></a><span class="co">#&gt; 148 1.488088816505 0.3585526288  0.00486308975</span></span>
<span id="cb85-873"><a href="#cb85-873" tabindex="-1"></a><span class="co">#&gt; 149 0.996557027939 0.5508286679  0.08682961540</span></span>
<span id="cb85-874"><a href="#cb85-874" tabindex="-1"></a><span class="co">#&gt; 150 1.061870455067 0.9320230048  0.09552301066</span></span>
<span id="cb85-875"><a href="#cb85-875" tabindex="-1"></a><span class="co">#&gt; 151 0.746723687358 1.2465754183  0.07466986296</span></span>
<span id="cb85-876"><a href="#cb85-876" tabindex="-1"></a><span class="co">#&gt; 152 0.871789574727 0.9381538104  0.03770235459</span></span>
<span id="cb85-877"><a href="#cb85-877" tabindex="-1"></a><span class="co">#&gt; 153 0.514029851926 0.5252837893  0.72258291167</span></span>
<span id="cb85-878"><a href="#cb85-878" tabindex="-1"></a><span class="co">#&gt; 154 0.973710851942 1.0241030234  0.36158882810</span></span>
<span id="cb85-879"><a href="#cb85-879" tabindex="-1"></a><span class="co">#&gt; 155 0.960871308810 0.0368683616  0.55044831469</span></span>
<span id="cb85-880"><a href="#cb85-880" tabindex="-1"></a><span class="co">#&gt; 156 1.509079506358 0.7225913927  0.00351193975</span></span>
<span id="cb85-881"><a href="#cb85-881" tabindex="-1"></a><span class="co">#&gt; 157 1.044666567002 0.8284273114  0.23798487148</span></span>
<span id="cb85-882"><a href="#cb85-882" tabindex="-1"></a><span class="co">#&gt; 158 1.358334652960 0.3817409297  0.99585488920</span></span>
<span id="cb85-883"><a href="#cb85-883" tabindex="-1"></a><span class="co">#&gt; 159 0.244766329393 2.7863020146  0.52417833404</span></span>
<span id="cb85-884"><a href="#cb85-884" tabindex="-1"></a><span class="co">#&gt; 160 0.429952262141 1.3041497868  0.11732846623</span></span>
<span id="cb85-885"><a href="#cb85-885" tabindex="-1"></a><span class="co">#&gt; 161 1.199921420148 0.1201065072  0.00325166181</span></span>
<span id="cb85-886"><a href="#cb85-886" tabindex="-1"></a><span class="co">#&gt; 162 0.677888434037 0.3086499637  0.00403321658</span></span>
<span id="cb85-887"><a href="#cb85-887" tabindex="-1"></a><span class="co">#&gt; 163 1.003452419825 0.0678155892  0.25075548873</span></span>
<span id="cb85-888"><a href="#cb85-888" tabindex="-1"></a><span class="co">#&gt; 164 0.868435283964 0.1079434150  0.30442279894</span></span>
<span id="cb85-889"><a href="#cb85-889" tabindex="-1"></a><span class="co">#&gt; 165 1.079751881891 0.5395415206  0.37606368611</span></span>
<span id="cb85-890"><a href="#cb85-890" tabindex="-1"></a><span class="co">#&gt; 166 1.448212963263 0.1712012174  0.08480596510</span></span>
<span id="cb85-891"><a href="#cb85-891" tabindex="-1"></a><span class="co">#&gt; 167 0.781307315731 1.5076448249  0.07127221587</span></span>
<span id="cb85-892"><a href="#cb85-892" tabindex="-1"></a><span class="co">#&gt; 168 1.067072058567 0.3616551572  0.57235843368</span></span>
<span id="cb85-893"><a href="#cb85-893" tabindex="-1"></a><span class="co">#&gt; 169 0.667042641053 0.9685878925  0.22678709064</span></span>
<span id="cb85-894"><a href="#cb85-894" tabindex="-1"></a><span class="co">#&gt; 170 0.766781362411 1.5035147699  0.78142757948</span></span>
<span id="cb85-895"><a href="#cb85-895" tabindex="-1"></a><span class="co">#&gt; 171 1.236931955112 0.0151413481  0.27920458359</span></span>
<span id="cb85-896"><a href="#cb85-896" tabindex="-1"></a><span class="co">#&gt; 172 1.566725424377 0.1577794901  0.69799754438</span></span>
<span id="cb85-897"><a href="#cb85-897" tabindex="-1"></a><span class="co">#&gt; 173 0.804361427379 1.0784058167  0.32810182025</span></span>
<span id="cb85-898"><a href="#cb85-898" tabindex="-1"></a><span class="co">#&gt; 174 1.335789535456 1.0955118409  0.04590542103</span></span>
<span id="cb85-899"><a href="#cb85-899" tabindex="-1"></a><span class="co">#&gt; 175 0.878828329070 0.6908012503  0.01671751572</span></span>
<span id="cb85-900"><a href="#cb85-900" tabindex="-1"></a><span class="co">#&gt; 176 0.930043749376 1.7089030489  0.34388809307</span></span>
<span id="cb85-901"><a href="#cb85-901" tabindex="-1"></a><span class="co">#&gt; 177 0.770392244718 1.1837133631  0.11773444891</span></span>
<span id="cb85-902"><a href="#cb85-902" tabindex="-1"></a><span class="co">#&gt; 178 1.240603090448 1.7146374482  0.39872347512</span></span>
<span id="cb85-903"><a href="#cb85-903" tabindex="-1"></a><span class="co">#&gt;                    Dim.4           Dim.5</span></span>
<span id="cb85-904"><a href="#cb85-904" tabindex="-1"></a><span class="co">#&gt; 1   0.000117407615748060  0.348057422186</span></span>
<span id="cb85-905"><a href="#cb85-905" tabindex="-1"></a><span class="co">#&gt; 2   0.105101134969162208  0.051508848877</span></span>
<span id="cb85-906"><a href="#cb85-906" tabindex="-1"></a><span class="co">#&gt; 3   0.267209966900561313  0.095881859217</span></span>
<span id="cb85-907"><a href="#cb85-907" tabindex="-1"></a><span class="co">#&gt; 4   0.193536299300787890  0.067185007336</span></span>
<span id="cb85-908"><a href="#cb85-908" tabindex="-1"></a><span class="co">#&gt; 5   0.117812491792402524  0.033140784842</span></span>
<span id="cb85-909"><a href="#cb85-909" tabindex="-1"></a><span class="co">#&gt; 6   0.221625373688730948  0.107700269688</span></span>
<span id="cb85-910"><a href="#cb85-910" tabindex="-1"></a><span class="co">#&gt; 7   0.075315116448881600  0.672133017262</span></span>
<span id="cb85-911"><a href="#cb85-911" tabindex="-1"></a><span class="co">#&gt; 8   0.939525983598246683  0.027246823176</span></span>
<span id="cb85-912"><a href="#cb85-912" tabindex="-1"></a><span class="co">#&gt; 9   0.014743159067940870  0.471907704235</span></span>
<span id="cb85-913"><a href="#cb85-913" tabindex="-1"></a><span class="co">#&gt; 10  0.044407741271843416  0.142425405943</span></span>
<span id="cb85-914"><a href="#cb85-914" tabindex="-1"></a><span class="co">#&gt; 11  0.000002518249909795  0.043179434762</span></span>
<span id="cb85-915"><a href="#cb85-915" tabindex="-1"></a><span class="co">#&gt; 12  0.730024141909479729  0.199936296004</span></span>
<span id="cb85-916"><a href="#cb85-916" tabindex="-1"></a><span class="co">#&gt; 13  0.262024887729514488  0.758252216073</span></span>
<span id="cb85-917"><a href="#cb85-917" tabindex="-1"></a><span class="co">#&gt; 14  0.032004317794258476  2.126884398340</span></span>
<span id="cb85-918"><a href="#cb85-918" tabindex="-1"></a><span class="co">#&gt; 15  0.025319771435723611  0.456286920016</span></span>
<span id="cb85-919"><a href="#cb85-919" tabindex="-1"></a><span class="co">#&gt; 16  1.395857166255741744  0.006517125478</span></span>
<span id="cb85-920"><a href="#cb85-920" tabindex="-1"></a><span class="co">#&gt; 17  0.487781037862799582  0.028305437880</span></span>
<span id="cb85-921"><a href="#cb85-921" tabindex="-1"></a><span class="co">#&gt; 18  0.800897809807331496  0.011068349071</span></span>
<span id="cb85-922"><a href="#cb85-922" tabindex="-1"></a><span class="co">#&gt; 19  0.672793828600922406  0.334845498305</span></span>
<span id="cb85-923"><a href="#cb85-923" tabindex="-1"></a><span class="co">#&gt; 20  0.194593744896610882  0.184994408084</span></span>
<span id="cb85-924"><a href="#cb85-924" tabindex="-1"></a><span class="co">#&gt; 21  0.036633066170305713  0.600986040417</span></span>
<span id="cb85-925"><a href="#cb85-925" tabindex="-1"></a><span class="co">#&gt; 22  0.490197159611038213  0.027978753527</span></span>
<span id="cb85-926"><a href="#cb85-926" tabindex="-1"></a><span class="co">#&gt; 23  0.025800288951335973  0.152347994170</span></span>
<span id="cb85-927"><a href="#cb85-927" tabindex="-1"></a><span class="co">#&gt; 24  0.202156797694306944  0.091131798854</span></span>
<span id="cb85-928"><a href="#cb85-928" tabindex="-1"></a><span class="co">#&gt; 25  0.066331840913015971  0.249536612899</span></span>
<span id="cb85-929"><a href="#cb85-929" tabindex="-1"></a><span class="co">#&gt; 26  1.100026673056931248  0.074606172424</span></span>
<span id="cb85-930"><a href="#cb85-930" tabindex="-1"></a><span class="co">#&gt; 27  0.200068729840102016  0.819052135681</span></span>
<span id="cb85-931"><a href="#cb85-931" tabindex="-1"></a><span class="co">#&gt; 28  0.275071351313565748  0.090221430192</span></span>
<span id="cb85-932"><a href="#cb85-932" tabindex="-1"></a><span class="co">#&gt; 29  0.589105667275088729  0.255980691171</span></span>
<span id="cb85-933"><a href="#cb85-933" tabindex="-1"></a><span class="co">#&gt; 30  0.010609521458262465  0.211533030596</span></span>
<span id="cb85-934"><a href="#cb85-934" tabindex="-1"></a><span class="co">#&gt; 31  0.120682969056064057  0.108098539323</span></span>
<span id="cb85-935"><a href="#cb85-935" tabindex="-1"></a><span class="co">#&gt; 32  0.062452197764169562  0.002106385960</span></span>
<span id="cb85-936"><a href="#cb85-936" tabindex="-1"></a><span class="co">#&gt; 33  0.527994895691463850  0.152718368597</span></span>
<span id="cb85-937"><a href="#cb85-937" tabindex="-1"></a><span class="co">#&gt; 34  3.359868659819711834  0.078160210627</span></span>
<span id="cb85-938"><a href="#cb85-938" tabindex="-1"></a><span class="co">#&gt; 35  0.733423120084460867  0.031831915738</span></span>
<span id="cb85-939"><a href="#cb85-939" tabindex="-1"></a><span class="co">#&gt; 36  0.024786135032638757  0.047674485168</span></span>
<span id="cb85-940"><a href="#cb85-940" tabindex="-1"></a><span class="co">#&gt; 37  1.164259737511181170  0.000001246546</span></span>
<span id="cb85-941"><a href="#cb85-941" tabindex="-1"></a><span class="co">#&gt; 38  0.731415147886352202  0.027069476099</span></span>
<span id="cb85-942"><a href="#cb85-942" tabindex="-1"></a><span class="co">#&gt; 39  0.432488175743307890  0.002817632211</span></span>
<span id="cb85-943"><a href="#cb85-943" tabindex="-1"></a><span class="co">#&gt; 40  1.092242937825087967  0.352814734241</span></span>
<span id="cb85-944"><a href="#cb85-944" tabindex="-1"></a><span class="co">#&gt; 41  0.218866159273872374  0.067551759491</span></span>
<span id="cb85-945"><a href="#cb85-945" tabindex="-1"></a><span class="co">#&gt; 42  0.580167035543063148  0.603777248879</span></span>
<span id="cb85-946"><a href="#cb85-946" tabindex="-1"></a><span class="co">#&gt; 43  0.125136043706002231  0.129503796435</span></span>
<span id="cb85-947"><a href="#cb85-947" tabindex="-1"></a><span class="co">#&gt; 44  0.946552183980151396  0.095382973318</span></span>
<span id="cb85-948"><a href="#cb85-948" tabindex="-1"></a><span class="co">#&gt; 45  0.427939009720395502  0.039706824657</span></span>
<span id="cb85-949"><a href="#cb85-949" tabindex="-1"></a><span class="co">#&gt; 46  0.120513134752630841  0.185212197725</span></span>
<span id="cb85-950"><a href="#cb85-950" tabindex="-1"></a><span class="co">#&gt; 47  0.824581092514616754  0.543001132759</span></span>
<span id="cb85-951"><a href="#cb85-951" tabindex="-1"></a><span class="co">#&gt; 48  0.602265339676487987  0.025872300051</span></span>
<span id="cb85-952"><a href="#cb85-952" tabindex="-1"></a><span class="co">#&gt; 49  0.011766624187836928  0.104698651244</span></span>
<span id="cb85-953"><a href="#cb85-953" tabindex="-1"></a><span class="co">#&gt; 50  0.012825999669277565  0.074646011661</span></span>
<span id="cb85-954"><a href="#cb85-954" tabindex="-1"></a><span class="co">#&gt; 51  0.879547434780281412  0.006967231157</span></span>
<span id="cb85-955"><a href="#cb85-955" tabindex="-1"></a><span class="co">#&gt; 52  0.081192717289882740  0.259760691559</span></span>
<span id="cb85-956"><a href="#cb85-956" tabindex="-1"></a><span class="co">#&gt; 53  0.000960245481952514  0.155491213185</span></span>
<span id="cb85-957"><a href="#cb85-957" tabindex="-1"></a><span class="co">#&gt; 54  1.072173188715491277  0.049375188242</span></span>
<span id="cb85-958"><a href="#cb85-958" tabindex="-1"></a><span class="co">#&gt; 55  0.002102147513566844  0.448594032181</span></span>
<span id="cb85-959"><a href="#cb85-959" tabindex="-1"></a><span class="co">#&gt; 56  0.156113995428456276  0.473737884015</span></span>
<span id="cb85-960"><a href="#cb85-960" tabindex="-1"></a><span class="co">#&gt; 57  0.066793046956511365  0.099823355138</span></span>
<span id="cb85-961"><a href="#cb85-961" tabindex="-1"></a><span class="co">#&gt; 58  0.280017977388000661  0.206796447765</span></span>
<span id="cb85-962"><a href="#cb85-962" tabindex="-1"></a><span class="co">#&gt; 59  0.060360633190478644  0.008196568394</span></span>
<span id="cb85-963"><a href="#cb85-963" tabindex="-1"></a><span class="co">#&gt; 60  0.556992090896559988  0.252906094761</span></span>
<span id="cb85-964"><a href="#cb85-964" tabindex="-1"></a><span class="co">#&gt; 61  5.816165815556198382  0.049466759531</span></span>
<span id="cb85-965"><a href="#cb85-965" tabindex="-1"></a><span class="co">#&gt; 62  1.401484359289813630  0.001343935696</span></span>
<span id="cb85-966"><a href="#cb85-966" tabindex="-1"></a><span class="co">#&gt; 63  0.951778255713765731  0.002486502553</span></span>
<span id="cb85-967"><a href="#cb85-967" tabindex="-1"></a><span class="co">#&gt; 64  0.487514059427300250  0.000904350267</span></span>
<span id="cb85-968"><a href="#cb85-968" tabindex="-1"></a><span class="co">#&gt; 65  2.699828651412937042  0.145700371200</span></span>
<span id="cb85-969"><a href="#cb85-969" tabindex="-1"></a><span class="co">#&gt; 66  0.187059018201503863  0.033715137814</span></span>
<span id="cb85-970"><a href="#cb85-970" tabindex="-1"></a><span class="co">#&gt; 67  1.234897969990328415  0.329319684741</span></span>
<span id="cb85-971"><a href="#cb85-971" tabindex="-1"></a><span class="co">#&gt; 68  0.000976623555934578  0.145963665096</span></span>
<span id="cb85-972"><a href="#cb85-972" tabindex="-1"></a><span class="co">#&gt; 69  4.064249590230555320  0.000278511671</span></span>
<span id="cb85-973"><a href="#cb85-973" tabindex="-1"></a><span class="co">#&gt; 70  0.000924027338102813 12.673613725530</span></span>
<span id="cb85-974"><a href="#cb85-974" tabindex="-1"></a><span class="co">#&gt; 71  0.591106758141871191  0.795651649888</span></span>
<span id="cb85-975"><a href="#cb85-975" tabindex="-1"></a><span class="co">#&gt; 72  0.005882441628589815  0.232637219707</span></span>
<span id="cb85-976"><a href="#cb85-976" tabindex="-1"></a><span class="co">#&gt; 73  0.014577965242474586  0.026674575306</span></span>
<span id="cb85-977"><a href="#cb85-977" tabindex="-1"></a><span class="co">#&gt; 74  0.053852534601658904  3.514308435703</span></span>
<span id="cb85-978"><a href="#cb85-978" tabindex="-1"></a><span class="co">#&gt; 75  0.188504360541637411  0.778180456273</span></span>
<span id="cb85-979"><a href="#cb85-979" tabindex="-1"></a><span class="co">#&gt; 76  0.266697232692795050  0.458177533014</span></span>
<span id="cb85-980"><a href="#cb85-980" tabindex="-1"></a><span class="co">#&gt; 77  0.000015004996448070  0.041933804466</span></span>
<span id="cb85-981"><a href="#cb85-981" tabindex="-1"></a><span class="co">#&gt; 78  0.193910034856861313  0.614021516510</span></span>
<span id="cb85-982"><a href="#cb85-982" tabindex="-1"></a><span class="co">#&gt; 79  0.007843576814299352  5.487325613434</span></span>
<span id="cb85-983"><a href="#cb85-983" tabindex="-1"></a><span class="co">#&gt; 80  0.483167498118191263  0.112388731855</span></span>
<span id="cb85-984"><a href="#cb85-984" tabindex="-1"></a><span class="co">#&gt; 81  0.051309483933885500  0.004403945944</span></span>
<span id="cb85-985"><a href="#cb85-985" tabindex="-1"></a><span class="co">#&gt; 82  0.051033313413691619  0.045778040985</span></span>
<span id="cb85-986"><a href="#cb85-986" tabindex="-1"></a><span class="co">#&gt; 83  0.935632459250888671  0.311449051448</span></span>
<span id="cb85-987"><a href="#cb85-987" tabindex="-1"></a><span class="co">#&gt; 84  0.055652411116995572  1.372049255876</span></span>
<span id="cb85-988"><a href="#cb85-988" tabindex="-1"></a><span class="co">#&gt; 85  0.477220356752983632  0.468858743685</span></span>
<span id="cb85-989"><a href="#cb85-989" tabindex="-1"></a><span class="co">#&gt; 86  0.259518212615070964  0.182452085451</span></span>
<span id="cb85-990"><a href="#cb85-990" tabindex="-1"></a><span class="co">#&gt; 87  0.671796418893100489  0.000121647345</span></span>
<span id="cb85-991"><a href="#cb85-991" tabindex="-1"></a><span class="co">#&gt; 88  0.775731464033367457  0.028015114623</span></span>
<span id="cb85-992"><a href="#cb85-992" tabindex="-1"></a><span class="co">#&gt; 89  0.187683244121513798  0.300599688640</span></span>
<span id="cb85-993"><a href="#cb85-993" tabindex="-1"></a><span class="co">#&gt; 90  0.067489232388545525  1.048718850419</span></span>
<span id="cb85-994"><a href="#cb85-994" tabindex="-1"></a><span class="co">#&gt; 91  0.311000511904994170  0.392985619416</span></span>
<span id="cb85-995"><a href="#cb85-995" tabindex="-1"></a><span class="co">#&gt; 92  0.341622354086685454  0.090028332425</span></span>
<span id="cb85-996"><a href="#cb85-996" tabindex="-1"></a><span class="co">#&gt; 93  0.435843548213749710  0.693346579726</span></span>
<span id="cb85-997"><a href="#cb85-997" tabindex="-1"></a><span class="co">#&gt; 94  1.009605978803493009  0.001812998605</span></span>
<span id="cb85-998"><a href="#cb85-998" tabindex="-1"></a><span class="co">#&gt; 95  0.216811659023260744  0.513947554273</span></span>
<span id="cb85-999"><a href="#cb85-999" tabindex="-1"></a><span class="co">#&gt; 96  0.006960031048036647 10.647367926762</span></span>
<span id="cb85-1000"><a href="#cb85-1000" tabindex="-1"></a><span class="co">#&gt; 97  0.151806989288743865  7.371341550621</span></span>
<span id="cb85-1001"><a href="#cb85-1001" tabindex="-1"></a><span class="co">#&gt; 98  0.062052481312512862  0.006161395984</span></span>
<span id="cb85-1002"><a href="#cb85-1002" tabindex="-1"></a><span class="co">#&gt; 99  0.686879393463422416  0.013418983112</span></span>
<span id="cb85-1003"><a href="#cb85-1003" tabindex="-1"></a><span class="co">#&gt; 100 0.734748579929490164  0.433263020123</span></span>
<span id="cb85-1004"><a href="#cb85-1004" tabindex="-1"></a><span class="co">#&gt; 101 0.015991936213401371  0.269333348689</span></span>
<span id="cb85-1005"><a href="#cb85-1005" tabindex="-1"></a><span class="co">#&gt; 102 0.036433604406160565  0.078831465198</span></span>
<span id="cb85-1006"><a href="#cb85-1006" tabindex="-1"></a><span class="co">#&gt; 103 0.268728285190232064  0.001319752595</span></span>
<span id="cb85-1007"><a href="#cb85-1007" tabindex="-1"></a><span class="co">#&gt; 104 0.145128819563083267  0.000417752364</span></span>
<span id="cb85-1008"><a href="#cb85-1008" tabindex="-1"></a><span class="co">#&gt; 105 0.084320749979561543  0.089022666635</span></span>
<span id="cb85-1009"><a href="#cb85-1009" tabindex="-1"></a><span class="co">#&gt; 106 0.007600489586779736  0.884067134028</span></span>
<span id="cb85-1010"><a href="#cb85-1010" tabindex="-1"></a><span class="co">#&gt; 107 0.043426503997764807  0.192639965059</span></span>
<span id="cb85-1011"><a href="#cb85-1011" tabindex="-1"></a><span class="co">#&gt; 108 0.029990070475240636  0.229935236118</span></span>
<span id="cb85-1012"><a href="#cb85-1012" tabindex="-1"></a><span class="co">#&gt; 109 0.624355414605494263  0.027193288264</span></span>
<span id="cb85-1013"><a href="#cb85-1013" tabindex="-1"></a><span class="co">#&gt; 110 0.396059142763317218  0.063778676046</span></span>
<span id="cb85-1014"><a href="#cb85-1014" tabindex="-1"></a><span class="co">#&gt; 111 9.593601398229306909  1.247880137608</span></span>
<span id="cb85-1015"><a href="#cb85-1015" tabindex="-1"></a><span class="co">#&gt; 112 0.513885720100823895  0.001589056801</span></span>
<span id="cb85-1016"><a href="#cb85-1016" tabindex="-1"></a><span class="co">#&gt; 113 2.315596277887253862  0.106396202046</span></span>
<span id="cb85-1017"><a href="#cb85-1017" tabindex="-1"></a><span class="co">#&gt; 114 0.411936446153175428  0.000036852789</span></span>
<span id="cb85-1018"><a href="#cb85-1018" tabindex="-1"></a><span class="co">#&gt; 115 0.044703732937296646  0.406251254433</span></span>
<span id="cb85-1019"><a href="#cb85-1019" tabindex="-1"></a><span class="co">#&gt; 116 0.583284373397891520  0.155439472023</span></span>
<span id="cb85-1020"><a href="#cb85-1020" tabindex="-1"></a><span class="co">#&gt; 117 0.170184069124478171  0.034826983680</span></span>
<span id="cb85-1021"><a href="#cb85-1021" tabindex="-1"></a><span class="co">#&gt; 118 0.000000000008637566  0.765725672743</span></span>
<span id="cb85-1022"><a href="#cb85-1022" tabindex="-1"></a><span class="co">#&gt; 119 0.164480911975323191  0.573275992948</span></span>
<span id="cb85-1023"><a href="#cb85-1023" tabindex="-1"></a><span class="co">#&gt; 120 0.993561939163883689  0.047218192208</span></span>
<span id="cb85-1024"><a href="#cb85-1024" tabindex="-1"></a><span class="co">#&gt; 121 1.045401141853805616  0.015823103992</span></span>
<span id="cb85-1025"><a href="#cb85-1025" tabindex="-1"></a><span class="co">#&gt; 122 0.108963977762702197  0.079066195700</span></span>
<span id="cb85-1026"><a href="#cb85-1026" tabindex="-1"></a><span class="co">#&gt; 123 0.666724826455187936  0.027681807697</span></span>
<span id="cb85-1027"><a href="#cb85-1027" tabindex="-1"></a><span class="co">#&gt; 124 6.754697563099782975  0.655991425207</span></span>
<span id="cb85-1028"><a href="#cb85-1028" tabindex="-1"></a><span class="co">#&gt; 125 8.798050822011504124  0.138618494779</span></span>
<span id="cb85-1029"><a href="#cb85-1029" tabindex="-1"></a><span class="co">#&gt; 126 0.535495289810000163  0.209161568785</span></span>
<span id="cb85-1030"><a href="#cb85-1030" tabindex="-1"></a><span class="co">#&gt; 127 0.895148314591673544  0.194685555644</span></span>
<span id="cb85-1031"><a href="#cb85-1031" tabindex="-1"></a><span class="co">#&gt; 128 0.099402269646634747  0.219035259501</span></span>
<span id="cb85-1032"><a href="#cb85-1032" tabindex="-1"></a><span class="co">#&gt; 129 0.272915997122198162  0.023586586330</span></span>
<span id="cb85-1033"><a href="#cb85-1033" tabindex="-1"></a><span class="co">#&gt; 130 0.765472127005171421  0.788602725259</span></span>
<span id="cb85-1034"><a href="#cb85-1034" tabindex="-1"></a><span class="co">#&gt; 131 0.398290963409896948  4.590894516099</span></span>
<span id="cb85-1035"><a href="#cb85-1035" tabindex="-1"></a><span class="co">#&gt; 132 0.000038538789257109  1.113085391315</span></span>
<span id="cb85-1036"><a href="#cb85-1036" tabindex="-1"></a><span class="co">#&gt; 133 0.011235077572901569  0.827147618819</span></span>
<span id="cb85-1037"><a href="#cb85-1037" tabindex="-1"></a><span class="co">#&gt; 134 0.120539567745701209  1.617469168626</span></span>
<span id="cb85-1038"><a href="#cb85-1038" tabindex="-1"></a><span class="co">#&gt; 135 0.575758906620158939  0.249381657172</span></span>
<span id="cb85-1039"><a href="#cb85-1039" tabindex="-1"></a><span class="co">#&gt; 136 0.461048833464460239  0.139884094296</span></span>
<span id="cb85-1040"><a href="#cb85-1040" tabindex="-1"></a><span class="co">#&gt; 137 0.041561972599194724  0.210613336907</span></span>
<span id="cb85-1041"><a href="#cb85-1041" tabindex="-1"></a><span class="co">#&gt; 138 0.035913400255859880  0.475660282756</span></span>
<span id="cb85-1042"><a href="#cb85-1042" tabindex="-1"></a><span class="co">#&gt; 139 0.086605343421305533  0.719421538584</span></span>
<span id="cb85-1043"><a href="#cb85-1043" tabindex="-1"></a><span class="co">#&gt; 140 0.406184157323022654  0.025641531864</span></span>
<span id="cb85-1044"><a href="#cb85-1044" tabindex="-1"></a><span class="co">#&gt; 141 0.650730027101319997  0.092246459871</span></span>
<span id="cb85-1045"><a href="#cb85-1045" tabindex="-1"></a><span class="co">#&gt; 142 0.129894721105895339  0.045369439447</span></span>
<span id="cb85-1046"><a href="#cb85-1046" tabindex="-1"></a><span class="co">#&gt; 143 0.907097508199228852  0.108184578635</span></span>
<span id="cb85-1047"><a href="#cb85-1047" tabindex="-1"></a><span class="co">#&gt; 144 0.102738483975348668  0.521979465164</span></span>
<span id="cb85-1048"><a href="#cb85-1048" tabindex="-1"></a><span class="co">#&gt; 145 0.303589467661879053  1.449847111131</span></span>
<span id="cb85-1049"><a href="#cb85-1049" tabindex="-1"></a><span class="co">#&gt; 146 0.086080171168624639  0.146860276169</span></span>
<span id="cb85-1050"><a href="#cb85-1050" tabindex="-1"></a><span class="co">#&gt; 147 0.384282699359800695  0.541335919241</span></span>
<span id="cb85-1051"><a href="#cb85-1051" tabindex="-1"></a><span class="co">#&gt; 148 0.375475167670306809  0.520280389900</span></span>
<span id="cb85-1052"><a href="#cb85-1052" tabindex="-1"></a><span class="co">#&gt; 149 0.198855299026788473  0.080715594262</span></span>
<span id="cb85-1053"><a href="#cb85-1053" tabindex="-1"></a><span class="co">#&gt; 150 0.383109449783406442  0.986793206355</span></span>
<span id="cb85-1054"><a href="#cb85-1054" tabindex="-1"></a><span class="co">#&gt; 151 0.167230800248455463  3.061079464926</span></span>
<span id="cb85-1055"><a href="#cb85-1055" tabindex="-1"></a><span class="co">#&gt; 152 0.490747385095024358  2.028362959441</span></span>
<span id="cb85-1056"><a href="#cb85-1056" tabindex="-1"></a><span class="co">#&gt; 153 0.085527653348953972  2.327533052539</span></span>
<span id="cb85-1057"><a href="#cb85-1057" tabindex="-1"></a><span class="co">#&gt; 154 0.230583542869587266  0.147923214287</span></span>
<span id="cb85-1058"><a href="#cb85-1058" tabindex="-1"></a><span class="co">#&gt; 155 0.107799196006976017  0.388033799991</span></span>
<span id="cb85-1059"><a href="#cb85-1059" tabindex="-1"></a><span class="co">#&gt; 156 0.611384201682070971  0.633464400622</span></span>
<span id="cb85-1060"><a href="#cb85-1060" tabindex="-1"></a><span class="co">#&gt; 157 0.798948770591288882  0.475569499524</span></span>
<span id="cb85-1061"><a href="#cb85-1061" tabindex="-1"></a><span class="co">#&gt; 158 0.235768976902861721  0.153170691340</span></span>
<span id="cb85-1062"><a href="#cb85-1062" tabindex="-1"></a><span class="co">#&gt; 159 0.616076904881930565  0.242257141715</span></span>
<span id="cb85-1063"><a href="#cb85-1063" tabindex="-1"></a><span class="co">#&gt; 160 0.342137960186919055  0.352500671634</span></span>
<span id="cb85-1064"><a href="#cb85-1064" tabindex="-1"></a><span class="co">#&gt; 161 0.429695402643398283  0.260072104920</span></span>
<span id="cb85-1065"><a href="#cb85-1065" tabindex="-1"></a><span class="co">#&gt; 162 0.878558095060358979  0.000185548689</span></span>
<span id="cb85-1066"><a href="#cb85-1066" tabindex="-1"></a><span class="co">#&gt; 163 0.563722128374992804  0.002455959457</span></span>
<span id="cb85-1067"><a href="#cb85-1067" tabindex="-1"></a><span class="co">#&gt; 164 0.010439701263005209  0.334495668503</span></span>
<span id="cb85-1068"><a href="#cb85-1068" tabindex="-1"></a><span class="co">#&gt; 165 0.000922695935840652  0.053805359451</span></span>
<span id="cb85-1069"><a href="#cb85-1069" tabindex="-1"></a><span class="co">#&gt; 166 0.059757154097012759  0.516030454289</span></span>
<span id="cb85-1070"><a href="#cb85-1070" tabindex="-1"></a><span class="co">#&gt; 167 0.000047773941644918  0.204304770938</span></span>
<span id="cb85-1071"><a href="#cb85-1071" tabindex="-1"></a><span class="co">#&gt; 168 0.035015419644588167  0.054437860899</span></span>
<span id="cb85-1072"><a href="#cb85-1072" tabindex="-1"></a><span class="co">#&gt; 169 0.025994689277427024  0.203214452005</span></span>
<span id="cb85-1073"><a href="#cb85-1073" tabindex="-1"></a><span class="co">#&gt; 170 0.395701947227853401  0.479974781686</span></span>
<span id="cb85-1074"><a href="#cb85-1074" tabindex="-1"></a><span class="co">#&gt; 171 0.009455865881071283  0.192820293914</span></span>
<span id="cb85-1075"><a href="#cb85-1075" tabindex="-1"></a><span class="co">#&gt; 172 0.032372031088215333  0.101519077650</span></span>
<span id="cb85-1076"><a href="#cb85-1076" tabindex="-1"></a><span class="co">#&gt; 173 0.003931646237866707  0.200792892157</span></span>
<span id="cb85-1077"><a href="#cb85-1077" tabindex="-1"></a><span class="co">#&gt; 174 0.342751393081241640  0.644385855824</span></span>
<span id="cb85-1078"><a href="#cb85-1078" tabindex="-1"></a><span class="co">#&gt; 175 0.096436473988638846  0.015321094365</span></span>
<span id="cb85-1079"><a href="#cb85-1079" tabindex="-1"></a><span class="co">#&gt; 176 0.222801879831957289  0.815836938220</span></span>
<span id="cb85-1080"><a href="#cb85-1080" tabindex="-1"></a><span class="co">#&gt; 177 0.093268178390993300  0.728583429018</span></span>
<span id="cb85-1081"><a href="#cb85-1081" tabindex="-1"></a><span class="co">#&gt; 178 0.074341186341570095  0.646286110668</span></span>
<span id="cb85-1082"><a href="#cb85-1082" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb85-1083"><a href="#cb85-1083" tabindex="-1"></a><span class="co">#&gt; $dist</span></span>
<span id="cb85-1084"><a href="#cb85-1084" tabindex="-1"></a><span class="co">#&gt;        1        2        3        4        5        6 </span></span>
<span id="cb85-1085"><a href="#cb85-1085" tabindex="-1"></a><span class="co">#&gt; 4.180544 3.595571 3.536697 5.004415 2.931119 4.127867 </span></span>
<span id="cb85-1086"><a href="#cb85-1086" tabindex="-1"></a><span class="co">#&gt;        7        8        9       10       11       12 </span></span>
<span id="cb85-1087"><a href="#cb85-1087" tabindex="-1"></a><span class="co">#&gt; 3.595103 3.560955 3.730884 3.491940 4.242925 3.077328 </span></span>
<span id="cb85-1088"><a href="#cb85-1088" tabindex="-1"></a><span class="co">#&gt;       13       14       15       16       17       18 </span></span>
<span id="cb85-1089"><a href="#cb85-1089" tabindex="-1"></a><span class="co">#&gt; 3.137977 5.038303 5.475668 3.630223 3.699088 3.267437 </span></span>
<span id="cb85-1090"><a href="#cb85-1090" tabindex="-1"></a><span class="co">#&gt;       19       20       21       22       23       24 </span></span>
<span id="cb85-1091"><a href="#cb85-1091" tabindex="-1"></a><span class="co">#&gt; 4.979567 3.329282 3.918818 2.765256 3.190832 2.633381 </span></span>
<span id="cb85-1092"><a href="#cb85-1092" tabindex="-1"></a><span class="co">#&gt;       25       26       27       28       29       30 </span></span>
<span id="cb85-1093"><a href="#cb85-1093" tabindex="-1"></a><span class="co">#&gt; 2.802558 4.523181 2.935622 2.719852 3.296779 3.059946 </span></span>
<span id="cb85-1094"><a href="#cb85-1094" tabindex="-1"></a><span class="co">#&gt;       31       32       33       34       35       36 </span></span>
<span id="cb85-1095"><a href="#cb85-1095" tabindex="-1"></a><span class="co">#&gt; 3.775600 3.679874 2.555385 4.111825 2.492084 2.509407 </span></span>
<span id="cb85-1096"><a href="#cb85-1096" tabindex="-1"></a><span class="co">#&gt;       37       38       39       40       41       42 </span></span>
<span id="cb85-1097"><a href="#cb85-1097" tabindex="-1"></a><span class="co">#&gt; 2.900096 2.259124 2.739298 4.499297 3.377361 2.692186 </span></span>
<span id="cb85-1098"><a href="#cb85-1098" tabindex="-1"></a><span class="co">#&gt;       43       44       45       46       47       48 </span></span>
<span id="cb85-1099"><a href="#cb85-1099" tabindex="-1"></a><span class="co">#&gt; 3.950290 2.413749 2.855672 3.296252 3.834444 3.574843 </span></span>
<span id="cb85-1100"><a href="#cb85-1100" tabindex="-1"></a><span class="co">#&gt;       49       50       51       52       53       54 </span></span>
<span id="cb85-1101"><a href="#cb85-1101" tabindex="-1"></a><span class="co">#&gt; 2.895810 3.796802 4.579472 3.678094 4.420176 3.536623 </span></span>
<span id="cb85-1102"><a href="#cb85-1102" tabindex="-1"></a><span class="co">#&gt;       55       56       57       58       59       60 </span></span>
<span id="cb85-1103"><a href="#cb85-1103" tabindex="-1"></a><span class="co">#&gt; 3.112228 3.385923 3.580485 3.147946 4.038973 5.858711 </span></span>
<span id="cb85-1104"><a href="#cb85-1104" tabindex="-1"></a><span class="co">#&gt;       61       62       63       64       65       66 </span></span>
<span id="cb85-1105"><a href="#cb85-1105" tabindex="-1"></a><span class="co">#&gt; 4.145652 3.408600 3.020558 3.581962 3.388259 2.194356 </span></span>
<span id="cb85-1106"><a href="#cb85-1106" tabindex="-1"></a><span class="co">#&gt;       67       68       69       70       71       72 </span></span>
<span id="cb85-1107"><a href="#cb85-1107" tabindex="-1"></a><span class="co">#&gt; 4.239400 3.298714 3.418805 5.554745 2.933992 3.937961 </span></span>
<span id="cb85-1108"><a href="#cb85-1108" tabindex="-1"></a><span class="co">#&gt;       73       74       75       76       77       78 </span></span>
<span id="cb85-1109"><a href="#cb85-1109" tabindex="-1"></a><span class="co">#&gt; 2.595103 5.383677 3.332945 3.459120 3.629859 2.852891 </span></span>
<span id="cb85-1110"><a href="#cb85-1110" tabindex="-1"></a><span class="co">#&gt;       79       80       81       82       83       84 </span></span>
<span id="cb85-1111"><a href="#cb85-1111" tabindex="-1"></a><span class="co">#&gt; 4.298454 2.903082 3.704903 2.085925 3.409388 3.256475 </span></span>
<span id="cb85-1112"><a href="#cb85-1112" tabindex="-1"></a><span class="co">#&gt;       85       86       87       88       89       90 </span></span>
<span id="cb85-1113"><a href="#cb85-1113" tabindex="-1"></a><span class="co">#&gt; 3.179007 2.538034 2.990212 3.825976 2.685040 3.434766 </span></span>
<span id="cb85-1114"><a href="#cb85-1114" tabindex="-1"></a><span class="co">#&gt;       91       92       93       94       95       96 </span></span>
<span id="cb85-1115"><a href="#cb85-1115" tabindex="-1"></a><span class="co">#&gt; 3.012728 2.961155 3.233546 2.985199 3.252707 5.639156 </span></span>
<span id="cb85-1116"><a href="#cb85-1116" tabindex="-1"></a><span class="co">#&gt;       97       98       99      100      101      102 </span></span>
<span id="cb85-1117"><a href="#cb85-1117" tabindex="-1"></a><span class="co">#&gt; 4.167759 3.134712 3.483657 4.018483 3.348875 3.054057 </span></span>
<span id="cb85-1118"><a href="#cb85-1118" tabindex="-1"></a><span class="co">#&gt;      103      104      105      106      107      108 </span></span>
<span id="cb85-1119"><a href="#cb85-1119" tabindex="-1"></a><span class="co">#&gt; 2.248410 3.122671 2.621994 3.555931 2.595285 2.668436 </span></span>
<span id="cb85-1120"><a href="#cb85-1120" tabindex="-1"></a><span class="co">#&gt;      109      110      111      112      113      114 </span></span>
<span id="cb85-1121"><a href="#cb85-1121" tabindex="-1"></a><span class="co">#&gt; 2.972768 3.392100 5.197823 2.600381 3.729774 3.117299 </span></span>
<span id="cb85-1122"><a href="#cb85-1122" tabindex="-1"></a><span class="co">#&gt;      115      116      117      118      119      120 </span></span>
<span id="cb85-1123"><a href="#cb85-1123" tabindex="-1"></a><span class="co">#&gt; 2.942524 4.960968 3.146220 2.556648 3.687142 3.023742 </span></span>
<span id="cb85-1124"><a href="#cb85-1124" tabindex="-1"></a><span class="co">#&gt;      121      122      123      124      125      126 </span></span>
<span id="cb85-1125"><a href="#cb85-1125" tabindex="-1"></a><span class="co">#&gt; 2.840590 6.167500 3.785195 4.139140 4.558940 2.719592 </span></span>
<span id="cb85-1126"><a href="#cb85-1126" tabindex="-1"></a><span class="co">#&gt;      127      128      129      130      131      132 </span></span>
<span id="cb85-1127"><a href="#cb85-1127" tabindex="-1"></a><span class="co">#&gt; 2.760318 4.137126 2.831158 3.088949 3.861726 3.545104 </span></span>
<span id="cb85-1128"><a href="#cb85-1128" tabindex="-1"></a><span class="co">#&gt;      133      134      135      136      137      138 </span></span>
<span id="cb85-1129"><a href="#cb85-1129" tabindex="-1"></a><span class="co">#&gt; 3.955355 3.715158 3.819499 3.965222 4.643031 4.986927 </span></span>
<span id="cb85-1130"><a href="#cb85-1130" tabindex="-1"></a><span class="co">#&gt;      139      140      141      142      143      144 </span></span>
<span id="cb85-1131"><a href="#cb85-1131" tabindex="-1"></a><span class="co">#&gt; 3.856767 3.377082 3.574763 3.361098 3.950873 3.599044 </span></span>
<span id="cb85-1132"><a href="#cb85-1132" tabindex="-1"></a><span class="co">#&gt;      145      146      147      148      149      150 </span></span>
<span id="cb85-1133"><a href="#cb85-1133" tabindex="-1"></a><span class="co">#&gt; 3.885114 3.587417 5.315181 4.319784 3.681983 4.273568 </span></span>
<span id="cb85-1134"><a href="#cb85-1134" tabindex="-1"></a><span class="co">#&gt;      151      152      153      154      155      156 </span></span>
<span id="cb85-1135"><a href="#cb85-1135" tabindex="-1"></a><span class="co">#&gt; 4.587886 4.567445 4.156535 4.509277 4.018832 4.755082 </span></span>
<span id="cb85-1136"><a href="#cb85-1136" tabindex="-1"></a><span class="co">#&gt;      157      158      159      160      161      162 </span></span>
<span id="cb85-1137"><a href="#cb85-1137" tabindex="-1"></a><span class="co">#&gt; 4.183781 4.593558 5.622229 4.693008 3.943670 3.361244 </span></span>
<span id="cb85-1138"><a href="#cb85-1138" tabindex="-1"></a><span class="co">#&gt;      163      164      165      166      167      168 </span></span>
<span id="cb85-1139"><a href="#cb85-1139" tabindex="-1"></a><span class="co">#&gt; 3.611354 3.388177 4.038167 4.245907 4.126619 4.009940 </span></span>
<span id="cb85-1140"><a href="#cb85-1140" tabindex="-1"></a><span class="co">#&gt;      169      170      171      172      173      174 </span></span>
<span id="cb85-1141"><a href="#cb85-1141" tabindex="-1"></a><span class="co">#&gt; 3.715343 4.533533 3.803092 4.592464 3.998035 4.695922 </span></span>
<span id="cb85-1142"><a href="#cb85-1142" tabindex="-1"></a><span class="co">#&gt;      175      176      177      178 </span></span>
<span id="cb85-1143"><a href="#cb85-1143" tabindex="-1"></a><span class="co">#&gt; 3.540547 4.542704 4.086320 4.792451</span></span>
<span id="cb85-1144"><a href="#cb85-1144" tabindex="-1"></a></span>
<span id="cb85-1145"><a href="#cb85-1145" tabindex="-1"></a><span class="co"># Coordinates of individuals</span></span>
<span id="cb85-1146"><a href="#cb85-1146" tabindex="-1"></a><span class="fu">head</span>(res.pca.wine<span class="sc">$</span>ind<span class="sc">$</span>coord)</span>
<span id="cb85-1147"><a href="#cb85-1147" tabindex="-1"></a><span class="co">#&gt;      Dim.1      Dim.2      Dim.3       Dim.4      Dim.5</span></span>
<span id="cb85-1148"><a href="#cb85-1148" tabindex="-1"></a><span class="co">#&gt; 1 3.522918  1.4531187 -0.1647724 -0.01392626 -0.7373234</span></span>
<span id="cb85-1149"><a href="#cb85-1149" tabindex="-1"></a><span class="co">#&gt; 2 2.528848 -0.3299990 -2.0266970 -0.41666781  0.2836439</span></span>
<span id="cb85-1150"><a href="#cb85-1150" tabindex="-1"></a><span class="co">#&gt; 3 2.785007  1.0369791  0.9832648  0.66437392  0.3869909</span></span>
<span id="cb85-1151"><a href="#cb85-1151" tabindex="-1"></a><span class="co">#&gt; 4 3.922570  2.7682981 -0.1749377  0.56541518  0.3239431</span></span>
<span id="cb85-1152"><a href="#cb85-1152" tabindex="-1"></a><span class="co">#&gt; 5 1.407475  0.8677976  2.0258183 -0.44114557 -0.2275171</span></span>
<span id="cb85-1153"><a href="#cb85-1153" tabindex="-1"></a><span class="co">#&gt; 6 3.288108  2.1301759 -0.6290160 -0.60505658  0.4101483</span></span>
<span id="cb85-1154"><a href="#cb85-1154" tabindex="-1"></a></span>
<span id="cb85-1155"><a href="#cb85-1155" tabindex="-1"></a><span class="co"># Quality of representation</span></span>
<span id="cb85-1156"><a href="#cb85-1156" tabindex="-1"></a><span class="fu">head</span>(res.pca.wine<span class="sc">$</span>ind<span class="sc">$</span>cos2)</span>
<span id="cb85-1157"><a href="#cb85-1157" tabindex="-1"></a><span class="co">#&gt;       Dim.1       Dim.2       Dim.3         Dim.4</span></span>
<span id="cb85-1158"><a href="#cb85-1158" tabindex="-1"></a><span class="co">#&gt; 1 0.7101325 0.120819351 0.001553471 0.00001109694</span></span>
<span id="cb85-1159"><a href="#cb85-1159" tabindex="-1"></a><span class="co">#&gt; 2 0.4946631 0.008423441 0.317718031 0.01342901319</span></span>
<span id="cb85-1160"><a href="#cb85-1160" tabindex="-1"></a><span class="co">#&gt; 3 0.6200931 0.085969475 0.077293909 0.03528819568</span></span>
<span id="cb85-1161"><a href="#cb85-1161" tabindex="-1"></a><span class="co">#&gt; 4 0.6143769 0.305998365 0.001221970 0.01276522112</span></span>
<span id="cb85-1162"><a href="#cb85-1162" tabindex="-1"></a><span class="co">#&gt; 5 0.2305762 0.087653656 0.477676791 0.02265150214</span></span>
<span id="cb85-1163"><a href="#cb85-1163" tabindex="-1"></a><span class="co">#&gt; 6 0.6345136 0.266305195 0.023220525 0.02148526329</span></span>
<span id="cb85-1164"><a href="#cb85-1164" tabindex="-1"></a><span class="co">#&gt;         Dim.5</span></span>
<span id="cb85-1165"><a href="#cb85-1165" tabindex="-1"></a><span class="co">#&gt; 1 0.031106443</span></span>
<span id="cb85-1166"><a href="#cb85-1166" tabindex="-1"></a><span class="co">#&gt; 2 0.006223163</span></span>
<span id="cb85-1167"><a href="#cb85-1167" tabindex="-1"></a><span class="co">#&gt; 3 0.011973080</span></span>
<span id="cb85-1168"><a href="#cb85-1168" tabindex="-1"></a><span class="co">#&gt; 4 0.004190163</span></span>
<span id="cb85-1169"><a href="#cb85-1169" tabindex="-1"></a><span class="co">#&gt; 5 0.006025056</span></span>
<span id="cb85-1170"><a href="#cb85-1170" tabindex="-1"></a><span class="co">#&gt; 6 0.009872579</span></span>
<span id="cb85-1171"><a href="#cb85-1171" tabindex="-1"></a></span>
<span id="cb85-1172"><a href="#cb85-1172" tabindex="-1"></a><span class="co"># Contributions</span></span>
<span id="cb85-1173"><a href="#cb85-1173" tabindex="-1"></a><span class="fu">head</span>(res.pca.wine<span class="sc">$</span>ind<span class="sc">$</span>contrib)</span>
<span id="cb85-1174"><a href="#cb85-1174" tabindex="-1"></a><span class="co">#&gt;       Dim.1      Dim.2      Dim.3        Dim.4      Dim.5</span></span>
<span id="cb85-1175"><a href="#cb85-1175" tabindex="-1"></a><span class="co">#&gt; 1 1.2594994 0.47505117 0.01054778 0.0001174076 0.34805742</span></span>
<span id="cb85-1176"><a href="#cb85-1176" tabindex="-1"></a><span class="co">#&gt; 2 0.6489902 0.02449986 1.59576937 0.1051011350 0.05150885</span></span>
<span id="cb85-1177"><a href="#cb85-1177" tabindex="-1"></a><span class="co">#&gt; 3 0.7871283 0.24192358 0.37560678 0.2672099669 0.09588186</span></span>
<span id="cb85-1178"><a href="#cb85-1178" tabindex="-1"></a><span class="co">#&gt; 4 1.5614725 1.72410586 0.01188939 0.1935362993 0.06718501</span></span>
<span id="cb85-1179"><a href="#cb85-1179" tabindex="-1"></a><span class="co">#&gt; 5 0.2010362 0.16942407 1.59438584 0.1178124918 0.03314078</span></span>
<span id="cb85-1180"><a href="#cb85-1180" tabindex="-1"></a><span class="co">#&gt; 6 1.0971983 1.02086701 0.15371484 0.2216253737 0.10770027</span></span></code></pre></div>
</div>
<div id="exercise-1.8-visualize-individuals" class="section level3" number="11.2.8">
<h3><span class="header-section-number">11.2.8</span> Exercise 1.8: Visualize Individuals</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co"># Basic individual plot</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res.pca.wine, <span class="at">col.ind =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex1-8-plot-ind-1.png" width="100%" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a><span class="co"># Individuals colored by cultivar (if available)</span></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a><span class="co"># First, check if cultivar information exists</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a><span class="cf">if</span>(<span class="st">&quot;class&quot;</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(wine)) {</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>  <span class="fu">fviz_pca_ind</span>(res.pca.wine, </span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>               <span class="at">col.ind =</span> wine<span class="sc">$</span>class,</span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>               <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>               <span class="at">addEllipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>               <span class="at">legend.title =</span> <span class="st">&quot;Cultivar&quot;</span>)</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>}</span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a><span class="co"># Individuals colored by quality of representation</span></span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res.pca.wine, <span class="at">col.ind =</span> <span class="st">&quot;cos2&quot;</span>,</span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb87-15"><a href="#cb87-15" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex1-8-plot-ind-2.png" width="100%" /></p>
<p><strong>Questions:</strong>
1. Do the wines cluster by cultivar in the PCA space?
2. Which individuals are outliers or poorly represented?</p>
</div>
<div id="exercise-1.9-biplot" class="section level3" number="11.2.9">
<h3><span class="header-section-number">11.2.9</span> Exercise 1.9: Biplot</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="co"># Create biplot</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(res.pca.wine, </span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>                <span class="at">col.ind =</span> <span class="cf">if</span>(<span class="st">&quot;class&quot;</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(wine)) wine<span class="sc">$</span>class <span class="cf">else</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>                <span class="at">col.var =</span> <span class="st">&quot;#2E9FDF&quot;</span>,</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>                <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>                <span class="at">legend.title =</span> <span class="fu">list</span>(<span class="at">col =</span> <span class="st">&quot;Cultivar&quot;</span>))</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a><span class="co">#&gt; Ignoring unknown labels:</span></span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a><span class="co">#&gt; * colour : &quot;Cultivar&quot;</span></span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex1-9-biplot-1.png" width="100%" /></p>
<p><strong>Questions:</strong>
1. What does the biplot show?
2. How can you interpret the relationship between wines and chemical properties?</p>
</div>
<div id="exercise-1.10-dimension-description" class="section level3" number="11.2.10">
<h3><span class="header-section-number">11.2.10</span> Exercise 1.10: Dimension Description</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="co"># Describe dimensions</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a><span class="fu">dimdesc</span>(res.pca.wine, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">proba =</span> <span class="fl">0.05</span>)</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="co">#&gt; $Dim.1</span></span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a><span class="co">#&gt; Link between the variable and the continuous variables (R-square)</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a><span class="co">#&gt; =================================================================================</span></span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a><span class="co">#&gt;                 correlation</span></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a><span class="co">#&gt; Flavanoids        0.9192839</span></span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a><span class="co">#&gt; Phenols           0.8452804</span></span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a><span class="co">#&gt; OD280             0.8247313</span></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins   0.6565970</span></span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a><span class="co">#&gt; Hue               0.6512773</span></span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a><span class="co">#&gt; Proline           0.6341411</span></span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a><span class="co">#&gt; Alcohol           0.3207450</span></span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a><span class="co">#&gt; Magnesium         0.2932430</span></span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a><span class="co">#&gt; Intensity        -0.2101655</span></span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a><span class="co">#&gt; Malic            -0.5239390</span></span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a><span class="co">#&gt; Alcalinity       -0.5277455</span></span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid     -0.6282221</span></span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a><span class="co">#&gt; Class            -0.9262550</span></span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a><span class="co">#&gt;                                                                                              p.value</span></span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a><span class="co">#&gt; Flavanoids      0.0000000000000000000000000000000000000000000000000000000000000000000000003494589897</span></span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a><span class="co">#&gt; Phenols         0.0000000000000000000000000000000000000000000000000879156880575670215513708884523662</span></span>
<span id="cb89-24"><a href="#cb89-24" tabindex="-1"></a><span class="co">#&gt; OD280           0.0000000000000000000000000000000000000000000019615400947908345061021626604797643458</span></span>
<span id="cb89-25"><a href="#cb89-25" tabindex="-1"></a><span class="co">#&gt; Proanthocyanins 0.0000000000000000000000251157016108634949061297244066807207974403170328496987274190</span></span>
<span id="cb89-26"><a href="#cb89-26" tabindex="-1"></a><span class="co">#&gt; Hue             0.0000000000000000000000737845177863062335780664662403473115181923439710317334146454</span></span>
<span id="cb89-27"><a href="#cb89-27" tabindex="-1"></a><span class="co">#&gt; Proline         0.0000000000000000000020601660483484618211293242510758065393477519343221041514709058</span></span>
<span id="cb89-28"><a href="#cb89-28" tabindex="-1"></a><span class="co">#&gt; Alcohol         0.0000127116253046300382189464153737112894759775372222065925598144531250000000000000</span></span>
<span id="cb89-29"><a href="#cb89-29" tabindex="-1"></a><span class="co">#&gt; Magnesium       0.0000711299198870513950127697500036560995795298367738723754882812500000000000000000</span></span>
<span id="cb89-30"><a href="#cb89-30" tabindex="-1"></a><span class="co">#&gt; Intensity       0.0048668091399486678241825821089605597080662846565246582031250000000000000000000000</span></span>
<span id="cb89-31"><a href="#cb89-31" tabindex="-1"></a><span class="co">#&gt; Malic           0.0000000000000614493295126217778802460478918332242609812859912565841113973874598742</span></span>
<span id="cb89-32"><a href="#cb89-32" tabindex="-1"></a><span class="co">#&gt; Alcalinity      0.0000000000000374990390681221850538160772429723636696256849898389873487758450210094</span></span>
<span id="cb89-33"><a href="#cb89-33" tabindex="-1"></a><span class="co">#&gt; Nonflavanoid    0.0000000000000000000062021435911901961177444163969774322735882739977212463881222140</span></span>
<span id="cb89-34"><a href="#cb89-34" tabindex="-1"></a><span class="co">#&gt; Class           0.0000000000000000000000000000000000000000000000000000000000000000000000000001685496</span></span>
<span id="cb89-35"><a href="#cb89-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb89-36"><a href="#cb89-36" tabindex="-1"></a><span class="co">#&gt; $Dim.2</span></span>
<span id="cb89-37"><a href="#cb89-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb89-38"><a href="#cb89-38" tabindex="-1"></a><span class="co">#&gt; Link between the variable and the continuous variables (R-square)</span></span>
<span id="cb89-39"><a href="#cb89-39" tabindex="-1"></a><span class="co">#&gt; =================================================================================</span></span>
<span id="cb89-40"><a href="#cb89-40" tabindex="-1"></a><span class="co">#&gt;           correlation</span></span>
<span id="cb89-41"><a href="#cb89-41" tabindex="-1"></a><span class="co">#&gt; Intensity   0.8371797</span></span>
<span id="cb89-42"><a href="#cb89-42" tabindex="-1"></a><span class="co">#&gt; Alcohol     0.7650819</span></span>
<span id="cb89-43"><a href="#cb89-43" tabindex="-1"></a><span class="co">#&gt; Proline     0.5784272</span></span>
<span id="cb89-44"><a href="#cb89-44" tabindex="-1"></a><span class="co">#&gt; Ash         0.4991239</span></span>
<span id="cb89-45"><a href="#cb89-45" tabindex="-1"></a><span class="co">#&gt; Magnesium   0.4749146</span></span>
<span id="cb89-46"><a href="#cb89-46" tabindex="-1"></a><span class="co">#&gt; Malic       0.3533433</span></span>
<span id="cb89-47"><a href="#cb89-47" tabindex="-1"></a><span class="co">#&gt; OD280      -0.2571935</span></span>
<span id="cb89-48"><a href="#cb89-48" tabindex="-1"></a><span class="co">#&gt; Hue        -0.4392310</span></span>
<span id="cb89-49"><a href="#cb89-49" tabindex="-1"></a><span class="co">#&gt;                                                            p.value</span></span>
<span id="cb89-50"><a href="#cb89-50" tabindex="-1"></a><span class="co">#&gt; Intensity 0.000000000000000000000000000000000000000000000005375287</span></span>
<span id="cb89-51"><a href="#cb89-51" tabindex="-1"></a><span class="co">#&gt; Alcohol   0.000000000000000000000000000000000017746323034316028007</span></span>
<span id="cb89-52"><a href="#cb89-52" tabindex="-1"></a><span class="co">#&gt; Proline   0.000000000000000027806147574753531173010130889545512741</span></span>
<span id="cb89-53"><a href="#cb89-53" tabindex="-1"></a><span class="co">#&gt; Ash       0.000000000001328193223710113881128336057027700258881611</span></span>
<span id="cb89-54"><a href="#cb89-54" tabindex="-1"></a><span class="co">#&gt; Magnesium 0.000000000021167017061932253127545316306567222720824706</span></span>
<span id="cb89-55"><a href="#cb89-55" tabindex="-1"></a><span class="co">#&gt; Malic     0.000001311816282252918812938980233639973960180213907734</span></span>
<span id="cb89-56"><a href="#cb89-56" tabindex="-1"></a><span class="co">#&gt; OD280     0.000528849147753647388751907509885086255962960422039032</span></span>
<span id="cb89-57"><a href="#cb89-57" tabindex="-1"></a><span class="co">#&gt; Hue       0.000000000860356799865085320132513419953603633905103720</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. Which variables are significantly associated with dimension 1?
2. Which variables are significantly associated with dimension 2?
3. How would you interpret these dimensions?</p>
<hr />
</div>
</div>
<div id="part-2-correspondence-analysis-ca" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Part 2: Correspondence Analysis (CA)</h2>
<div id="exercise-2.1-understanding-ca-data---hair-and-eye-color" class="section level3" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Exercise 2.1: Understanding CA Data - Hair and Eye Color</h3>
<p>We‚Äôll work with a contingency table showing the relationship between hair color and eye color.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co"># Create a contingency table</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="co"># Hair color (rows) vs Eye color (columns)</span></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>hair_eye <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">3</span>,    <span class="co"># Black hair</span></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>                     <span class="dv">38</span>, <span class="dv">50</span>, <span class="dv">25</span>, <span class="dv">15</span>,    <span class="co"># Brown hair</span></span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a>                     <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">7</span>,      <span class="co"># Red hair</span></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>                     <span class="dv">3</span>, <span class="dv">30</span>, <span class="dv">5</span>, <span class="dv">8</span>),      <span class="co"># Blond hair</span></span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a>                   <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a><span class="fu">rownames</span>(hair_eye) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Black&quot;</span>, <span class="st">&quot;Brown&quot;</span>, <span class="st">&quot;Red&quot;</span>, <span class="st">&quot;Blond&quot;</span>)</span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a><span class="fu">colnames</span>(hair_eye) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Brown&quot;</span>, <span class="st">&quot;Blue&quot;</span>, <span class="st">&quot;Hazel&quot;</span>, <span class="st">&quot;Green&quot;</span>)</span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a></span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a><span class="co"># Convert to data frame for better display</span></span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a>hair_eye_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(hair_eye)</span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a>hair_eye_df</span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a><span class="co">#&gt;       Brown Blue Hazel Green</span></span>
<span id="cb90-16"><a href="#cb90-16" tabindex="-1"></a><span class="co">#&gt; Black    32   11    10     3</span></span>
<span id="cb90-17"><a href="#cb90-17" tabindex="-1"></a><span class="co">#&gt; Brown    38   50    25    15</span></span>
<span id="cb90-18"><a href="#cb90-18" tabindex="-1"></a><span class="co">#&gt; Red      10   10     7     7</span></span>
<span id="cb90-19"><a href="#cb90-19" tabindex="-1"></a><span class="co">#&gt; Blond     3   30     5     8</span></span>
<span id="cb90-20"><a href="#cb90-20" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" tabindex="-1"></a><span class="co"># Total</span></span>
<span id="cb90-22"><a href="#cb90-22" tabindex="-1"></a><span class="fu">sum</span>(hair_eye)</span>
<span id="cb90-23"><a href="#cb90-23" tabindex="-1"></a><span class="co">#&gt; [1] 264</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. What does this contingency table represent?
2. What is the total number of observations?
3. Are there any obvious associations between hair and eye color?</p>
</div>
<div id="exercise-2.2-perform-correspondence-analysis" class="section level3" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Exercise 2.2: Perform Correspondence Analysis</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co"># Perform CA</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>res.ca <span class="ot">&lt;-</span> <span class="fu">CA</span>(hair_eye, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a><span class="fu">print</span>(res.ca)</span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a><span class="co">#&gt; **Results of the Correspondence Analysis (CA)**</span></span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a><span class="co">#&gt; The row variable has  4  categories; the column variable has 4 categories</span></span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a><span class="co">#&gt; The chi square of independence between the two variables is equal to 42.16325 (p-value =  0.000003068241 ).</span></span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a><span class="co">#&gt; *The results are available in the following objects:</span></span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb91-11"><a href="#cb91-11" tabindex="-1"></a><span class="co">#&gt;    name              description                   </span></span>
<span id="cb91-12"><a href="#cb91-12" tabindex="-1"></a><span class="co">#&gt; 1  &quot;$eig&quot;            &quot;eigenvalues&quot;                 </span></span>
<span id="cb91-13"><a href="#cb91-13" tabindex="-1"></a><span class="co">#&gt; 2  &quot;$col&quot;            &quot;results for the columns&quot;     </span></span>
<span id="cb91-14"><a href="#cb91-14" tabindex="-1"></a><span class="co">#&gt; 3  &quot;$col$coord&quot;      &quot;coord. for the columns&quot;      </span></span>
<span id="cb91-15"><a href="#cb91-15" tabindex="-1"></a><span class="co">#&gt; 4  &quot;$col$cos2&quot;       &quot;cos2 for the columns&quot;        </span></span>
<span id="cb91-16"><a href="#cb91-16" tabindex="-1"></a><span class="co">#&gt; 5  &quot;$col$contrib&quot;    &quot;contributions of the columns&quot;</span></span>
<span id="cb91-17"><a href="#cb91-17" tabindex="-1"></a><span class="co">#&gt; 6  &quot;$row&quot;            &quot;results for the rows&quot;        </span></span>
<span id="cb91-18"><a href="#cb91-18" tabindex="-1"></a><span class="co">#&gt; 7  &quot;$row$coord&quot;      &quot;coord. for the rows&quot;         </span></span>
<span id="cb91-19"><a href="#cb91-19" tabindex="-1"></a><span class="co">#&gt; 8  &quot;$row$cos2&quot;       &quot;cos2 for the rows&quot;           </span></span>
<span id="cb91-20"><a href="#cb91-20" tabindex="-1"></a><span class="co">#&gt; 9  &quot;$row$contrib&quot;    &quot;contributions of the rows&quot;   </span></span>
<span id="cb91-21"><a href="#cb91-21" tabindex="-1"></a><span class="co">#&gt; 10 &quot;$call&quot;           &quot;summary called parameters&quot;   </span></span>
<span id="cb91-22"><a href="#cb91-22" tabindex="-1"></a><span class="co">#&gt; 11 &quot;$call$marge.col&quot; &quot;weights of the columns&quot;      </span></span>
<span id="cb91-23"><a href="#cb91-23" tabindex="-1"></a><span class="co">#&gt; 12 &quot;$call$marge.row&quot; &quot;weights of the rows&quot;</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. How many dimensions does CA create?
2. What is the total inertia? What does it represent?</p>
</div>
<div id="exercise-2.3-examine-eigenvalues-and-inertia" class="section level3" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Exercise 2.3: Examine Eigenvalues and Inertia</h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co"># Get eigenvalues</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>res.ca<span class="sc">$</span>eig</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a><span class="co">#&gt;        eigenvalue percentage of variance</span></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a><span class="co">#&gt; dim 1 0.143999532              90.163534</span></span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a><span class="co">#&gt; dim 2 0.012946621               8.106367</span></span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a><span class="co">#&gt; dim 3 0.002763128               1.730099</span></span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a><span class="co">#&gt;       cumulative percentage of variance</span></span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a><span class="co">#&gt; dim 1                          90.16353</span></span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a><span class="co">#&gt; dim 2                          98.26990</span></span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a><span class="co">#&gt; dim 3                         100.00000</span></span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a><span class="co"># Plot scree plot</span></span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a><span class="fu">fviz_screeplot</span>(res.ca, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex2-3-eigenvalues-1.png" width="100%" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="co"># Calculate percentage of inertia explained</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>inertia_percent <span class="ot">&lt;-</span> res.ca<span class="sc">$</span>eig[,<span class="dv">2</span>]</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>inertia_percent</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="co">#&gt;     dim 1     dim 2     dim 3 </span></span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a><span class="co">#&gt; 90.163534  8.106367  1.730099</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. How much inertia is explained by the first dimension?
2. How many dimensions would you retain? Why?</p>
</div>
<div id="exercise-2.4-analyze-rows-hair-colors" class="section level3" number="11.3.4">
<h3><span class="header-section-number">11.3.4</span> Exercise 2.4: Analyze Rows (Hair Colors)</h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co"># Row information</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>res.ca<span class="sc">$</span>row</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a><span class="co">#&gt; $coord</span></span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a><span class="co">#&gt;             Dim 1        Dim 2       Dim 3</span></span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a><span class="co">#&gt; Black -0.57580893 -0.087872153 -0.04746620</span></span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a><span class="co">#&gt; Brown  0.01954447 -0.001138702  0.05411300</span></span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a><span class="co">#&gt; Red   -0.00379309  0.275607428 -0.04979811</span></span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a><span class="co">#&gt; Blond  0.64940376 -0.093566482 -0.05598307</span></span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a><span class="co">#&gt; $contrib</span></span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a><span class="co">#&gt;              Dim 1        Dim 2    Dim 3</span></span>
<span id="cb94-12"><a href="#cb94-12" tabindex="-1"></a><span class="co">#&gt; Black 48.840468066 12.651155966 17.29625</span></span>
<span id="cb94-13"><a href="#cb94-13" tabindex="-1"></a><span class="co">#&gt; Brown  0.128615377  0.004855899 51.38168</span></span>
<span id="cb94-14"><a href="#cb94-14" tabindex="-1"></a><span class="co">#&gt; Red    0.001286768 75.561470941 11.55845</span></span>
<span id="cb94-15"><a href="#cb94-15" tabindex="-1"></a><span class="co">#&gt; Blond 51.029629789 11.782517193 19.76361</span></span>
<span id="cb94-16"><a href="#cb94-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb94-17"><a href="#cb94-17" tabindex="-1"></a><span class="co">#&gt; $cos2</span></span>
<span id="cb94-18"><a href="#cb94-18" tabindex="-1"></a><span class="co">#&gt;              Dim 1        Dim 2       Dim 3</span></span>
<span id="cb94-19"><a href="#cb94-19" tabindex="-1"></a><span class="co">#&gt; Black 0.9707945377 0.0226085682 0.006596894</span></span>
<span id="cb94-20"><a href="#cb94-20" tabindex="-1"></a><span class="co">#&gt; Brown 0.1153514752 0.0003915572 0.884256968</span></span>
<span id="cb94-21"><a href="#cb94-21" tabindex="-1"></a><span class="co">#&gt; Red   0.0001833889 0.9682074924 0.031609119</span></span>
<span id="cb94-22"><a href="#cb94-22" tabindex="-1"></a><span class="co">#&gt; Blond 0.9725820899 0.0201900445 0.007227866</span></span>
<span id="cb94-23"><a href="#cb94-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb94-24"><a href="#cb94-24" tabindex="-1"></a><span class="co">#&gt; $inertia</span></span>
<span id="cb94-25"><a href="#cb94-25" tabindex="-1"></a><span class="co">#&gt; [1] 0.072445860 0.001605576 0.010103885 0.075553960</span></span>
<span id="cb94-26"><a href="#cb94-26" tabindex="-1"></a></span>
<span id="cb94-27"><a href="#cb94-27" tabindex="-1"></a><span class="co"># Row coordinates</span></span>
<span id="cb94-28"><a href="#cb94-28" tabindex="-1"></a>res.ca<span class="sc">$</span>row<span class="sc">$</span>coord</span>
<span id="cb94-29"><a href="#cb94-29" tabindex="-1"></a><span class="co">#&gt;             Dim 1        Dim 2       Dim 3</span></span>
<span id="cb94-30"><a href="#cb94-30" tabindex="-1"></a><span class="co">#&gt; Black -0.57580893 -0.087872153 -0.04746620</span></span>
<span id="cb94-31"><a href="#cb94-31" tabindex="-1"></a><span class="co">#&gt; Brown  0.01954447 -0.001138702  0.05411300</span></span>
<span id="cb94-32"><a href="#cb94-32" tabindex="-1"></a><span class="co">#&gt; Red   -0.00379309  0.275607428 -0.04979811</span></span>
<span id="cb94-33"><a href="#cb94-33" tabindex="-1"></a><span class="co">#&gt; Blond  0.64940376 -0.093566482 -0.05598307</span></span>
<span id="cb94-34"><a href="#cb94-34" tabindex="-1"></a></span>
<span id="cb94-35"><a href="#cb94-35" tabindex="-1"></a><span class="co"># Row contributions</span></span>
<span id="cb94-36"><a href="#cb94-36" tabindex="-1"></a>res.ca<span class="sc">$</span>row<span class="sc">$</span>contrib</span>
<span id="cb94-37"><a href="#cb94-37" tabindex="-1"></a><span class="co">#&gt;              Dim 1        Dim 2    Dim 3</span></span>
<span id="cb94-38"><a href="#cb94-38" tabindex="-1"></a><span class="co">#&gt; Black 48.840468066 12.651155966 17.29625</span></span>
<span id="cb94-39"><a href="#cb94-39" tabindex="-1"></a><span class="co">#&gt; Brown  0.128615377  0.004855899 51.38168</span></span>
<span id="cb94-40"><a href="#cb94-40" tabindex="-1"></a><span class="co">#&gt; Red    0.001286768 75.561470941 11.55845</span></span>
<span id="cb94-41"><a href="#cb94-41" tabindex="-1"></a><span class="co">#&gt; Blond 51.029629789 11.782517193 19.76361</span></span>
<span id="cb94-42"><a href="#cb94-42" tabindex="-1"></a></span>
<span id="cb94-43"><a href="#cb94-43" tabindex="-1"></a><span class="co"># Row cos¬≤ (quality of representation)</span></span>
<span id="cb94-44"><a href="#cb94-44" tabindex="-1"></a>res.ca<span class="sc">$</span>row<span class="sc">$</span>cos2</span>
<span id="cb94-45"><a href="#cb94-45" tabindex="-1"></a><span class="co">#&gt;              Dim 1        Dim 2       Dim 3</span></span>
<span id="cb94-46"><a href="#cb94-46" tabindex="-1"></a><span class="co">#&gt; Black 0.9707945377 0.0226085682 0.006596894</span></span>
<span id="cb94-47"><a href="#cb94-47" tabindex="-1"></a><span class="co">#&gt; Brown 0.1153514752 0.0003915572 0.884256968</span></span>
<span id="cb94-48"><a href="#cb94-48" tabindex="-1"></a><span class="co">#&gt; Red   0.0001833889 0.9682074924 0.031609119</span></span>
<span id="cb94-49"><a href="#cb94-49" tabindex="-1"></a><span class="co">#&gt; Blond 0.9725820899 0.0201900445 0.007227866</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. Which hair color is best represented in the first dimension?
2. Which hair color contributes most to dimension 1?</p>
</div>
<div id="exercise-2.5-analyze-columns-eye-colors" class="section level3" number="11.3.5">
<h3><span class="header-section-number">11.3.5</span> Exercise 2.5: Analyze Columns (Eye Colors)</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co"># Column information</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>res.ca<span class="sc">$</span>col</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a><span class="co">#&gt; $coord</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a><span class="co">#&gt;            Dim 1       Dim 2        Dim 3</span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a><span class="co">#&gt; Brown -0.5007873 -0.04021648 -0.029465204</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a><span class="co">#&gt; Blue   0.3675634 -0.09349453  0.001139311</span></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a><span class="co">#&gt; Hazel -0.1148856  0.10363689  0.101053690</span></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a><span class="co">#&gt; Green  0.2982143  0.23969641 -0.073302482</span></span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a><span class="co">#&gt; $contrib</span></span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a><span class="co">#&gt;           Dim 1     Dim 2       Dim 3</span></span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a><span class="co">#&gt; Brown 54.754495  3.927587  9.87852390</span></span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a><span class="co">#&gt; Blue  35.893916 25.830536  0.01797218</span></span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a><span class="co">#&gt; Hazel  1.631790 14.769515 65.79566432</span></span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a><span class="co">#&gt; Green  7.719799 55.472361 24.30783960</span></span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a><span class="co">#&gt; $cos2</span></span>
<span id="cb95-18"><a href="#cb95-18" tabindex="-1"></a><span class="co">#&gt;           Dim 1       Dim 2          Dim 3</span></span>
<span id="cb95-19"><a href="#cb95-19" tabindex="-1"></a><span class="co">#&gt; Brown 0.9901862 0.006385844 0.003427907556</span></span>
<span id="cb95-20"><a href="#cb95-20" tabindex="-1"></a><span class="co">#&gt; Blue  0.9392228 0.060768222 0.000009023779</span></span>
<span id="cb95-21"><a href="#cb95-21" tabindex="-1"></a><span class="co">#&gt; Hazel 0.3864791 0.314501861 0.299019045325</span></span>
<span id="cb95-22"><a href="#cb95-22" tabindex="-1"></a><span class="co">#&gt; Green 0.5860051 0.378588491 0.035406394579</span></span>
<span id="cb95-23"><a href="#cb95-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-24"><a href="#cb95-24" tabindex="-1"></a><span class="co">#&gt; $inertia</span></span>
<span id="cb95-25"><a href="#cb95-25" tabindex="-1"></a><span class="co">#&gt; [1] 0.079627662 0.055031749 0.006079942 0.018969927</span></span>
<span id="cb95-26"><a href="#cb95-26" tabindex="-1"></a></span>
<span id="cb95-27"><a href="#cb95-27" tabindex="-1"></a><span class="co"># Column coordinates</span></span>
<span id="cb95-28"><a href="#cb95-28" tabindex="-1"></a>res.ca<span class="sc">$</span>col<span class="sc">$</span>coord</span>
<span id="cb95-29"><a href="#cb95-29" tabindex="-1"></a><span class="co">#&gt;            Dim 1       Dim 2        Dim 3</span></span>
<span id="cb95-30"><a href="#cb95-30" tabindex="-1"></a><span class="co">#&gt; Brown -0.5007873 -0.04021648 -0.029465204</span></span>
<span id="cb95-31"><a href="#cb95-31" tabindex="-1"></a><span class="co">#&gt; Blue   0.3675634 -0.09349453  0.001139311</span></span>
<span id="cb95-32"><a href="#cb95-32" tabindex="-1"></a><span class="co">#&gt; Hazel -0.1148856  0.10363689  0.101053690</span></span>
<span id="cb95-33"><a href="#cb95-33" tabindex="-1"></a><span class="co">#&gt; Green  0.2982143  0.23969641 -0.073302482</span></span>
<span id="cb95-34"><a href="#cb95-34" tabindex="-1"></a></span>
<span id="cb95-35"><a href="#cb95-35" tabindex="-1"></a><span class="co"># Column contributions</span></span>
<span id="cb95-36"><a href="#cb95-36" tabindex="-1"></a>res.ca<span class="sc">$</span>col<span class="sc">$</span>contrib</span>
<span id="cb95-37"><a href="#cb95-37" tabindex="-1"></a><span class="co">#&gt;           Dim 1     Dim 2       Dim 3</span></span>
<span id="cb95-38"><a href="#cb95-38" tabindex="-1"></a><span class="co">#&gt; Brown 54.754495  3.927587  9.87852390</span></span>
<span id="cb95-39"><a href="#cb95-39" tabindex="-1"></a><span class="co">#&gt; Blue  35.893916 25.830536  0.01797218</span></span>
<span id="cb95-40"><a href="#cb95-40" tabindex="-1"></a><span class="co">#&gt; Hazel  1.631790 14.769515 65.79566432</span></span>
<span id="cb95-41"><a href="#cb95-41" tabindex="-1"></a><span class="co">#&gt; Green  7.719799 55.472361 24.30783960</span></span>
<span id="cb95-42"><a href="#cb95-42" tabindex="-1"></a></span>
<span id="cb95-43"><a href="#cb95-43" tabindex="-1"></a><span class="co"># Column cos¬≤</span></span>
<span id="cb95-44"><a href="#cb95-44" tabindex="-1"></a>res.ca<span class="sc">$</span>col<span class="sc">$</span>cos2</span>
<span id="cb95-45"><a href="#cb95-45" tabindex="-1"></a><span class="co">#&gt;           Dim 1       Dim 2          Dim 3</span></span>
<span id="cb95-46"><a href="#cb95-46" tabindex="-1"></a><span class="co">#&gt; Brown 0.9901862 0.006385844 0.003427907556</span></span>
<span id="cb95-47"><a href="#cb95-47" tabindex="-1"></a><span class="co">#&gt; Blue  0.9392228 0.060768222 0.000009023779</span></span>
<span id="cb95-48"><a href="#cb95-48" tabindex="-1"></a><span class="co">#&gt; Hazel 0.3864791 0.314501861 0.299019045325</span></span>
<span id="cb95-49"><a href="#cb95-49" tabindex="-1"></a><span class="co">#&gt; Green 0.5860051 0.378588491 0.035406394579</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. Which eye color is best represented in the first dimension?
2. Which eye color contributes most to dimension 1?</p>
</div>
<div id="exercise-2.6-visualize-ca-results" class="section level3" number="11.3.6">
<h3><span class="header-section-number">11.3.6</span> Exercise 2.6: Visualize CA Results</h3>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># Symmetric plot (default)</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(res.ca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex2-6-plot-ca-1.png" width="100%" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a></span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="co"># Asymmetric plot (rows in principal coordinates)</span></span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(res.ca, <span class="at">map =</span> <span class="st">&quot;rowprincipal&quot;</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex2-6-plot-ca-2.png" width="100%" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="co"># Asymmetric plot (columns in principal coordinates)</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(res.ca, <span class="at">map =</span> <span class="st">&quot;colprincipal&quot;</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex2-6-plot-ca-3.png" width="100%" /></p>
<p><strong>Questions:</strong>
1. What does proximity between a row point and a column point indicate?
2. Which hair colors are associated with which eye colors?
3. What does the distance from the origin tell you?</p>
</div>
<div id="exercise-2.7-chi-square-test" class="section level3" number="11.3.7">
<h3><span class="header-section-number">11.3.7</span> Exercise 2.7: Chi-Square Test</h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="co"># Perform chi-square test</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a><span class="fu">chisq.test</span>(hair_eye)</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a><span class="co">#&gt;  Pearson&#39;s Chi-squared test</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a><span class="co">#&gt; data:  hair_eye</span></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="co">#&gt; X-squared = 42.163, df = 9, p-value = 0.000003068</span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a><span class="co"># CA provides chi-square statistics</span></span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a><span class="fu">summary</span>(res.ca)</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a><span class="co">#&gt; CA(X = hair_eye, graph = FALSE) </span></span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a><span class="co">#&gt; The chi square of independence between the two variables is equal to 42.16325 (p-value =  0.000003068241 ).</span></span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a><span class="co">#&gt; Eigenvalues</span></span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a><span class="co">#&gt;                        Dim.1   Dim.2   Dim.3</span></span>
<span id="cb99-19"><a href="#cb99-19" tabindex="-1"></a><span class="co">#&gt; Variance               0.144   0.013   0.003</span></span>
<span id="cb99-20"><a href="#cb99-20" tabindex="-1"></a><span class="co">#&gt; % of var.             90.164   8.106   1.730</span></span>
<span id="cb99-21"><a href="#cb99-21" tabindex="-1"></a><span class="co">#&gt; Cumulative % of var.  90.164  98.270 100.000</span></span>
<span id="cb99-22"><a href="#cb99-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-23"><a href="#cb99-23" tabindex="-1"></a><span class="co">#&gt; Rows</span></span>
<span id="cb99-24"><a href="#cb99-24" tabindex="-1"></a><span class="co">#&gt;         Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr</span></span>
<span id="cb99-25"><a href="#cb99-25" tabindex="-1"></a><span class="co">#&gt; Black |    72.446 | -0.576 48.840  0.971 | -0.088 12.651</span></span>
<span id="cb99-26"><a href="#cb99-26" tabindex="-1"></a><span class="co">#&gt; Brown |     1.606 |  0.020  0.129  0.115 | -0.001  0.005</span></span>
<span id="cb99-27"><a href="#cb99-27" tabindex="-1"></a><span class="co">#&gt; Red   |    10.104 | -0.004  0.001  0.000 |  0.276 75.561</span></span>
<span id="cb99-28"><a href="#cb99-28" tabindex="-1"></a><span class="co">#&gt; Blond |    75.554 |  0.649 51.030  0.973 | -0.094 11.783</span></span>
<span id="cb99-29"><a href="#cb99-29" tabindex="-1"></a><span class="co">#&gt;         cos2    Dim.3    ctr   cos2  </span></span>
<span id="cb99-30"><a href="#cb99-30" tabindex="-1"></a><span class="co">#&gt; Black  0.023 | -0.047 17.296  0.007 |</span></span>
<span id="cb99-31"><a href="#cb99-31" tabindex="-1"></a><span class="co">#&gt; Brown  0.000 |  0.054 51.382  0.884 |</span></span>
<span id="cb99-32"><a href="#cb99-32" tabindex="-1"></a><span class="co">#&gt; Red    0.968 | -0.050 11.558  0.032 |</span></span>
<span id="cb99-33"><a href="#cb99-33" tabindex="-1"></a><span class="co">#&gt; Blond  0.020 | -0.056 19.764  0.007 |</span></span>
<span id="cb99-34"><a href="#cb99-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb99-35"><a href="#cb99-35" tabindex="-1"></a><span class="co">#&gt; Columns</span></span>
<span id="cb99-36"><a href="#cb99-36" tabindex="-1"></a><span class="co">#&gt;         Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr</span></span>
<span id="cb99-37"><a href="#cb99-37" tabindex="-1"></a><span class="co">#&gt; Brown |    79.628 | -0.501 54.754  0.990 | -0.040  3.928</span></span>
<span id="cb99-38"><a href="#cb99-38" tabindex="-1"></a><span class="co">#&gt; Blue  |    55.032 |  0.368 35.894  0.939 | -0.093 25.831</span></span>
<span id="cb99-39"><a href="#cb99-39" tabindex="-1"></a><span class="co">#&gt; Hazel |     6.080 | -0.115  1.632  0.386 |  0.104 14.770</span></span>
<span id="cb99-40"><a href="#cb99-40" tabindex="-1"></a><span class="co">#&gt; Green |    18.970 |  0.298  7.720  0.586 |  0.240 55.472</span></span>
<span id="cb99-41"><a href="#cb99-41" tabindex="-1"></a><span class="co">#&gt;         cos2    Dim.3    ctr   cos2  </span></span>
<span id="cb99-42"><a href="#cb99-42" tabindex="-1"></a><span class="co">#&gt; Brown  0.006 | -0.029  9.879  0.003 |</span></span>
<span id="cb99-43"><a href="#cb99-43" tabindex="-1"></a><span class="co">#&gt; Blue   0.061 |  0.001  0.018  0.000 |</span></span>
<span id="cb99-44"><a href="#cb99-44" tabindex="-1"></a><span class="co">#&gt; Hazel  0.315 |  0.101 65.796  0.299 |</span></span>
<span id="cb99-45"><a href="#cb99-45" tabindex="-1"></a><span class="co">#&gt; Green  0.379 | -0.073 24.308  0.035 |</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. Is there a significant association between hair and eye color?
2. What does the chi-square statistic tell us?</p>
</div>
<div id="exercise-2.8-real-dataset---smoking-and-exercise" class="section level3" number="11.3.8">
<h3><span class="header-section-number">11.3.8</span> Exercise 2.8: Real Dataset - Smoking and Exercise</h3>
<p>Let‚Äôs work with a more realistic example. Create a contingency table from survey data.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="co"># Create a contingency table: Smoking status vs Exercise frequency</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>smoking_exercise <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">20</span>,    <span class="co"># Non-smoker</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>                             <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">15</span>,    <span class="co"># Occasional smoker</span></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>                             <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>),   <span class="co"># Regular smoker</span></span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>                           <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a><span class="fu">rownames</span>(smoking_exercise) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Non-smoker&quot;</span>, <span class="st">&quot;Occasional&quot;</span>, <span class="st">&quot;Regular&quot;</span>)</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a><span class="fu">colnames</span>(smoking_exercise) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Moderate&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>smoking_exercise_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(smoking_exercise)</span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a>smoking_exercise_df</span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a><span class="co">#&gt;            High Moderate Low</span></span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a><span class="co">#&gt; Non-smoker   50       30  20</span></span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a><span class="co">#&gt; Occasional   20       25  15</span></span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a><span class="co">#&gt; Regular      10       15  25</span></span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a></span>
<span id="cb100-17"><a href="#cb100-17" tabindex="-1"></a><span class="co"># Perform CA</span></span>
<span id="cb100-18"><a href="#cb100-18" tabindex="-1"></a>res.ca2 <span class="ot">&lt;-</span> <span class="fu">CA</span>(smoking_exercise, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb100-19"><a href="#cb100-19" tabindex="-1"></a><span class="fu">print</span>(res.ca2)</span>
<span id="cb100-20"><a href="#cb100-20" tabindex="-1"></a><span class="co">#&gt; **Results of the Correspondence Analysis (CA)**</span></span>
<span id="cb100-21"><a href="#cb100-21" tabindex="-1"></a><span class="co">#&gt; The row variable has  3  categories; the column variable has 3 categories</span></span>
<span id="cb100-22"><a href="#cb100-22" tabindex="-1"></a><span class="co">#&gt; The chi square of independence between the two variables is equal to 21 (p-value =  0.0003166692 ).</span></span>
<span id="cb100-23"><a href="#cb100-23" tabindex="-1"></a><span class="co">#&gt; *The results are available in the following objects:</span></span>
<span id="cb100-24"><a href="#cb100-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb100-25"><a href="#cb100-25" tabindex="-1"></a><span class="co">#&gt;    name              description                   </span></span>
<span id="cb100-26"><a href="#cb100-26" tabindex="-1"></a><span class="co">#&gt; 1  &quot;$eig&quot;            &quot;eigenvalues&quot;                 </span></span>
<span id="cb100-27"><a href="#cb100-27" tabindex="-1"></a><span class="co">#&gt; 2  &quot;$col&quot;            &quot;results for the columns&quot;     </span></span>
<span id="cb100-28"><a href="#cb100-28" tabindex="-1"></a><span class="co">#&gt; 3  &quot;$col$coord&quot;      &quot;coord. for the columns&quot;      </span></span>
<span id="cb100-29"><a href="#cb100-29" tabindex="-1"></a><span class="co">#&gt; 4  &quot;$col$cos2&quot;       &quot;cos2 for the columns&quot;        </span></span>
<span id="cb100-30"><a href="#cb100-30" tabindex="-1"></a><span class="co">#&gt; 5  &quot;$col$contrib&quot;    &quot;contributions of the columns&quot;</span></span>
<span id="cb100-31"><a href="#cb100-31" tabindex="-1"></a><span class="co">#&gt; 6  &quot;$row&quot;            &quot;results for the rows&quot;        </span></span>
<span id="cb100-32"><a href="#cb100-32" tabindex="-1"></a><span class="co">#&gt; 7  &quot;$row$coord&quot;      &quot;coord. for the rows&quot;         </span></span>
<span id="cb100-33"><a href="#cb100-33" tabindex="-1"></a><span class="co">#&gt; 8  &quot;$row$cos2&quot;       &quot;cos2 for the rows&quot;           </span></span>
<span id="cb100-34"><a href="#cb100-34" tabindex="-1"></a><span class="co">#&gt; 9  &quot;$row$contrib&quot;    &quot;contributions of the rows&quot;   </span></span>
<span id="cb100-35"><a href="#cb100-35" tabindex="-1"></a><span class="co">#&gt; 10 &quot;$call&quot;           &quot;summary called parameters&quot;   </span></span>
<span id="cb100-36"><a href="#cb100-36" tabindex="-1"></a><span class="co">#&gt; 11 &quot;$call$marge.col&quot; &quot;weights of the columns&quot;      </span></span>
<span id="cb100-37"><a href="#cb100-37" tabindex="-1"></a><span class="co">#&gt; 12 &quot;$call$marge.row&quot; &quot;weights of the rows&quot;</span></span></code></pre></div>
</div>
<div id="exercise-2.9-visualize-and-interpret" class="section level3" number="11.3.9">
<h3><span class="header-section-number">11.3.9</span> Exercise 2.9: Visualize and Interpret</h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co"># Create biplot</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(res.ca2, <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">&quot;CA: Smoking Status vs Exercise Frequency&quot;</span>)</span></code></pre></div>
<p><img src="18-lab-pca-ca_files/figure-html/ex2-9-plot-ca2-1.png" width="100%" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="co"># Get detailed information</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a><span class="fu">summary</span>(res.ca2)</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a><span class="co">#&gt; CA(X = smoking_exercise, graph = FALSE) </span></span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a><span class="co">#&gt; The chi square of independence between the two variables is equal to 21 (p-value =  0.0003166692 ).</span></span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a><span class="co">#&gt; Eigenvalues</span></span>
<span id="cb102-11"><a href="#cb102-11" tabindex="-1"></a><span class="co">#&gt;                        Dim.1   Dim.2</span></span>
<span id="cb102-12"><a href="#cb102-12" tabindex="-1"></a><span class="co">#&gt; Variance               0.088   0.012</span></span>
<span id="cb102-13"><a href="#cb102-13" tabindex="-1"></a><span class="co">#&gt; % of var.             87.500  12.500</span></span>
<span id="cb102-14"><a href="#cb102-14" tabindex="-1"></a><span class="co">#&gt; Cumulative % of var.  87.500 100.000</span></span>
<span id="cb102-15"><a href="#cb102-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb102-16"><a href="#cb102-16" tabindex="-1"></a><span class="co">#&gt; Rows</span></span>
<span id="cb102-17"><a href="#cb102-17" tabindex="-1"></a><span class="co">#&gt;              Iner*1000    Dim.1    ctr   cos2    Dim.2</span></span>
<span id="cb102-18"><a href="#cb102-18" tabindex="-1"></a><span class="co">#&gt; Non-smoker |    31.548 | -0.247 33.333  0.925 | -0.071</span></span>
<span id="cb102-19"><a href="#cb102-19" tabindex="-1"></a><span class="co">#&gt; Occasional |     8.929 |  0.000  0.000  0.000 |  0.177</span></span>
<span id="cb102-20"><a href="#cb102-20" tabindex="-1"></a><span class="co">#&gt; Regular    |    59.524 |  0.495 66.667  0.980 | -0.071</span></span>
<span id="cb102-21"><a href="#cb102-21" tabindex="-1"></a><span class="co">#&gt;               ctr   cos2  </span></span>
<span id="cb102-22"><a href="#cb102-22" tabindex="-1"></a><span class="co">#&gt; Non-smoker 19.048  0.075 |</span></span>
<span id="cb102-23"><a href="#cb102-23" tabindex="-1"></a><span class="co">#&gt; Occasional 71.429  1.000 |</span></span>
<span id="cb102-24"><a href="#cb102-24" tabindex="-1"></a><span class="co">#&gt; Regular     9.524  0.020 |</span></span>
<span id="cb102-25"><a href="#cb102-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb102-26"><a href="#cb102-26" tabindex="-1"></a><span class="co">#&gt; Columns</span></span>
<span id="cb102-27"><a href="#cb102-27" tabindex="-1"></a><span class="co">#&gt;              Iner*1000    Dim.1    ctr   cos2    Dim.2</span></span>
<span id="cb102-28"><a href="#cb102-28" tabindex="-1"></a><span class="co">#&gt; High       |    39.881 | -0.314 42.857  0.940 | -0.079</span></span>
<span id="cb102-29"><a href="#cb102-29" tabindex="-1"></a><span class="co">#&gt; Moderate   |     8.333 |  0.000  0.000  0.000 |  0.158</span></span>
<span id="cb102-30"><a href="#cb102-30" tabindex="-1"></a><span class="co">#&gt; Low        |    51.786 |  0.418 57.143  0.966 | -0.079</span></span>
<span id="cb102-31"><a href="#cb102-31" tabindex="-1"></a><span class="co">#&gt;               ctr   cos2  </span></span>
<span id="cb102-32"><a href="#cb102-32" tabindex="-1"></a><span class="co">#&gt; High       19.048  0.060 |</span></span>
<span id="cb102-33"><a href="#cb102-33" tabindex="-1"></a><span class="co">#&gt; Moderate   66.667  1.000 |</span></span>
<span id="cb102-34"><a href="#cb102-34" tabindex="-1"></a><span class="co">#&gt; Low        14.286  0.034 |</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. What associations do you see between smoking and exercise?
2. How would you interpret the dimensions?
3. What insights can you draw from this analysis?</p>
<hr />
</div>
</div>
<div id="part-3-integrated-exercise" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Part 3: Integrated Exercise</h2>
<div id="exercise-3.1-complete-analysis---usarrests-dataset" class="section level3" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Exercise 3.1: Complete Analysis - USArrests Dataset</h3>
<p>Perform a complete PCA analysis on the <code>USArrests</code> dataset and answer the following questions:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="fu">data</span>(USArrests)</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a><span class="fu">head</span>(USArrests)</span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a><span class="co">#&gt;            Murder Assault UrbanPop Rape</span></span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a><span class="co">#&gt; Alabama      13.2     236       58 21.2</span></span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a><span class="co">#&gt; Alaska       10.0     263       48 44.5</span></span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a><span class="co">#&gt; Arizona       8.1     294       80 31.0</span></span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a><span class="co">#&gt; Arkansas      8.8     190       50 19.5</span></span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a><span class="co">#&gt; California    9.0     276       91 40.6</span></span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a><span class="co">#&gt; Colorado      7.9     204       78 38.7</span></span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" tabindex="-1"></a><span class="co"># Your tasks:</span></span>
<span id="cb103-13"><a href="#cb103-13" tabindex="-1"></a><span class="co"># 1. Explore the data (means, variances, correlations)</span></span>
<span id="cb103-14"><a href="#cb103-14" tabindex="-1"></a><span class="co"># 2. Perform PCA</span></span>
<span id="cb103-15"><a href="#cb103-15" tabindex="-1"></a><span class="co"># 3. Determine how many components to retain</span></span>
<span id="cb103-16"><a href="#cb103-16" tabindex="-1"></a><span class="co"># 4. Interpret the results</span></span>
<span id="cb103-17"><a href="#cb103-17" tabindex="-1"></a><span class="co"># 5. Create visualizations</span></span>
<span id="cb103-18"><a href="#cb103-18" tabindex="-1"></a><span class="co"># 6. Describe what each dimension represents</span></span>
<span id="cb103-19"><a href="#cb103-19" tabindex="-1"></a></span>
<span id="cb103-20"><a href="#cb103-20" tabindex="-1"></a><span class="co"># Write your code here:</span></span></code></pre></div>
<p><strong>Questions to Answer:</strong>
1. Why is standardization important for this dataset?
2. How many principal components should be retained? Justify your answer.
3. What does the first principal component represent?
4. Which states are outliers or unusual?
5. Can you identify regional patterns in the data?</p>
</div>
<div id="exercise-3.2-ca-on-survey-data" class="section level3" number="11.4.2">
<h3><span class="header-section-number">11.4.2</span> Exercise 3.2: CA on Survey Data</h3>
<p>Create your own contingency table (e.g., from a survey or research question) and perform CA.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="co"># Create your contingency table here</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="co"># Example: Education level vs Job satisfaction</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="co"># my_table &lt;- matrix(c(...), nrow = ..., ncol = ...)</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a><span class="co"># Perform CA</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a><span class="co"># res.ca.custom &lt;- CA(my_table, graph = FALSE)</span></span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a><span class="co"># Visualize and interpret</span></span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a><span class="co"># fviz_ca_biplot(res.ca.custom, repel = TRUE)</span></span></code></pre></div>
<p><strong>Questions:</strong>
1. What is your research question?
2. What associations do you find?
3. How would you interpret the dimensions?</p>
<hr />
</div>
</div>
<div id="summary-and-key-takeaways" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Summary and Key Takeaways</h2>
<p>After completing these exercises, you should be able to:</p>
<p>‚úÖ <strong>PCA:</strong>
- Understand when and why to use PCA
- Perform PCA using FactoMineR
- Interpret eigenvalues, loadings, and contributions
- Determine the optimal number of components
- Visualize and interpret PCA results
- Understand the difference between covariance and correlation-based PCA</p>
<p>‚úÖ <strong>CA:</strong>
- Understand when to use CA (categorical data in contingency tables)
- Perform CA using FactoMineR
- Interpret row and column coordinates
- Understand the relationship between CA and chi-square test
- Visualize and interpret CA results
- Understand the difference between symmetric and asymmetric plots</p>
<div id="common-mistakes-to-avoid" class="section level3" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Common Mistakes to Avoid</h3>
<ol style="list-style-type: decimal">
<li><strong>Forgetting to standardize</strong> in PCA when variables are on different scales</li>
<li><strong>Using PCA on categorical data</strong> - use CA instead</li>
<li><strong>Over-interpreting dimensions</strong> - not all dimensions are meaningful</li>
<li><strong>Ignoring quality of representation</strong> - check cos¬≤ values</li>
<li><strong>Not checking assumptions</strong> - understand your data before analysis</li>
</ol>
</div>
<div id="next-steps" class="section level3" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Next Steps</h3>
<ul>
<li>Practice with different datasets</li>
<li>Try combining PCA with clustering (see clustering chapters)</li>
<li>Explore other dimensionality reduction techniques</li>
<li>Read about Multiple Correspondence Analysis (MCA) for multiple categorical variables</li>
</ul>
<hr />
</div>
</div>
<div id="additional-resources" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> Additional Resources</h2>
<div id="r-documentation" class="section level3" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> R Documentation</h3>
<ul>
<li>FactoMineR documentation: <code>?PCA</code>, <code>?CA</code></li>
<li>factoextra documentation: <code>?fviz_pca_var</code>, <code>?fviz_ca_biplot</code></li>
</ul>
</div>
<div id="online-resources-all-links-verified-and-working" class="section level3" number="11.6.2">
<h3><span class="header-section-number">11.6.2</span> Online Resources (All Links Verified and Working)</h3>
<div id="official-package-documentation" class="section level4" number="11.6.2.1">
<h4><span class="header-section-number">11.6.2.1</span> Official Package Documentation</h4>
<ul>
<li><strong>FactoMineR CRAN</strong>: <a href="https://cran.r-project.org/package=FactoMineR" class="uri">https://cran.r-project.org/package=FactoMineR</a></li>
<li><strong>FactoMineR GitHub</strong>: <a href="https://github.com/husson/FactoMineR" class="uri">https://github.com/husson/FactoMineR</a></li>
<li><strong>FactoMineR Website</strong>: <a href="http://factominer.free.fr/" class="uri">http://factominer.free.fr/</a></li>
<li><strong>factoextra CRAN</strong>: <a href="https://cran.r-project.org/package=factoextra" class="uri">https://cran.r-project.org/package=factoextra</a></li>
</ul>
</div>
<div id="tutorials-and-guides-1" class="section level4" number="11.6.2.2">
<h4><span class="header-section-number">11.6.2.2</span> Tutorials and Guides</h4>
<ul>
<li><strong>STHDA PCA Guide</strong>: <a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/" class="uri">http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/</a></li>
<li><strong>STHDA CA Guide</strong>: <a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/113-ca-correspondence-analysis-in-r-the-essentials/" class="uri">http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/113-ca-correspondence-analysis-in-r-the-essentials/</a></li>
<li><strong>R Documentation Search</strong>: <a href="https://www.rdocumentation.org/" class="uri">https://www.rdocumentation.org/</a> (search for PCA, CA functions)</li>
</ul>
</div>
<div id="r-markdown-resources-from-slides" class="section level4" number="11.6.2.3">
<h4><span class="header-section-number">11.6.2.3</span> R Markdown Resources (from slides)</h4>
<ul>
<li><strong>R Markdown Cheat Sheet</strong>: <a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a> (download R Markdown cheat sheet)</li>
<li><strong>R Markdown Guide</strong>: <a href="https://bookdown.org/yihui/rmarkdown/" class="uri">https://bookdown.org/yihui/rmarkdown/</a></li>
<li><strong>RStudio Download</strong>: <a href="https://www.rstudio.com/products/rstudio/download/" class="uri">https://www.rstudio.com/products/rstudio/download/</a></li>
<li><strong>R Markdown Tutorial</strong>: <a href="https://rmarkdown.rstudio.com/lesson-1.html" class="uri">https://rmarkdown.rstudio.com/lesson-1.html</a></li>
</ul>
</div>
</div>
<div id="further-reading" class="section level3" number="11.6.3">
<h3><span class="header-section-number">11.6.3</span> Further Reading</h3>
<ul>
<li>Review the theoretical slides for deeper understanding</li>
<li>Check the main PCA chapter (Chapter 17) for more examples</li>
<li><strong>Principal Component Analysis</strong> by Jolliffe (textbook)</li>
<li><strong>Correspondence Analysis in Practice</strong> by Greenacre</li>
</ul>
<p><strong>‚ö†Ô∏è Important</strong>: If you find broken links in the PDF slides (<code>module_2_PCA_&amp;_CA.pdf</code>), all the links above are verified and working. Use this section as your reference.</p>
<p><strong>Good luck with your analysis! üçÄ</strong></p>
<!--chapter:end:18-lab-pca-ca.Rmd-->
</div>
</div>
</div>
<div id="hier-clust" class="section level1" number="12">
<h1><span class="header-section-number">12</span> üíª Hierarchical Clustering</h1>
<p>Hierarchical clustering is a machine learning technique used to group data points into clusters based on their similarity. It works by creating a hierarchical tree-like structure of clusters, where each cluster is divided into smaller clusters until all data points are grouped together. This technique is useful for finding patterns in data and can be used for a variety of applications, such as customer segmentation, image recognition, and anomaly detection.</p>
<p>If you are stuck either ask to the TA or team work! Collaboration is always key üëØ‚Äç‚ôÇÔ∏è!</p>
<p>Remember also that if you want to visualize clusters you may think to use <code>fviz_cluster()</code> from lib <code>factoextra</code>. you just simply define which observation belogs to which group taking advantage of the <code>cutree</code> function. Below a minimal example</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">library</span>(cluster)  <span class="co"># clustering algorithms</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="co">#</span></span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df)</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">scale</span>(df)</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a> </span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a><span class="co"># Dissimilarity matrix</span></span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(df, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a><span class="co"># Hierarchical clustering using Complete Linkage</span></span>
<span id="cb106-9"><a href="#cb106-9" tabindex="-1"></a>hc1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">&quot;complete&quot;</span> )</span>
<span id="cb106-10"><a href="#cb106-10" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" tabindex="-1"></a><span class="co"># Cut tree into 3 groups</span></span>
<span id="cb106-12"><a href="#cb106-12" tabindex="-1"></a>sub_grps <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc1, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb106-13"><a href="#cb106-13" tabindex="-1"></a> </span>
<span id="cb106-14"><a href="#cb106-14" tabindex="-1"></a><span class="co"># Visualize the result in a scatter plot</span></span>
<span id="cb106-15"><a href="#cb106-15" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> df, <span class="at">cluster =</span> sub_grps))</span></code></pre></div>
<p><img src="19-hierarchical-clustering_files/figure-html/example-hier-1.png" width="100%" /></p>
<div id="exercises" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> 19.1 Exercises üë®‚Äçüíª</h2>
<div id="exercise-19.1" class="section level3" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Exercise 19.1</h3>
<p>Consider the USArrests data which is by default installed with R. We will now perform hierarchical clustering on the states.</p>
<ol style="list-style-type: decimal">
<li>compute the distance matrix of for data USArrests.</li>
<li>Using hierarchical clustering though funtion hclust with complete linkage and Euclidean distance, cluster the states.</li>
<li>Cut the dendrogram at a height that results in 4 distinct clusters. Which states belong to which clusters?</li>
<li>It‚Äôs also possible to draw the dendrogram with a border around the clusters when they are 4. The argument border is used to specify the border colors for the rectangles:</li>
<li>Visualise results with scatterplot</li>
<li>Let‚Äôs say you are interested in clustering data USArrests for just Murder and Rape. What are the results?</li>
</ol>
<p>Remember how to use hclust.</p>
<div class="answer">
<p><strong>Answer to Question 19.1:</strong></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co"># Distance matrix</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(USArrests)</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>hc_complete <span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(USArrests),<span class="at">method=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a><span class="fu">plot</span>(hc_complete)</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>sub_groups <span class="ot">=</span> <span class="fu">cutree</span>(hc_complete, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a><span class="fu">rect.hclust</span>(hc_complete, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="19-hierarchical-clustering_files/figure-html/answer-19-1-1.png" width="100%" /></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> <span class="fu">dist</span>(USArrests), <span class="at">cluster =</span> sub_groups))</span></code></pre></div>
<p><img src="19-hierarchical-clustering_files/figure-html/answer-19-1-2.png" width="100%" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>us_arrests_simplified <span class="ot">=</span> <span class="fu">select</span>(USArrests, Murder, Rape)</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>hc_complete_simple <span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(us_arrests_simplified), <span class="at">method=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a><span class="fu">plot</span>(hc_complete_simple)</span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a><span class="fu">rect.hclust</span>(hc_complete_simple, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="19-hierarchical-clustering_files/figure-html/answer-19-1-3.png" width="100%" /></p>
</div>
</div>
<div id="exercise-19.2" class="section level3" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Exercise 19.2</h3>
<p>suppose you measure a small sample of penguins üêß. Measurament are stored into the following dataframe:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>penguins_small <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>    <span class="at">depth =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">2.7</span>, <span class="fl">3.2</span>, <span class="fl">3.5</span>, <span class="fl">3.6</span>),</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>    <span class="at">length =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">4.7</span>)</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Fit hierarchical clustering and visualize it both through dendogram and scatterplot</p>
<div class="answer">
<p><strong>Answer to Question 19.2:</strong></p>
<p>At first visualise clusters through dendogram</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>penguin_cluster <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(penguins_small), <span class="at">method =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a><span class="fu">plot</span>(penguin_cluster)</span></code></pre></div>
<p><img src="19-hierarchical-clustering_files/figure-html/answer-19-2-1.png" width="100%" /></p>
<p>then with scatter:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>penguins_subgroups <span class="ot">=</span> <span class="fu">cutree</span>(penguin_cluster, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> <span class="fu">dist</span>(penguins_small), <span class="at">cluster =</span> penguins_subgroups))</span></code></pre></div>
<p><img src="19-hierarchical-clustering_files/figure-html/answer-19-2-scatter-1.png" width="100%" /></p>
</div>
</div>
<div id="exercise-19.3" class="section level3" number="12.1.3">
<h3><span class="header-section-number">12.1.3</span> Exercise 19.3</h3>
<p>The coleman data set in the robustbase library lists summary statistics for 20 different schools in the northeast US.</p>
<p>The six variables measured on each school include demographic information (such as percent of white-collar fathers) and characteristics of each school (such as staff salaries per pupil).</p>
<p>Perform a hierarchical cluster of this data using all explanatory variables.</p>
<p>If we cluster individuals in 9 groups how many individuals fall in the largest cluster ?</p>
<div class="answer">
<p><strong>Answer to Question 19.3:</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">library</span>(robustbase)</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="fu">data</span>(coleman)</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a><span class="co"># Perform hierarchical clustering</span></span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>hc_coleman <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(coleman), <span class="at">method =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a><span class="fu">plot</span>(hc_coleman)</span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a><span class="co"># Cut into 9 groups</span></span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>sub_groups_coleman <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc_coleman, <span class="at">k =</span> <span class="dv">9</span>)</span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a></span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a><span class="co"># Find the largest cluster</span></span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a><span class="fu">table</span>(sub_groups_coleman)</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">table</span>(sub_groups_coleman))</span></code></pre></div>
</div>
<!--chapter:end:19-hierarchical-clustering.Rmd-->
</div>
</div>
</div>
<div id="k-means" class="section level1" number="13">
<h1><span class="header-section-number">13</span> üíª K-Means Clustering</h1>
<p>K-means clustering is an unsupervised machine learning algorithm used to group data points into clusters. It is one of the most popular clustering algorithms and is used in a variety of applications, such as image segmentation, data compression, and market segmentation. The algorithm works by assigning each data point to the closest cluster center, and then iteratively updating the cluster centers to minimize the distance between them and the data points.</p>
<p>If you are stuck either ask to the TA or team work! Collaboration is always key üëØ‚Äç‚ôÇÔ∏è! As you may notice the functioning is pretty similar to hierarchical clustering, so we will not spend too much time on that!</p>
<p>Remember also that if you want to visualize clusters you may think to use <code>fviz_cluster()</code> from lib <code>factoextra</code>. You can also use the ggplot2 package calling the autoplot function on the kmean regression. We are going to use the same dataset USArrests. We are scaling data because we don‚Äôt want the clustering algorithm to depend to an arbitrary variable unit, we start by scaling/standardizing the data using the R function. This could/should be done also for hierarchical cluster. Please note also that if you want to consistently reproduce results across you need to set the seed to a specific number with <code>set.seed(28)</code></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a>scale_USArrests <span class="ot">&lt;-</span> <span class="fu">scale</span>(USArrests)</span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(scale_USArrests, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k2, <span class="at">data =</span> scale_USArrests)</span></code></pre></div>
<p><img src="20-k-means-clustering_files/figure-html/kmeans-example-1.png" width="100%" /></p>
<p>Lets also see how clusters change wrt the number of <span class="math inline">\(k\)</span>s</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(scale_USArrests, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(scale_USArrests, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>k5 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(scale_USArrests, <span class="at">centers =</span> <span class="dv">5</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a><span class="co"># plots to compare</span></span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">fviz_cluster</span>(k2, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">data =</span> scale_USArrests) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;k = 2&quot;</span>)</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">fviz_cluster</span>(k3, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,  <span class="at">data =</span> scale_USArrests) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;k = 3&quot;</span>)</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">fviz_cluster</span>(k4, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,  <span class="at">data =</span> scale_USArrests) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;k = 4&quot;</span>)</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">fviz_cluster</span>(k5, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,  <span class="at">data =</span> scale_USArrests) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;k = 5&quot;</span>)</span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a></span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-14"><a href="#cb116-14" tabindex="-1"></a><span class="co">#&gt; Caricamento pacchetto: &#39;gridExtra&#39;</span></span>
<span id="cb116-15"><a href="#cb116-15" tabindex="-1"></a><span class="co">#&gt; Il seguente oggetto `e mascherato da &#39;package:dplyr&#39;:</span></span>
<span id="cb116-16"><a href="#cb116-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-17"><a href="#cb116-17" tabindex="-1"></a><span class="co">#&gt;     combine</span></span>
<span id="cb116-18"><a href="#cb116-18" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="20-k-means-clustering_files/figure-html/kmeans-multiple-k-1.png" width="100%" /></p>
<div id="exercises-1" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> 20.1 Exercises üë®‚Äçüíª</h2>
<div id="exercise-20.1" class="section level3" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Exercise 20.1</h3>
<p>Let‚Äôs have a look at an example in R using the Chatterjee-Price Attitude Data from the <code>library(datasets)</code> package. The dataset is a survey of clerical employees of a large financial organization. The data are aggregated from questionnaires of approximately 35 employees for each of 30 (randomly selected) departments. The numbers give the percent proportion of favourable responses to seven questions in each department. For more details, see <code>?attitude</code>. We take a subset of the attitude dataset and consider only two variables in our K-Means clustering exercise i.e.¬†privileges learning.</p>
<ol style="list-style-type: decimal">
<li>visualize privileges and learning in a scatterplot. Do you see any cluster?</li>
<li>apply algorithm kmeans on data with <span class="math inline">\(k = 2\)</span> and visualize results through the function fviz_cluster</li>
<li>now let‚Äôs try with <span class="math inline">\(k = 3\)</span>, by visual inspection , do you think it is better?</li>
</ol>
<p>Remember how to use kmeans which is in base::R.</p>
<div class="answer">
<p><strong>Answer to Question 20.1:</strong></p>
<p>at first select variables from data:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>selected_data <span class="ot">=</span> <span class="fu">select</span>(attitude, privileges, learning)</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a><span class="fu">plot</span>(selected_data,  <span class="at">pch =</span><span class="dv">20</span>, <span class="at">cex =</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="20-k-means-clustering_files/figure-html/answer-20-1-1.png" width="100%" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>  </span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="co"># execute k-means algo:</span></span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>km1 <span class="ot">=</span> <span class="fu">kmeans</span>(selected_data, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart=</span><span class="dv">100</span>)</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km1, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">data =</span> selected_data)</span></code></pre></div>
<p><img src="20-k-means-clustering_files/figure-html/answer-20-1-2.png" width="100%" /></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a><span class="co"># let&#39;s try with k = 3</span></span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>km2 <span class="ot">=</span> <span class="fu">kmeans</span>(selected_data, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">100</span>)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km2, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">data =</span> selected_data)</span></code></pre></div>
<p><img src="20-k-means-clustering_files/figure-html/answer-20-1-3.png" width="100%" /></p>
</div>
</div>
</div>
<div id="bonus-elbow-method" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> 20.2 bonus: elbow method ‚ú®</h2>
<p>The main goal of cluster partitioning algorithms, such as k-means clustering, is to minimize the total intra-cluster variation, also known as the total within-cluster variation or total within-cluster sum of square.</p>
<p><span class="math display">\[minimize(\sum_{k = 1}^{k}W(C_k))\]</span></p>
<p>where <span class="math inline">\(C_k\)</span> is the <span class="math inline">\(k\)</span>th cluster and <span class="math inline">\(W(C_k)\)</span> is the within-cluster variation. The total within-cluster sum of square (wss) measures the compactness of the clustering and we want it to be as small as possible. Thus, we can use the following algorithm to define the optimal clusters:</p>
<ol style="list-style-type: decimal">
<li>Compute clustering algorithm (e.g., k-means clustering) for different values of k. For instance, by varying k from 1 to 10 clusters</li>
<li>For each k, calculate the total within-cluster sum of square (wss)</li>
<li>Plot the curve of wss according to the number of clusters k.</li>
<li>The location of a bend (knee) in the plot is generally considered as an indicator of the appropriate number of clusters.</li>
</ol>
<div id="code-implementation" class="section level3" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> 20.2.1 code implementation</h3>
<p>Data is the same as beginning</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(scale_USArrests, kmeans, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>)</span></code></pre></div>
<p><img src="20-k-means-clustering_files/figure-html/elbow-method-1.png" width="100%" /></p>
<!--chapter:end:20-k-means-clustering.Rmd-->
</div>
</div>
</div>
<div id="part-additional-resources" class="section level1 unnumbered">
<h1 class="unnumbered">(PART*) Additional Resources</h1>
</div>
<div id="int-prep" class="section level1" number="14">
<h1><span class="header-section-number">14</span> üíª Intermediate preparation</h1>
<p>Intermediate test topics should include:
- <strong>hypothesis tests on means</strong>
- <strong>anova</strong>
- <strong>simple + multiple regression (adj-R2 + collinearity + dummy vars)</strong>
- <strong>logistic regression</strong></p>
<p>Below you find a review of core concepts and a bunch of exercises which in some way may resemble intermediate ones.</p>
<div id="core-concepts-of-t-test" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> ü™® core concepts of T test</h2>
<p>recall from <a href="https://drive.google.com/file/d/1UqDW1UG5CY3wbW2SisCqzoPtK7ZpvQs7/view?usp=sharing">Arbia‚Äôs slide</a> 69 that we are focusing on test on <strong>mean</strong> and that steps for calculating statistical tests generally are:</p>
<ol style="list-style-type: decimal">
<li>Develop the null Hypothesis</li>
<li>Specify the level of Significance <span class="math inline">\(\alpha\)</span></li>
<li>Collect the sample data and compute the test statistic.</li>
</ol>
<p>then <em>pvalues</em>:
4. Use the value of the test statistic to compute the p-value
5. Reject <span class="math inline">\(H_0\)</span> if p-value $ &lt; $</p>
<p>Notice that Z-test are not really used since we almost always do not know the variance <span class="math inline">\(\sigma^2\)</span> of the distribution. So instead of Standard Normal distribution we use Student‚Äôs <strong>T distribution</strong>, doing t-tests. That‚Äôs the t test stat:</p>
<p><span class="math display">\[
t = \frac{(m - \mu_0)}{S/\sqrt{n}}
\]</span></p>
<p>Below all the possible cases you should be dealing with:</p>
<div class="figure">
<img src="images/wf_test.png" alt="The t.test vademecum" width="100%" />
<p class="caption">
(#fig:ttest)The t.test vademecum
</p>
</div>
</div>
<div id="t.test-function" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> <code>t.test()</code> function</h2>
<p>The <code>t.test()</code> function may run one and two sample t-tests on data vectors. The function has several parameters and is invoked as follows:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;greater&quot;</span>), <span class="at">mu =</span> <span class="dv">0</span>, </span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>        <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p>In this case, <code>x</code> is a numeric vector of data values, and <code>y</code> is optional. If <code>y</code> is not included, the function does a one-sample t-test on the data in <code>x</code>; if it is included, the function runs a two-sample t-test on both <code>x</code> and <code>y</code>.</p>
<p>The <code>mu</code> (i.e.¬†<span class="math inline">\(\mu\)</span>) argument returns a number showing the real value of the mean (or difference in means if a two sample test is used) under the null hypothesis. The test conducts a two-sided t-test by default; however, you may perform an alternative hypothesis by changing the <code>alternative</code> argument to <code>"greater"</code> or <code>"less"</code>, depending on whether the alternative hypothesis is that the mean is larger than or smaller than <code>mu</code>. Consider the following:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="at">mu =</span> <span class="dv">25</span>)</span></code></pre></div>
<p>‚Ä¶performs a one-sample t-test on the data contained in <code>x</code> where the null hypothesis is that $ = 25$ and the alternative is that $ &lt; 25 $</p>
<p>The <code>paired</code> argument will indicate whether or not you want a paired t-test. The default is set to <code>FALSE</code> but can be set to <code>TRUE</code> if you desire to perform a paired t-test. We do paired test when we are considering pre-post treatment test or when we are considering couples of individuals.</p>
<p>When doing a two-sample t-test, the <code>var.equal</code> option specifies whether or not to assume equal variances. The default assumption is unequal variance and the Welsh approximation to degrees of freedom; however, you may change this to <code>TRUE</code> to pool the variance.</p>
<p>Finally, the <code>conf.level</code> parameter specifies the degree of confidence in the reported confidence interval for <span class="math inline">\(\mu\)</span> in the one-sample and for <span class="math inline">\(\mu_1 - \mu_2\)</span> two-sample cases. Below a very simple example:</p>
<p>To use the <code>lm()</code> function in R for linear modeling, you can create a Markdown document to explain its usage and its various arguments. Below is an example of how to create a conceptual guide in RMarkdown format:</p>
<p>##¬†Linear Modeling with lm() in R</p>
</div>
<div id="introduction" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Introduction</h2>
<p>The <code>lm()</code> function in R is used for performing linear regression modeling. Linear regression is a statistical method that models the relationship between a dependent variable and one or more independent variables. In this document, we will explore how to use the <code>lm()</code> function and its various arguments for linear modeling.</p>
</div>
<div id="basic-usage" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Basic Usage</h2>
<p>To perform linear modeling with <code>lm()</code>, you need to specify the formula of the linear regression model. The basic syntax is as follows:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(dependent_variable <span class="sc">~</span> independent_variable, <span class="at">data =</span> your_data)</span></code></pre></div>
<ul>
<li><code>dependent_variable</code>: The variable you want to predict.</li>
<li><code>independent_variable</code>: The variable(s) used to make the prediction.</li>
<li><code>data</code>: The data frame containing your variables.</li>
</ul>
</div>
<div id="arguments" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Arguments</h2>
<div id="formula" class="section level3" number="14.5.1">
<h3><span class="header-section-number">14.5.1</span> Formula</h3>
<p>The formula is at the core of the <code>lm()</code> function and specifies the relationship between the dependent and independent variables. It follows the <code>Y ~ X</code> pattern, where <code>Y</code> is the dependent variable, and <code>X</code> is the independent variable. You can include multiple independent variables and interactions by using <code>+</code> and <code>*</code>. For example:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x1<span class="sc">*</span>x2, <span class="at">data =</span> your_data)</span></code></pre></div>
</div>
<div id="data" class="section level3" number="14.5.2">
<h3><span class="header-section-number">14.5.2</span> Data</h3>
<p>The <code>data</code> argument should point to the data frame where your variables are located. This argument helps R locate the variables specified in the formula.</p>
</div>
<div id="subset" class="section level3" number="14.5.3">
<h3><span class="header-section-number">14.5.3</span> Subset</h3>
<p>You can use the <code>subset</code> argument to specify a subset of your data for modeling. This is useful when you want to focus on a specific portion of your dataset.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> your_data, <span class="at">subset =</span> condition)</span></code></pre></div>
</div>
<div id="weight" class="section level3" number="14.5.4">
<h3><span class="header-section-number">14.5.4</span> Weight</h3>
<p>The <code>weight</code> argument allows you to assign different weights to each data point. This can be useful when you want to give more importance to certain observations.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> your_data, <span class="at">weights =</span> weight_variable)</span></code></pre></div>
</div>
<div id="na.action" class="section level3" number="14.5.5">
<h3><span class="header-section-number">14.5.5</span> Na.action</h3>
<p>The <code>na.action</code> argument controls how missing values are treated. By default, <code>na.action = na.fail</code>, which means the model will fail if there are missing values in your data. You can also use <code>na.omit</code> to automatically remove rows with missing values.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> your_data, <span class="at">na.action =</span> na.omit)</span></code></pre></div>
</div>
<div id="other-arguments" class="section level3" number="14.5.6">
<h3><span class="header-section-number">14.5.6</span> Other Arguments</h3>
<p>There are additional arguments for controlling aspects of the modeling process, such as <code>offset</code>, <code>method</code>, and <code>control</code>. You can refer to the R documentation for a complete list of available arguments and their descriptions.</p>
</div>
</div>
<div id="vif-variance-inflation-factor" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> VIF (Variance Inflation Factor)</h2>
<p>The Variance Inflation Factor (VIF) is a measure used to detect multicollinearity in a linear regression model. Multicollinearity occurs when independent variables in the model are highly correlated, making it challenging to determine the individual effect of each variable on the dependent variable. The <code>VIF</code> function from the <code>regclass</code> package in R can help us identify multicollinearity in our linear regression model.</p>
<div id="calculating-vif" class="section level3" number="14.6.1">
<h3><span class="header-section-number">14.6.1</span> Calculating VIF</h3>
<p>To calculate the VIF for the independent variables in your model, you can use the <code>VIF()</code> function. First, make sure you have the <code>regclass</code> package installed and loaded:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;regclass&quot;</span>)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a><span class="fu">library</span>(regclass)</span></code></pre></div>
<p>Next, you can calculate VIF for your linear regression model as follows:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="co"># Fit a linear regression model</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula  =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> your_data)</span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a><span class="co"># Calculate VIF</span></span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a>vif_results <span class="ot">&lt;-</span> <span class="fu">VIF</span>(model)</span></code></pre></div>
<p>The <code>VIF()</code> function takes the linear regression model as its argument and returns a data frame with VIF values for each independent variable. Higher VIF values indicate stronger multicollinearity, typically with a threshold of 5 or 10 as a rule of thumb.</p>
</div>
<div id="interpreting-vif" class="section level3" number="14.6.2">
<h3><span class="header-section-number">14.6.2</span> Interpreting VIF</h3>
<ul>
<li><p>If VIF is close to 1, it suggests that the variable is not highly correlated with other independent variables, indicating no significant multicollinearity.</p></li>
<li><p>If VIF is greater than 1 but less than a chosen threshold (e.g., 5 or 10), it suggests some correlation but not necessarily problematic multicollinearity.</p></li>
<li><p>If VIF is significantly greater than the chosen threshold (e.g., 10), it indicates a high degree of multicollinearity, and you may need to consider removing or combining variables to address this issue.</p></li>
</ul>
</div>
<div id="addressing-multicollinearity" class="section level3" number="14.6.3">
<h3><span class="header-section-number">14.6.3</span> Addressing Multicollinearity</h3>
<p>If you detect problematic multicollinearity with high VIF values, you can take several steps to address the issue:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Remove one of the correlated variables:</strong> If two or more variables are highly correlated, removing one of them can often resolve the multicollinearity issue.</p></li>
<li><p><strong>Combine correlated variables:</strong> You can create new variables that are combinations of highly correlated variables, reducing multicollinearity.</p></li>
<li><p><strong>Collect more data:</strong> Sometimes, multicollinearity can be alleviated by collecting more data, especially if the sample size is small.</p></li>
<li><p><strong>Regularization techniques:</strong> Consider using regularization techniques like Ridge or Lasso regression, which can handle multicollinearity by adding penalties to the coefficients of correlated variables.</p></li>
</ol>
<p>VIF analysis is a crucial step in assessing the quality of your linear regression model and ensuring the independence of your independent variables.</p>
</div>
</div>
<div id="anova-analysis-of-variance" class="section level2" number="14.7">
<h2><span class="header-section-number">14.7</span> ANOVA (Analysis of Variance)</h2>
<p>ANOVA, or Analysis of Variance, is a statistical technique used to analyze the differences among group means in a dataset. It is particularly useful when you want to compare the means of more than two groups. The <code>aov()</code> function in R is commonly used to perform ANOVA.</p>
<div id="performing-anova-with-aov" class="section level3" number="14.7.1">
<h3><span class="header-section-number">14.7.1</span> Performing ANOVA with <code>aov()</code></h3>
<p>To perform ANOVA using the <code>aov()</code> function, you need to specify a formula that describes the relationship between the dependent variable and the grouping factor (categorical variable). The basic syntax is as follows:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(dependent_variable <span class="sc">~</span> grouping_factor, <span class="at">data =</span> your_data)</span></code></pre></div>
<ul>
<li><code>dependent_variable</code>: The continuous variable you want to analyze.</li>
<li><code>grouping_factor</code>: The categorical variable that defines the groups.</li>
<li><code>data</code>: The data frame containing your variables.</li>
</ul>
</div>
<div id="anova-tables" class="section level3" number="14.7.2">
<h3><span class="header-section-number">14.7.2</span> ANOVA Tables</h3>
<p>Once you‚Äôve created the ANOVA model, you can obtain an ANOVA table using the <code>summary()</code> function applied to the <code>aov</code> object:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="fu">summary</span>(anova_model)</span></code></pre></div>
<p>This table provides various statistics, including the sum of squares, degrees of freedom, F-statistic, and p-value, which allow you to assess the significance of differences among group means.</p>
</div>
<div id="interpreting-anova" class="section level3" number="14.7.3">
<h3><span class="header-section-number">14.7.3</span> Interpreting ANOVA</h3>
<ul>
<li><p>The F-statistic in the ANOVA table tests whether there are significant differences among the group means. A small p-value (&lt; 0.05) suggests that there are significant differences.</p></li>
<li><p>If the ANOVA is not statistically significant, it indicates that there are no significant differences among the group means.</p></li>
</ul>
</div>
<div id="assumptions-of-anova" class="section level3" number="14.7.4">
<h3><span class="header-section-number">14.7.4</span> Assumptions of ANOVA</h3>
<p>ANOVA assumes that the variances of the groups are equal (homogeneity of variances) and that the data are normally distributed. Violations of these assumptions may lead to inaccurate results. You can check the homogeneity of variances using tests like Levene‚Äôs test or Bartlett‚Äôs test and assess the normality of data using normal probability plots or statistical tests like the Shapiro-Wilk test.</p>
</div>
</div>
<div id="logistic-regression-with-glm" class="section level2" number="14.8">
<h2><span class="header-section-number">14.8</span> Logistic Regression with <code>glm()</code></h2>
<p>Logistic regression is a statistical technique used for modeling the relationship between a binary dependent variable (0/1, Yes/No, True/False) and one or more independent variables. The <code>glm()</code> function in R is commonly used to perform logistic regression.</p>
<div id="performing-logistic-regression-with-glm" class="section level3" number="14.8.1">
<h3><span class="header-section-number">14.8.1</span> Performing Logistic Regression with <code>glm()</code></h3>
<p>To perform logistic regression using the <code>glm()</code> function, you need to specify a formula that describes the relationship between the binary dependent variable and the independent variables. The basic syntax is as follows:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a>logistic_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> dependent_variable <span class="sc">~</span> independent_variable1 <span class="sc">+</span> independent_variable2, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> your_data)</span></code></pre></div>
<ul>
<li><code>dependent_variable</code>: The binary dependent variable you want to model.</li>
<li><code>independent_variable1</code>, <code>independent_variable2</code>, etc.: The independent variables that influence the probability of the binary outcome.</li>
<li><code>family</code>: Specify the family argument as <code>binomial</code> to indicate logistic regression.</li>
<li><code>data</code>: The data frame containing your variables.</li>
</ul>
</div>
<div id="model-summary" class="section level3" number="14.8.2">
<h3><span class="header-section-number">14.8.2</span> Model Summary</h3>
<p>After creating the logistic regression model, you can obtain a summary of the model‚Äôs coefficients, standard errors, z-values, and p-values using the <code>summary()</code> function applied to the <code>glm</code> object:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">summary</span>(logistic_model)</span></code></pre></div>
<p>This summary provides valuable information about the influence of the independent variables on the log-odds of the binary outcome.</p>
</div>
<div id="interpreting-logistic-regression" class="section level3" number="14.8.3">
<h3><span class="header-section-number">14.8.3</span> Interpreting Logistic Regression</h3>
<ul>
<li><p>The coefficients in the summary indicate the direction and strength of the relationship between the independent variables and the log-odds of the binary outcome.</p></li>
<li><p>Positive coefficients suggest an increase in the log-odds, while negative coefficients suggest a decrease.</p></li>
<li><p>The odds ratio (exp(coef)) can be used to interpret the change in the odds of the binary outcome for a one-unit change in the independent variable.</p></li>
<li><p>A significant p-value (&lt; 0.05) for a coefficient suggests that the independent variable has a significant effect on the binary outcome.</p></li>
<li><p>The null hypothesis in logistic regression is that there is no relationship between the independent variable and the binary outcome.</p></li>
</ul>
</div>
<div id="model-evaluation" class="section level3" number="14.8.4">
<h3><span class="header-section-number">14.8.4</span> Model Evaluation</h3>
<p>To evaluate the performance of your logistic regression model, you can assess its accuracy, sensitivity, specificity, and other metrics using techniques like cross-validation and ROC analysis. You can also plot the ROC curve and calculate the AUC (Area Under the Curve) to assess the model‚Äôs predictive power.</p>
</div>
<div id="assumptions-of-logistic-regression" class="section level3" number="14.8.5">
<h3><span class="header-section-number">14.8.5</span> Assumptions of Logistic Regression</h3>
<p>Logistic regression assumes that the log-odds of the binary outcome are a linear combination of the independent variables. It is important to check for violations of this assumption, which can be done through residual analysis.</p>
</div>
</div>
<div id="poisson-regression-with-glm" class="section level2" number="14.9">
<h2><span class="header-section-number">14.9</span> Poisson Regression with <code>glm()</code></h2>
<p>Poisson regression is a statistical technique used to model the relationship between a count-dependent variable (typically non-negative integers) and one or more independent variables. The <code>glm()</code> function in R is commonly used to perform Poisson regression.</p>
<div id="performing-poisson-regression-with-glm" class="section level3" number="14.9.1">
<h3><span class="header-section-number">14.9.1</span> Performing Poisson Regression with <code>glm()</code></h3>
<p>To perform Poisson regression using the <code>glm()</code> function, you need to specify a formula that describes the relationship between the count-dependent variable and the independent variables. The basic syntax is as follows:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>poisson_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> count_dependent_variable <span class="sc">~</span> independent_variable1 <span class="sc">+</span> independent_variable2, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="at">data =</span> your_data)</span></code></pre></div>
<ul>
<li><code>count_dependent_variable</code>: The count-dependent variable you want to model.</li>
<li><code>independent_variable1</code>, <code>independent_variable2</code>, etc.: The independent variables that influence the count-dependent variable.</li>
<li><code>family</code>: Specify the family argument as <code>poisson</code> to indicate Poisson regression.</li>
<li><code>data</code>: The data frame containing your variables.</li>
</ul>
</div>
<div id="model-summary-1" class="section level3" number="14.9.2">
<h3><span class="header-section-number">14.9.2</span> Model Summary</h3>
<p>After creating the Poisson regression model, you can obtain a summary of the model‚Äôs coefficients, standard errors, z-values, and p-values using the <code>summary()</code> function applied to the <code>glm</code> object:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">summary</span>(poisson_model)</span></code></pre></div>
<p>This summary provides information about the influence of the independent variables on the expected count of the dependent variable.</p>
</div>
<div id="interpreting-poisson-regression" class="section level3" number="14.9.3">
<h3><span class="header-section-number">14.9.3</span> Interpreting Poisson Regression</h3>
<ul>
<li><p>The coefficients in the summary indicate the direction and strength of the relationship between the independent variables and the expected count of the dependent variable.</p></li>
<li><p>Positive coefficients suggest an increase in the expected count, while negative coefficients suggest a decrease.</p></li>
<li><p>The exponential of the coefficients (exp(coef)) can be used to interpret the multiplicative effect of a one-unit change in the independent variable on the expected count.</p></li>
<li><p>A significant p-value (&lt; 0.05) for a coefficient suggests that the independent variable has a significant effect on the expected count.</p></li>
<li><p>The null hypothesis in Poisson regression is that there is no relationship between the independent variable and the expected count.</p></li>
</ul>
</div>
</div>
<div id="class-exercises-do-it-in-groups" class="section level2" number="14.10">
<h2><span class="header-section-number">14.10</span> class exercises, do it in groups üëØ</h2>
<p>first guided,</p>
<div class="exercise">
<p><span id="exr:ttest1" class="exercise"><strong>(#exr:ttest1) </strong></span>A state Highway Patrol periodically samples vehicle at various location on a
particular roadway. The sample of vehicle speed is used to test the hypothesis H0
for which the mean is less than equal to <strong>65</strong></p>
<p>The locations where <span class="math inline">\(H_0\)</span> is rejected are deemed the best locations for radar traps.
At location F, a sample of <strong>64</strong> vehicles shows a mean speed of <strong>66.2 mph</strong> with a std
dev of <strong>4.2 mph</strong>. Use a <span class="math inline">\(\alpha  = 0.05\)</span> to test the hypothesis.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:ttest6" class="exercise"><strong>(#exr:ttest6) </strong></span>Let‚Äôs assume to have dataset <code>midwest</code> in <code>ggplot2</code> package: this contains demographic information of midwest counties from 2000 US census.
Besides all the other variables we are interested in <code>percollege</code> which describes the Percent college educated in midwest.</p>
<ol style="list-style-type: decimal">
<li>test if the midwest average is less than the national average (i.e.¬†*<strong>35%</strong>) with a p-value &lt; .02.</li>
</ol>
</div>
<hr />
<div class="exercise">
<p><span id="exr:ttest2" class="exercise"><strong>(#exr:ttest2) </strong></span>Download the datafile ‚ÄòprawnGR.CSV‚Äô from the <a href="https://alexd106.github.io/intro2R/data.html">Data link</a> and save it to the data directory (Remember R projects and working directory). Import these data into R and assign to a variable with an appropriate name. These data were collected from an experiment to investigate the difference in growth rate of the <strong>giant tiger prawn</strong> (Penaeus monodon) fed either an artificial or natural diet.</p>
<ol style="list-style-type: decimal">
<li>Have a quick look at the structure of this dataset.</li>
<li>plot the growth rate versus the diet using an appropriate plot.</li>
<li>How many observations are there in each diet treatment?</li>
<li>You want to compare the difference in growth rate between the two diets using a two sample t-test.</li>
<li>Conduct a two sample t-test using the t.test() using the argument <code>var.equal = TRUE</code> to perform the t-test assuming equal variances. What is the null hypothesis you want to test? Do you reject or fail to reject the null hypothesis? What is the value of the t statistic, degrees of freedom and p value? How would you summarise these summary statistics in a report?</li>
</ol>
</div>
<hr />
<div class="exercise">
<p><span id="exr:ttest3" class="exercise"><strong>(#exr:ttest3) </strong></span>A new coach has been hired at an athletics school, and the effectiveness of the new type of training will be evaluated by comparing the average times of 10 centimeters. The times in seconds before and after each athlete‚Äôs competition are repeated.√π</p>
<pre><code>before_training: =  c(12.9, 13.5, 12.8, 15.6, 17.2, 19.2, 12.6, 15.3, 14.4, 11.3)
after_training = c( 12.7, 13.6, 12.0, 15.2, 16.8, 20.0, 12.0, 15.9, 16.0, 11.1)</code></pre>
<p>We are up against two groups of trained competitors, as measurements were taken on the same athletes before and after the competition. To determine if there has been an improvement, a deterioration, or if the time averages have remained essentially constant (i.e., H0). Conduct a test t of student for paired changes if the difference significant to a 95% confidence level?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:ttest4" class="exercise"><strong>(#exr:ttest4) </strong></span>Following exercise 4 Assume that the club management, based on the statistics, fires this coach who has not improved and hires another more promising coach. Following the second training session, we record the athletes‚Äô times:</p>
<pre><code>before training: 12.9, 13.5, 12.8, 15.6, 17.2, 19.2, 12.6, 15.3, 14.4, 11.3
after training: 12.0, 12.2, 11.2, 13.0, 15.0, 15.8, 12.2, 13.4, 12.9, 11.0</code></pre>
</div>
<hr />
<div class="exercise">
<p><span id="exr:ttest5" class="exercise"><strong>(#exr:ttest5) </strong></span>Let‚Äôs assume <code>genderweight</code> in <code>datarium</code> package, containing the weight of 40 individuals (20 women and 20 men).</p>
<ol style="list-style-type: decimal">
<li>which are the mean weights for male and females?</li>
<li>test is they are statistically significant with 95% confidence level</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:anova1" class="exercise"><strong>(#exr:anova1) </strong></span>Let‚Äôs assume to have a sample with this data and respective belonging group:</p>
<pre><code>x&lt;-c(12,23,12,13,14,21,23,24,30,21,12,13,14,15,16)

z&lt;-c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)</code></pre>
<p>perform anova test with <code>aov()</code> function testing if there is significant differences between group <strong>1</strong>, <strong>2</strong> and <strong>3</strong>.</p>
</div>
<p>You specify the formula, where <code>x</code> is the continous variable and <code>z</code> is the group variable.
This is how you solve it.</p>
<hr />
<div class="exercise">
<p><span id="exr:anova2" class="exercise"><strong>(#exr:anova2) </strong></span>Assume you have a dataset named <code>PlantGrowth</code> with variables <code>weight</code> (dependent variable) and <code>group</code> (categorical independent variable).</p>
<ol style="list-style-type: decimal">
<li>Perform an ANOVA analysis to compare the means of <code>weight</code> among different <code>group</code> levels.</li>
<li>Check the p-value and determine whether there are significant differences among the group means.</li>
</ol>
</div>
<hr />
<div class="exercise">
<p><span id="exr:anova3" class="exercise"><strong>(#exr:anova3) </strong></span>We recruit 90 people to participate in an experiment in which we randomly assign 30 people to follow either program A, program B, or program C for one month.</p>
<pre><code>#make this example reproducible
set.seed(0)

#create data frame
data &lt;- data.frame(program = rep(c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), each = 30),
                   weight_loss = c(runif(30, 0, 3),
                                   runif(30, 0, 5),
                                   runif(30, 1, 7)))
                                   </code></pre>
<ol style="list-style-type: decimal">
<li>plot boxplot of weight_loss ~ program Hint: use <code>boxplot()</code> function specifying the formula.</li>
<li>fit 1 way anova to test difference in weight loss for each program.</li>
</ol>
</div>
<hr />
<div class="exercise">
<p><span id="exr:anova4" class="exercise"><strong>(#exr:anova4) </strong></span>Consider the maximum size of 4 fish each from 3 populations (n=12). We want to use a model that will help us examine the question of whether the mean maximum fish size differs among populations.</p>
<pre><code>size &lt;- c(3,4,5,6,4,5,6,7,7,8,9,10)
pop &lt;- c(&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;C&quot;,&quot;C&quot;,&quot;C&quot;,&quot;C&quot;)</code></pre>
<ol style="list-style-type: decimal">
<li>visualize it through boxplot</li>
<li>Using ANOVA model test whether any group means differ from another.</li>
</ol>
</div>
<hr />
<div class="exercise">
<p><span id="exr:anova5" class="exercise"><strong>(#exr:anova5) </strong></span>Let‚Äôs consider 6 different insect sprays in <code>InsectSprays</code> contained in R. Let‚Äôs assume we are interested in testing if there was a difference in the number of insects found in the field after each spraying, use varibales <code>count</code> and <code>spray</code>.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:anova6" class="exercise"><strong>(#exr:anova6) </strong></span>Let‚Äôs consider the <code>diet</code> dataset in <a href="https://www.kaggle.com/code/evitaginiyatullina/one-way-anova-comparison/data">this link here</a> The data set contains information on 76 people who undertook one of three diets (referred to as diet A, B and C). There is background information such as age, gender, and height. The aim of the study was to see which diet was best for losing weight.</p>
<p>to read data first dowload it from the link, then move data inside your R project. then run these commands:</p>
<pre><code>diet = read.csv(&quot;&lt; the dataset name&gt;.csv&quot;)</code></pre>
<p>We will be using variable <code>Diet</code>, <code>pre.weight</code> and <code>weight6weeks</code></p>
<ol style="list-style-type: decimal">
<li>read data from kaggle</li>
<li>compute mean weights for each group</li>
<li>calculate anova on Diet against the weight cut</li>
</ol>
</div>
<hr />
<div class="exercise">
<p><span id="exr:lr1" class="exercise"><strong>(#exr:lr1) </strong></span>Use the built-in <code>mtcars</code> dataset with variables mpg (miles per gallon) and vs (engine type: 0 = V-shaped, 1 = straight).</p>
<ul>
<li>Fit a logistic regression model to predict vs (engine type) based on mpg.</li>
<li>Interpret the coefficients of the logistic regression model.</li>
</ul>
</div>
<hr />
<div class="exercise">
<p><span id="exr:pr1" class="exercise"><strong>(#exr:pr1) </strong></span>Use the built-in <code>mtcars</code> dataset with variables <code>mpg</code> (miles per gallon) and <code>gear</code> (number of forward gears).</p>
<ul>
<li>Fit a Poisson regression model to predict gear based on mpg.</li>
<li>Interpret the coefficients of the Poisson regression model.</li>
</ul>
</div>
<hr />
</div>
<div id="solutions" class="section level2" number="14.11">
<h2><span class="header-section-number">14.11</span> solutions</h2>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:ttest1)</strong>:</p>
<p>Sample random data from a Normal distribution with a given mean and sd.
Then define <strong>H0</strong> and <strong>H1</strong>. In the end run hte test.</p>
<pre><code>x &lt;- rnorm(n = 64, mean = 66.2, sd = 4.2)
test&lt;-t.test(x, mu = 65, alternative = &quot;less&quot;)


t = 1.469, df = 63, p-value = 0.9266
alternative hypothesis: true mean is less than 65
95 percent confidence interval:
 -Inf 66.80805
sample estimates:
mean of x 
65.84629 </code></pre>
<p>The One Sample t-test testing the difference between x (mean = 65.85)
and mu = 65 suggests that the effect is positive, statistically not
significant, and very small (difference = 0.85, 95% CI [-Inf, 66.81],
t(63) = 1.47, p = <strong>0.927</strong></p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:anova1)</strong>:</p>
<pre><code>x &lt;- c(12,23,12,13,14,21,23,24,30,21,12,13,14,15,16) 
z &lt;- c(1,1,1,1,1,2,2,2,2,2,3,3,3,3,3)
z &lt;- as.factor(z)
anova_test &lt;- aov(x ~ z) 
summary(anova_test)

        Df Sum Sq Mean Sq F value Pr(&gt;F)
z            1    1.6    1.60   0.047  **0.832**
Residuals   13  446.1   34.32</code></pre>
<p>The ANOVA (formula: x ~ z) suggests that the main effect of z is statistically not significant and very small
(F(1, 13) = 0.05, p = 0.832; Eta2 = 3.57e-03, 95% CI [0.00, 1.00]). That means that group means are not that different
one from the other</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:anova6)</strong>:</p>
<p>Assuming you have the ‚Äòplant_growth‚Äô dataset</p>
<pre><code># 1. Perform ANOVA
anova_model &lt;- aov(weight ~ group, data = plant_growth)

# 2. Check p-value
summary(anova_model)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:lr1)</strong>:</p>
<pre><code>data(mtcars)</code></pre>
<p>Convert vs to a factor variable</p>
<pre><code>mtcars$vs &lt;- as.factor(mtcars$vs)</code></pre>
<p>Fit a logistic regression model</p>
<pre><code>logistic_model &lt;- glm(vs ~ mpg, family = binomial, data = mtcars)</code></pre>
<p>Interpret coefficients</p>
<pre><code>summary(logistic_model)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:pr1)</strong>:</p>
<pre><code>data(mtcars)</code></pre>
<p>Fit a Poisson regression model</p>
<pre><code>poisson_model &lt;- glm(gear ~ mpg, family = poisson, data = mtcars)</code></pre>
<p>Interpret coefficients</p>
<pre><code>summary(poisson_model)</code></pre>
</div>
</div>
<div id="tips" class="section level2" number="14.12">
<h2><span class="header-section-number">14.12</span> üç¨ tips and tricks</h2>
<p>Yout might be interested in standardizing/fornalize how you say things with a statistical jargon, <code>report</code> does that for you.
you simply pass the test, wether it is ANOVA or t.test object inside report <code>report()</code>. Do you rememer the function <code>summary()</code> we have been using for linear regression? This is exactly that, but for both ANOVA and t tests.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a><span class="co"># install.packages(&quot;remotes&quot;)</span></span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;easystats/report&quot;)</span></span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a></span>
<span id="cb152-5"><a href="#cb152-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">64</span>, <span class="at">mean =</span> <span class="fl">66.2</span>, <span class="at">sd =</span> <span class="fl">4.2</span>)</span>
<span id="cb152-6"><a href="#cb152-6" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">t.test</span>(x, <span class="at">mu =</span> <span class="dv">65</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb152-7"><a href="#cb152-7" tabindex="-1"></a><span class="fu">report</span>(test)</span>
<span id="cb152-8"><a href="#cb152-8" tabindex="-1"></a><span class="co">#&gt; Effect sizes were labelled following Cohen&#39;s (1988)</span></span>
<span id="cb152-9"><a href="#cb152-9" tabindex="-1"></a><span class="co">#&gt; recommendations.</span></span>
<span id="cb152-10"><a href="#cb152-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb152-11"><a href="#cb152-11" tabindex="-1"></a><span class="co">#&gt; The One Sample t-test testing the difference between x</span></span>
<span id="cb152-12"><a href="#cb152-12" tabindex="-1"></a><span class="co">#&gt; (mean = 66.49) and mu = 65 suggests that the effect is</span></span>
<span id="cb152-13"><a href="#cb152-13" tabindex="-1"></a><span class="co">#&gt; positive, statistically not significant, and small</span></span>
<span id="cb152-14"><a href="#cb152-14" tabindex="-1"></a><span class="co">#&gt; (difference = 1.49, 95% CI [-Inf, 67.47], t(63) = 2.54, p =</span></span>
<span id="cb152-15"><a href="#cb152-15" tabindex="-1"></a><span class="co">#&gt; 0.993; Cohen&#39;s d = 0.32, 95% CI [-Inf, 0.53])</span></span></code></pre></div>
<hr />
<p>when you have data in <code>longer</code> fromat there a different in syntax when you specify t test and it pretty much follows the one for linear models i.e.¬†<code>lm()</code>.
let‚Äôs look at it.</p>
<p>we may have something like:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a>longer <span class="ot">=</span> <span class="fu">tribble</span>( </span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>  <span class="sc">~</span>group, <span class="sc">~</span>var,</span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>  <span class="st">&quot;a&quot;</span>,   <span class="dv">10</span>,</span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a>  <span class="st">&quot;b&quot;</span>,   <span class="dv">24</span>, </span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a>  <span class="st">&quot;a&quot;</span>,   <span class="dv">31</span>,</span>
<span id="cb153-7"><a href="#cb153-7" tabindex="-1"></a>  <span class="st">&quot;a&quot;</span>,   <span class="dv">75</span>,</span>
<span id="cb153-8"><a href="#cb153-8" tabindex="-1"></a>  <span class="st">&quot;b&quot;</span>,   <span class="dv">26</span>,</span>
<span id="cb153-9"><a href="#cb153-9" tabindex="-1"></a>  <span class="st">&quot;a&quot;</span>,   <span class="dv">8</span>,</span>
<span id="cb153-10"><a href="#cb153-10" tabindex="-1"></a>  <span class="st">&quot;b&quot;</span>,   <span class="dv">98</span>,</span>
<span id="cb153-11"><a href="#cb153-11" tabindex="-1"></a>  <span class="st">&quot;b&quot;</span>,   <span class="dv">62</span>,</span>
<span id="cb153-12"><a href="#cb153-12" tabindex="-1"></a>  )</span>
<span id="cb153-13"><a href="#cb153-13" tabindex="-1"></a>wider <span class="ot">=</span> <span class="fu">tribble</span>( </span>
<span id="cb153-14"><a href="#cb153-14" tabindex="-1"></a>  <span class="sc">~</span>group_a, <span class="sc">~</span>group_b,</span>
<span id="cb153-15"><a href="#cb153-15" tabindex="-1"></a>   <span class="dv">10</span>,       <span class="dv">24</span>,</span>
<span id="cb153-16"><a href="#cb153-16" tabindex="-1"></a>   <span class="dv">31</span>,       <span class="dv">26</span>,</span>
<span id="cb153-17"><a href="#cb153-17" tabindex="-1"></a>   <span class="dv">75</span>,       <span class="dv">98</span>,</span>
<span id="cb153-18"><a href="#cb153-18" tabindex="-1"></a>   <span class="dv">8</span>,        <span class="dv">62</span></span>
<span id="cb153-19"><a href="#cb153-19" tabindex="-1"></a>  )</span></code></pre></div>
<p>Those are exaclty the same dataset but arranged in a different format. We are used to the <em>wider</em> format but iut might happen that we bump into the <em>longer</em> one. What do we do? There‚Äôsa trick for that, let‚Äôs say you want to test if the mean are statistically different with a 95% confidence level, the instead of supplying <code>x</code> and <code>y</code> to <code>t.test()</code> you would follow pretty much the syntax for linear models <code>lm()</code>:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a></span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>test_for_wider_format <span class="ot">=</span> <span class="fu">t.test</span>(var<span class="sc">~</span>group, <span class="at">data =</span>  longer)</span>
<span id="cb154-3"><a href="#cb154-3" tabindex="-1"></a>test_for_wider_format</span>
<span id="cb154-4"><a href="#cb154-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb154-5"><a href="#cb154-5" tabindex="-1"></a><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span id="cb154-6"><a href="#cb154-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb154-7"><a href="#cb154-7" tabindex="-1"></a><span class="co">#&gt; data:  var by group</span></span>
<span id="cb154-8"><a href="#cb154-8" tabindex="-1"></a><span class="co">#&gt; t = -0.91809, df = 5.9192, p-value = 0.3944</span></span>
<span id="cb154-9"><a href="#cb154-9" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means between group a and group b is not equal to 0</span></span>
<span id="cb154-10"><a href="#cb154-10" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb154-11"><a href="#cb154-11" tabindex="-1"></a><span class="co">#&gt;  -78.99271  35.99271</span></span>
<span id="cb154-12"><a href="#cb154-12" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb154-13"><a href="#cb154-13" tabindex="-1"></a><span class="co">#&gt; mean in group a mean in group b </span></span>
<span id="cb154-14"><a href="#cb154-14" tabindex="-1"></a><span class="co">#&gt;            31.0            52.5</span></span></code></pre></div>
<p>what we conclude? we conclude that: Effect sizes were labelled following Cohen‚Äôs (1988) recommendations.</p>
<p>The Welch Two Sample t-test testing the difference of var by group (mean in group a = 31.00, mean in group b = 52.50) suggests that the effect is negative, statistically not significant, and medium (difference = -21.50, 95% CI [-78.99, 35.99], t(5.92) = -0.92, p = 0.394; Cohen‚Äôs d = -0.75, 95% CI [-2.39, 0.94])</p>
</div>
<div id="further-exercies" class="section level2" number="14.13">
<h2><span class="header-section-number">14.13</span> further exercies üèãÔ∏è</h2>
<div class="exercise">
<p><span id="exr:paired1" class="exercise"><strong>(#exr:paired1) </strong></span>We have the test scores of students before and after an intervention. How can we assess if the intervention had a statistically significant effect on the scores? Specify the type of test to use and the assumptions involved.</p>
</div>
<div class="exercise">
<p><span id="exr:mtcars1" class="exercise"><strong>(#exr:mtcars1) </strong></span>Using the dataset mtcars, write the R command to calculate the mean and standard deviation of the disp variable grouped by cyl.</p>
</div>
<div class="exercise">
<p><span id="exr:mean_diff1" class="exercise"><strong>(#exr:mean_diff1) </strong></span>Explain how you would assess if the mean difference between two groups is statistically significant, without running any R code.</p>
</div>
<div class="exercise">
<p><span id="exr:boston1" class="exercise"><strong>(#exr:boston1) </strong></span>Use the Boston dataset in MASS to create a histogram for the variable crim. Report the R code you used.</p>
</div>
<div class="exercise">
<p><span id="exr:pvalue1" class="exercise"><strong>(#exr:pvalue1) </strong></span>Describe the meaning of the p-value in the context of hypothesis testing.</p>
</div>
<div class="exercise">
<p><span id="exr:temp_diff1" class="exercise"><strong>(#exr:temp_diff1) </strong></span>Given a dataset with daily temperatures recorded for two cities over one year, write the R code to perform a hypothesis test to determine if there is a significant difference in mean temperature between the cities. Specify which test should be used.</p>
</div>
<div class="exercise">
<p><span id="exr:corr1" class="exercise"><strong>(#exr:corr1) </strong></span>Given X = c(10, 12, 15, 20) and Y = c(11, 14, 16, 18), calculate the Pearson correlation coefficient between X and Y using R.</p>
</div>
<div class="exercise">
<p><span id="exr:errors1" class="exercise"><strong>(#exr:errors1) </strong></span>Explain the concept of Type I and Type II errors in hypothesis testing.</p>
</div>
<div class="exercise">
<p><span id="exr:plantgrowth1" class="exercise"><strong>(#exr:plantgrowth1) </strong></span>Using the PlantGrowth dataset in R, calculate the mean of weight for each level of group and plot a boxplot of weight grouped by group.</p>
</div>
<div class="exercise">
<p><span id="exr:ttest1" class="exercise"><strong>(#exr:ttest1) </strong></span>Run a one-sample t-test to test if the mean of hp in mtcars is different from 120. Write the R code.</p>
</div>
<div class="exercise">
<p><span id="exr:iris1" class="exercise"><strong>(#exr:iris1) </strong></span>Using the dataset iris, write the R code to test for a significant difference between the average Sepal.Length of setosa and versicolor species.</p>
</div>
<div class="exercise">
<p><span id="exr:poisson1" class="exercise"><strong>(#exr:poisson1) </strong></span>Write an R function to simulate 500 observations from a Poisson distribution with a lambda of 3 and plot its histogram.</p>
</div>
<div class="exercise">
<p><span id="exr:multicollinearity1" class="exercise"><strong>(#exr:multicollinearity1) </strong></span>Describe how to check for multicollinearity in a multiple regression model in R.</p>
</div>
<div class="exercise">
<p><span id="exr:airquality1" class="exercise"><strong>(#exr:airquality1) </strong></span>Using the airquality dataset, calculate the correlation matrix for Ozone, Solar.R, Wind, and Temp.</p>
</div>
<div class="exercise">
<p><span id="exr:paired2" class="exercise"><strong>(#exr:paired2) </strong></span>Perform a paired t-test using the before and after variables where before = c(5, 7, 8, 6, 10) and after = c(6, 8, 9, 7, 12). Report the p-value.</p>
</div>
<div class="exercise">
<p><span id="exr:lr1" class="exercise"><strong>(#exr:lr1) </strong></span>Using the dataset mtcars, perform a linear regression with mpg as the dependent variable and hp and wt as independent variables. Report the adjusted R-squared.</p>
</div>
<div class="exercise">
<p><span id="exr:density1" class="exercise"><strong>(#exr:density1) </strong></span>Write the R code to create a density plot of the variable Sepal.Length for each species in the iris dataset.</p>
</div>
<div class="exercise">
<p><span id="exr:anova1" class="exercise"><strong>(#exr:anova1) </strong></span>Using iris, perform a one-way ANOVA to test if the mean Sepal.Length differs across the three species.</p>
</div>
<div class="exercise">
<p><span id="exr:ci1" class="exercise"><strong>(#exr:ci1) </strong></span>Define the term ‚Äúconfidence interval‚Äù in the context of statistical estimation.</p>
</div>
<div class="exercise">
<p><span id="exr:stepwise1" class="exercise"><strong>(#exr:stepwise1) </strong></span>Using the mtcars dataset, refit a multiple linear regression model with mpg as the dependent variable and hp, wt, and drat as independent variables. Use stepwise regression to iteratively remove insignificant predictors. Report the final model with the significant coefficients.</p>
</div>
<div class="exercise">
<p><span id="exr:anova2" class="exercise"><strong>(#exr:anova2) </strong></span>Using the dataset ToothGrowth, perform a one-way ANOVA with the function aov() to test if the mean tooth length differs across the supplement types and doses.</p>
</div>
<div class="exercise">
<p><span id="exr:anova3" class="exercise"><strong>(#exr:anova3) </strong></span>We recruit 90 people to participate in an experiment in which we randomly assign 30 people to follow either program A, program B, or program C for one month.</p>
<pre><code>#make this example reproducible
set.seed(0)

#create data frame
data &lt;- data.frame(program = rep(c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), each = 30),
                   weight_loss = c(runif(30, 0, 3),
                                   runif(30, 0, 5),
                                   runif(30, 1, 7)))</code></pre>
<ol style="list-style-type: decimal">
<li>plot boxplot of weight_loss ~ program Hint: use <code>boxplot()</code> function specifying the formula.</li>
<li>fit 1 way anova to test difference in weight loss for each program.</li>
</ol>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:paired1)</strong>:</p>
<p>The appropriate test to use is the paired t-test. This test is used when we have two related samples, such as before and after measurements for the same individuals, and we want to determine if there is a statistically significant difference between the means. The assumptions include that the differences are normally distributed and the data is paired.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:mtcars1)</strong>:</p>
<p>The <code>dplyr</code> package is used to calculate the mean and standard deviation of the <code>disp</code> variable grouped by <code>cyl</code>:</p>
<pre><code>library(dplyr)
mtcars %&gt;% group_by(cyl) %&gt;% summarise(mean_disp = mean(disp), sd_disp = sd(disp))</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:mean_diff1)</strong>:</p>
<p>To assess if the mean difference between two groups is statistically significant, we can use a hypothesis test such as the independent t-test. This involves setting up null and alternative hypotheses, calculating the test statistic, and comparing it to a critical value or using the p-value to determine significance, typically using a significance level (e.g., 0.05).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:boston1)</strong>:</p>
<p>To create a histogram of the <code>crim</code> variable from the Boston dataset, use the following code:</p>
<pre><code>library(MASS)
data(Boston)
hist(Boston$crim, main = &quot;Histogram of crim&quot;, xlab = &quot;Crime rate per capita&quot;)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:pvalue1)</strong>:</p>
<p>The p-value is the probability of obtaining test results at least as extreme as the observed results, under the assumption that the null hypothesis is true. A smaller p-value indicates stronger evidence against the null hypothesis, and if the p-value is below a chosen significance level (e.g., 0.05), we reject the null hypothesis.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:temp_diff1)</strong>:</p>
<p>The appropriate test to use is the two-sample t-test, as we are comparing the means of two independent groups. The R code is as follows:</p>
<pre><code>t.test(temp_city1, temp_city2, var.equal = TRUE)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:corr1)</strong>:</p>
<p>To calculate the Pearson correlation coefficient between vectors <code>X</code> and <code>Y</code>:</p>
<pre><code>X &lt;- c(10, 12, 15, 20)
Y &lt;- c(11, 14, 16, 18)
cor(X, Y)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:errors1)</strong>:</p>
<p>A Type I error occurs when we reject a true null hypothesis (false positive), while a Type II error occurs when we fail to reject a false null hypothesis (false negative).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:plantgrowth1)</strong>:</p>
<p>To calculate the mean of <code>weight</code> for each level of <code>group</code> and plot a boxplot of <code>weight</code> grouped by <code>group</code>:</p>
<pre><code>data(PlantGrowth)
aggregate(weight ~ group, data = PlantGrowth, mean)
boxplot(weight ~ group, data = PlantGrowth, main = &quot;Boxplot of Weight by Group&quot;)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:ttest1)</strong>:</p>
<p>To run a one-sample t-test to test if the mean of <code>hp</code> in <code>mtcars</code> is different from 120:</p>
<pre><code>t.test(mtcars$hp, mu = 120)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:iris1)</strong>:</p>
<p>To test for a significant difference between the average <code>Sepal.Length</code> of setosa and versicolor species:</p>
<pre><code>t.test(Sepal.Length ~ Species, data = subset(iris, Species %in% c(&quot;setosa&quot;, &quot;versicolor&quot;)))</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:poisson1)</strong>:</p>
<p>To simulate 500 observations from a Poisson distribution with a lambda of 3 and plot its histogram:</p>
<pre><code>set.seed(0)
poisson_data &lt;- rpois(500, lambda = 3)
hist(poisson_data, main = &quot;Histogram of Poisson Distribution&quot;, xlab = &quot;Values&quot;)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:multicollinearity1)</strong>:</p>
<p>To check for multicollinearity, we can use the Variance Inflation Factor (VIF). A VIF value greater than 10 indicates high multicollinearity:</p>
<pre><code>library(car)
vif(model)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:airquality1)</strong>:</p>
<p>To calculate the correlation matrix for <code>Ozone</code>, <code>Solar.R</code>, <code>Wind</code>, and <code>Temp</code> in the <code>airquality</code> dataset:</p>
<pre><code>airquality_subset &lt;- airquality[, c(&quot;Ozone&quot;, &quot;Solar.R&quot;, &quot;Wind&quot;, &quot;Temp&quot;)]
cor(airquality_subset, use = &quot;complete.obs&quot;)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:paired2)</strong>:</p>
<p>To perform a paired t-test using the <code>before</code> and <code>after</code> variables:</p>
<pre><code>before &lt;- c(5, 7, 8, 6, 10)
after &lt;- c(6, 8, 9, 7, 12)
t.test(before, after, paired = TRUE)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:lr1)</strong>:</p>
<p>To perform a linear regression with <code>mpg</code> as the dependent variable and <code>hp</code> and <code>wt</code> as independent variables, and report the adjusted R-squared:</p>
<pre><code>model &lt;- lm(mpg ~ hp + wt, data = mtcars)
summary(model)$adj.r.squared</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:density1)</strong>:</p>
<p>To create a density plot of the variable <code>Sepal.Length</code> for each species in the <code>iris</code> dataset:</p>
<pre><code>library(ggplot2)
ggplot(iris, aes(x = Sepal.Length, fill = Species)) +
  geom_density(alpha = 0.5) +
  labs(title = &quot;Density Plot of Sepal.Length by Species&quot;)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:anova1)</strong>:</p>
<p>To perform a one-way ANOVA to test if the mean <code>Sepal.Length</code> differs across the three species:</p>
<pre><code>aov_model &lt;- aov(Sepal.Length ~ Species, data = iris)
summary(aov_model)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:ci1)</strong>:</p>
<p>A confidence interval is a range of values, derived from sample statistics, that is likely to contain the population parameter with a specified level of confidence (e.g., 95%). It provides an estimated range that is expected to include the true parameter value.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:stepwise1)</strong>:</p>
<p>To refit a multiple linear regression model with <code>mpg</code> as the dependent variable and <code>hp</code>, <code>wt</code>, and <code>drat</code> as independent variables, using stepwise regression:</p>
<pre><code>library(MASS)
initial_model &lt;- lm(mpg ~ hp + wt + drat, data = mtcars)
stepwise_model &lt;- stepAIC(initial_model, direction = &quot;both&quot;)
summary(stepwise_model)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:anova2)</strong>:</p>
<p>To perform a one-way ANOVA using the <code>ToothGrowth</code> dataset to test if the mean tooth length differs across the supplement types and doses:</p>
<pre><code>data(ToothGrowth)
aov_model &lt;- aov(len ~ supp * dose, data = ToothGrowth)
summary(aov_model)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:anova3)</strong>:</p>
<p>To plot a boxplot of <code>weight_loss</code> by <code>program</code> and fit a one-way ANOVA to test the difference in weight loss for each program:</p>
<pre><code># Plot boxplot
boxplot(weight_loss ~ program, data = data, main = &quot;Boxplot of Weight Loss by Program&quot;, xlab = &quot;Program&quot;, ylab = &quot;Weight Loss&quot;)

# Fit one-way ANOVA
aov_model &lt;- aov(weight_loss ~ program, data = data)
summary(aov_model)</code></pre>
</div>
<!--chapter:end:06ter-lab-prep-to-intermediate.Rmd-->
</div>
</div>
<div id="int-samp-q-first" class="section level1" number="15">
<h1><span class="header-section-number">15</span> üíª First Intermediate Sample Questions</h1>
<p>Hi guys, this is your favourite <strong>TA</strong>, I am just aggregating questions that have been asked in previous exam sessions the previous years i.e.¬†2020/2021 and 2021/2022. They are representative of the actual exam, but you know, take it like a grain of salt.</p>
<p>I will also make sure to provide to you some other exercises if you are still anxious.</p>
<div id="section" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> üë®‚Äçüéì 2020/2021</h2>
<div class="exercise">
<p><span id="exr:int1" class="exercise"><strong>(#exr:int1) </strong></span>Write the line of the R command that you use to produce a boxplot of the variable X</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int2" class="exercise"><strong>(#exr:int2) </strong></span>We want to test statistically the hypothesis that the performances of students at UCSC in Rome that graduated last year are better than those that graduated this year. Can we say that this is a paired sample test ?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int3" class="exercise"><strong>(#exr:int3) </strong></span>Without using formulae, describe how you can calculate the test statistics in a hypothesis testing procedure on a single mean with known variance.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int4" class="exercise"><strong>(#exr:int4) </strong></span>Using the dataset Boston downloaded from the library spdep, write the correlation matrix of the variables MEDV, NOX and CRIM.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int5" class="exercise"><strong>(#exr:int5) </strong></span>How do you define the confidence of a statistical test?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int6" class="exercise"><strong>(#exr:int6) </strong></span>Given the following 2 variables X = (1,5,3,3,5,5) and Y= (4,4,6,3,2,3), write the cross-tabulation between X and Y.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int7" class="exercise"><strong>(#exr:int7) </strong></span>Write the line of the R command that you use to simulate 1000 random observation from normal distribution with 0 mean and variance = 0.5.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int8" class="exercise"><strong>(#exr:int8) </strong></span>A law company is evaluating the performances of two departments measuring in terms of the time required for solving a conflict in the last year. The observed values are reported in the following table:</p>
<p>‚Ä¶</p>
<p>can we accept the hypothesis H0: (the mean of Dept 1 is equal to the mean of Dept 2) versus a bilateral alternative hypothesis? (F)</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int9" class="exercise"><strong>(#exr:int9) </strong></span>A company has recorded the number of costumers in 10 sample stores before (variable X) and after (Variable Y) a new advertising campaign was introduced. The observed values are reported in the following table</p>
<p>‚Ä¶</p>
<p>write the p-value of the test with H0: (the mean of X is equal to the mean of Y) versus a bilateral alternative hypothesis. ( 0,000341138)</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int12" class="exercise"><strong>(#exr:int12) </strong></span>The HR office of a cleaning company wants to test if there is a gender discrimination between its employees. Call X = the income of a set of 20 male workers and Y = the income of a set of 35 female workers. Write the line R command to run an appropriate test of hypothesis.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int13" class="exercise"><strong>(#exr:int13) </strong></span>What is the power of statistical test?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int14" class="exercise"><strong>(#exr:int14) </strong></span>Using the dataset <code>boston.c</code> downloaded from the library <code>spdep</code>, calculate the coefficient of skewness of the variable RM.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:int14)</strong>:</p>
<pre><code>library(moments)
skewness(boston.c$RM)

0,4024147</code></pre>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int16" class="exercise"><strong>(#exr:int16) </strong></span>How do you define the significance of a statistical test?</p>
</div>
</div>
<div id="section-1" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> üë®‚Äçüéì 2021/2022</h2>
<div class="exercise">
<p><span id="exr:int17" class="exercise"><strong>(#exr:int17) </strong></span>Given the dataset ‚ÄúDuncan‚Äù in the library ‚ÄúcarData‚Äù estimate the regression model where the variable prestige is regressed on the variables income Looking at the following information,</p>
<pre><code>Residuals:

Min      1Q  Median      3Q     Max

-29.538  -6.417   0.655   6.605  34.641</code></pre>
<p>Do residuals display.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int18" class="exercise"><strong>(#exr:int18) </strong></span>What are the consequences of <strong>collinearity</strong> among regressors?</p>
<ol style="list-style-type: decimal">
<li>Estimators become biased</li>
<li>Estimators become inefficient</li>
<li>Estimators become inconsistent</li>
<li>Estimators become unstable</li>
</ol>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int19" class="exercise"><strong>(#exr:int19) </strong></span>What is the correct definition of the <strong>variance inflation factor</strong> i.e.¬†VIF?</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(1-R2\)</span></li>
<li><span class="math inline">\(\frac{1}{R2}\)</span><br />
</li>
<li><span class="math inline">\(\frac{1}{1-R2}\)</span></li>
<li><span class="math inline">\(1-\frac{1}{R2}\)</span></li>
</ol>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:int19)</strong>:</p>
<p>A general guideline is that a VIF larger than 5 or 10 is large, indicating that the model has problems estimating the coefficient. However, this in general does not degrade the quality of predictions. If the VIF is larger than 1/(1-R2), where R2 is the Multiple R-squared of the regression, then that predictor is more related to the other predictors than it is to the response.</p>
<pre><code>install.packages(&quot;regclass&quot;)
library(regclass)
VIF(modello_regressione)</code></pre>
<p>alternatively you can use the library <code>car</code> and use <code>vif()</code> function</p>
<pre><code>install.packges(&quot;car&quot;)
library(car)
vif(modello_regressione)</code></pre>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int20" class="exercise"><strong>(#exr:int20) </strong></span>Using only the following variables <code>minority</code> , <code>crime</code> , <code>poverty</code> , <code>language</code> <code>highschool</code> and <code>housing</code> of the <code>Ericksen</code> data in the library <code>carData</code>, run a factor analysis. What is the percentage explained by the first two factors?</p>
<p>risposta: <strong>90.130.001</strong></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int21" class="exercise"><strong>(#exr:int21) </strong></span>In a multiple linear regression model y= a+bx1+cx2, if Correlation(x1,x2)=0.9, do we have to discard one of the two variables for collinearity?</p>
<p>risposta: <strong>F</strong></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int23" class="exercise"><strong>(#exr:int23) </strong></span>Given the dataset <code>Duncan</code> in the library <code>carData</code> estimate the regression model where the variable <code>prestige</code> is regressed on the variables <code>income</code> and <code>education</code>. Which variable is the most significant?</p>
<ol style="list-style-type: decimal">
<li>Education</li>
<li>income</li>
</ol>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:int23)</strong>:</p>
<p>at first you load data from <code>Duncan</code> dataset</p>
<pre><code>library(carData)
data(&quot;Duncan&quot;)</code></pre>
<p>Then you specify the model and produce sumamries:</p>
<pre><code>duncan_regression = lm(prestige~ income + education, data= Duncan)
summary(duncan_regression)</code></pre>
<p>you look at pvalues and</p>
<pre><code>Coefficients:
            Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept) -6.06466    4.27194  -1.420      0.163    
income       0.59873    0.11967   5.003 0.00001053 ***
education    0.54583    0.09825   5.555 0.00000173 ***</code></pre>
<p>education is significant more than income since <em>0.00000173</em> &lt; <em>0.00001053</em></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int25" class="exercise"><strong>(#exr:int25) </strong></span>In a multiple linear regression model y= a+bx1+cx2, what is the level of correlation between x1 and x2 beyond which we have to discard one of the two variables for collinearity?</p>
<p>risposta: <strong>0.948</strong></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int26" class="exercise"><strong>(#exr:int26) </strong></span>Given the dataset <code>Duncan</code> in the library <code>carData</code> estimate the regression model where the variable <code>prestige</code> is regressed on the variables <code>income</code> and <code>education</code>. What is the p-value of the coefficient of the variable <code>education</code>?</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:int26)</strong>:</p>
<p>at first you load data from <code>Duncan</code> dataset</p>
<pre><code>library(carData)
data(&quot;Duncan&quot;)</code></pre>
<p>Then you specify the model and produce sumamries:</p>
<pre><code>duncan_regression = lm(prestige~ income + education, data= Duncan)
summary(duncan_regression)</code></pre>
<p>you look at pvalues and</p>
<pre><code>Coefficients:
            Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept) -6.06466    4.27194  -1.420      0.163    
income       0.59873    0.11967   5.003 0.00001053 ***
education    0.54583    0.09825   5.555 0.00000173 ***</code></pre>
<p>The pvalue for the coefficient is <strong>0.00000173</strong></p>
<p>you may want to directly access to it instead of just copying and pasting from console sumamry output</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int27" class="exercise"><strong>(#exr:int27) </strong></span>What is the reason for adjusting the R2 in a multiple regression</p>
<ol style="list-style-type: decimal">
<li>To account for the number of degrees of freedom</li>
<li>To account for the number of parameters</li>
<li>To reduce the uncertainty</li>
<li>To adjust for variance inflation factor</li>
</ol>
<p>rispoasta: <strong>To account for the number of degrees of freedom</strong></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int28" class="exercise"><strong>(#exr:int28) </strong></span>Given the dataset <code>Duncan</code> in the library <code>carData</code> estimate the regression model where the variable <code>prestige</code> is regressed on the variables <code>income</code>. Using the VIF, do we have to exclude some variable due to collinearity?</p>
<p>result: F</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:int28)</strong>:</p>
<p>at first you load data from <code>Duncan</code> dataset</p>
<pre><code>library(carData)
library(car)
data(&quot;Duncan&quot;)</code></pre>
<p>Then you specify the model and produce sumamries:</p>
<pre><code>duncan_regression = lm(prestige~ income + education, data= Duncan)
vif(duncan_regression)</code></pre>
<p>Then the output will look like something like.</p>
<pre><code> income education 
 2.1049    2.1049 </code></pre>
<p>Since they are below <strong>10</strong> which is the rule of thumb we gave to ourselves to assess multicollinearity then we conclude that neither <code>income</code> nor <code>education</code> are collinear.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int29" class="exercise"><strong>(#exr:int29) </strong></span>Given the dataset <code>Duncan</code> in the library <code>carData</code> estimate the regression model where the variable <code>prestige</code> is regressed on the variables <code>income</code>. What is the value of the t value of the coefficient of the variable <code>education</code>?</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:int29)</strong>:</p>
<p>at first you load data from <code>Duncan</code> dataset</p>
<pre><code>library(carData)
data(&quot;Duncan&quot;)</code></pre>
<p>Then you specify the model and produce sumamries:</p>
<pre><code>duncan_regression = lm(prestige~ income + education, data= Duncan)
summary(duncan_regression)</code></pre>
<p>Then the output will look like something like.</p>
<pre><code>Coefficients:
            Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept) -6.06466    4.27194  -1.420      0.163    
income       0.59873    0.11967   5.003 0.00001053 ***
education    0.54583    0.09825   5.555 0.00000173 ***</code></pre>
<p>By inspecting the summary wee obtain that the t value (t value column in the summary) dor variable <code>education</code> is <strong>5.555</strong></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int29" class="exercise"><strong>(#exr:int29) </strong></span>Using only the following variables <code>minority</code> , <code>crime</code> , <code>poverty</code> , <code>language</code>, <code>highschool</code> and <code>housing</code> of the <code>Ericksen</code> data in the library <code>carData</code>, run a cluster analysis using the k-means method. If we divide the observations in 4 classes what is the frequency of the largest class ?</p>
<p>result: <strong>26</strong></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int30" class="exercise"><strong>(#exr:int30) </strong></span>Using only the following variables <code>minority</code> , <code>crime</code> , <code>poverty</code> , <code>language</code>, <code>highschool</code> and <code>housing</code> of the <code>Ericksen</code> data in the library <code>carData</code>, run a cluster analysis using the <strong>k-means method</strong>. What is the percentage explained by the first factor?</p>
<p>risposta: 7.391.719</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int31" class="exercise"><strong>(#exr:int31) </strong></span>Using only the following variables <code>minority</code> , <code>crime</code> , <code>poverty</code> , <code>language</code>, <code>highschool</code> and <code>housing</code> of the <code>Ericksen</code> data in the library <code>carData</code>, run a cluster analysis using the <strong>hierarchical method</strong>. If we divide the observations in 10 classes what is the frequency of the largest class ?</p>
<p>risposta: 27</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:int32" class="exercise"><strong>(#exr:int32) </strong></span>Given the dataset <code>Duncan</code> in the library <code>carData</code> estimate the regression model where the variable <code>prestige</code> is regressed on the variables <code>income</code> and <code>education</code> and report the <span class="math inline">\(R^2\)</span>.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise @ref(exr:int32)</strong>:</p>
<p>at first you load data from <code>Duncan</code> dataset</p>
<pre><code>library(carData)
data(&quot;Duncan&quot;)</code></pre>
<p>Then you specify the model and produce sumamries:</p>
<pre><code>duncan_regression = lm(prestige~ income + education, data= Duncan)
summary(duncan_regression)</code></pre>
<p>Then the output will look like something like.</p>
<pre><code>Residual standard error: 13.37 on 42 degrees of freedom
Multiple R-squared:  0.8282,    Adjusted R-squared:   0.82 
F-statistic: 101.2 on 2 and 42 DF,  p-value: &lt; 0.00000000000000022
    </code></pre>
<p>By inspecting the lowe end of the summary we obtain that the R2 (multiple) for the model is <strong>0.8282</strong>, which is high.</p>
</div>
<hr />
</div>
<div id="section-2" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> üë®‚Äçüéì 2022/2023</h2>
<div class="exercise">
<p><span id="exr:intres1" class="exercise"><strong>(#exr:intres1) </strong></span>Using the dataset <code>Boston</code> downloaded from the library <code>spdep</code>,
calculate the coefficient of skewness of the variable <code>RM</code>.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres2" class="exercise"><strong>(#exr:intres2) </strong></span>How do you define the significance of a statistical test?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres3" class="exercise"><strong>(#exr:intres3) </strong></span>What is the power of statistical test?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres4" class="exercise"><strong>(#exr:intres4) </strong></span>How do you define the confidence of a statistical test?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres5" class="exercise"><strong>(#exr:intres5) </strong></span>A law company is evaluating the performances of two departments
measuring in terms of the time required for solving a conflict in the
last year. The observed values are reported in the following table:</p>
<pre><code>perf_table = data.frame(
  stringsAsFactors = FALSE,
             month = c(&quot;january&quot;,&quot;febraury&quot;,&quot;march&quot;,
                       &quot;april&quot;,&quot;may&quot;,&quot;june&quot;,&quot;july&quot;,&quot;august&quot;,&quot;september&quot;,
                       &quot;october&quot;,&quot;november&quot;,&quot;december&quot;),
            dept_1 = c(NA, NA, NA, 3L, 6L, 9L, 7L, 5L, 7L, 3L, 4L, 6L),
            dept_2 = c(4L, 3L, 9L, 5L, 7L, 2L, 6L, 3L, 6L, 7L, 4L, 1L)
)
)</code></pre>
<p>can we reject the hypothesis H0: (the mean of Dept 1 is equal to the
mean of Dept 2) versus a bilateral alternative hypothesis?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres6" class="exercise"><strong>(#exr:intres6) </strong></span>A company has recorded the number of costumers in 10 sample stores
before (variable X) and after (Variable Y) a new advertising campaign
was introduced. The observed values are reported in the following table:</p>
<pre><code>stores = data.frame(
     n_store = c(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L),
      before = c(113L, 110L, 108L, 108L, 103L, 101L, 96L, 101L, 104L, 98L),
       after = c(125L, 113L, 115L, 117L, 105L, 112L, 100L, 103L, 116L, 104L)
)</code></pre>
<p>can we reject the hypothesis H0: (the mean of X, i.e.¬†before is equal to
the mean of Y, i.e.¬†after) versus a bilateral alternative hypothesis?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres7" class="exercise"><strong>(#exr:intres7) </strong></span>Write the line of the R command that you use to simulate 2000 random
observation from normal distribution with 0 mean and variance = 0.1</p>
</div>
<p>Many of you fall into this <strong>trap!</strong>. Tip: always use the ‚Äútab‚Äù for
automatic suggestion but also check what are arguments. In this case
exercise wants you to sample from a normal distribution with <strong>2000</strong>
instances (data points), <strong>0</strong> mean and <strong>variance = 0.1</strong>. The argument
in <code>rnorm</code> is sd not var, so you have to apply the square root!</p>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres7):</p>
<pre><code>rnorm(n = 2000, mean = 0, sd = 0.1^(1/2))</code></pre>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres8" class="exercise"><strong>(#exr:intres8) </strong></span>Write the line of the R command that you use to produce a boxplot of the
variable X</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres9" class="exercise"><strong>(#exr:intres9) </strong></span>Given the following 2 variables <code>X = (5,5,3,3,5,5)</code> and
<code>Y= (4,4,3,3,3,3)</code>, test if the mean of X is significantly different
from the mean of Y. Report the p-value of the appropriate test and your
decision.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres10" class="exercise"><strong>(#exr:intres10) </strong></span>Using the dataset <code>boston.c</code> downloaded from the library <code>spdep</code>, write
the elements of the correlation matrix of the variables <code>MEDV</code>, <code>NOX</code> and
<code>CRIM</code>.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres11" class="exercise"><strong>(#exr:intres11) </strong></span>Without using formulae, describe how you can calculate the test
statistics in a hypothesis testing procedure on a single mean with known
variance.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres12" class="exercise"><strong>(#exr:intres12) </strong></span>The HR office of a cleaning company wants to test if there is significant difference in the salary between males and females. Call X = the salary of a set of <strong>2000</strong> male workers and Y = the salary of a set of <strong>150</strong> female workers. From previous survey we know that the <strong>variances of the two groups are equal</strong>. Write the line R command to run an appropriate test of hypothesis.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres13" class="exercise"><strong>(#exr:intres13) </strong></span>We want to test statistically the hypothesis that the students at UCSC
in Rome have better performances in the second year than in first year
year. Can we say that this is a paired sample test?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres14" class="exercise"><strong>(#exr:intres14) </strong></span>Using the dataset <code>iris</code> test if there is a significant difference
between the mean of <code>Petal.Length</code> and the mean of <code>Sepal.Width</code> and
report the outcome value of the t-test.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres15" class="exercise"><strong>(#exr:intres15) </strong></span>Using the dataset <code>iris</code> calculate the correlation between
<code>Sepal.Length</code> and <code>Sepal.Width</code>.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres16" class="exercise"><strong>(#exr:intres16) </strong></span>Using the dataset <code>iris</code> report the highest correlation coefficient that
you find between the four variables.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres161" class="exercise"><strong>(#exr:intres161) </strong></span>Using the dataset <code>iris</code> report the highest correlation coefficient that
you find between the four variables.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres17" class="exercise"><strong>(#exr:intres17) </strong></span>Using the dataset <code>iris</code> report the variance of <code>Sepal.Length</code></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres18" class="exercise"><strong>(#exr:intres18) </strong></span>Using the dataset <code>iris</code> report the third quartile of <code>Sepal.Length</code></p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres19" class="exercise"><strong>(#exr:intres19) </strong></span>What is the reason for adjusting the R2 in a multiple regression?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres20" class="exercise"><strong>(#exr:intres20) </strong></span>What is the correct definition of the variance inflation factor?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres21" class="exercise"><strong>(#exr:intres21) </strong></span>What are the consequences of <strong>collinearity</strong> among regressors?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres22" class="exercise"><strong>(#exr:intres22) </strong></span>Using the dataset <code>Wong</code> from the R library <code>carData</code>, estimate a
multiple linear regression where the variable <code>piq</code> is expressed as a
function of <code>age</code>, <code>days</code> and <code>duration.</code></p>
<p>After the check of collinearity and of significance choose the best
model.</p>
<p>Which variables are retained in the model? (retained means
<em>tratteresti</em>)</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres23" class="exercise"><strong>(#exr:intres23) </strong></span>sing the dataset <code>Wong</code> from the R library <code>carData</code>, estimate a
multiple linear regression where the variable <code>piq</code> is expressed as a
function of <code>age</code>, <code>days</code> and <code>duration.</code></p>
<p>After the check of collinearity and of significance choose the best
model.</p>
<p>What is the value of the <strong>adjusted R squared</strong> in the best model</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres24" class="exercise"><strong>(#exr:intres24) </strong></span>sing the dataset <code>Wong</code> from the R library <code>carData</code>, estimate a
multiple linear regression where the variable <code>piq</code> is expressed as a
function of <code>age</code>, <code>days</code> and <code>duration.</code></p>
<p>After the check of collinearity and of significance choose the best
model.</p>
<p>What is the estimated coefficient of the variable <code>duration</code> in the best
model?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres25" class="exercise"><strong>(#exr:intres25) </strong></span>sing the dataset <code>Wong</code> from the R library <code>carData</code>, estimate a
multiple linear regression where the variable <code>piq</code> is expressed as a
function of <code>age</code>, <code>days</code> and <code>duration.</code></p>
<p>After the check of collinearity and of significance choose the best
model.</p>
<p>What is the estimated value of the <code>intercept</code> in the best model?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres26" class="exercise"><strong>(#exr:intres26) </strong></span>sing the dataset <code>Wong</code> from the R library <code>carData</code>, estimate a
multiple linear regression where the variable <code>piq</code> is expressed as a
function of <code>age</code>, <code>days</code> and <code>duration.</code></p>
<p>After the check of collinearity and of significance choose the best
model.</p>
<p>What is the <strong>p-value</strong> of the variable <code>duration</code> in the best model?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres27" class="exercise"><strong>(#exr:intres27) </strong></span>sing the dataset <code>Wong</code> from the R library <code>carData</code>, estimate a
multiple linear regression where the variable <code>piq</code> is expressed as a
function of <code>age</code>, <code>days</code> and <code>duration.</code></p>
<p>After the check of collinearity and of significance choose the best
model.</p>
<p>What is the value of the <strong>R square</strong> in the best model</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres28" class="exercise"><strong>(#exr:intres28) </strong></span>Using the dataset <code>iris</code>, test if the average of the variable
<code>Sepal.Length</code> changes significantly in the three <code>Species</code> considered.
Report here the p-value of the appropiate test.</p>
</div>
<p>We look at <code>Species</code> (we have already gone through that during lecture)
by inspecting the dataset. What we see is that <code>Species</code> has three
categories <em>setosa</em>, <em>versicolor</em> and <em>virginica</em>. If we would like to
compare means across these 3 different categories we can‚Äôt use
<code>t.test()</code> since they are 3. Instead we use <strong>ANOVA</strong> with the <code>aov()</code>.
Sintax is similar to linear models. We saw this when we were trying to
tackle ‚Äúlong‚Äù format data vs.¬†‚Äúwide‚Äù format data.</p>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres28):</p>
<pre><code>test_species = aov(Sepal.Length~Species, data = iris)
summary(test_species)</code></pre>
<p>resulting in <strong>0.0000000000000002</strong>, very significant. We can conclude
that: The ANOVA (formula: Sepal.Length ~ Species) suggests that the
main effect of Species is statistically significant and large.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:intres29" class="exercise"><strong>(#exr:intres29) </strong></span>Using the dataset <code>iris</code>, test if the average of the variable
<code>Sepal.Length</code> differs significantly in the three <code>Species</code>, Report here
the value of the test statistic.</p>
</div>
</div>
<div id="solutions-1" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> solutions</h2>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres1):</p>
<pre><code>library(spdep)</code></pre>
<p>you are not required to load data in this case since the package already
does it for you. SO you just need to type <code>boston.c</code> and you find it.
Then you need to extract <code>RM</code></p>
<pre><code>RM_var = boston.c$RM</code></pre>
<p>There are a nunber of packages that makes you able to compute skewness,
there are some: <code>e1071</code>, <code>moments</code>, <code>PerformanceAnalytics</code> etc. I will
suggest to use moments. So if you dont have it installed execute:</p>
<pre><code>install.packages(&quot;moments&quot;)
library(moments)</code></pre>
<p>Then use teh function <code>skewnes</code> on <code>RM_var</code></p>
<pre><code>skewness(RM_var)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres2):</p>
<p>The probability of type I error, The probability of rejecting H0 when H0
it is true</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres3):</p>
<p>1 minus the probability of type II error, The probability of accepting
H0 when H0 it is true.</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres4):</p>
<p>The probability of accepting H0 when H0 it is true.</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres5):</p>
<p>H0: <span class="math inline">\(\mu_{dept1} = \mu_{dept2}\)</span> H1: <span class="math inline">\(\mu_{dept1} \neq \mu_{dept2}\)</span></p>
<p>Remember you always test the alternative hypothesis H1. If the pvalue
for the t test is not statistically significant then you reject H1 and
conversely you accept H0, in this case means being the same (they are
different but that‚Äôs because of randomness in data, i.e.¬†sampling
variation).</p>
<pre><code>t.test(x = perf_table$dept_1, y = perf_table$dept_2, paired = F, alternative = &quot;two.sided&quot;)</code></pre>
<p>Then we look at the p-value for this test and we see something like:
<strong>0.4076</strong>, so we can conclude that the Two Sample t-test testing the
difference between dept_1 and dept_2 (mean of dept_1 = 5.56, mean of
dept_2 = 4.75) suggests that the effect is positive, statistically <strong>not
significant, and small</strong>. So we reject the alt. hypo H1 and accept H0.</p>
<p>The question tells you if you can reject the Null Hypo, this is not the
case since you just accepted it!</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres6):</p>
<p>This is exactly the same reasoning as before except that this is a
paired t test. ‚ÄúAre we talking about the same individuals? are we
checking individuals pre and after a treatment?‚Äù <strong>YES</strong></p>
<pre><code>t.test(x = stores$before, y = stores$after, paired = T, alternative = &quot;two.sided&quot;)</code></pre>
<p>Look at the p-value: <strong>p-value = 0.0004646</strong>.this is really small. SO we
can conclude that the Paired t-test testing the difference between
before and after (mean difference = -6.80) suggests that the effect is
negative, statistically significant, and large.</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres7):</p>
<pre><code>rnorm(n = 2000, mean = 0, sd = 0.1^(1/2))</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres8):</p>
<pre><code>boxplot(X)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres9):</p>
<p>you at first define vectors X and Y by executing:</p>
<pre><code>X = c(5,5,3,3,5,5)
Y = c(4,4,3,3,3,3)
t.test(X, Y, alternative = &quot;two.sided&quot;, paired = F)</code></pre>
<p>so the answer may look something like: The (Welch, remember we did not
check variance so we rely on default R behavior applying a
transformation to t.test) Sample t-test testing the difference between X
and Y (mean of x = 4.33, mean of y = 3.33) suggests that the effect is
positive, statistically not significant, and large given the pvalue
being <strong>0.0697</strong>. However this would also be significant if the alpha
level of significance was 10%.</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres10):</p>
<pre><code>library(spdep)
library(dplyr)
new_boston = select(boston.c, MEDV, NOX, CRIM)
cor(new_boston)</code></pre>
<p>Note that the principal diag for the matrix is all 1s. This is because
you a variables has perfect correlation with itself. You are just
interested in the upper triangle. You might also be interested in
visualizing it with <code>corrplot</code>. Install it
<code>install.packages("corrplot")</code> then pass the matrix as the argument
<code>corrplot(cor(new_boston))</code></p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres11):</p>
<p>the test statistic is calculated seeing, for example, how many times the
absolute difference between the sample mean and the population mean
(sm-mu) embodies the standard error = sqrt[(known variance)/n]. This
value allow us to standardize the distribution and allocate the value in
a Normal distribution (if the variance is known) or in a T di Student
distribution (variance unknown) - looking at this value we can now
calculate the probability that it is within the range of values
established by the level of confidence of the statistical test.</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres12):</p>
<pre><code>t.test(X, Y, paired = F, alternative =&quot;less&quot;, var.equal = T)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres13):</p>
<p><strong>FALSE</strong></p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres15):</p>
<p>simple correlation aight?!</p>
<pre><code>cor(x = iris$Sepal.Length, y = iris$Sepal.Width)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres16):</p>
<p>Please note that correlation with <code>cor()</code> can be computed with only
numeric values. Looking at <code>iris</code> you see the variable <code>species</code> which
is a factor (aka grouping variable) we used that for ANOVA <code>aov()</code> when
we are interested in comparing means across more than 2 groups. As a
result you need to select all the variables but <code>Species</code> and do
<code>cor()</code>.</p>
<pre><code>iris_filtr = select(iris, Sepal.Length, Sepal.Width, Petal.Length, Petal.Width)
cor(iris_filtr)</code></pre>
<p>there‚Äôs another way to do the filtering stuff, you just deselect
<code>Species</code> such that:</p>
<pre><code>iris_filtr2 = select(iris, -Species)
cor(iris_filtr2)</code></pre>
<p>You also might want to visualize the correlation as we did before (advanced trick):</p>
<pre><code>library(corrplot)
iris_filtr2 = select(iris, -Species)
corrplot::corrplot(cor(iris_filtr2))
    </code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres161):</p>
<pre><code>iris_filtr = select(iris, Sepal.Length, Sepal.Width, Petal.Length, Petal.Width)
cor(iris_filtr)</code></pre>
<p>there‚Äôs another way to do the filtering stuff, you just deselect
<code>Species</code> such that:</p>
<pre><code>iris_filtr2 = select(iris, -Species)
cor(iris_filtr2)
    </code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres17):</p>
<pre><code>var(iris$Sepal.Length)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres18):</p>
<pre><code>summary(iris$Sepal.Length)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres19):</p>
<p>Adjusted R2 is a corrected goodness-of-fit (model accuracy) measure for linear models. It identifies the percentage
of variance in the target field that is explained by the input or
inputs. R2 tends to optimistically estimate the fit of the linear
regression. It always increases as the number of effects are included in
the model. Adjusted R2 attempts to correct for this overestimation.
Adjusted R2 might decrease if a specific effect does not improve the
model. If you guessed the <code>To account for the number of parameters</code> this
would also get you some points, But more precisely we are talking about
the <strong>degrees of freedom</strong>.</p>
<p><span class="math inline">\(R_{adj}^2 = 1- \frac{(1-R^2)(n-1)}{n-k-1}\)</span></p>
<blockquote>
<p>To account for the number of degrees of freedom!</p>
</blockquote>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres20):</p>
<p>As you may know Multicollinearity is problem that you can run into when
you‚Äôre fitting a regression model, or other linear model. It refers to
predictors that are correlated with other predictors in the model.
Unfortunately, the effects of multicollinearity can feel murky and
intangible, which makes it unclear whether it‚Äôs important to fix.
Multicollinearity results in unstable parameter estimates which makes it
very difficult to assess the effect of independent variables on
dependent variables.</p>
<p>Let‚Äôs see that from another pov:</p>
<p>Consider the simplest case where <span class="math inline">\(Y\)</span> is regressed against <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span>
such that <span class="math inline">\(Y = \alpha + \beta_1X +\beta_2Z + \epsilon\)</span> and where <span class="math inline">\(Z\)</span> and
<span class="math inline">\(Z\)</span> are highly positively correlated. Then the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> is
hard to distinguish from the effect of <span class="math inline">\(Z\)</span> on <span class="math inline">\(Y\)</span> because any increase
in <span class="math inline">\(X\)</span> tends to be associated with an increase in <span class="math inline">\(Z\)</span>. Now let‚Äôs also
consider th pathological case where <span class="math inline">\(X = Z\)</span> highlights this further.
<span class="math inline">\(Y = \alpha + \beta_1X + \beta_2Z + \epsilon\)</span> -&gt;
<span class="math inline">\(Y = \alpha + (\beta_1 + \beta_2)X + 0Z + \epsilon\)</span> then both of the two
variables would be indistinguishable.</p>
<p><span class="math inline">\(\frac{1}{1-R^2}\)</span></p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres21):</p>
<p>Estimators become unstable</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres22):</p>
<p>first attempt:</p>
<pre><code>library(carData)
library(car)
data(&quot;Wong&quot;)
wong_regression = lm(piq ~ age + days + duration, data = Wong)
summary(wong_regression)</code></pre>
<p>From here you see that <code>age</code> and <code>days</code> are not significant, indeed
<code>duration</code> is. However <code>days</code> havign .13 as p values is much more
significant than age which accounts for .38 Let‚Äôs also check
collinearity for this <strong>uncorrectly specified</strong> model. They all look
good since their values are all <strong>&lt;10</strong>.</p>
<p>Then we mnay want to see how the model, behaves by cancelling out <code>age</code>
and keeping <code>days</code>, so:</p>
<pre><code>wong_regression_2 = lm(piq ~ days + duration, data = Wong)</code></pre>
<p>In this iteration we verify that <code>duration</code> becomes even more important
since now has ***. However <code>days</code> just got worst. We finally remove
it too. We don‚Äôt check <code>vif()</code> we have already done that and we do not
expect that a subset of non collinear varibales (as before) now become
collinear. As a result:√π</p>
<pre><code>wong_regression_3 = lm(piq ~ duration, data = Wong)</code></pre>
<p>In the end we only retain <code>duration</code></p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres23):</p>
<pre><code>summary(wong_regression_3)</code></pre>
<p>resulting in <strong>0.02618</strong></p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres24):</p>
<pre><code>wong_regression_3$coefficients[2]</code></pre>
<p>resulting in <strong>-0.09918208</strong></p>
<p>you can also directly look it through the summary</p>
<pre><code>summary(wong_regression_3)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres25):</p>
<pre><code>wong_regression_3$coefficients[1]</code></pre>
<p>resulting in <strong>88.97380549</strong></p>
<p>you can also directly look it through the summary</p>
<pre><code>summary(wong_regression_3)</code></pre>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres26):</p>
<pre><code>summary(wong_regression_3)</code></pre>
<p>resulting in <code>duration</code> p-value: <strong>0.00183</strong></p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres27):</p>
<pre><code>summary(wong_regression_3)</code></pre>
<p>result : <strong>0.02913</strong></p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres28):</p>
<p>We look at <code>Species</code> (we have already gone through that during lecture)
by inspecting the dataset. What we see is that <code>Species</code> has three
categories <em>setosa</em>, <em>versicolor</em> and <em>virginica</em>. If we would like to
compare means across these 3 different categories we can‚Äôt use
<code>t.test()</code> since they are 3. Instead we use <strong>ANOVA</strong> with the <code>aov()</code>.
Sintax is similar to linear models. We saw this when we were trying to
tackle ‚Äúlong‚Äù format data vs.¬†‚Äúwide‚Äù format data.</p>
<pre><code>test_species = aov(Sepal.Length~Species, data = iris)
summary(test_species)</code></pre>
<p>resulting in <strong>0.0000000000000002</strong>, very significant. We can conclude
that: The ANOVA (formula: Sepal.Length ~ Species) suggests that the
main effect of Species is statistically significant and large.</p>
</div>
<div class="answer">
<p><strong>Answer to Question</strong> @ref(exr:intres29):</p>
<p>We take the exact same test as before and we look for the statistic</p>
<pre><code>summary(test_species)</code></pre>
<p>Here you look for the <strong>F statistics</strong>: F = <strong>119.3</strong></p>
</div>
<!--chapter:end:06quater-intermediaate-sample.Rmd-->
</div>
</div>
<div id="int-samp-q-second" class="section level1" number="16">
<h1><span class="header-section-number">16</span> üíª Second Intermediate Sample Questions</h1>
<p>Hi guys, these are the sample questions that prof Dabo gave us to exercise yourself. As you may notice most of them are open questions on very superifical theory concepts, no indeep math or heavy calculations (matrix products, dot products etc.). So please my suggestion is to review carefully the slides and just learn the basic R commands to execute analysis on a higer level! üçÄ</p>
<div id="nd-intermediate" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> üë®‚Äçüéì 2023/2024 (2nd intermediate)</h2>
<div id="exercise-10.1-basic-understanding" class="section level3" number="16.1.1">
<h3><span class="header-section-number">16.1.1</span> Exercise 10.1 Basic Understanding:</h3>
<p>What does PCA stand for?</p>
<p>Briefly explain the primary objective of Principal Component Analysis.</p>
<p>How does PCA help in dimensionality reduction?</p>
</div>
<div id="exercise-10.2-library-and-data-loading" class="section level3" number="16.1.2">
<h3><span class="header-section-number">16.1.2</span> Exercise 10.2 Library and Data Loading:</h3>
<p>Which R library is commonly used for performing PCA?</p>
<p>Write the command to load the library FactomineR for PCA.</p>
<p>How do you read a dataset into R for PCA analysis?</p>
</div>
<div id="exercise-10.3-data-preparation" class="section level3" number="16.1.3">
<h3><span class="header-section-number">16.1.3</span> Exercise 10.3 Data Preparation:</h3>
<p>Explain the importance of scaling or standardizing variables before applying PCA.</p>
<p>Write the R command to standardize a data matrix.</p>
</div>
<div id="exercise-10.4-pca-execution" class="section level3" number="16.1.4">
<h3><span class="header-section-number">16.1.4</span> Exercise 10.4 PCA Execution:</h3>
<p>What function in R is used to perform PCA?</p>
<p>Provide the basic syntax for running PCA on a dataset named ¬´ my_data.¬ª</p>
</div>
<div id="exercise-10.5-interpretation-of-results" class="section level3" number="16.1.5">
<h3><span class="header-section-number">16.1.5</span> Exercise 10.5 Interpretation of Results:</h3>
<p>How can you access the proportion of variance explained by each principal component in the following R script?</p>
<p>What is the significance of the eigenvalues and eigenvectors in PCA?</p>
</div>
<div id="exercise-10.6-selecting-principal-components" class="section level3" number="16.1.6">
<h3><span class="header-section-number">16.1.6</span> Exercise 10.6 Selecting Principal Components:</h3>
<p>How can you determine the optimal number of principal components to retain in R?</p>
<p>Write the R command to extract the loadings of principal components.</p>
</div>
<div id="exercise-10.7-the-inertia-of-a-centered-matrix-of-n-individuals-and-p-quantitative-variables-is" class="section level3" number="16.1.7">
<h3><span class="header-section-number">16.1.7</span> Exercise 10.7 The inertia of a centered matrix of n individuals and p quantitative variables is</h3>
<ul>
<li>p</li>
<li>The sum of variances of the p variables</li>
<li>None of the responses are true</li>
</ul>
</div>
<div id="exercise-10.8-the-principal-components-coordinates-of-the-individuals-are-un-correlated" class="section level3" number="16.1.8">
<h3><span class="header-section-number">16.1.8</span> Exercise 10.8 The principal components (coordinates of the individuals) are un-correlated</h3>
<ul>
<li>TRUE</li>
<li>FALSE</li>
</ul>
</div>
<div id="exercise-10.9-in-a-normed-pca-the-mean-eigen-values-is" class="section level3" number="16.1.9">
<h3><span class="header-section-number">16.1.9</span> Exercise 10.9 In a normed PCA, the mean eigen-values is</h3>
<ul>
<li>1</li>
<li>2</li>
<li>3</li>
</ul>
</div>
<div id="exercise-10.10-let-z-be-a-matrix-50-rows-and-4-columns-of-centered-and-reduced-quantitative-data-with-a-correlation-matrix-r-of-dimension-4-and-three-eigenvalues-are-2-1-and-0.4." class="section level3" number="16.1.10">
<h3><span class="header-section-number">16.1.10</span> Exercise 10.10 Let Z be a matrix (50 rows and 4 columns) of centered and reduced quantitative data, with a correlation matrix R (of dimension 4) and three eigenvalues are 2, 1 and 0.4.</h3>
<p>Give the maximum number of eigen-values</p>
<p>Give the remaining eigen-values</p>
</div>
<div id="exercise-10.11-a-dataset-x-gives-for-23-charolais-and-zebus-cattles-6-different-weights-in-kg-live-weight-w_liv-carcass-weight-w_car-prime-meat-weight-w_quali-total-meat-weight-w_total-fat-meat-weight-w_fat-bone-weight-w_bo-and-the-cattle-type-type." class="section level3" number="16.1.11">
<h3><span class="header-section-number">16.1.11</span> Exercise 10.11 A dataset X gives, for 23 Charolais and Zebus cattles, 6 different weights, in kg: live weight (W_LIV), carcass weight (W_CAR), prime meat weight (W_QUALI), total meat weight (W_TOTAL), fat meat weight (W_FAT), bone weight (W_BO) and the cattle type (Type).</h3>
<p>How do you interpret the following correlation matrix plot?</p>
<div class="float">
<img src="images/corr_mat.png" alt="corr matrix" />
<div class="figcaption">corr matrix</div>
</div>
<p>How many components would you choose regarding the following figures (giving the eigen-values and correlation between the components and the variables)</p>
<div class="float">
<img src="images/eig_table.png" alt="eig table" />
<div class="figcaption">eig table</div>
</div>
<p>Interpret the following figure:</p>
<div class="float">
<img src="images/ind_pca.png" alt="eig table" />
<div class="figcaption">eig table</div>
</div>
</div>
<div id="exercise-10.12-scree-plot" class="section level3" number="16.1.12">
<h3><span class="header-section-number">16.1.12</span> Exercise 10.12 Scree Plot:</h3>
<p>What is the purpose of a scree plot in PCA?</p>
<p>How do you generate and interpret the following scree plot ?</p>
<div class="float">
<img src="images/scree_plot_sample.png" alt="scree plot" />
<div class="figcaption">scree plot</div>
</div>
</div>
<div id="exercise-10.13-scree-plot" class="section level3" number="16.1.13">
<h3><span class="header-section-number">16.1.13</span> Exercise 10.13 Scree Plot:</h3>
<p>Briefly explain the main objective of Correspondence Analysis (CA).</p>
<p>How is CA different from Principal Component Analysis (PCA)?</p>
<p>Provide an example of a scenario where CA would be a suitable analysis.</p>
</div>
<div id="exercise-10.14-correspondence-analysis" class="section level3" number="16.1.14">
<h3><span class="header-section-number">16.1.14</span> Exercise 10.14 Correspondence Analysis:</h3>
<p>Briefly explain the main objective of Correspondence Analysis (CA).</p>
<p>How is CA different from Principal Component Analysis (PCA)?</p>
<p>Provide an example of a scenario where CA would be a suitable analysis.</p>
</div>
<div id="exercise-10.14-ca-execution" class="section level3" number="16.1.15">
<h3><span class="header-section-number">16.1.15</span> Exercise 10.14 CA Execution:</h3>
<p>Provide the basic syntax for running CA on a contingency table named ‚Äúmy_table.‚Äù</p>
</div>
<div id="exercise-10.14-interpretation-of-results" class="section level3" number="16.1.16">
<h3><span class="header-section-number">16.1.16</span> Exercise 10.14 Interpretation of Results:</h3>
<p>How can you access the row and column scores of the CA results in R?</p>
</div>
<div id="exercise-10.15-visualization" class="section level3" number="16.1.17">
<h3><span class="header-section-number">16.1.17</span> Exercise 10.15 Visualization:</h3>
<p>Write the R command to create a biplot for a Correspondence Analysis result.</p>
<p>How can you visually assess the relationships between rows and columns in a CA plot?</p>
</div>
<div id="exercise-10.16-e3" class="section level3" number="16.1.18">
<h3><span class="header-section-number">16.1.18</span> Exercise 10.16 E3:</h3>
<p>Write the R command to extract the contributions of dimensions in CA (write it in general)</p>
</div>
<div id="exercise-10.17-disjunctive-table" class="section level3" number="16.1.19">
<h3><span class="header-section-number">16.1.19</span> Exercise 10.17 Disjunctive table:</h3>
<p>Construct the disjunctive table of the following data</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" tabindex="-1"></a><span class="fu">library</span>(tibble) </span>
<span id="cb227-2"><a href="#cb227-2" tabindex="-1"></a>disj_table <span class="ot">=</span> <span class="fu">tribble</span>(</span>
<span id="cb227-3"><a href="#cb227-3" tabindex="-1"></a>  <span class="sc">~</span>Var1, <span class="sc">~</span>Var2, <span class="sc">~</span>Var3,</span>
<span id="cb227-4"><a href="#cb227-4" tabindex="-1"></a>  <span class="st">&quot;CB&quot;</span>, <span class="st">&quot;YB&quot;</span>, <span class="st">&quot;F&quot;</span>,</span>
<span id="cb227-5"><a href="#cb227-5" tabindex="-1"></a>  <span class="st">&quot;CB&quot;</span>, <span class="st">&quot;YV&quot;</span>, <span class="st">&quot;F&quot;</span>,</span>
<span id="cb227-6"><a href="#cb227-6" tabindex="-1"></a>  <span class="st">&quot;CC&quot;</span>, <span class="st">&quot;YB&quot;</span>, <span class="st">&quot;M&quot;</span>,</span>
<span id="cb227-7"><a href="#cb227-7" tabindex="-1"></a>  <span class="st">&quot;CC&quot;</span>, <span class="st">&quot;YM&quot;</span>, <span class="st">&quot;F&quot;</span>,</span>
<span id="cb227-8"><a href="#cb227-8" tabindex="-1"></a>  <span class="st">&quot;CR&quot;</span>, <span class="st">&quot;YV&quot;</span>, <span class="st">&quot;M&quot;</span>,</span>
<span id="cb227-9"><a href="#cb227-9" tabindex="-1"></a>  <span class="st">&quot;CB&quot;</span>, <span class="st">&quot;YB&quot;</span>, <span class="st">&quot;M&quot;</span></span>
<span id="cb227-10"><a href="#cb227-10" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="exercise-10.18-chi-square-test" class="section level3" number="16.1.20">
<h3><span class="header-section-number">16.1.20</span> Exercise 10.18 Chi-Square Test:</h3>
<p>What is the role of the chi-square test in Correspondence Analysis?</p>
<p>How can you perform a chi-square test on a CA result in R?</p>
</div>
<div id="exercise-10.19-clustering" class="section level3" number="16.1.21">
<h3><span class="header-section-number">16.1.21</span> Exercise 10.19 Clustering:</h3>
<p>What is the main goal of clustering algorithms?</p>
</div>
<div id="exercise-10.20-k-means-clustering" class="section level3" number="16.1.22">
<h3><span class="header-section-number">16.1.22</span> Exercise 10.20 K-Means Clustering:</h3>
<p>What is the fundamental concept behind K-means clustering?</p>
<p>Explain the meaning of centroids in the context of K-means clustering.</p>
<p>Write the R command to perform K-means clustering on a dataset named ‚Äúmy_data.‚Äù</p>
</div>
<div id="exercise-10.21-hierarchical-clustering" class="section level3" number="16.1.23">
<h3><span class="header-section-number">16.1.23</span> Exercise 10.21 Hierarchical Clustering:</h3>
<p>Briefly explain how hierarchical clustering works.</p>
<p>Write the R command to conduct hierarchical clustering on a dataset.</p>
</div>
<div id="exercise-10.22-interpretation-of-clustering-results" class="section level3" number="16.1.24">
<h3><span class="header-section-number">16.1.24</span> Exercise 10.22 Interpretation of Clustering Results:</h3>
<p>How do you interpret the following output of a clustering analysis on the cattle data?</p>
</div>
<div id="exercise-10.23-classification" class="section level3" number="16.1.25">
<h3><span class="header-section-number">16.1.25</span> Exercise 10.23 Classification:</h3>
<p>What is the main goal of a classification ?</p>
<p>Provide an example of a real-world application where classification analysis could be beneficial.</p>
<p>How can classification be used in medical diagnosis or fraud detection?</p>
</div>
<div id="exercise-10.24-what-does-pca-stand-for" class="section level3" number="16.1.26">
<h3><span class="header-section-number">16.1.26</span> Exercise 10.24 What does PCA stand for?</h3>
<ul>
<li>Primary Component Analysis</li>
<li>Principal Component Algorithm</li>
<li>Principal Component Analysis</li>
<li>Primary Component Algorithm</li>
</ul>
</div>
<div id="exercise-10.25-in-pca-what-is-the-primary-goal" class="section level3" number="16.1.27">
<h3><span class="header-section-number">16.1.27</span> Exercise 10.25 In PCA, what is the primary goal?</h3>
<ul>
<li>Reduce dimensionality while preserving variance</li>
<li>Increase dimensionality for better visualization</li>
<li>Minimize all components equally</li>
<li>Focus on individual components only</li>
</ul>
</div>
<div id="exercise-10.26-which-r-function-is-commonly-used-to-perform-pca" class="section level3" number="16.1.28">
<h3><span class="header-section-number">16.1.28</span> Exercise 10.26 Which R function is commonly used to perform PCA?</h3>
<ul>
<li>kmeans()</li>
<li>PCA()</li>
<li>prcomp()</li>
<li>corresp()</li>
</ul>
</div>
<div id="exercise-10.27-what-is-the-purpose-of-a-scree-plot-in-pca" class="section level3" number="16.1.29">
<h3><span class="header-section-number">16.1.29</span> Exercise 10.27 What is the purpose of a scree plot in PCA?</h3>
<ul>
<li>Visualize the clusters in data</li>
<li>Assess the quality of clustering</li>
<li>Evaluate the distribution of data</li>
<li>Display the eigenvalues of principal components</li>
</ul>
</div>
<div id="exercise-10.28-how-do-you-determine-the-optimal-number-of-principal-components-to-retain-in-pca" class="section level3" number="16.1.30">
<h3><span class="header-section-number">16.1.30</span> Exercise 10.28 How do you determine the optimal number of principal components to retain in PCA?</h3>
<ul>
<li>Use hierarchical clustering</li>
<li>Examine the scree plot</li>
<li>Apply k-means clustering</li>
<li>Perform a chi-square test</li>
</ul>
</div>
<div id="exercise-10.29-what-is-the-primary-application-of-correspondence-analysis-ca" class="section level3" number="16.1.31">
<h3><span class="header-section-number">16.1.31</span> Exercise 10.29 What is the primary application of Correspondence Analysis (CA)?</h3>
<ul>
<li>Reducing dimensionality of numerical data</li>
<li>Analyzing relationships in categorical data</li>
<li>Classifying data points into clusters</li>
<li>Predicting future values in a time series</li>
</ul>
</div>
<div id="exercise-10.30-which-r-library-is-commonly-used-for-correspondence-analysis" class="section level3" number="16.1.32">
<h3><span class="header-section-number">16.1.32</span> Exercise 10.30 Which R library is commonly used for Correspondence Analysis?</h3>
<ul>
<li>cluster</li>
<li>caret</li>
<li>ca</li>
<li>factoextra</li>
<li>FactomineR</li>
</ul>
</div>
<div id="exercise-10.31-what-is-the-role-of-the-chi-square-test-in-correspondence-analysis" class="section level3" number="16.1.33">
<h3><span class="header-section-number">16.1.33</span> Exercise 10.31 What is the role of the chi-square test in Correspondence Analysis?</h3>
<ul>
<li>Assess the significance of relationships</li>
<li>Determine the optimal number of clusters</li>
<li>Evaluate the distribution of data</li>
<li>Visualize the proximity between data points</li>
</ul>
</div>
<div id="exercise-10.32-what-is-the-primary-goal-of-clustering-algorithms" class="section level3" number="16.1.34">
<h3><span class="header-section-number">16.1.34</span> Exercise 10.32 What is the primary goal of clustering algorithms?</h3>
<ul>
<li>Dimensionality reduction</li>
<li>Classification</li>
<li>Grouping similar data points</li>
<li>Visualization of data</li>
</ul>
</div>
<div id="exercise-10.33-which-r-function-is-commonly-used-for-k-means-clustering" class="section level3" number="16.1.35">
<h3><span class="header-section-number">16.1.35</span> Exercise 10.33 Which R function is commonly used for K-means clustering?</h3>
<ul>
<li>hierarch()</li>
<li>PCA()</li>
<li>kmeans()</li>
<li>prcomp()</li>
</ul>
</div>
<div id="exercise-10.34-how-can-you-visually-assess-relationships-between-rows-and-columns-in-a-clustering-plot" class="section level3" number="16.1.36">
<h3><span class="header-section-number">16.1.36</span> Exercise 10.34 How can you visually assess relationships between rows and columns in a clustering plot?</h3>
<ul>
<li>Scree plot</li>
<li>Dendrogram</li>
<li>Silhouette plot</li>
<li>Biplot</li>
</ul>
</div>
<div id="exercise-10.35-what-is-the-primary-goal-of-a-classification-algorithm" class="section level3" number="16.1.37">
<h3><span class="header-section-number">16.1.37</span> Exercise 10.35 What is the primary goal of a classification algorithm?</h3>
<ul>
<li>Group similar data points</li>
<li>Predict numerical values</li>
<li>Assign labels to data points</li>
<li>Visualize high-dimensional data</li>
</ul>
</div>
<div id="exercise-10.36-which-algorithm-is-commonly-used-for-binary-classification-tasks-answers-can-be-more-than-one" class="section level3" number="16.1.38">
<h3><span class="header-section-number">16.1.38</span> Exercise 10.36 Which algorithm is commonly used for binary classification tasks? (Answers can be more than one)</h3>
<ul>
<li>Decision Trees</li>
<li>K-means</li>
<li>LDA</li>
<li>Logistic Regression</li>
</ul>
</div>
<div id="exercise-10.37-which-metric-is-commonly-used-to-evaluate-the-performance-of-a-classification-model" class="section level3" number="16.1.39">
<h3><span class="header-section-number">16.1.39</span> Exercise 10.37 Which metric is commonly used to evaluate the performance of a classification model?</h3>
<ul>
<li>R-squared</li>
<li>Mean Absolute Error</li>
<li>Silhouette Score</li>
<li>Accuracy</li>
</ul>
</div>
<div id="exercise-10.38-pca-eigenvalues" class="section level3" number="16.1.40">
<h3><span class="header-section-number">16.1.40</span> Exercise 10.38 PCA Eigenvalues:</h3>
<p>In PCA, what does a high eigenvalue indicate?</p>
<ul>
<li>The principal component explains a large amount of variance</li>
<li>The principal component is not important</li>
<li>The data has high correlation</li>
<li>None of the above</li>
</ul>
</div>
<div id="exercise-10.39-pca-loadings" class="section level3" number="16.1.41">
<h3><span class="header-section-number">16.1.41</span> Exercise 10.39 PCA Loadings:</h3>
<p>What do loadings represent in PCA?</p>
<ul>
<li>The correlation between variables and principal components</li>
<li>The eigenvalues of the components</li>
<li>The proportion of variance explained</li>
<li>The number of observations</li>
</ul>
</div>
<div id="exercise-10.40-k-means-initialization" class="section level3" number="16.1.42">
<h3><span class="header-section-number">16.1.42</span> Exercise 10.40 K-Means Initialization:</h3>
<p>Why is it important to set a seed when performing K-means clustering?</p>
<ul>
<li>To ensure reproducibility of results</li>
<li>To increase the number of clusters</li>
<li>To improve the accuracy</li>
<li>To reduce computation time</li>
</ul>
</div>
<div id="exercise-10.41-hierarchical-clustering-methods" class="section level3" number="16.1.43">
<h3><span class="header-section-number">16.1.43</span> Exercise 10.41 Hierarchical Clustering Methods:</h3>
<p>Which of the following are common linkage methods in hierarchical clustering?</p>
<ul>
<li>Complete linkage</li>
<li>Single linkage</li>
<li>Average linkage</li>
<li>All of the above</li>
</ul>
</div>
<div id="exercise-10.42-optimal-number-of-clusters" class="section level3" number="16.1.44">
<h3><span class="header-section-number">16.1.44</span> Exercise 10.42 Optimal Number of Clusters:</h3>
<p>How can you determine the optimal number of clusters in K-means?</p>
<ul>
<li>Using the elbow method</li>
<li>Using silhouette analysis</li>
<li>Using within-cluster sum of squares</li>
<li>All of the above</li>
</ul>
</div>
<div id="exercise-10.43-ca-vs-pca" class="section level3" number="16.1.45">
<h3><span class="header-section-number">16.1.45</span> Exercise 10.43 CA vs PCA:</h3>
<p>What type of data is Correspondence Analysis designed for?</p>
<ul>
<li>Continuous numerical data</li>
<li>Categorical data in contingency tables</li>
<li>Time series data</li>
<li>Binary data only</li>
</ul>
</div>
<div id="exercise-10.44-pca-scaling" class="section level3" number="16.1.46">
<h3><span class="header-section-number">16.1.46</span> Exercise 10.44 PCA Scaling:</h3>
<p>What happens if you don‚Äôt scale variables before PCA?</p>
<ul>
<li>Variables with larger scales will dominate</li>
<li>The results will be incorrect</li>
<li>PCA cannot be performed</li>
<li>Nothing, scaling is optional</li>
</ul>
</div>
<div id="exercise-10.45-clustering-distance" class="section level3" number="16.1.47">
<h3><span class="header-section-number">16.1.47</span> Exercise 10.45 Clustering Distance:</h3>
<p>What is the most common distance metric used in clustering?</p>
<ul>
<li>Euclidean distance</li>
<li>Manhattan distance</li>
<li>Correlation distance</li>
<li>All of the above</li>
</ul>
</div>
<div id="exercise-10.46-classification-vs-clustering" class="section level3" number="16.1.48">
<h3><span class="header-section-number">16.1.48</span> Exercise 10.46 Classification vs Clustering:</h3>
<p>What is the main difference between classification and clustering?</p>
<ul>
<li>Classification requires labeled data, clustering does not</li>
<li>Clustering requires labeled data, classification does not</li>
<li>They are the same thing</li>
<li>Classification is supervised, clustering is unsupervised</li>
</ul>
</div>
<div id="exercise-10.47-pca-visualization" class="section level3" number="16.1.49">
<h3><span class="header-section-number">16.1.49</span> Exercise 10.47 PCA Visualization:</h3>
<p>What is a biplot used for in PCA?</p>
<ul>
<li>To visualize both variables and observations</li>
<li>To show only eigenvalues</li>
<li>To display correlation matrices</li>
<li>To plot residuals</li>
</ul>
</div>
<div id="exercise-10.48-ca-interpretation" class="section level3" number="16.1.50">
<h3><span class="header-section-number">16.1.50</span> Exercise 10.48 CA Interpretation:</h3>
<p>In Correspondence Analysis, what does proximity between row and column points indicate?</p>
<ul>
<li>Strong association between categories</li>
<li>Weak association</li>
<li>No relationship</li>
<li>Random distribution</li>
</ul>
</div>
<div id="exercise-10.49-k-means-limitations" class="section level3" number="16.1.51">
<h3><span class="header-section-number">16.1.51</span> Exercise 10.49 K-Means Limitations:</h3>
<p>What is a limitation of K-means clustering?</p>
<ul>
<li>Requires pre-specification of number of clusters</li>
<li>Cannot handle categorical variables</li>
<li>Sensitive to outliers</li>
<li>All of the above</li>
</ul>
</div>
<div id="exercise-10.50-hierarchical-clustering-output" class="section level3" number="16.1.52">
<h3><span class="header-section-number">16.1.52</span> Exercise 10.50 Hierarchical Clustering Output:</h3>
<p>What is a dendrogram?</p>
<ul>
<li>A tree-like diagram showing cluster relationships</li>
<li>A scatter plot of data points</li>
<li>A correlation matrix</li>
<li>A scree plot</li>
</ul>
</div>
</div>
<div id="solutions-2" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> Solutions</h2>
<div id="answer-to-question-10.1" class="section level3" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> Answer to Question 10.1:</h3>
<p><strong>What does PCA stand for?</strong>
<strong>Principal Component Analysis</strong></p>
<p><strong>Briefly explain the primary objective of Principal Component Analysis.</strong>
PCA aims to reduce the dimensionality of a dataset while preserving as much variance as possible. It transforms the original variables into a smaller set of uncorrelated variables called principal components.</p>
<p><strong>How does PCA help in dimensionality reduction?</strong>
PCA identifies directions (principal components) in which the data varies the most. By keeping only the first few principal components that explain most of the variance, we can reduce the number of dimensions while retaining most of the information.</p>
</div>
<div id="answer-to-question-10.2" class="section level3" number="16.2.2">
<h3><span class="header-section-number">16.2.2</span> Answer to Question 10.2:</h3>
<p><strong>Which R library is commonly used for performing PCA?</strong>
<strong>FactoMineR, factoextra, or base R (prcomp, princomp)</strong></p>
<p><strong>Write the command to load the library FactomineR for PCA.</strong></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span></code></pre></div>
<p><strong>How do you read a dataset into R for PCA analysis?</strong></p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" tabindex="-1"></a><span class="co"># For CSV files</span></span>
<span id="cb229-2"><a href="#cb229-2" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;filename.csv&quot;</span>)</span>
<span id="cb229-3"><a href="#cb229-3" tabindex="-1"></a></span>
<span id="cb229-4"><a href="#cb229-4" tabindex="-1"></a><span class="co"># For other formats</span></span>
<span id="cb229-5"><a href="#cb229-5" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;filename.txt&quot;</span>)</span></code></pre></div>
</div>
<div id="answer-to-question-10.3" class="section level3" number="16.2.3">
<h3><span class="header-section-number">16.2.3</span> Answer to Question 10.3:</h3>
<p><strong>Explain the importance of scaling or standardizing variables before applying PCA.</strong>
Scaling is crucial because PCA is sensitive to the scale of variables. Variables with larger scales will dominate the analysis. Standardizing ensures all variables contribute equally to the principal components.</p>
<p><strong>Write the R command to standardize a data matrix.</strong></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" tabindex="-1"></a><span class="co"># Method 1: Using scale()</span></span>
<span id="cb230-2"><a href="#cb230-2" tabindex="-1"></a>scaled_data <span class="ot">&lt;-</span> <span class="fu">scale</span>(my_data)</span>
<span id="cb230-3"><a href="#cb230-3" tabindex="-1"></a></span>
<span id="cb230-4"><a href="#cb230-4" tabindex="-1"></a><span class="co"># Method 2: Manual standardization</span></span>
<span id="cb230-5"><a href="#cb230-5" tabindex="-1"></a>scaled_data <span class="ot">&lt;-</span> (my_data <span class="sc">-</span> <span class="fu">mean</span>(my_data)) <span class="sc">/</span> <span class="fu">sd</span>(my_data)</span></code></pre></div>
</div>
<div id="answer-to-question-10.4" class="section level3" number="16.2.4">
<h3><span class="header-section-number">16.2.4</span> Answer to Question 10.4:</h3>
<p><strong>What function in R is used to perform PCA?</strong>
<strong><code>prcomp()</code>, <code>PCA()</code> (from FactoMineR), or <code>princomp()</code></strong></p>
<p><strong>Provide the basic syntax for running PCA on a dataset named ‚Äúmy_data.‚Äù</strong></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" tabindex="-1"></a><span class="co"># Using prcomp (base R)</span></span>
<span id="cb231-2"><a href="#cb231-2" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(my_data, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb231-3"><a href="#cb231-3" tabindex="-1"></a></span>
<span id="cb231-4"><a href="#cb231-4" tabindex="-1"></a><span class="co"># Using FactoMineR</span></span>
<span id="cb231-5"><a href="#cb231-5" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">PCA</span>(my_data, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="answer-to-question-10.5" class="section level3" number="16.2.5">
<h3><span class="header-section-number">16.2.5</span> Answer to Question 10.5:</h3>
<p><strong>How can you access the proportion of variance explained by each principal component?</strong></p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" tabindex="-1"></a><span class="co"># Using prcomp</span></span>
<span id="cb232-2"><a href="#cb232-2" tabindex="-1"></a><span class="fu">summary</span>(pca_result)<span class="sc">$</span>importance[<span class="dv">2</span>, ]  <span class="co"># Proportion of variance</span></span>
<span id="cb232-3"><a href="#cb232-3" tabindex="-1"></a></span>
<span id="cb232-4"><a href="#cb232-4" tabindex="-1"></a><span class="co"># Or calculate manually</span></span>
<span id="cb232-5"><a href="#cb232-5" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb232-6"><a href="#cb232-6" tabindex="-1"></a>proportion_variance <span class="ot">&lt;-</span> eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)</span></code></pre></div>
<p><strong>What is the significance of the eigenvalues and eigenvectors in PCA?</strong>
- <strong>Eigenvalues</strong>: Represent the amount of variance explained by each principal component. Larger eigenvalues indicate components that capture more variance.
- <strong>Eigenvectors</strong>: Represent the direction of each principal component. They show how the original variables contribute to each component (loadings).</p>
</div>
<div id="answer-to-question-10.6" class="section level3" number="16.2.6">
<h3><span class="header-section-number">16.2.6</span> Answer to Question 10.6:</h3>
<p><strong>How can you determine the optimal number of principal components to retain?</strong>
- Examine the scree plot (look for the ‚Äúelbow‚Äù)
- Use Kaiser‚Äôs criterion (keep components with eigenvalues &gt; 1)
- Retain components that explain a cumulative variance above a threshold (e.g., 80-90%)
- Use parallel analysis</p>
<p><strong>Write the R command to extract the loadings of principal components.</strong></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" tabindex="-1"></a><span class="co"># Using prcomp</span></span>
<span id="cb233-2"><a href="#cb233-2" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>rotation</span>
<span id="cb233-3"><a href="#cb233-3" tabindex="-1"></a></span>
<span id="cb233-4"><a href="#cb233-4" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb233-5"><a href="#cb233-5" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span>k]  <span class="co"># For first k components</span></span></code></pre></div>
</div>
<div id="answer-to-question-10.1-1" class="section level3" number="16.2.7">
<h3><span class="header-section-number">16.2.7</span> Answer to Question 10.1:</h3>
<p><strong>What does PCA stand for?</strong>
Principal Component Analysis</p>
<p><strong>Briefly explain the primary objective of Principal Component Analysis.</strong>
PCA aims to reduce the dimensionality of a dataset while preserving as much variance as possible. It transforms the original variables into a smaller set of uncorrelated variables called principal components.</p>
<p><strong>How does PCA help in dimensionality reduction?</strong>
PCA identifies directions (principal components) in which the data varies the most. By keeping only the first few principal components that explain most of the variance, we can reduce the number of dimensions while retaining most of the information.</p>
</div>
<div id="answer-to-question-10.2-1" class="section level3" number="16.2.8">
<h3><span class="header-section-number">16.2.8</span> Answer to Question 10.2:</h3>
<p><strong>Which R library is commonly used for performing PCA?</strong>
FactoMineR, factoextra, or base R (prcomp, princomp)</p>
<p><strong>Write the command to load the library FactomineR for PCA.</strong></p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span></code></pre></div>
<p><strong>How do you read a dataset into R for PCA analysis?</strong></p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" tabindex="-1"></a><span class="co"># For CSV files</span></span>
<span id="cb235-2"><a href="#cb235-2" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;filename.csv&quot;</span>)</span>
<span id="cb235-3"><a href="#cb235-3" tabindex="-1"></a></span>
<span id="cb235-4"><a href="#cb235-4" tabindex="-1"></a><span class="co"># For other formats</span></span>
<span id="cb235-5"><a href="#cb235-5" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;filename.txt&quot;</span>)</span></code></pre></div>
</div>
<div id="answer-to-question-10.3-1" class="section level3" number="16.2.9">
<h3><span class="header-section-number">16.2.9</span> Answer to Question 10.3:</h3>
<p><strong>Explain the importance of scaling or standardizing variables before applying PCA.</strong>
Scaling is crucial because PCA is sensitive to the scale of variables. Variables with larger scales will dominate the analysis. Standardizing ensures all variables contribute equally to the principal components.</p>
<p><strong>Write the R command to standardize a data matrix.</strong></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" tabindex="-1"></a><span class="co"># Method 1: Using scale()</span></span>
<span id="cb236-2"><a href="#cb236-2" tabindex="-1"></a>scaled_data <span class="ot">&lt;-</span> <span class="fu">scale</span>(my_data)</span>
<span id="cb236-3"><a href="#cb236-3" tabindex="-1"></a></span>
<span id="cb236-4"><a href="#cb236-4" tabindex="-1"></a><span class="co"># Method 2: Manual standardization</span></span>
<span id="cb236-5"><a href="#cb236-5" tabindex="-1"></a>scaled_data <span class="ot">&lt;-</span> (my_data <span class="sc">-</span> <span class="fu">mean</span>(my_data)) <span class="sc">/</span> <span class="fu">sd</span>(my_data)</span></code></pre></div>
</div>
<div id="answer-to-question-10.4-1" class="section level3" number="16.2.10">
<h3><span class="header-section-number">16.2.10</span> Answer to Question 10.4:</h3>
<p><strong>What function in R is used to perform PCA?</strong>
<code>prcomp()</code>, <code>PCA()</code> (from FactoMineR), or <code>princomp()</code></p>
<p><strong>Provide the basic syntax for running PCA on a dataset named ‚Äúmy_data.‚Äù</strong></p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" tabindex="-1"></a><span class="co"># Using prcomp (base R)</span></span>
<span id="cb237-2"><a href="#cb237-2" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(my_data, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb237-3"><a href="#cb237-3" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" tabindex="-1"></a><span class="co"># Using FactoMineR</span></span>
<span id="cb237-5"><a href="#cb237-5" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">PCA</span>(my_data, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="answer-to-question-10.5-1" class="section level3" number="16.2.11">
<h3><span class="header-section-number">16.2.11</span> Answer to Question 10.5:</h3>
<p><strong>How can you access the proportion of variance explained by each principal component?</strong></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" tabindex="-1"></a><span class="co"># Using prcomp</span></span>
<span id="cb238-2"><a href="#cb238-2" tabindex="-1"></a><span class="fu">summary</span>(pca_result)<span class="sc">$</span>importance[<span class="dv">2</span>, ]  <span class="co"># Proportion of variance</span></span>
<span id="cb238-3"><a href="#cb238-3" tabindex="-1"></a></span>
<span id="cb238-4"><a href="#cb238-4" tabindex="-1"></a><span class="co"># Or calculate manually</span></span>
<span id="cb238-5"><a href="#cb238-5" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb238-6"><a href="#cb238-6" tabindex="-1"></a>proportion_variance <span class="ot">&lt;-</span> eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)</span></code></pre></div>
<p><strong>What is the significance of the eigenvalues and eigenvectors in PCA?</strong>
- <strong>Eigenvalues</strong>: Represent the amount of variance explained by each principal component. Larger eigenvalues indicate components that capture more variance.
- <strong>Eigenvectors</strong>: Represent the direction of each principal component. They show how the original variables contribute to each component (loadings).</p>
</div>
<div id="answer-to-question-10.6-1" class="section level3" number="16.2.12">
<h3><span class="header-section-number">16.2.12</span> Answer to Question 10.6:</h3>
<p><strong>How can you determine the optimal number of principal components to retain?</strong>
- Examine the scree plot (look for the ‚Äúelbow‚Äù)
- Use Kaiser‚Äôs criterion (keep components with eigenvalues &gt; 1)
- Retain components that explain a cumulative variance above a threshold (e.g., 80-90%)
- Use parallel analysis</p>
<p><strong>Write the R command to extract the loadings of principal components.</strong></p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" tabindex="-1"></a><span class="co"># Using prcomp</span></span>
<span id="cb239-2"><a href="#cb239-2" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>rotation</span>
<span id="cb239-3"><a href="#cb239-3" tabindex="-1"></a></span>
<span id="cb239-4"><a href="#cb239-4" tabindex="-1"></a><span class="co"># Or</span></span>
<span id="cb239-5"><a href="#cb239-5" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span>k]  <span class="co"># For first k components</span></span></code></pre></div>
</div>
<div id="answer-to-question-10.7" class="section level3" number="16.2.13">
<h3><span class="header-section-number">16.2.13</span> Answer to Question 10.7:</h3>
<ul>
<li>p</li>
<li><strong>The sum of variances of the p variables</strong></li>
<li>None of the responses are true</li>
</ul>
</div>
<div id="answer-to-question-10.8" class="section level3" number="16.2.14">
<h3><span class="header-section-number">16.2.14</span> Answer to Question 10.8:</h3>
<ul>
<li><strong>TRUE</strong></li>
<li>FALSE</li>
</ul>
</div>
<div id="answer-to-question-10.9" class="section level3" number="16.2.15">
<h3><span class="header-section-number">16.2.15</span> Answer to Question 10.9:</h3>
<ul>
<li><strong>1</strong></li>
<li>2</li>
<li>3</li>
</ul>
</div>
<div id="answer-to-question-10.10" class="section level3" number="16.2.16">
<h3><span class="header-section-number">16.2.16</span> Answer to Question 10.10:</h3>
<p>Maximum number of eigenvalues: <strong>4</strong> (equal to the number of variables/columns)</p>
<p>Remaining eigenvalue: <strong>0.6</strong> (since eigenvalues sum to p = 4: 2 + 1 + 0.4 + x = 4, so x = 0.6)</p>
</div>
<div id="answer-to-question-10.24" class="section level3" number="16.2.17">
<h3><span class="header-section-number">16.2.17</span> Answer to Question 10.24:</h3>
<ul>
<li>Primary Component Analysis</li>
<li>Principal Component Algorithm</li>
<li><strong>Principal Component Analysis</strong></li>
<li>Primary Component Algorithm</li>
</ul>
</div>
<div id="answer-to-question-10.25" class="section level3" number="16.2.18">
<h3><span class="header-section-number">16.2.18</span> Answer to Question 10.25:</h3>
<ul>
<li><strong>Reduce dimensionality while preserving variance</strong></li>
<li>Increase dimensionality for better visualization</li>
<li>Minimize all components equally</li>
<li>Focus on individual components only</li>
</ul>
</div>
<div id="answer-to-question-10.26" class="section level3" number="16.2.19">
<h3><span class="header-section-number">16.2.19</span> Answer to Question 10.26:</h3>
<ul>
<li>kmeans()</li>
<li>PCA()</li>
<li><strong>prcomp()</strong></li>
<li>corresp()</li>
</ul>
</div>
<div id="answer-to-question-10.27" class="section level3" number="16.2.20">
<h3><span class="header-section-number">16.2.20</span> Answer to Question 10.27:</h3>
<ul>
<li>Visualize the clusters in data</li>
<li>Assess the quality of clustering</li>
<li>Evaluate the distribution of data</li>
<li><strong>Display the eigenvalues of principal components</strong></li>
</ul>
</div>
<div id="answer-to-question-10.28" class="section level3" number="16.2.21">
<h3><span class="header-section-number">16.2.21</span> Answer to Question 10.28:</h3>
<ul>
<li>Use hierarchical clustering</li>
<li><strong>Examine the scree plot</strong></li>
<li>Apply k-means clustering</li>
<li>Perform a chi-square test</li>
</ul>
</div>
<div id="answer-to-question-10.29" class="section level3" number="16.2.22">
<h3><span class="header-section-number">16.2.22</span> Answer to Question 10.29:</h3>
<ul>
<li>Reducing dimensionality of numerical data</li>
<li><strong>Analyzing relationships in categorical data</strong></li>
<li>Classifying data points into clusters</li>
<li>Predicting future values in a time series</li>
</ul>
</div>
<div id="answer-to-question-10.30" class="section level3" number="16.2.23">
<h3><span class="header-section-number">16.2.23</span> Answer to Question 10.30:</h3>
<ul>
<li>cluster</li>
<li>caret</li>
<li><strong>ca</strong></li>
<li>factoextra</li>
<li><strong>FactomineR</strong></li>
</ul>
</div>
<div id="answer-to-question-10.31" class="section level3" number="16.2.24">
<h3><span class="header-section-number">16.2.24</span> Answer to Question 10.31:</h3>
<ul>
<li><strong>Assess the significance of relationships</strong></li>
<li>Determine the optimal number of clusters</li>
<li>Evaluate the distribution of data</li>
<li>Visualize the proximity between data points</li>
</ul>
</div>
<div id="answer-to-question-10.32" class="section level3" number="16.2.25">
<h3><span class="header-section-number">16.2.25</span> Answer to Question 10.32:</h3>
<ul>
<li>Dimensionality reduction</li>
<li>Classification</li>
<li><strong>Grouping similar data points</strong></li>
<li>Visualization of data</li>
</ul>
</div>
<div id="answer-to-question-10.33" class="section level3" number="16.2.26">
<h3><span class="header-section-number">16.2.26</span> Answer to Question 10.33:</h3>
<ul>
<li>hierarch()</li>
<li>PCA()</li>
<li><strong>kmeans()</strong></li>
<li>prcomp()</li>
</ul>
</div>
<div id="answer-to-question-10.34" class="section level3" number="16.2.27">
<h3><span class="header-section-number">16.2.27</span> Answer to Question 10.34:</h3>
<ul>
<li>Scree plot</li>
<li><strong>Dendrogram</strong></li>
<li>Silhouette plot</li>
<li>Biplot</li>
</ul>
</div>
<div id="answer-to-question-10.35" class="section level3" number="16.2.28">
<h3><span class="header-section-number">16.2.28</span> Answer to Question 10.35:</h3>
<ul>
<li>Group similar data points</li>
<li>Predict numerical values</li>
<li><strong>Assign labels to data points</strong></li>
<li>Visualize high-dimensional data</li>
</ul>
</div>
<div id="answer-to-question-10.36" class="section level3" number="16.2.29">
<h3><span class="header-section-number">16.2.29</span> Answer to Question 10.36:</h3>
<ul>
<li><strong>Decision Trees</strong></li>
<li>K-means</li>
<li><strong>LDA</strong></li>
<li><strong>Logistic Regression</strong></li>
</ul>
</div>
<div id="answer-to-question-10.37" class="section level3" number="16.2.30">
<h3><span class="header-section-number">16.2.30</span> Answer to Question 10.37:</h3>
<ul>
<li>R-squared</li>
<li>Mean Absolute Error</li>
<li>Silhouette Score</li>
<li><strong>Accuracy</strong></li>
</ul>
</div>
<div id="answer-to-question-10.38" class="section level3" number="16.2.31">
<h3><span class="header-section-number">16.2.31</span> Answer to Question 10.38:</h3>
<ul>
<li><strong>The principal component explains a large amount of variance</strong></li>
<li>The principal component is not important</li>
<li>The data has high correlation</li>
<li>None of the above</li>
</ul>
</div>
<div id="answer-to-question-10.39" class="section level3" number="16.2.32">
<h3><span class="header-section-number">16.2.32</span> Answer to Question 10.39:</h3>
<ul>
<li><strong>The correlation between variables and principal components</strong></li>
<li>The eigenvalues of the components</li>
<li>The proportion of variance explained</li>
<li>The number of observations</li>
</ul>
</div>
<div id="answer-to-question-10.40" class="section level3" number="16.2.33">
<h3><span class="header-section-number">16.2.33</span> Answer to Question 10.40:</h3>
<ul>
<li><strong>To ensure reproducibility of results</strong></li>
<li>To increase the number of clusters</li>
<li>To improve the accuracy</li>
<li>To reduce computation time</li>
</ul>
</div>
<div id="answer-to-question-10.41" class="section level3" number="16.2.34">
<h3><span class="header-section-number">16.2.34</span> Answer to Question 10.41:</h3>
<ul>
<li>Complete linkage</li>
<li>Single linkage</li>
<li>Average linkage</li>
<li><strong>All of the above</strong></li>
</ul>
</div>
<div id="answer-to-question-10.42" class="section level3" number="16.2.35">
<h3><span class="header-section-number">16.2.35</span> Answer to Question 10.42:</h3>
<ul>
<li>Using the elbow method</li>
<li>Using silhouette analysis</li>
<li>Using within-cluster sum of squares</li>
<li><strong>All of the above</strong></li>
</ul>
</div>
<div id="answer-to-question-10.43" class="section level3" number="16.2.36">
<h3><span class="header-section-number">16.2.36</span> Answer to Question 10.43:</h3>
<ul>
<li>Continuous numerical data</li>
<li><strong>Categorical data in contingency tables</strong></li>
<li>Time series data</li>
<li>Binary data only</li>
</ul>
</div>
<div id="answer-to-question-10.44" class="section level3" number="16.2.37">
<h3><span class="header-section-number">16.2.37</span> Answer to Question 10.44:</h3>
<ul>
<li><strong>Variables with larger scales will dominate</strong></li>
<li>The results will be incorrect</li>
<li>PCA cannot be performed</li>
<li>Nothing, scaling is optional</li>
</ul>
</div>
<div id="answer-to-question-10.45" class="section level3" number="16.2.38">
<h3><span class="header-section-number">16.2.38</span> Answer to Question 10.45:</h3>
<ul>
<li>Euclidean distance</li>
<li>Manhattan distance</li>
<li>Correlation distance</li>
<li><strong>All of the above</strong></li>
</ul>
</div>
<div id="answer-to-question-10.46" class="section level3" number="16.2.39">
<h3><span class="header-section-number">16.2.39</span> Answer to Question 10.46:</h3>
<ul>
<li><strong>Classification requires labeled data, clustering does not</strong></li>
<li>Clustering requires labeled data, classification does not</li>
<li>They are the same thing</li>
<li>Classification is supervised, clustering is unsupervised</li>
</ul>
</div>
<div id="answer-to-question-10.47" class="section level3" number="16.2.40">
<h3><span class="header-section-number">16.2.40</span> Answer to Question 10.47:</h3>
<ul>
<li><strong>To visualize both variables and observations</strong></li>
<li>To show only eigenvalues</li>
<li>To display correlation matrices</li>
<li>To plot residuals</li>
</ul>
</div>
<div id="answer-to-question-10.48" class="section level3" number="16.2.41">
<h3><span class="header-section-number">16.2.41</span> Answer to Question 10.48:</h3>
<ul>
<li><strong>Strong association between categories</strong></li>
<li>Weak association</li>
<li>No relationship</li>
<li>Random distribution</li>
</ul>
</div>
<div id="answer-to-question-10.49" class="section level3" number="16.2.42">
<h3><span class="header-section-number">16.2.42</span> Answer to Question 10.49:</h3>
<ul>
<li>Requires pre-specification of number of clusters</li>
<li>Cannot handle categorical variables</li>
<li>Sensitive to outliers</li>
<li><strong>All of the above</strong></li>
</ul>
</div>
<div id="answer-to-question-10.50" class="section level3" number="16.2.43">
<h3><span class="header-section-number">16.2.43</span> Answer to Question 10.50:</h3>
<ul>
<li><strong>A tree-like diagram showing cluster relationships</strong></li>
<li>A scatter plot of data points</li>
<li>A correlation matrix</li>
<li>A scree plot</li>
</ul>
<!--chapter:end:06oct_2nd_intermed_sample.Rmd-->
</div>
</div>
</div>
<div id="exam-sim-intermediate" class="section level1" number="17">
<h1><span class="header-section-number">17</span> üìù Intermediate Exam Simulation - Healthcare Management</h1>
<p>This is a comprehensive simulation of the intermediate exam covering all major statistical topics applied to healthcare management scenarios. Complete all 20 questions to test your knowledge and prepare for the actual exam.</p>
<p><strong>Instructions</strong>: Answer all questions carefully. Solutions are provided at the end of this chapter.</p>
<hr />
<div id="question-1-data-wrangling---reshaping-data" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> üè• Question 1: Data Wrangling - Reshaping Data</h2>
<div class="exercise">
<p><span id="exr:exam1" class="exercise"><strong>(#exr:exam1) </strong></span>You have a <code>patient_data</code> dataframe with columns: <code>patient_id</code>, <code>emergency_visits</code>, and <code>outpatient_visits</code>. Reshape the data into a ‚Äúlong‚Äù format with three columns: <code>patient_id</code>, <code>visit_type</code> (containing ‚Äúemergency_visits‚Äù or ‚Äúoutpatient_visits‚Äù), and <code>visit_count</code>. Write the R command using the tidyr package.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb240-2"><a href="#cb240-2" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb240-3"><a href="#cb240-3" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb240-4"><a href="#cb240-4" tabindex="-1"></a>  <span class="at">emergency_visits =</span> <span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">2</span>),</span>
<span id="cb240-5"><a href="#cb240-5" tabindex="-1"></a>  <span class="at">outpatient_visits =</span> <span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">5</span>)</span>
<span id="cb240-6"><a href="#cb240-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-2-data-wrangling---complex-filtering" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> üè• Question 2: Data Wrangling - Complex Filtering</h2>
<div class="exercise">
<p><span id="exr:exam2" class="exercise"><strong>(#exr:exam2) </strong></span>From a <code>patient_satisfaction</code> dataset with columns <code>patient_id</code>, <code>department</code> (e.g., ‚ÄúCardiology‚Äù, ‚ÄúOrthopedics‚Äù, ‚ÄúEmergency‚Äù), <code>satisfaction_score</code>, and <code>treatment_cost</code>, write a dplyr pipeline to create a summary table showing the number of patients, mean satisfaction score, and total treatment cost for each department. Show only departments with more than 50 patients AND mean satisfaction above 4.0.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb241-2"><a href="#cb241-2" tabindex="-1"></a>patient_satisfaction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb241-3"><a href="#cb241-3" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,</span>
<span id="cb241-4"><a href="#cb241-4" tabindex="-1"></a>  <span class="at">department =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Cardiology&quot;</span>, <span class="st">&quot;Orthopedics&quot;</span>, <span class="st">&quot;Emergency&quot;</span>, <span class="st">&quot;Pediatrics&quot;</span>, <span class="st">&quot;Surgery&quot;</span>), <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb241-5"><a href="#cb241-5" tabindex="-1"></a>  <span class="at">satisfaction_score =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb241-6"><a href="#cb241-6" tabindex="-1"></a>  <span class="at">treatment_cost =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb241-7"><a href="#cb241-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-3-data-wrangling---advanced-calculations" class="section level2" number="17.3">
<h2><span class="header-section-number">17.3</span> üè• Question 3: Data Wrangling - Advanced Calculations</h2>
<div class="exercise">
<p><span id="exr:exam3" class="exercise"><strong>(#exr:exam3) </strong></span>A hospital needs to calculate physician bonuses based on performance. Given a <code>physician_data</code> dataframe with columns <code>physician_id</code>, <code>patient_satisfaction_score</code>, <code>years_experience</code>, and <code>specialty</code>, create a new column <code>bonus_amount</code> that calculates 2% of satisfaction score per year of experience, with a maximum bonus of 8000 and a minimum bonus of 1000 for physicians with less than 3 years experience. Additionally, add a 15% specialty bonus for physicians in ‚ÄúEmergency Medicine‚Äù due to higher risk. Write the complete dplyr pipeline.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb242-2"><a href="#cb242-2" tabindex="-1"></a>physician_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb242-3"><a href="#cb242-3" tabindex="-1"></a>  <span class="at">physician_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb242-4"><a href="#cb242-4" tabindex="-1"></a>  <span class="at">patient_satisfaction_score =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">85</span>, <span class="dv">10</span>),</span>
<span id="cb242-5"><a href="#cb242-5" tabindex="-1"></a>  <span class="at">years_experience =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb242-6"><a href="#cb242-6" tabindex="-1"></a>  <span class="at">specialty =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Emergency Medicine&quot;</span>, <span class="st">&quot;Cardiology&quot;</span>, <span class="st">&quot;Orthopedics&quot;</span>, <span class="st">&quot;Pediatrics&quot;</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb242-7"><a href="#cb242-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-4-data-wrangling---complex-reshaping" class="section level2" number="17.4">
<h2><span class="header-section-number">17.4</span> üè• Question 4: Data Wrangling - Complex Reshaping</h2>
<div class="exercise">
<p><span id="exr:exam4" class="exercise"><strong>(#exr:exam4) </strong></span>From a <code>patient_monitoring</code> dataset with columns <code>patient_id</code>, <code>measurement_date</code>, <code>pain_level</code>, <code>mobility_score</code>, and <code>measurement_time</code> (with values ‚Äúmorning‚Äù or ‚Äúevening‚Äù), filter to include only patients who have taken both types of measurements, and calculate the difference in their pain levels between these two measurement times. Also calculate the correlation between morning and evening pain levels. Write the complete dplyr pipeline.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb243-2"><a href="#cb243-2" tabindex="-1"></a>patient_monitoring <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb243-3"><a href="#cb243-3" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb243-4"><a href="#cb243-4" tabindex="-1"></a>  <span class="at">measurement_date =</span> <span class="fu">rep</span>(<span class="fu">seq.Date</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2024-01-01&quot;</span>), <span class="at">by =</span> <span class="st">&quot;day&quot;</span>, <span class="at">length.out =</span> <span class="dv">50</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb243-5"><a href="#cb243-5" tabindex="-1"></a>  <span class="at">measurement_time =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;morning&quot;</span>, <span class="st">&quot;evening&quot;</span>), <span class="dv">50</span>),</span>
<span id="cb243-6"><a href="#cb243-6" tabindex="-1"></a>  <span class="at">pain_level =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="fl">1.5</span>),</span>
<span id="cb243-7"><a href="#cb243-7" tabindex="-1"></a>  <span class="at">mobility_score =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">7</span>, <span class="fl">1.2</span>)</span>
<span id="cb243-8"><a href="#cb243-8" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-5-data-wrangling---advanced-grouping" class="section level2" number="17.5">
<h2><span class="header-section-number">17.5</span> üè• Question 5: Data Wrangling - Advanced Grouping</h2>
<div class="exercise">
<p><span id="exr:exam5" class="exercise"><strong>(#exr:exam5) </strong></span>You have hospital performance data in long format. The <code>hospital_performance</code> dataframe contains <code>hospital_id</code>, <code>quarter</code> (with values ‚ÄúQ1‚Äù, ‚ÄúQ2‚Äù, ‚ÄúQ3‚Äù, ‚ÄúQ4‚Äù), <code>patient_volume</code>, and <code>region</code>. Reshape this data into wide format so that each hospital has one row with separate columns for each quarter (<code>volume_Q1</code>, <code>volume_Q2</code>, <code>volume_Q3</code>, <code>volume_Q4</code>). Then calculate the quarterly growth rate for each hospital (Q4 vs Q1). Write the complete pipeline.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">654</span>)</span>
<span id="cb244-2"><a href="#cb244-2" tabindex="-1"></a>hospital_performance <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb244-3"><a href="#cb244-3" tabindex="-1"></a>  <span class="at">hospital_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb244-4"><a href="#cb244-4" tabindex="-1"></a>  <span class="at">quarter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Q1&quot;</span>, <span class="st">&quot;Q2&quot;</span>, <span class="st">&quot;Q3&quot;</span>, <span class="st">&quot;Q4&quot;</span>), <span class="dv">30</span>),</span>
<span id="cb244-5"><a href="#cb244-5" tabindex="-1"></a>  <span class="at">patient_volume =</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="dv">1000</span>, <span class="dv">200</span>),</span>
<span id="cb244-6"><a href="#cb244-6" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">rep</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;North&quot;</span>, <span class="st">&quot;South&quot;</span>, <span class="st">&quot;East&quot;</span>, <span class="st">&quot;West&quot;</span>), <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb244-7"><a href="#cb244-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-6-hypothesis-testing---single-population" class="section level2" number="17.6">
<h2><span class="header-section-number">17.6</span> üî¨ Question 6: Hypothesis Testing - Single Population</h2>
<div class="exercise">
<p><span id="exr:exam6" class="exercise"><strong>(#exr:exam6) </strong></span>A hospital claims that their new patient management system reduces average waiting time by 15 minutes. In a pilot study with 45 patients, the mean reduction was 18 minutes with a standard deviation of 6 minutes. Test at Œ± = 0.05 if the actual reduction is significantly greater than the claimed 15 minutes. Write the R command and interpret the results.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb245-2"><a href="#cb245-2" tabindex="-1"></a>waiting_time_reduction <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">45</span>, <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-7-hypothesis-testing---proportions" class="section level2" number="17.7">
<h2><span class="header-section-number">17.7</span> üî¨ Question 7: Hypothesis Testing - Proportions</h2>
<div class="exercise">
<p><span id="exr:exam7" class="exercise"><strong>(#exr:exam7) </strong></span>A hospital claims that 35% of patients are satisfied with their emergency department experience. In a sample of 400 patients, only 120 reported satisfaction. Write the R command to test if the true satisfaction rate is significantly lower than 35%. Calculate the 95% confidence interval for the true proportion and interpret both results.</p>
</div>
<hr />
</div>
<div id="question-8-hypothesis-testing---two-populations" class="section level2" number="17.8">
<h2><span class="header-section-number">17.8</span> üî¨ Question 8: Hypothesis Testing - Two Populations</h2>
<div class="exercise">
<p><span id="exr:exam8" class="exercise"><strong>(#exr:exam8) </strong></span>A hospital is testing a new training program for nurses. The same 25 nurses took a patient safety competency test before and after the training. Test if the training program significantly improved the test scores. Write the appropriate R command and state whether this should be a paired or unpaired test.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb246-2"><a href="#cb246-2" tabindex="-1"></a>nurse_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb246-3"><a href="#cb246-3" tabindex="-1"></a>  <span class="at">nurse_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb246-4"><a href="#cb246-4" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">72</span>, <span class="dv">5</span>),</span>
<span id="cb246-5"><a href="#cb246-5" tabindex="-1"></a>  <span class="at">after =</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">78</span>, <span class="dv">5</span>)</span>
<span id="cb246-6"><a href="#cb246-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-9-hypothesis-testing---two-proportions" class="section level2" number="17.9">
<h2><span class="header-section-number">17.9</span> üî¨ Question 9: Hypothesis Testing - Two Proportions</h2>
<div class="exercise">
<p><span id="exr:exam9" class="exercise"><strong>(#exr:exam9) </strong></span>Two hospitals are comparing their patient satisfaction rates. Hospital A reports that 180 out of 250 patients (72%) were satisfied, while Hospital B reports that 210 out of 280 patients (75%) were satisfied. Write the R command to test if there is a significant difference in satisfaction rates between the two hospitals. Calculate the effect size and interpret the results.</p>
</div>
<hr />
</div>
<div id="question-10-hypothesis-testing---advanced-concepts" class="section level2" number="17.10">
<h2><span class="header-section-number">17.10</span> üî¨ Question 10: Hypothesis Testing - Advanced Concepts</h2>
<div class="exercise">
<p><span id="exr:exam10" class="exercise"><strong>(#exr:exam10) </strong></span>A study compares the patient satisfaction scores between two different hospital wards. Before running a t-test, you perform a Levene‚Äôs test for equality of variances and get a p-value of 0.02. Which type of two-sample t-test should you use and why? Write the R command for the appropriate t-test, assuming you have a <code>patient_satisfaction</code> dataframe with <code>score</code> and <code>ward</code> columns.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb247-2"><a href="#cb247-2" tabindex="-1"></a>patient_satisfaction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb247-3"><a href="#cb247-3" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="fl">4.2</span>, <span class="fl">0.8</span>), <span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="fl">4.0</span>, <span class="fl">1.2</span>)),</span>
<span id="cb247-4"><a href="#cb247-4" tabindex="-1"></a>  <span class="at">ward =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Ward_A&quot;</span>, <span class="st">&quot;Ward_B&quot;</span>), <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">35</span>))</span>
<span id="cb247-5"><a href="#cb247-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-11-anova---basic-analysis" class="section level2" number="17.11">
<h2><span class="header-section-number">17.11</span> üìä Question 11: ANOVA - Basic Analysis</h2>
<div class="exercise">
<p><span id="exr:exam11" class="exercise"><strong>(#exr:exam11) </strong></span>A clinical trial tests three different pain management protocols (Protocol A, Protocol B, Protocol C) on different patients. The pain reduction scores are stored in a variable called <code>pain_reduction</code> and the treatment group is stored in <code>protocol</code> in a dataframe called <code>pain_study</code>. Write the R command to perform ANOVA and display the results. Also test the assumptions.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb248-2"><a href="#cb248-2" tabindex="-1"></a>pain_study <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb248-3"><a href="#cb248-3" tabindex="-1"></a>  <span class="at">pain_reduction =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="fl">6.5</span>, <span class="fl">1.2</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="fl">7.2</span>, <span class="fl">1.5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="fl">5.8</span>, <span class="fl">1.0</span>)),</span>
<span id="cb248-4"><a href="#cb248-4" tabindex="-1"></a>  <span class="at">protocol =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Protocol_A&quot;</span>, <span class="st">&quot;Protocol_B&quot;</span>, <span class="st">&quot;Protocol_C&quot;</span>), <span class="at">each =</span> <span class="dv">20</span>)</span>
<span id="cb248-5"><a href="#cb248-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-12-anova---post-hoc-analysis" class="section level2" number="17.12">
<h2><span class="header-section-number">17.12</span> üìä Question 12: ANOVA - Post-hoc Analysis</h2>
<div class="exercise">
<p><span id="exr:exam12" class="exercise"><strong>(#exr:exam12) </strong></span>After performing ANOVA and finding a significant result (p = 0.003), you want to perform post-hoc pairwise comparisons to identify which specific protocols differ. Your ANOVA model is stored in the variable <code>anova_model</code>. Write the R command to perform Tukey‚Äôs Honest Significant Difference (HSD) test and interpret the results.</p>
<p><strong>Sample ANOVA output:</strong></p>
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
protocol     2  245.6   122.8   5.234 0.003 **
Residuals   57 1337.2    23.5                 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<hr />
</div>
<div id="question-13-anova---assumptions-testing" class="section level2" number="17.13">
<h2><span class="header-section-number">17.13</span> üìä Question 13: ANOVA - Assumptions Testing</h2>
<div class="exercise">
<p><span id="exr:exam13" class="exercise"><strong>(#exr:exam13) </strong></span>Before conducting ANOVA, you want to test the homogeneity of variances assumption using Levene‚Äôs test. Your data is in a dataframe called <code>patient_data</code> with a continuous variable <code>recovery_time</code> and a grouping variable <code>hospital</code>. Write the R command using the car package. Also test for normality of residuals and interpret both results.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">654</span>)</span>
<span id="cb250-2"><a href="#cb250-2" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb250-3"><a href="#cb250-3" tabindex="-1"></a>  <span class="at">recovery_time =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">10</span>, <span class="dv">2</span>), <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">12</span>, <span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">8</span>, <span class="fl">1.5</span>)),</span>
<span id="cb250-4"><a href="#cb250-4" tabindex="-1"></a>  <span class="at">hospital =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Hospital_A&quot;</span>, <span class="st">&quot;Hospital_B&quot;</span>, <span class="st">&quot;Hospital_C&quot;</span>), <span class="at">each =</span> <span class="dv">25</span>)</span>
<span id="cb250-5"><a href="#cb250-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-14-linear-regression---multiple-regression" class="section level2" number="17.14">
<h2><span class="header-section-number">17.14</span> üìà Question 14: Linear Regression - Multiple Regression</h2>
<div class="exercise">
<p><span id="exr:exam14" class="exercise"><strong>(#exr:exam14) </strong></span>You have a <code>patient_data</code> dataframe with variables <code>length_of_stay</code> (dependent variable), <code>age</code>, <code>BMI</code>, and <code>comorbidity_count</code> (independent variables). Write the R command to fit a multiple linear regression model, check for multicollinearity using VIF, and display the summary. Interpret the results.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">987</span>)</span>
<span id="cb251-2"><a href="#cb251-2" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb251-3"><a href="#cb251-3" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">65</span>, <span class="dv">15</span>),</span>
<span id="cb251-4"><a href="#cb251-4" tabindex="-1"></a>  <span class="at">BMI =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">28</span>, <span class="dv">5</span>),</span>
<span id="cb251-5"><a href="#cb251-5" tabindex="-1"></a>  <span class="at">comorbidity_count =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb251-6"><a href="#cb251-6" tabindex="-1"></a>  <span class="at">length_of_stay =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> BMI <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> comorbidity_count <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb251-7"><a href="#cb251-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-15-linear-regression---model-prediction-and-classification" class="section level2" number="17.15">
<h2><span class="header-section-number">17.15</span> üìà Question 15: Linear Regression - Model Prediction and Classification</h2>
<div class="exercise">
<p><span id="exr:exam15" class="exercise"><strong>(#exr:exam15) </strong></span>A hospital has developed a regression model to predict length of stay (LOS) based on patient age, BMI, and number of comorbidities. The model output is:</p>
<pre><code>Coefficients:
              Estimate  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)   3.250     0.450       7.22     &lt; 0.001 ***
age           0.045     0.012       3.75     0.0003 ***
BMI           0.120     0.025       4.80     &lt; 0.001 ***
comorbidities 1.450     0.180       8.06     &lt; 0.001 ***</code></pre>
<p>Using this model, predict the length of stay for a 65-year-old patient with BMI of 28 and 2 comorbidities. Then, classify this patient as ‚ÄúShort Stay‚Äù (&lt; 7 days) or ‚ÄúLong Stay‚Äù (‚â• 7 days). Show your calculations.</p>
</div>
<hr />
</div>
<div id="question-16-linear-regression---practical-prediction" class="section level2" number="17.16">
<h2><span class="header-section-number">17.16</span> üìà Question 16: Linear Regression - Practical Prediction</h2>
<div class="exercise">
<p><span id="exr:exam16" class="exercise"><strong>(#exr:exam16) </strong></span>A hospital has fitted a multiple regression model to predict patient readmission risk score (scale 0-100) based on the following variables:</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb253-2"><a href="#cb253-2" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb253-3"><a href="#cb253-3" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">62</span>, <span class="dv">71</span>, <span class="dv">55</span>, <span class="dv">68</span>, <span class="dv">58</span>, <span class="dv">75</span>, <span class="dv">63</span>, <span class="dv">52</span>, <span class="dv">70</span>),</span>
<span id="cb253-4"><a href="#cb253-4" tabindex="-1"></a>  <span class="at">length_of_stay =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">9</span>),</span>
<span id="cb253-5"><a href="#cb253-5" tabindex="-1"></a>  <span class="at">comorbidities =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb253-6"><a href="#cb253-6" tabindex="-1"></a>  <span class="at">readmission_risk =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">55</span>, <span class="dv">72</span>, <span class="dv">35</span>, <span class="dv">60</span>, <span class="dv">40</span>, <span class="dv">78</span>, <span class="dv">50</span>, <span class="dv">28</span>, <span class="dv">68</span>)</span>
<span id="cb253-7"><a href="#cb253-7" tabindex="-1"></a>)</span>
<span id="cb253-8"><a href="#cb253-8" tabindex="-1"></a></span>
<span id="cb253-9"><a href="#cb253-9" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb253-10"><a href="#cb253-10" tabindex="-1"></a>risk_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(readmission_risk <span class="sc">~</span> age <span class="sc">+</span> length_of_stay <span class="sc">+</span> comorbidities, </span>
<span id="cb253-11"><a href="#cb253-11" tabindex="-1"></a>                 <span class="at">data =</span> patient_data)</span></code></pre></div>
<p><strong>Task:</strong>
1. Fit the model and display the summary
2. Predict the readmission risk for a new 60-year-old patient with 6-day length of stay and 2 comorbidities
3. Based on the prediction, classify the patient as ‚ÄúLow Risk‚Äù (&lt; 40), ‚ÄúMedium Risk‚Äù (40-60), or ‚ÄúHigh Risk‚Äù (&gt; 60)
4. Write the complete R code</p>
</div>
<hr />
</div>
<div id="question-17-logistic-regression---model-fitting" class="section level2" number="17.17">
<h2><span class="header-section-number">17.17</span> üéØ Question 17: Logistic Regression - Model Fitting</h2>
<div class="exercise">
<p><span id="exr:exam17" class="exercise"><strong>(#exr:exam17) </strong></span>You want to predict the probability of hospital readmission (binary variable: 1=readmitted, 0=not readmitted) based on age, diabetes status, and length of stay. The data is in <code>patient_data</code>. Write the R command to fit a logistic regression model, calculate odds ratios, and interpret the results.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb254-2"><a href="#cb254-2" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb254-3"><a href="#cb254-3" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">65</span>, <span class="dv">15</span>),</span>
<span id="cb254-4"><a href="#cb254-4" tabindex="-1"></a>  <span class="at">diabetes_status =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb254-5"><a href="#cb254-5" tabindex="-1"></a>  <span class="at">length_of_stay =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">7</span>, <span class="dv">3</span>),</span>
<span id="cb254-6"><a href="#cb254-6" tabindex="-1"></a>  <span class="at">readmission =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>))</span>
<span id="cb254-7"><a href="#cb254-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-18-logistic-regression---prediction-and-interpretation" class="section level2" number="17.18">
<h2><span class="header-section-number">17.18</span> üéØ Question 18: Logistic Regression - Prediction and Interpretation</h2>
<div class="exercise">
<p><span id="exr:exam18" class="exercise"><strong>(#exr:exam18) </strong></span>Using the logistic regression model from Question 17, predict the probability of readmission for a 75-year-old patient with diabetes and a 10-day length of stay. Also calculate the odds ratio for diabetes status and interpret what it means in practical terms.</p>
<p><strong>Sample model:</strong></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" tabindex="-1"></a><span class="co"># Using the model from Question 17</span></span>
<span id="cb255-2"><a href="#cb255-2" tabindex="-1"></a>new_patient <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">75</span>, <span class="at">diabetes_status =</span> <span class="dv">1</span>, <span class="at">length_of_stay =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-19-dummy-variables---categorical-regression" class="section level2" number="17.19">
<h2><span class="header-section-number">17.19</span> üè∑Ô∏è Question 19: Dummy Variables - Categorical Regression</h2>
<div class="exercise">
<p><span id="exr:exam19" class="exercise"><strong>(#exr:exam19) </strong></span>You have a <code>clinical_data</code> dataframe with <code>recovery_time</code> (continuous), <code>age</code> (continuous), and <code>treatment_type</code> (categorical: A, B, C). Write the R command to fit a linear regression model including <code>treatment_type</code> as a factor. Set treatment A as the reference category and interpret the coefficients.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb256-2"><a href="#cb256-2" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb256-3"><a href="#cb256-3" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="dv">65</span>, <span class="dv">10</span>),</span>
<span id="cb256-4"><a href="#cb256-4" tabindex="-1"></a>  <span class="at">treatment_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">each =</span> <span class="dv">30</span>),</span>
<span id="cb256-5"><a href="#cb256-5" tabindex="-1"></a>  <span class="at">recovery_time =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">15</span>, <span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">12</span>, <span class="fl">2.5</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">18</span>, <span class="dv">4</span>))</span>
<span id="cb256-6"><a href="#cb256-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="question-20-dummy-variables---interaction-effects" class="section level2" number="17.20">
<h2><span class="header-section-number">17.20</span> üè∑Ô∏è Question 20: Dummy Variables - Interaction Effects</h2>
<div class="exercise">
<p><span id="exr:exam20" class="exercise"><strong>(#exr:exam20) </strong></span>You want to test if the effect of age on <code>patient_satisfaction</code> differs between patients with and without chronic conditions. Write the R command to fit a regression model that includes an interaction term between age (continuous) and chronic_condition (binary dummy variable). Interpret the interaction coefficient if it is significant.</p>
<p><strong>Sample data:</strong></p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb257-2"><a href="#cb257-2" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb257-3"><a href="#cb257-3" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">150</span>, <span class="dv">55</span>, <span class="dv">12</span>),</span>
<span id="cb257-4"><a href="#cb257-4" tabindex="-1"></a>  <span class="at">chronic_condition =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb257-5"><a href="#cb257-5" tabindex="-1"></a>  <span class="at">patient_satisfaction =</span> <span class="dv">7</span> <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> chronic_condition <span class="sc">+</span> </span>
<span id="cb257-6"><a href="#cb257-6" tabindex="-1"></a>                         <span class="fl">0.01</span> <span class="sc">*</span> age <span class="sc">*</span> chronic_condition <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">150</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb257-7"><a href="#cb257-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
</div>
<div id="solutions-3" class="section level2" number="17.21">
<h2><span class="header-section-number">17.21</span> ‚úÖ SOLUTIONS</h2>
<div class="answer">
<p><strong>Answer to Question 1:</strong></p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb258-2"><a href="#cb258-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb258-3"><a href="#cb258-3" tabindex="-1"></a></span>
<span id="cb258-4"><a href="#cb258-4" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb258-5"><a href="#cb258-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb258-6"><a href="#cb258-6" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb258-7"><a href="#cb258-7" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb258-8"><a href="#cb258-8" tabindex="-1"></a>  <span class="at">emergency_visits =</span> <span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">2</span>),</span>
<span id="cb258-9"><a href="#cb258-9" tabindex="-1"></a>  <span class="at">outpatient_visits =</span> <span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">5</span>)</span>
<span id="cb258-10"><a href="#cb258-10" tabindex="-1"></a>)</span>
<span id="cb258-11"><a href="#cb258-11" tabindex="-1"></a></span>
<span id="cb258-12"><a href="#cb258-12" tabindex="-1"></a><span class="co"># Reshape to long format</span></span>
<span id="cb258-13"><a href="#cb258-13" tabindex="-1"></a>patient_data_long <span class="ot">&lt;-</span> patient_data <span class="sc">%&gt;%</span></span>
<span id="cb258-14"><a href="#cb258-14" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb258-15"><a href="#cb258-15" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(emergency_visits, outpatient_visits), </span>
<span id="cb258-16"><a href="#cb258-16" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;visit_type&quot;</span>, </span>
<span id="cb258-17"><a href="#cb258-17" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;visit_count&quot;</span></span>
<span id="cb258-18"><a href="#cb258-18" tabindex="-1"></a>  )</span>
<span id="cb258-19"><a href="#cb258-19" tabindex="-1"></a></span>
<span id="cb258-20"><a href="#cb258-20" tabindex="-1"></a><span class="fu">print</span>(patient_data_long)</span></code></pre></div>
<p><strong>Explanation</strong>: The <code>pivot_longer()</code> function transforms the wide format (separate columns for emergency_visits and outpatient_visits) into long format (single visit_count column with visit_type indicating the source).</p>
</div>
<div class="answer">
<p><strong>Answer to Question 2:</strong></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb259-2"><a href="#cb259-2" tabindex="-1"></a></span>
<span id="cb259-3"><a href="#cb259-3" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb259-4"><a href="#cb259-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb259-5"><a href="#cb259-5" tabindex="-1"></a>patient_satisfaction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb259-6"><a href="#cb259-6" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,</span>
<span id="cb259-7"><a href="#cb259-7" tabindex="-1"></a>  <span class="at">department =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Cardiology&quot;</span>, <span class="st">&quot;Orthopedics&quot;</span>, <span class="st">&quot;Emergency&quot;</span>, <span class="st">&quot;Pediatrics&quot;</span>, <span class="st">&quot;Surgery&quot;</span>), <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb259-8"><a href="#cb259-8" tabindex="-1"></a>  <span class="at">satisfaction_score =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb259-9"><a href="#cb259-9" tabindex="-1"></a>  <span class="at">treatment_cost =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb259-10"><a href="#cb259-10" tabindex="-1"></a>)</span>
<span id="cb259-11"><a href="#cb259-11" tabindex="-1"></a></span>
<span id="cb259-12"><a href="#cb259-12" tabindex="-1"></a><span class="co"># Solution</span></span>
<span id="cb259-13"><a href="#cb259-13" tabindex="-1"></a>result <span class="ot">&lt;-</span> patient_satisfaction <span class="sc">%&gt;%</span></span>
<span id="cb259-14"><a href="#cb259-14" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span></span>
<span id="cb259-15"><a href="#cb259-15" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb259-16"><a href="#cb259-16" tabindex="-1"></a>    <span class="at">n_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb259-17"><a href="#cb259-17" tabindex="-1"></a>    <span class="at">mean_satisfaction =</span> <span class="fu">mean</span>(satisfaction_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb259-18"><a href="#cb259-18" tabindex="-1"></a>    <span class="at">total_cost =</span> <span class="fu">sum</span>(treatment_cost, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb259-19"><a href="#cb259-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb259-20"><a href="#cb259-20" tabindex="-1"></a>  <span class="fu">filter</span>(n_patients <span class="sc">&gt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> mean_satisfaction <span class="sc">&gt;</span> <span class="fl">4.0</span>)</span>
<span id="cb259-21"><a href="#cb259-21" tabindex="-1"></a></span>
<span id="cb259-22"><a href="#cb259-22" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<p><strong>Explanation</strong>: The pipeline groups by department, calculates summary statistics, then filters for departments with more than 50 patients AND mean satisfaction above 4.0.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 3:</strong></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb260-2"><a href="#cb260-2" tabindex="-1"></a></span>
<span id="cb260-3"><a href="#cb260-3" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb260-4"><a href="#cb260-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb260-5"><a href="#cb260-5" tabindex="-1"></a>physician_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb260-6"><a href="#cb260-6" tabindex="-1"></a>  <span class="at">physician_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb260-7"><a href="#cb260-7" tabindex="-1"></a>  <span class="at">patient_satisfaction_score =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">85</span>, <span class="dv">10</span>),</span>
<span id="cb260-8"><a href="#cb260-8" tabindex="-1"></a>  <span class="at">years_experience =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb260-9"><a href="#cb260-9" tabindex="-1"></a>  <span class="at">specialty =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Emergency Medicine&quot;</span>, <span class="st">&quot;Cardiology&quot;</span>, <span class="st">&quot;Orthopedics&quot;</span>, <span class="st">&quot;Pediatrics&quot;</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb260-10"><a href="#cb260-10" tabindex="-1"></a>)</span>
<span id="cb260-11"><a href="#cb260-11" tabindex="-1"></a></span>
<span id="cb260-12"><a href="#cb260-12" tabindex="-1"></a><span class="co"># Solution</span></span>
<span id="cb260-13"><a href="#cb260-13" tabindex="-1"></a>physician_data <span class="ot">&lt;-</span> physician_data <span class="sc">%&gt;%</span></span>
<span id="cb260-14"><a href="#cb260-14" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-15"><a href="#cb260-15" tabindex="-1"></a>    <span class="co"># Base bonus calculation</span></span>
<span id="cb260-16"><a href="#cb260-16" tabindex="-1"></a>    <span class="at">bonus_amount =</span> <span class="fu">pmin</span>(patient_satisfaction_score <span class="sc">*</span> <span class="fl">0.02</span> <span class="sc">*</span> years_experience, <span class="dv">8000</span>),</span>
<span id="cb260-17"><a href="#cb260-17" tabindex="-1"></a>    <span class="co"># Minimum bonus for physicians with &lt; 3 years experience</span></span>
<span id="cb260-18"><a href="#cb260-18" tabindex="-1"></a>    <span class="at">bonus_amount =</span> <span class="fu">ifelse</span>(years_experience <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="fu">pmax</span>(bonus_amount, <span class="dv">1000</span>), bonus_amount),</span>
<span id="cb260-19"><a href="#cb260-19" tabindex="-1"></a>    <span class="co"># Specialty bonus for Emergency Medicine</span></span>
<span id="cb260-20"><a href="#cb260-20" tabindex="-1"></a>    <span class="at">bonus_amount =</span> <span class="fu">ifelse</span>(specialty <span class="sc">==</span> <span class="st">&quot;Emergency Medicine&quot;</span>, bonus_amount <span class="sc">*</span> <span class="fl">1.15</span>, bonus_amount)</span>
<span id="cb260-21"><a href="#cb260-21" tabindex="-1"></a>  )</span>
<span id="cb260-22"><a href="#cb260-22" tabindex="-1"></a></span>
<span id="cb260-23"><a href="#cb260-23" tabindex="-1"></a><span class="fu">head</span>(physician_data)</span></code></pre></div>
<p><strong>Explanation</strong>: The solution uses <code>pmin()</code> for maximum cap, <code>pmax()</code> for minimum bonus, and conditional logic for specialty bonuses. Emergency Medicine physicians get a 15% bonus on top of the calculated amount due to higher risk.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 4:</strong></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb261-2"><a href="#cb261-2" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb261-3"><a href="#cb261-3" tabindex="-1"></a></span>
<span id="cb261-4"><a href="#cb261-4" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb261-5"><a href="#cb261-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb261-6"><a href="#cb261-6" tabindex="-1"></a>patient_monitoring <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb261-7"><a href="#cb261-7" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb261-8"><a href="#cb261-8" tabindex="-1"></a>  <span class="at">measurement_date =</span> <span class="fu">rep</span>(<span class="fu">seq.Date</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2024-01-01&quot;</span>), <span class="at">by =</span> <span class="st">&quot;day&quot;</span>, <span class="at">length.out =</span> <span class="dv">50</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb261-9"><a href="#cb261-9" tabindex="-1"></a>  <span class="at">measurement_time =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;morning&quot;</span>, <span class="st">&quot;evening&quot;</span>), <span class="dv">50</span>),</span>
<span id="cb261-10"><a href="#cb261-10" tabindex="-1"></a>  <span class="at">pain_level =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="fl">1.5</span>),</span>
<span id="cb261-11"><a href="#cb261-11" tabindex="-1"></a>  <span class="at">mobility_score =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">7</span>, <span class="fl">1.2</span>)</span>
<span id="cb261-12"><a href="#cb261-12" tabindex="-1"></a>)</span>
<span id="cb261-13"><a href="#cb261-13" tabindex="-1"></a></span>
<span id="cb261-14"><a href="#cb261-14" tabindex="-1"></a><span class="co"># Solution</span></span>
<span id="cb261-15"><a href="#cb261-15" tabindex="-1"></a>pain_analysis <span class="ot">&lt;-</span> patient_monitoring <span class="sc">%&gt;%</span></span>
<span id="cb261-16"><a href="#cb261-16" tabindex="-1"></a>  <span class="fu">group_by</span>(patient_id) <span class="sc">%&gt;%</span></span>
<span id="cb261-17"><a href="#cb261-17" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(measurement_time) <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb261-18"><a href="#cb261-18" tabindex="-1"></a>  <span class="fu">select</span>(patient_id, measurement_time, pain_level) <span class="sc">%&gt;%</span></span>
<span id="cb261-19"><a href="#cb261-19" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb261-20"><a href="#cb261-20" tabindex="-1"></a>    <span class="at">names_from =</span> measurement_time,</span>
<span id="cb261-21"><a href="#cb261-21" tabindex="-1"></a>    <span class="at">values_from =</span> pain_level</span>
<span id="cb261-22"><a href="#cb261-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb261-23"><a href="#cb261-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pain_diff =</span> morning <span class="sc">-</span> evening)</span>
<span id="cb261-24"><a href="#cb261-24" tabindex="-1"></a></span>
<span id="cb261-25"><a href="#cb261-25" tabindex="-1"></a><span class="co"># Calculate correlation</span></span>
<span id="cb261-26"><a href="#cb261-26" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(pain_analysis<span class="sc">$</span>morning, pain_analysis<span class="sc">$</span>evening, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</span>
<span id="cb261-27"><a href="#cb261-27" tabindex="-1"></a></span>
<span id="cb261-28"><a href="#cb261-28" tabindex="-1"></a><span class="fu">print</span>(pain_analysis)</span>
<span id="cb261-29"><a href="#cb261-29" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Correlation between morning and evening pain levels:&quot;</span>, <span class="fu">round</span>(correlation, <span class="dv">3</span>)))</span></code></pre></div>
<p><strong>Explanation</strong>: The solution filters for patients with both measurement times, reshapes to wide format, calculates the difference, and computes the correlation between morning and evening pain levels.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 5:</strong></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb262-2"><a href="#cb262-2" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb262-3"><a href="#cb262-3" tabindex="-1"></a></span>
<span id="cb262-4"><a href="#cb262-4" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb262-5"><a href="#cb262-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">654</span>)</span>
<span id="cb262-6"><a href="#cb262-6" tabindex="-1"></a>performance_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb262-7"><a href="#cb262-7" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb262-8"><a href="#cb262-8" tabindex="-1"></a>  <span class="at">quarter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Q1&quot;</span>, <span class="st">&quot;Q2&quot;</span>, <span class="st">&quot;Q3&quot;</span>, <span class="st">&quot;Q4&quot;</span>), <span class="dv">30</span>),</span>
<span id="cb262-9"><a href="#cb262-9" tabindex="-1"></a>  <span class="at">sales_amount =</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="dv">10000</span>, <span class="dv">2000</span>),</span>
<span id="cb262-10"><a href="#cb262-10" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">rep</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;North&quot;</span>, <span class="st">&quot;South&quot;</span>, <span class="st">&quot;East&quot;</span>, <span class="st">&quot;West&quot;</span>), <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb262-11"><a href="#cb262-11" tabindex="-1"></a>)</span>
<span id="cb262-12"><a href="#cb262-12" tabindex="-1"></a></span>
<span id="cb262-13"><a href="#cb262-13" tabindex="-1"></a><span class="co"># Solution</span></span>
<span id="cb262-14"><a href="#cb262-14" tabindex="-1"></a>performance_wide <span class="ot">&lt;-</span> performance_data <span class="sc">%&gt;%</span></span>
<span id="cb262-15"><a href="#cb262-15" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb262-16"><a href="#cb262-16" tabindex="-1"></a>    <span class="at">names_from =</span> quarter,</span>
<span id="cb262-17"><a href="#cb262-17" tabindex="-1"></a>    <span class="at">values_from =</span> sales_amount,</span>
<span id="cb262-18"><a href="#cb262-18" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">&quot;sales_&quot;</span></span>
<span id="cb262-19"><a href="#cb262-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb262-20"><a href="#cb262-20" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb262-21"><a href="#cb262-21" tabindex="-1"></a>    <span class="at">quarterly_growth_rate =</span> (sales_Q4 <span class="sc">-</span> sales_Q1) <span class="sc">/</span> sales_Q1 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb262-22"><a href="#cb262-22" tabindex="-1"></a>  )</span>
<span id="cb262-23"><a href="#cb262-23" tabindex="-1"></a></span>
<span id="cb262-24"><a href="#cb262-24" tabindex="-1"></a><span class="fu">head</span>(performance_wide)</span></code></pre></div>
<p><strong>Explanation</strong>: The solution reshapes the data to wide format with separate columns for each quarter, then calculates the growth rate from Q1 to Q4 as a percentage.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 6:</strong></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb263-2"><a href="#cb263-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb263-3"><a href="#cb263-3" tabindex="-1"></a>waiting_time_reduction <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">45</span>, <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span>
<span id="cb263-4"><a href="#cb263-4" tabindex="-1"></a></span>
<span id="cb263-5"><a href="#cb263-5" tabindex="-1"></a><span class="co"># One-sample t-test (one-sided)</span></span>
<span id="cb263-6"><a href="#cb263-6" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(waiting_time_reduction, <span class="at">mu =</span> <span class="dv">15</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb263-7"><a href="#cb263-7" tabindex="-1"></a><span class="fu">print</span>(test_result)</span>
<span id="cb263-8"><a href="#cb263-8" tabindex="-1"></a></span>
<span id="cb263-9"><a href="#cb263-9" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb263-10"><a href="#cb263-10" tabindex="-1"></a><span class="cf">if</span>(test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb263-11"><a href="#cb263-11" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Reject H0: The new system produces significantly greater reduction than claimed (p =&quot;</span>, </span>
<span id="cb263-12"><a href="#cb263-12" tabindex="-1"></a>      <span class="fu">round</span>(test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb263-13"><a href="#cb263-13" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb263-14"><a href="#cb263-14" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Fail to reject H0: No significant evidence of greater reduction (p =&quot;</span>, </span>
<span id="cb263-15"><a href="#cb263-15" tabindex="-1"></a>      <span class="fu">round</span>(test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb263-16"><a href="#cb263-16" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: This is a one-sided test because we‚Äôre testing if the reduction is significantly greater than 15 minutes. The test compares the sample mean to the hypothesized population mean.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 7:</strong></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" tabindex="-1"></a><span class="co"># Proportion test</span></span>
<span id="cb264-2"><a href="#cb264-2" tabindex="-1"></a>prop_test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="dv">120</span>, <span class="dv">400</span>, <span class="at">p =</span> <span class="fl">0.35</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb264-3"><a href="#cb264-3" tabindex="-1"></a><span class="fu">print</span>(prop_test)</span>
<span id="cb264-4"><a href="#cb264-4" tabindex="-1"></a></span>
<span id="cb264-5"><a href="#cb264-5" tabindex="-1"></a><span class="co"># Confidence interval</span></span>
<span id="cb264-6"><a href="#cb264-6" tabindex="-1"></a>ci_test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="dv">120</span>, <span class="dv">400</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb264-7"><a href="#cb264-7" tabindex="-1"></a><span class="fu">print</span>(ci_test)</span>
<span id="cb264-8"><a href="#cb264-8" tabindex="-1"></a></span>
<span id="cb264-9"><a href="#cb264-9" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb264-10"><a href="#cb264-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample proportion:&quot;</span>, <span class="fu">round</span>(<span class="dv">120</span><span class="sc">/</span><span class="dv">400</span>, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb264-11"><a href="#cb264-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% CI for true proportion: [&quot;</span>, <span class="fu">round</span>(ci_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>, </span>
<span id="cb264-12"><a href="#cb264-12" tabindex="-1"></a>    <span class="fu">round</span>(ci_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb264-13"><a href="#cb264-13" tabindex="-1"></a></span>
<span id="cb264-14"><a href="#cb264-14" tabindex="-1"></a><span class="cf">if</span>(prop_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb264-15"><a href="#cb264-15" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Reject H0: Click-through rate is significantly lower than 35% (p =&quot;</span>, </span>
<span id="cb264-16"><a href="#cb264-16" tabindex="-1"></a>      <span class="fu">round</span>(prop_test<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb264-17"><a href="#cb264-17" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: The test shows if the observed proportion (30%) is significantly lower than the claimed 35%. The confidence interval provides a range of plausible values for the true proportion.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 8:</strong></p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb265-2"><a href="#cb265-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb265-3"><a href="#cb265-3" tabindex="-1"></a>nurse_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb265-4"><a href="#cb265-4" tabindex="-1"></a>  <span class="at">nurse_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb265-5"><a href="#cb265-5" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">72</span>, <span class="dv">5</span>),</span>
<span id="cb265-6"><a href="#cb265-6" tabindex="-1"></a>  <span class="at">after =</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">78</span>, <span class="dv">5</span>)</span>
<span id="cb265-7"><a href="#cb265-7" tabindex="-1"></a>)</span>
<span id="cb265-8"><a href="#cb265-8" tabindex="-1"></a></span>
<span id="cb265-9"><a href="#cb265-9" tabindex="-1"></a><span class="co"># Paired t-test</span></span>
<span id="cb265-10"><a href="#cb265-10" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(nurse_data<span class="sc">$</span>after, nurse_data<span class="sc">$</span>before, </span>
<span id="cb265-11"><a href="#cb265-11" tabindex="-1"></a>                     <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb265-12"><a href="#cb265-12" tabindex="-1"></a><span class="fu">print</span>(test_result)</span>
<span id="cb265-13"><a href="#cb265-13" tabindex="-1"></a></span>
<span id="cb265-14"><a href="#cb265-14" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb265-15"><a href="#cb265-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;This should be a PAIRED test because the same nurses are measured before and after training.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb265-16"><a href="#cb265-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean improvement:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(nurse_data<span class="sc">$</span>after <span class="sc">-</span> nurse_data<span class="sc">$</span>before), <span class="dv">2</span>), <span class="st">&quot;points</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb265-17"><a href="#cb265-17" tabindex="-1"></a></span>
<span id="cb265-18"><a href="#cb265-18" tabindex="-1"></a><span class="cf">if</span>(test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb265-19"><a href="#cb265-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Reject H0: Training significantly improved scores (p =&quot;</span>, </span>
<span id="cb265-20"><a href="#cb265-20" tabindex="-1"></a>      <span class="fu">round</span>(test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb265-21"><a href="#cb265-21" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: This is a paired test because we‚Äôre comparing the same subjects (nurses) before and after treatment. The test examines if there‚Äôs a significant improvement in scores.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 9:</strong></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" tabindex="-1"></a><span class="co"># Two-sample proportion test</span></span>
<span id="cb266-2"><a href="#cb266-2" tabindex="-1"></a>prop_test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">180</span>, <span class="dv">210</span>), <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">250</span>, <span class="dv">280</span>), <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb266-3"><a href="#cb266-3" tabindex="-1"></a><span class="fu">print</span>(prop_test)</span>
<span id="cb266-4"><a href="#cb266-4" tabindex="-1"></a></span>
<span id="cb266-5"><a href="#cb266-5" tabindex="-1"></a><span class="co"># Calculate effect size (Cohen&#39;s h)</span></span>
<span id="cb266-6"><a href="#cb266-6" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="dv">180</span><span class="sc">/</span><span class="dv">250</span></span>
<span id="cb266-7"><a href="#cb266-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">210</span><span class="sc">/</span><span class="dv">280</span></span>
<span id="cb266-8"><a href="#cb266-8" tabindex="-1"></a>cohens_h <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">asin</span>(<span class="fu">sqrt</span>(p1)) <span class="sc">-</span> <span class="fu">asin</span>(<span class="fu">sqrt</span>(p2)))</span>
<span id="cb266-9"><a href="#cb266-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Cohen&#39;s h (effect size):&quot;</span>, <span class="fu">round</span>(cohens_h, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb266-10"><a href="#cb266-10" tabindex="-1"></a></span>
<span id="cb266-11"><a href="#cb266-11" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb266-12"><a href="#cb266-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hospital A satisfaction rate:&quot;</span>, <span class="fu">round</span>(p1, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb266-13"><a href="#cb266-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hospital B satisfaction rate:&quot;</span>, <span class="fu">round</span>(p2, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb266-14"><a href="#cb266-14" tabindex="-1"></a></span>
<span id="cb266-15"><a href="#cb266-15" tabindex="-1"></a><span class="cf">if</span>(prop_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb266-16"><a href="#cb266-16" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Reject H0: Significant difference in satisfaction rates (p =&quot;</span>, </span>
<span id="cb266-17"><a href="#cb266-17" tabindex="-1"></a>      <span class="fu">round</span>(prop_test<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb266-18"><a href="#cb266-18" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb266-19"><a href="#cb266-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Fail to reject H0: No significant difference (p =&quot;</span>, </span>
<span id="cb266-20"><a href="#cb266-20" tabindex="-1"></a>      <span class="fu">round</span>(prop_test<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb266-21"><a href="#cb266-21" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: The test compares two independent proportions. Cohen‚Äôs h measures the effect size, where values around 0.2, 0.5, and 0.8 represent small, medium, and large effects respectively.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 10:</strong></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb267-2"><a href="#cb267-2" tabindex="-1"></a></span>
<span id="cb267-3"><a href="#cb267-3" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb267-4"><a href="#cb267-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb267-5"><a href="#cb267-5" tabindex="-1"></a>cholesterol_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb267-6"><a href="#cb267-6" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">200</span>, <span class="dv">15</span>), <span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="dv">195</span>, <span class="dv">25</span>)),</span>
<span id="cb267-7"><a href="#cb267-7" tabindex="-1"></a>  <span class="at">clinic =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Clinic_A&quot;</span>, <span class="st">&quot;Clinic_B&quot;</span>), <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">35</span>))</span>
<span id="cb267-8"><a href="#cb267-8" tabindex="-1"></a>)</span>
<span id="cb267-9"><a href="#cb267-9" tabindex="-1"></a></span>
<span id="cb267-10"><a href="#cb267-10" tabindex="-1"></a><span class="co"># Levene&#39;s test</span></span>
<span id="cb267-11"><a href="#cb267-11" tabindex="-1"></a>levene_test <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(level <span class="sc">~</span> clinic, <span class="at">data =</span> cholesterol_data)</span>
<span id="cb267-12"><a href="#cb267-12" tabindex="-1"></a><span class="fu">print</span>(levene_test)</span>
<span id="cb267-13"><a href="#cb267-13" tabindex="-1"></a></span>
<span id="cb267-14"><a href="#cb267-14" tabindex="-1"></a><span class="co"># Appropriate t-test (Welch&#39;s t-test - default in R)</span></span>
<span id="cb267-15"><a href="#cb267-15" tabindex="-1"></a>t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(level <span class="sc">~</span> clinic, <span class="at">data =</span> cholesterol_data)</span>
<span id="cb267-16"><a href="#cb267-16" tabindex="-1"></a><span class="fu">print</span>(t_test)</span>
<span id="cb267-17"><a href="#cb267-17" tabindex="-1"></a></span>
<span id="cb267-18"><a href="#cb267-18" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb267-19"><a href="#cb267-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Levene&#39;s test p-value:&quot;</span>, <span class="fu">round</span>(levene_test<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb267-20"><a href="#cb267-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Since p &lt; 0.05, variances are significantly different.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb267-21"><a href="#cb267-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Use Welch&#39;s t-test (default) which doesn&#39;t assume equal variances.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><strong>Explanation</strong>: When Levene‚Äôs test shows unequal variances (p &lt; 0.05), use Welch‚Äôs t-test instead of the standard two-sample t-test. Welch‚Äôs test adjusts for unequal variances.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 11:</strong></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb268-2"><a href="#cb268-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb268-3"><a href="#cb268-3" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb268-4"><a href="#cb268-4" tabindex="-1"></a>  <span class="at">blood_pressure =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">140</span>, <span class="dv">10</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">135</span>, <span class="dv">12</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">130</span>, <span class="dv">8</span>)),</span>
<span id="cb268-5"><a href="#cb268-5" tabindex="-1"></a>  <span class="at">treatment_group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Drug_A&quot;</span>, <span class="st">&quot;Drug_B&quot;</span>, <span class="st">&quot;Drug_C&quot;</span>), <span class="at">each =</span> <span class="dv">20</span>)</span>
<span id="cb268-6"><a href="#cb268-6" tabindex="-1"></a>)</span>
<span id="cb268-7"><a href="#cb268-7" tabindex="-1"></a></span>
<span id="cb268-8"><a href="#cb268-8" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb268-9"><a href="#cb268-9" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(blood_pressure <span class="sc">~</span> treatment_group, <span class="at">data =</span> clinical_data)</span>
<span id="cb268-10"><a href="#cb268-10" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span>
<span id="cb268-11"><a href="#cb268-11" tabindex="-1"></a></span>
<span id="cb268-12"><a href="#cb268-12" tabindex="-1"></a><span class="co"># Test assumptions</span></span>
<span id="cb268-13"><a href="#cb268-13" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb268-14"><a href="#cb268-14" tabindex="-1"></a></span>
<span id="cb268-15"><a href="#cb268-15" tabindex="-1"></a><span class="co"># Normality of residuals</span></span>
<span id="cb268-16"><a href="#cb268-16" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(anova_result))</span>
<span id="cb268-17"><a href="#cb268-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Shapiro-Wilk test for normality p-value:&quot;</span>, <span class="fu">round</span>(shapiro_test<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb268-18"><a href="#cb268-18" tabindex="-1"></a></span>
<span id="cb268-19"><a href="#cb268-19" tabindex="-1"></a><span class="co"># Homogeneity of variances</span></span>
<span id="cb268-20"><a href="#cb268-20" tabindex="-1"></a>levene_test <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(blood_pressure <span class="sc">~</span> treatment_group, <span class="at">data =</span> clinical_data)</span>
<span id="cb268-21"><a href="#cb268-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Levene&#39;s test p-value:&quot;</span>, <span class="fu">round</span>(levene_test<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb268-22"><a href="#cb268-22" tabindex="-1"></a></span>
<span id="cb268-23"><a href="#cb268-23" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb268-24"><a href="#cb268-24" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]][[<span class="st">&quot;Pr(&gt;F)&quot;</span>]][<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb268-25"><a href="#cb268-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Reject H0: Significant differences among treatment groups</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb268-26"><a href="#cb268-26" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb268-27"><a href="#cb268-27" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Fail to reject H0: No significant differences among groups</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb268-28"><a href="#cb268-28" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: ANOVA tests if there are significant differences among group means. The assumptions (normality and equal variances) should be checked before interpreting results.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 12:</strong></p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" tabindex="-1"></a><span class="co"># Assuming anova_model is already fitted</span></span>
<span id="cb269-2"><a href="#cb269-2" tabindex="-1"></a><span class="co"># Tukey&#39;s HSD test</span></span>
<span id="cb269-3"><a href="#cb269-3" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_model)</span>
<span id="cb269-4"><a href="#cb269-4" tabindex="-1"></a><span class="fu">print</span>(tukey_result)</span>
<span id="cb269-5"><a href="#cb269-5" tabindex="-1"></a></span>
<span id="cb269-6"><a href="#cb269-6" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb269-7"><a href="#cb269-7" tabindex="-1"></a><span class="fu">plot</span>(tukey_result)</span>
<span id="cb269-8"><a href="#cb269-8" tabindex="-1"></a></span>
<span id="cb269-9"><a href="#cb269-9" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb269-10"><a href="#cb269-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Tukey HSD identifies which specific groups differ significantly.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb269-11"><a href="#cb269-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Look for p-values &lt; 0.05 in the &#39;p adj&#39; column.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb269-12"><a href="#cb269-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The &#39;diff&#39; column shows the difference in means between groups.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><strong>Explanation</strong>: Tukey‚Äôs HSD test performs pairwise comparisons while controlling the family-wise error rate. Significant differences are indicated by p-values &lt; 0.05 in the adjusted p-value column.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 13:</strong></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb270-2"><a href="#cb270-2" tabindex="-1"></a></span>
<span id="cb270-3"><a href="#cb270-3" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb270-4"><a href="#cb270-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">654</span>)</span>
<span id="cb270-5"><a href="#cb270-5" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb270-6"><a href="#cb270-6" tabindex="-1"></a>  <span class="at">recovery_time =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">10</span>, <span class="dv">2</span>), <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">12</span>, <span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">8</span>, <span class="fl">1.5</span>)),</span>
<span id="cb270-7"><a href="#cb270-7" tabindex="-1"></a>  <span class="at">hospital =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Hospital_A&quot;</span>, <span class="st">&quot;Hospital_B&quot;</span>, <span class="st">&quot;Hospital_C&quot;</span>), <span class="at">each =</span> <span class="dv">25</span>)</span>
<span id="cb270-8"><a href="#cb270-8" tabindex="-1"></a>)</span>
<span id="cb270-9"><a href="#cb270-9" tabindex="-1"></a></span>
<span id="cb270-10"><a href="#cb270-10" tabindex="-1"></a><span class="co"># ANOVA model</span></span>
<span id="cb270-11"><a href="#cb270-11" tabindex="-1"></a>anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(recovery_time <span class="sc">~</span> hospital, <span class="at">data =</span> patient_data)</span>
<span id="cb270-12"><a href="#cb270-12" tabindex="-1"></a></span>
<span id="cb270-13"><a href="#cb270-13" tabindex="-1"></a><span class="co"># Levene&#39;s test for homogeneity of variances</span></span>
<span id="cb270-14"><a href="#cb270-14" tabindex="-1"></a>levene_test <span class="ot">&lt;-</span> <span class="fu">leveneTest</span>(recovery_time <span class="sc">~</span> hospital, <span class="at">data =</span> patient_data)</span>
<span id="cb270-15"><a href="#cb270-15" tabindex="-1"></a><span class="fu">print</span>(levene_test)</span>
<span id="cb270-16"><a href="#cb270-16" tabindex="-1"></a></span>
<span id="cb270-17"><a href="#cb270-17" tabindex="-1"></a><span class="co"># Normality test for residuals</span></span>
<span id="cb270-18"><a href="#cb270-18" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(anova_model))</span>
<span id="cb270-19"><a href="#cb270-19" tabindex="-1"></a><span class="fu">print</span>(shapiro_test)</span>
<span id="cb270-20"><a href="#cb270-20" tabindex="-1"></a></span>
<span id="cb270-21"><a href="#cb270-21" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb270-22"><a href="#cb270-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Levene&#39;s test p-value:&quot;</span>, <span class="fu">round</span>(levene_test<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>], <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb270-23"><a href="#cb270-23" tabindex="-1"></a><span class="cf">if</span>(levene_test<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb270-24"><a href="#cb270-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Assumption of equal variances is met (p &gt; 0.05)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb270-25"><a href="#cb270-25" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb270-26"><a href="#cb270-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Assumption of equal variances is violated (p &lt; 0.05)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb270-27"><a href="#cb270-27" tabindex="-1"></a>}</span>
<span id="cb270-28"><a href="#cb270-28" tabindex="-1"></a></span>
<span id="cb270-29"><a href="#cb270-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Shapiro-Wilk test p-value:&quot;</span>, <span class="fu">round</span>(shapiro_test<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb270-30"><a href="#cb270-30" tabindex="-1"></a><span class="cf">if</span>(shapiro_test<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb270-31"><a href="#cb270-31" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Assumption of normality is met (p &gt; 0.05)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb270-32"><a href="#cb270-32" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb270-33"><a href="#cb270-33" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Assumption of normality is violated (p &lt; 0.05)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb270-34"><a href="#cb270-34" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: Both tests check ANOVA assumptions. Levene‚Äôs test checks equal variances (homoscedasticity), while Shapiro-Wilk tests normality of residuals. Both assumptions should be met for valid ANOVA results.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 14:</strong></p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb271-2"><a href="#cb271-2" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb271-4"><a href="#cb271-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">987</span>)</span>
<span id="cb271-5"><a href="#cb271-5" tabindex="-1"></a>health_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb271-6"><a href="#cb271-6" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">55</span>, <span class="dv">12</span>),</span>
<span id="cb271-7"><a href="#cb271-7" tabindex="-1"></a>  <span class="at">BMI =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">27</span>, <span class="dv">4</span>),</span>
<span id="cb271-8"><a href="#cb271-8" tabindex="-1"></a>  <span class="at">exercise_hours =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb271-9"><a href="#cb271-9" tabindex="-1"></a>  <span class="at">blood_pressure =</span> <span class="dv">90</span> <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fl">1.8</span> <span class="sc">*</span> BMI <span class="sc">-</span> <span class="fl">2.1</span> <span class="sc">*</span> exercise_hours <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb271-10"><a href="#cb271-10" tabindex="-1"></a>)</span>
<span id="cb271-11"><a href="#cb271-11" tabindex="-1"></a></span>
<span id="cb271-12"><a href="#cb271-12" tabindex="-1"></a><span class="co"># Multiple linear regression</span></span>
<span id="cb271-13"><a href="#cb271-13" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(blood_pressure <span class="sc">~</span> age <span class="sc">+</span> BMI <span class="sc">+</span> exercise_hours, <span class="at">data =</span> health_data)</span>
<span id="cb271-14"><a href="#cb271-14" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb271-15"><a href="#cb271-15" tabindex="-1"></a></span>
<span id="cb271-16"><a href="#cb271-16" tabindex="-1"></a><span class="co"># Check for multicollinearity</span></span>
<span id="cb271-17"><a href="#cb271-17" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model)</span>
<span id="cb271-18"><a href="#cb271-18" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;VIF values:&quot;</span>)</span>
<span id="cb271-19"><a href="#cb271-19" tabindex="-1"></a><span class="fu">print</span>(vif_values)</span>
<span id="cb271-20"><a href="#cb271-20" tabindex="-1"></a></span>
<span id="cb271-21"><a href="#cb271-21" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb271-22"><a href="#cb271-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;R-squared:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb271-23"><a href="#cb271-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Adjusted R-squared:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb271-24"><a href="#cb271-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;F-statistic p-value:&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>fstatistic[<span class="dv">4</span>], <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb271-25"><a href="#cb271-25" tabindex="-1"></a></span>
<span id="cb271-26"><a href="#cb271-26" tabindex="-1"></a><span class="co"># Check VIF interpretation</span></span>
<span id="cb271-27"><a href="#cb271-27" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">all</span>(vif_values <span class="sc">&lt;</span> <span class="dv">5</span>)) {</span>
<span id="cb271-28"><a href="#cb271-28" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;No multicollinearity concerns (all VIF &lt; 5)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb271-29"><a href="#cb271-29" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">any</span>(vif_values <span class="sc">&gt;</span> <span class="dv">10</span>)) {</span>
<span id="cb271-30"><a href="#cb271-30" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Severe multicollinearity detected (VIF &gt; 10)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb271-31"><a href="#cb271-31" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb271-32"><a href="#cb271-32" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Moderate multicollinearity (5 &lt; VIF &lt; 10)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb271-33"><a href="#cb271-33" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: The model shows how age, BMI, and exercise hours predict blood pressure. VIF values &lt; 5 indicate no multicollinearity concerns. Higher VIF values suggest correlated predictors.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 15:</strong></p>
<p><strong>Step 1: Write the regression equation</strong></p>
<pre><code>LOS = 3.250 + 0.045(age) + 0.120(BMI) + 1.450(comorbidities)</code></pre>
<p><strong>Step 2: Plug in the values</strong>
- age = 65
- BMI = 28
- comorbidities = 2</p>
<pre><code>LOS = 3.250 + 0.045(65) + 0.120(28) + 1.450(2)
LOS = 3.250 + 2.925 + 3.360 + 2.900
LOS = 12.435 days</code></pre>
<p><strong>Step 3: Classification</strong>
Since 12.435 ‚â• 7 days, this patient is classified as <strong>‚ÄúLong Stay‚Äù</strong></p>
<p><strong>R code:</strong></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" tabindex="-1"></a><span class="co"># Coefficients from the model</span></span>
<span id="cb274-2"><a href="#cb274-2" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fl">3.250</span></span>
<span id="cb274-3"><a href="#cb274-3" tabindex="-1"></a>coef_age <span class="ot">&lt;-</span> <span class="fl">0.045</span></span>
<span id="cb274-4"><a href="#cb274-4" tabindex="-1"></a>coef_bmi <span class="ot">&lt;-</span> <span class="fl">0.120</span></span>
<span id="cb274-5"><a href="#cb274-5" tabindex="-1"></a>coef_comorbidities <span class="ot">&lt;-</span> <span class="fl">1.450</span></span>
<span id="cb274-6"><a href="#cb274-6" tabindex="-1"></a></span>
<span id="cb274-7"><a href="#cb274-7" tabindex="-1"></a><span class="co"># New patient values</span></span>
<span id="cb274-8"><a href="#cb274-8" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">65</span></span>
<span id="cb274-9"><a href="#cb274-9" tabindex="-1"></a>bmi <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb274-10"><a href="#cb274-10" tabindex="-1"></a>comorbidities <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb274-11"><a href="#cb274-11" tabindex="-1"></a></span>
<span id="cb274-12"><a href="#cb274-12" tabindex="-1"></a><span class="co"># Prediction</span></span>
<span id="cb274-13"><a href="#cb274-13" tabindex="-1"></a>predicted_los <span class="ot">&lt;-</span> intercept <span class="sc">+</span> coef_age <span class="sc">*</span> age <span class="sc">+</span> coef_bmi <span class="sc">*</span> bmi <span class="sc">+</span> coef_comorbidities <span class="sc">*</span> comorbidities</span>
<span id="cb274-14"><a href="#cb274-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Predicted Length of Stay:&quot;</span>, <span class="fu">round</span>(predicted_los, <span class="dv">2</span>), <span class="st">&quot;days</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb274-15"><a href="#cb274-15" tabindex="-1"></a></span>
<span id="cb274-16"><a href="#cb274-16" tabindex="-1"></a><span class="co"># Classification</span></span>
<span id="cb274-17"><a href="#cb274-17" tabindex="-1"></a><span class="cf">if</span>(predicted_los <span class="sc">&lt;</span> <span class="dv">7</span>) {</span>
<span id="cb274-18"><a href="#cb274-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Classification: Short Stay</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb274-19"><a href="#cb274-19" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb274-20"><a href="#cb274-20" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Classification: Long Stay</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb274-21"><a href="#cb274-21" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: The predicted length of stay is approximately 12.4 days, which exceeds the 7-day threshold, classifying this patient as a ‚ÄúLong Stay‚Äù case. This information can help the hospital plan resource allocation.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 16:</strong></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" tabindex="-1"></a><span class="co"># Create the data</span></span>
<span id="cb275-2"><a href="#cb275-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb275-3"><a href="#cb275-3" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb275-4"><a href="#cb275-4" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">62</span>, <span class="dv">71</span>, <span class="dv">55</span>, <span class="dv">68</span>, <span class="dv">58</span>, <span class="dv">75</span>, <span class="dv">63</span>, <span class="dv">52</span>, <span class="dv">70</span>),</span>
<span id="cb275-5"><a href="#cb275-5" tabindex="-1"></a>  <span class="at">length_of_stay =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">9</span>),</span>
<span id="cb275-6"><a href="#cb275-6" tabindex="-1"></a>  <span class="at">comorbidities =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb275-7"><a href="#cb275-7" tabindex="-1"></a>  <span class="at">readmission_risk =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">55</span>, <span class="dv">72</span>, <span class="dv">35</span>, <span class="dv">60</span>, <span class="dv">40</span>, <span class="dv">78</span>, <span class="dv">50</span>, <span class="dv">28</span>, <span class="dv">68</span>)</span>
<span id="cb275-8"><a href="#cb275-8" tabindex="-1"></a>)</span>
<span id="cb275-9"><a href="#cb275-9" tabindex="-1"></a></span>
<span id="cb275-10"><a href="#cb275-10" tabindex="-1"></a><span class="co"># Task 1: Fit the model and display summary</span></span>
<span id="cb275-11"><a href="#cb275-11" tabindex="-1"></a>risk_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(readmission_risk <span class="sc">~</span> age <span class="sc">+</span> length_of_stay <span class="sc">+</span> comorbidities, </span>
<span id="cb275-12"><a href="#cb275-12" tabindex="-1"></a>                 <span class="at">data =</span> patient_data)</span>
<span id="cb275-13"><a href="#cb275-13" tabindex="-1"></a><span class="fu">summary</span>(risk_model)</span>
<span id="cb275-14"><a href="#cb275-14" tabindex="-1"></a></span>
<span id="cb275-15"><a href="#cb275-15" tabindex="-1"></a><span class="co"># Task 2: Predict for new patient</span></span>
<span id="cb275-16"><a href="#cb275-16" tabindex="-1"></a>new_patient <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">60</span>, <span class="at">length_of_stay =</span> <span class="dv">6</span>, <span class="at">comorbidities =</span> <span class="dv">2</span>)</span>
<span id="cb275-17"><a href="#cb275-17" tabindex="-1"></a>predicted_risk <span class="ot">&lt;-</span> <span class="fu">predict</span>(risk_model, <span class="at">newdata =</span> new_patient)</span>
<span id="cb275-18"><a href="#cb275-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Predicted readmission risk:&quot;</span>, <span class="fu">round</span>(predicted_risk, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb275-19"><a href="#cb275-19" tabindex="-1"></a></span>
<span id="cb275-20"><a href="#cb275-20" tabindex="-1"></a><span class="co"># Task 3: Classification</span></span>
<span id="cb275-21"><a href="#cb275-21" tabindex="-1"></a><span class="cf">if</span>(predicted_risk <span class="sc">&lt;</span> <span class="dv">40</span>) {</span>
<span id="cb275-22"><a href="#cb275-22" tabindex="-1"></a>  risk_category <span class="ot">&lt;-</span> <span class="st">&quot;Low Risk&quot;</span></span>
<span id="cb275-23"><a href="#cb275-23" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(predicted_risk <span class="sc">&lt;=</span> <span class="dv">60</span>) {</span>
<span id="cb275-24"><a href="#cb275-24" tabindex="-1"></a>  risk_category <span class="ot">&lt;-</span> <span class="st">&quot;Medium Risk&quot;</span></span>
<span id="cb275-25"><a href="#cb275-25" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb275-26"><a href="#cb275-26" tabindex="-1"></a>  risk_category <span class="ot">&lt;-</span> <span class="st">&quot;High Risk&quot;</span></span>
<span id="cb275-27"><a href="#cb275-27" tabindex="-1"></a>}</span>
<span id="cb275-28"><a href="#cb275-28" tabindex="-1"></a></span>
<span id="cb275-29"><a href="#cb275-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Risk Classification:&quot;</span>, risk_category, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb275-30"><a href="#cb275-30" tabindex="-1"></a></span>
<span id="cb275-31"><a href="#cb275-31" tabindex="-1"></a><span class="co"># Display complete results</span></span>
<span id="cb275-32"><a href="#cb275-32" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== COMPLETE RESULTS ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb275-33"><a href="#cb275-33" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Patient Profile:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb275-34"><a href="#cb275-34" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - Age: 60 years</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb275-35"><a href="#cb275-35" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - Length of Stay: 6 days</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb275-36"><a href="#cb275-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  - Comorbidities: 2</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb275-37"><a href="#cb275-37" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Predicted Risk Score:&quot;</span>, <span class="fu">round</span>(predicted_risk, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb275-38"><a href="#cb275-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Risk Category:&quot;</span>, risk_category, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><strong>Interpretation</strong>: Based on the model, a 60-year-old patient with a 6-day length of stay and 2 comorbidities has a predicted readmission risk score around 49-51 (depending on the exact coefficients). This falls into the ‚ÄúMedium Risk‚Äù category (40-60), suggesting moderate follow-up care and monitoring would be appropriate.</p>
<p><strong>Explanation</strong>: This practical approach shows how hospitals can use regression models to classify patients into risk categories, enabling targeted interventions and resource allocation for patients most at risk of readmission.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 17:</strong></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb276-2"><a href="#cb276-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb276-3"><a href="#cb276-3" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb276-4"><a href="#cb276-4" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">55</span>, <span class="dv">12</span>),</span>
<span id="cb276-5"><a href="#cb276-5" tabindex="-1"></a>  <span class="at">smoking_status =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb276-6"><a href="#cb276-6" tabindex="-1"></a>  <span class="at">cholesterol =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">200</span>, <span class="dv">30</span>),</span>
<span id="cb276-7"><a href="#cb276-7" tabindex="-1"></a>  <span class="at">disease =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>))</span>
<span id="cb276-8"><a href="#cb276-8" tabindex="-1"></a>)</span>
<span id="cb276-9"><a href="#cb276-9" tabindex="-1"></a></span>
<span id="cb276-10"><a href="#cb276-10" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb276-11"><a href="#cb276-11" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(disease <span class="sc">~</span> age <span class="sc">+</span> smoking_status <span class="sc">+</span> cholesterol, </span>
<span id="cb276-12"><a href="#cb276-12" tabindex="-1"></a>                   <span class="at">data =</span> patient_data, <span class="at">family =</span> binomial)</span>
<span id="cb276-13"><a href="#cb276-13" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span>
<span id="cb276-14"><a href="#cb276-14" tabindex="-1"></a></span>
<span id="cb276-15"><a href="#cb276-15" tabindex="-1"></a><span class="co"># Odds ratios</span></span>
<span id="cb276-16"><a href="#cb276-16" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb276-17"><a href="#cb276-17" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Odds Ratios:&quot;</span>)</span>
<span id="cb276-18"><a href="#cb276-18" tabindex="-1"></a><span class="fu">print</span>(odds_ratios)</span>
<span id="cb276-19"><a href="#cb276-19" tabindex="-1"></a></span>
<span id="cb276-20"><a href="#cb276-20" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb276-21"><a href="#cb276-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Interpretation of coefficients:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb276-22"><a href="#cb276-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Age: For each year increase, odds of disease multiply by&quot;</span>, <span class="fu">round</span>(odds_ratios[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb276-23"><a href="#cb276-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Smoking: Smokers have&quot;</span>, <span class="fu">round</span>(odds_ratios[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">&quot;times the odds of disease vs non-smokers</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb276-24"><a href="#cb276-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Cholesterol: For each unit increase, odds multiply by&quot;</span>, <span class="fu">round</span>(odds_ratios[<span class="dv">4</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><strong>Explanation</strong>: Logistic regression models log-odds of disease. Odds ratios &gt; 1 indicate increased risk, &lt; 1 indicate decreased risk. The coefficients represent log-odds changes, so we exponentiate to get odds ratios.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 18:</strong></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" tabindex="-1"></a><span class="co"># Using the model from Question 17</span></span>
<span id="cb277-2"><a href="#cb277-2" tabindex="-1"></a>new_patient <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">60</span>, <span class="at">smoking_status =</span> <span class="dv">1</span>, <span class="at">cholesterol =</span> <span class="dv">250</span>)</span>
<span id="cb277-3"><a href="#cb277-3" tabindex="-1"></a></span>
<span id="cb277-4"><a href="#cb277-4" tabindex="-1"></a><span class="co"># Predict probability</span></span>
<span id="cb277-5"><a href="#cb277-5" tabindex="-1"></a>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> new_patient, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb277-6"><a href="#cb277-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Predicted probability of disease:&quot;</span>, <span class="fu">round</span>(predicted_prob, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb277-7"><a href="#cb277-7" tabindex="-1"></a></span>
<span id="cb277-8"><a href="#cb277-8" tabindex="-1"></a><span class="co"># Odds ratio for smoking</span></span>
<span id="cb277-9"><a href="#cb277-9" tabindex="-1"></a>smoking_or <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model)[<span class="dv">3</span>])</span>
<span id="cb277-10"><a href="#cb277-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Odds ratio for smoking:&quot;</span>, <span class="fu">round</span>(smoking_or, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb277-11"><a href="#cb277-11" tabindex="-1"></a></span>
<span id="cb277-12"><a href="#cb277-12" tabindex="-1"></a><span class="co"># Practical interpretation</span></span>
<span id="cb277-13"><a href="#cb277-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Practical interpretation:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb277-14"><a href="#cb277-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;A 60-year-old smoker with cholesterol 250 has a&quot;</span>, <span class="fu">round</span>(predicted_prob<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;% chance of disease</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb277-15"><a href="#cb277-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Smokers have&quot;</span>, <span class="fu">round</span>(smoking_or, <span class="dv">1</span>), <span class="st">&quot;times higher odds of disease than non-smokers</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb277-16"><a href="#cb277-16" tabindex="-1"></a><span class="cf">if</span>(smoking_or <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb277-17"><a href="#cb277-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;This means smoking increases disease risk by&quot;</span>, <span class="fu">round</span>((smoking_or<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb277-18"><a href="#cb277-18" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: The predicted probability gives the likelihood of disease for this specific patient. The odds ratio quantifies how much smoking increases disease risk compared to non-smoking.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 19:</strong></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb278-2"><a href="#cb278-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb278-3"><a href="#cb278-3" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb278-4"><a href="#cb278-4" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="dv">65</span>, <span class="dv">10</span>),</span>
<span id="cb278-5"><a href="#cb278-5" tabindex="-1"></a>  <span class="at">treatment_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">each =</span> <span class="dv">30</span>),</span>
<span id="cb278-6"><a href="#cb278-6" tabindex="-1"></a>  <span class="at">recovery_time =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">15</span>, <span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">12</span>, <span class="fl">2.5</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">18</span>, <span class="dv">4</span>))</span>
<span id="cb278-7"><a href="#cb278-7" tabindex="-1"></a>)</span>
<span id="cb278-8"><a href="#cb278-8" tabindex="-1"></a></span>
<span id="cb278-9"><a href="#cb278-9" tabindex="-1"></a><span class="co"># Set treatment A as reference</span></span>
<span id="cb278-10"><a href="#cb278-10" tabindex="-1"></a>clinical_data<span class="sc">$</span>treatment_type <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(clinical_data<span class="sc">$</span>treatment_type), <span class="at">ref =</span> <span class="st">&quot;A&quot;</span>)</span>
<span id="cb278-11"><a href="#cb278-11" tabindex="-1"></a></span>
<span id="cb278-12"><a href="#cb278-12" tabindex="-1"></a><span class="co"># Linear regression with dummy variables</span></span>
<span id="cb278-13"><a href="#cb278-13" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(recovery_time <span class="sc">~</span> age <span class="sc">+</span> treatment_type, <span class="at">data =</span> clinical_data)</span>
<span id="cb278-14"><a href="#cb278-14" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb278-15"><a href="#cb278-15" tabindex="-1"></a></span>
<span id="cb278-16"><a href="#cb278-16" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb278-17"><a href="#cb278-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Interpretation of coefficients:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb278-18"><a href="#cb278-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Intercept: Expected recovery time for treatment A at age 0</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb278-19"><a href="#cb278-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Age: For each year increase, recovery time changes by&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;days</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb278-20"><a href="#cb278-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Treatment B: Recovery time differs by&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">&quot;days vs treatment A</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb278-21"><a href="#cb278-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Treatment C: Recovery time differs by&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">4</span>], <span class="dv">3</span>), <span class="st">&quot;days vs treatment A</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><strong>Explanation</strong>: Treatment A is the reference category. The coefficients for treatments B and C show how much their recovery times differ from treatment A, holding age constant. Positive coefficients mean longer recovery times.</p>
</div>
<div class="answer">
<p><strong>Answer to Question 20:</strong></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb279-2"><a href="#cb279-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb279-3"><a href="#cb279-3" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb279-4"><a href="#cb279-4" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">150</span>, <span class="dv">55</span>, <span class="dv">12</span>),</span>
<span id="cb279-5"><a href="#cb279-5" tabindex="-1"></a>  <span class="at">smoking_status =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">150</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb279-6"><a href="#cb279-6" tabindex="-1"></a>  <span class="at">blood_pressure =</span> <span class="dv">90</span> <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="dv">12</span> <span class="sc">*</span> smoking_status <span class="sc">+</span> </span>
<span id="cb279-7"><a href="#cb279-7" tabindex="-1"></a>                   <span class="fl">0.2</span> <span class="sc">*</span> age <span class="sc">*</span> smoking_status <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">150</span>, <span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb279-8"><a href="#cb279-8" tabindex="-1"></a>)</span>
<span id="cb279-9"><a href="#cb279-9" tabindex="-1"></a></span>
<span id="cb279-10"><a href="#cb279-10" tabindex="-1"></a><span class="co"># Regression with interaction term</span></span>
<span id="cb279-11"><a href="#cb279-11" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(blood_pressure <span class="sc">~</span> age <span class="sc">*</span> smoking_status, <span class="at">data =</span> patient_data)</span>
<span id="cb279-12"><a href="#cb279-12" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb279-13"><a href="#cb279-13" tabindex="-1"></a></span>
<span id="cb279-14"><a href="#cb279-14" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb279-15"><a href="#cb279-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Model equation: BP =&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&quot;+&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&quot;*age +&quot;</span>, </span>
<span id="cb279-16"><a href="#cb279-16" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">3</span>], <span class="dv">2</span>), <span class="st">&quot;*smoking +&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">4</span>], <span class="dv">2</span>), <span class="st">&quot;*age*smoking</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb279-17"><a href="#cb279-17" tabindex="-1"></a></span>
<span id="cb279-18"><a href="#cb279-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Interpretation:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb279-19"><a href="#cb279-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;For non-smokers (smoking=0): BP =&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&quot;+&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&quot;*age</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb279-20"><a href="#cb279-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;For smokers (smoking=1): BP =&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(model)[<span class="dv">3</span>], <span class="dv">2</span>), <span class="st">&quot;+&quot;</span>, </span>
<span id="cb279-21"><a href="#cb279-21" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">coef</span>(model)[<span class="dv">4</span>], <span class="dv">2</span>), <span class="st">&quot;*age</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb279-22"><a href="#cb279-22" tabindex="-1"></a></span>
<span id="cb279-23"><a href="#cb279-23" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">coef</span>(model)[<span class="dv">4</span>] <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb279-24"><a href="#cb279-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;The interaction term shows that the effect of age on BP differs between smokers and non-smokers</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb279-25"><a href="#cb279-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Age effect for smokers:&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">coef</span>(model)[<span class="dv">4</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb279-26"><a href="#cb279-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Age effect for non-smokers:&quot;</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb279-27"><a href="#cb279-27" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explanation</strong>: The interaction term (age * smoking_status) allows the effect of age on blood pressure to differ between smokers and non-smokers. If significant, it means the relationship between age and blood pressure is different for the two groups.</p>
</div>
<!--chapter:end:exam_simulation_intermediate.Rmd-->
</div>
</div>
<div id="course-performance" class="section level1" number="18">
<h1><span class="header-section-number">18</span> ‚ö° Course Performance</h1>
<p>In this place you can have a grasp on how your previous colleagues performed on past years in this course. Hopefully this will inspire you to do better and challenge your grade expectation.
Data is extracted by <a href="https://www.blackboard.com/it-it">Blackboard</a> and have been carefully anonymized and securely stored to preserve privacy.</p>
<div id="students-performance-analysis" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> üéì 24-25 Students Performance Analysis</h2>
<p>Based on the data from the 2024-2025 academic year, here‚Äôs a comprehensive analysis of student performance:</p>
<div id="overall-statistics" class="section level3" number="18.1.1">
<h3><span class="header-section-number">18.1.1</span> Overall Statistics</h3>
<table>
<caption>
(#tab:performance-analysis-24-25)Summary Statistics for 2024-2025 Academic Year
</caption>
<thead>
<tr>
<th style="text-align:right;">
Students
</th>
<th style="text-align:right;">
Mean Grade
</th>
<th style="text-align:right;">
Median Grade
</th>
<th style="text-align:right;">
Std Dev
</th>
<th style="text-align:right;">
Min Grade
</th>
<th style="text-align:right;">
Max Grade
</th>
<th style="text-align:right;">
Pass Rate (%)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
23.2
</td>
<td style="text-align:right;">
26.75
</td>
<td style="text-align:right;">
7.63
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
32.25
</td>
<td style="text-align:right;">
77.6
</td>
</tr>
</tbody>
</table>
</div>
<div id="grade-distribution" class="section level3" number="18.1.2">
<h3><span class="header-section-number">18.1.2</span> Grade Distribution</h3>
<p><img src="94-courseperformance_files/figure-html/grade-distribution-1.png" width="100%" /></p>
</div>
<div id="intermediate-exam-performance" class="section level3" number="18.1.3">
<h3><span class="header-section-number">18.1.3</span> Intermediate Exam Performance</h3>
<table>
<caption>
(#tab:intermediate-analysis)Intermediate Exam Performance
</caption>
<thead>
<tr>
<th style="text-align:right;">
1st Intermediate Mean
</th>
<th style="text-align:right;">
2nd Intermediate Mean
</th>
<th style="text-align:right;">
1st Intermediate Count
</th>
<th style="text-align:right;">
2nd Intermediate Count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
23.26
</td>
<td style="text-align:right;">
27.07
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
30
</td>
</tr>
</tbody>
</table>
</div>
<div id="performance-by-exam-type" class="section level3" number="18.1.4">
<h3><span class="header-section-number">18.1.4</span> Performance by Exam Type</h3>
<p><img src="94-courseperformance_files/figure-html/exam-type-analysis-1.png" width="100%" /></p>
</div>
<div id="key-insights" class="section level3" number="18.1.5">
<h3><span class="header-section-number">18.1.5</span> Key Insights</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Overall Performance</strong>: The mean final grade for the 2024-2025 academic year was 23.2 out of 30.</p></li>
<li><p><strong>Pass Rate</strong>: 77.6% of students achieved a passing grade (‚â•18).</p></li>
<li><p><strong>Grade Range</strong>: Final grades ranged from 1.5 to 32.25.</p></li>
<li><p><strong>Intermediate Exams</strong>: Students performed similarly on both intermediate exams, with slight variations.</p></li>
<li><p><strong>Distribution</strong>: The grade distribution shows a normal distribution with most students scoring in the middle range.</p></li>
</ol>
</div>
</div>
<div id="students" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> üéì 20-21 Students</h2>
<p><img src="images/perf_20-21.png" width="100%" /></p>
<hr />
<p><img src="images/perf_mg_20-21.png" width="100%" /></p>
</div>
<div id="students-1" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> üéì 21-22 Students</h2>
<p>‚Ä¶ soon to be analysed ‚Ä¶</p>
</div>
<div id="students-2" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> üéì 22-23 Students</h2>
<p>‚Ä¶ soon to be analysed ‚Ä¶</p>
</div>
<div id="students-3" class="section level2" number="18.5">
<h2><span class="header-section-number">18.5</span> üéì 23-24 Students</h2>
<p>‚Ä¶ soon to be analysed ‚Ä¶</p>
<!--chapter:end:94-courseperformance.Rmd-->
</div>
</div>
<div id="frequently-asked-questions" class="section level1" number="19">
<h1><span class="header-section-number">19</span> ‚ùì Frequently Asked Questions</h1>
<p>So there are a number of frequent troubles that students get most frequently stucked on. Here a collection of them with relative answer. What I generally suggest is to look for online answer just coping and pasting the error message from console to Google. <strong>The most respected resource to look for when you are in trouble is <a href="https://stackoverflow.com/">Stackovverflow</a></strong>.</p>
<div id="q-na" class="section level2" number="19.1">
<h2><span class="header-section-number">19.1</span> Q n‚ÄôA</h2>
<ul>
<li>I can‚Äôt really install <package> via <code>install.packages("&lt;package&gt;")</code>, it gives me some weird stuff I cant undestrand.</li>
</ul>
<blockquote>
<p>have you check the syntax? Did you spell correctly the package name, capital letters matters you know it?
still have the problem? try to install it from source, in most cases packages source code lies in GitHub. Look for the package author and name then do that: <code>library(devtools)</code> (if you still have not already installed the package <code>devtools</code> run <code>install.packages("devtools)</code> then execute <code>library(devtools)</code>). At this point run <code>install_github("&lt;github package author username&gt;/&lt;package name&gt;")</code>. I did not mentioned it before because I give it fro granted: PLEASE BE SURE TO HAVE INTERNET CONNECTION ACCESS otherwise you are not going to dowload anything.</p>
</blockquote>
<ul>
<li>So I have a file in local inside my R project and when I execute <code>read.csv("&lt;path to file&gt;")</code> that says R cant find the files, so what‚Äôs up?</li>
</ul>
<blockquote>
<p>most likely the problem is in the Working Directory ( check what Working Directory means @ref(workdir)). Load <code>here</code> with <code>library(here)</code> (if you still have not already installed the package <code>here</code>, then execute before <code>install.packages("here")</code> then <code>library(devtools)</code>). At this point run <code>here()</code> and verify the file lies in the very same directory in the output.</p>
</blockquote>
<ul>
<li><p>Are lectures recorded?
&gt; Generally Yes, the lectures will be recorded and made available to enrolled students. It might happen sometimes that teacher forget to start registration, if you notice please raise your hand and say it!</p></li>
<li><p>Will the videos be made available publicly?
&gt; This we can‚Äôt do, we are sorry for that but it is internal policy</p></li>
<li><p>Is attendance mandatory?
&gt; We won‚Äôt be taking attendance but we expect to see you often in class. We love talking to students to understand how you are doing, make sure you get the most out of the class, and get your feedback to improve the materials. The class is relatively small so we will probably get to know each other well.
If you have a time conflict and can‚Äôt attend the online lectures, please send us an email to let us know!</p></li>
<li><p>What is the format of the class?
&gt; It will be lectures, laboratories, and discussion. Occasionally depending on how fast we do lectures we might have some industry experts giving us tutorials or themed speeches.</p></li>
<li><p>Do I need to know R for the course?
&gt; Since R is the gold standard for statistics people, we expect most tutorials will be in R even though fluency isn‚Äôt required, but will make your life so much easier during the course.</p></li>
<li><p>Are there any (group) assignments?
&gt; We are still discussing about that, evemntually we will make it clear in one month max</p></li>
<li><p>I have a question about the class. What is the best way to reach the course staff?
&gt; please email <a href="mailto:niccolo.salvini27@gmail.com">your teaching assistant</a>, Dr.¬†Niccolo Salvini if it is related to R and laboratories, if that is not the case drop an email to <a href="mailto:giuseppe.arbia@unicatt.it">Prof.¬†Giuseppe Arbia</a></p></li>
<li><p>I can‚Äôt install package <code>OneTwoSamples</code>, why?
&gt; This is something that has to do with incopatible R version between built time and your current R version. If that cunfuses you don‚Äôt bother you are not going to use it. Instead you are going to use base R hyp testing with <code>stats::t.test()</code> or make use of <code>infer</code>, tidy statistical inferece.</p></li>
</ul>
<!--chapter:end:96-faqs.Rmd-->
</div>
</div>
<div id="part-appendix" class="section level1 unnumbered">
<h1 class="unnumbered">(PART*) Appendix</h1>
</div>
<div id="StatisticsAndParameters" class="section level1" number="20">
<h1><span class="header-section-number">20</span> Symbols, formulas, statistics and parameters</h1>
<div id="symbols-and-standard-errors" class="section level2" number="20.1">
<h2><span class="header-section-number">20.1</span> Symbols and standard errors</h2>
<p>(ref:DEFSamplingDistributionPhat) Def. @ref(def:DEFSamplingDistributionPhat)</p>
<p>(ref:DEFSamplingDistributionXbar) Def. @ref(def:DEFSamplingDistributionXbar)</p>
<p>(ref:DEFSamplingDistributionDbar) Def. @ref(def:DEFSamplingDistributionDbar)</p>
<table>
<caption>
(#tab:ParametersStatistics)Some sample statistics used to estimate population parameters. Empty table cells means that these are not studied in this textbook. The dashes means that no formula is given in this textbook.
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
</th>
<th style="text-align:center;font-weight: bold;">
Parameter
</th>
<th style="text-align:center;font-weight: bold;">
Statistic
</th>
<th style="text-align:center;font-weight: bold;">
Standard error
</th>
<th style="text-align:center;font-weight: bold;">
S.E. formula reference
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Proportion
</td>
<td style="text-align:center;">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\hat{p}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\text{s.e.}(\hat{p}) = \sqrt{\frac{ \hat{p} \times (1 - \hat{p})}{n}}\)</span>
</td>
<td style="text-align:center;">
(ref:DEFSamplingDistributionPhat)
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean
</td>
<td style="text-align:center;">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{x}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\text{s.e.}(\bar{x}) = \frac{s}{\sqrt{n}}\)</span>
</td>
<td style="text-align:center;">
(ref:DEFSamplingDistributionXbar)
</td>
</tr>
<tr>
<td style="text-align:left;">
Standard deviation
</td>
<td style="text-align:center;">
<span class="math inline">\(\sigma\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(s\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean difference
</td>
<td style="text-align:center;">
<span class="math inline">\(\mu_d\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{d}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\text{s.e.}(\bar{d}) = \frac{s_d}{\sqrt{n}}\)</span>
</td>
<td style="text-align:center;">
(ref:DEFSamplingDistributionDbar)
</td>
</tr>
<tr>
<td style="text-align:left;">
Diff. between means
</td>
<td style="text-align:center;">
<span class="math inline">\(\mu_1 - \mu_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\bar{x}_1 - \bar{x}_2\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\text{s.e.}(\bar{x}_1 - \bar{x}_2)\)</span>
</td>
<td style="text-align:center;">
‚Äì
</td>
</tr>
<tr>
<td style="text-align:left;">
Odds ratio
</td>
<td style="text-align:center;">
Pop. OR
</td>
<td style="text-align:center;">
Sample OR
</td>
<td style="text-align:center;">
<span class="math inline">\(\displaystyle\text{s.e.}(\text{sample OR})\)</span>
</td>
<td style="text-align:center;">
‚Äì
</td>
</tr>
<tr>
<td style="text-align:left;">
Correlation
</td>
<td style="text-align:center;">
<span class="math inline">\(\rho\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(r\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope of regression line
</td>
<td style="text-align:center;">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(b_1\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\text{s.e.}(b_1)\)</span>
</td>
<td style="text-align:center;">
‚Äì
</td>
</tr>
<tr>
<td style="text-align:left;">
Intercept of regression line
</td>
<td style="text-align:center;">
<span class="math inline">\(\beta_0\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(b_0\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\text{s.e.}(b_0)\)</span>
</td>
<td style="text-align:center;">
‚Äì
</td>
</tr>
<tr>
<td style="text-align:left;">
R-squared
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
<span class="math inline">\(R^2\)</span>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="confidence-intervals" class="section level2" number="20.2">
<h2><span class="header-section-number">20.2</span> Confidence intervals</h2>
<p>Almost all <strong>confidence intervals</strong> have the form</p>
<p><span class="math display">\[
    \text{statistic} \pm ( \text{multiplier} \times \text{s.e.}(\text{statistic})).
\]</span></p>
<p><strong>Notes:</strong></p>
<ul>
<li>The multiplier is <em>approximately</em> 2 for an <em>approximate</em> 95% CI (based on the 68‚Äì95‚Äì99.7 rule).</li>
<li><span class="math inline">\(\text{multiplier} \times \text{s.e.}(\text{statistic})\)</span> is called the <em>margin of error</em>.</li>
<li>Confidence intervals for <em>odds ratios</em> are slightly different, so <strong>this formula does not apply for odds ratios</strong>.
For the same reason, a standard error for ORs is not given.</li>
</ul>
</div>
<div id="hypothesis-testing" class="section level2" number="20.3">
<h2><span class="header-section-number">20.3</span> Hypothesis testing</h2>
<p>For many <strong>hypothesis tests</strong>, the <em>test statistic</em> is a <span class="math inline">\(t\)</span>-score, which has the form:</p>
<p><span class="math display">\[
  t = \frac{\text{statistic} - \text{parameter}}{\text{s.e.}(\text{statistic})}.
\]</span></p>
<p><strong>Notes:</strong></p>
<ul>
<li>Since <span class="math inline">\(t\)</span>-scores are a little like <span class="math inline">\(z\)</span>-scores, the 68‚Äì95‚Äì99.7 rule can be used to <em>approximate</em> <span class="math inline">\(P\)</span>-values.</li>
<li>Tests involving <em>odds ratios</em> do not use <span class="math inline">\(t\)</span>-scores, so <strong>this formula does not apply for tests involving odds ratios</strong>.</li>
<li>For tests involving odds ratios, the <em>test statistic</em>
is a <span class="math inline">\(\chi^2\)</span> score and not <span class="math inline">\(t\)</span>-score.
For the same reason, a standard error for ORs is not given.</li>
<li>The <span class="math inline">\(\chi^2\)</span> statistic is approximately like a <span class="math inline">\(z\)</span>-score with a value of (where <span class="math inline">\(\text{df}\)</span> is the ‚Äòdegrees of freedom‚Äô given in the software output):</li>
</ul>
<p><span class="math display">\[
   \sqrt{\frac{\chi^2}{\text{df}}}.
\]</span></p>
<p>(ref:AboutHypotheses) Sect. @ref(AboutHypotheses)</p>
<p>(ref:TestStatObs) Sect. @ref(TestStatObs)</p>
<p>(ref:AboutCIs) Chap. @ref(AboutCIs)</p>
<p>(ref:StandardError) Def. @ref(def:StandardError)</p>
</div>
<div id="other-formulas" class="section level2" number="20.4">
<h2><span class="header-section-number">20.4</span> Other formulas</h2>
<ul>
<li>To <a href="#EstimatingSampleSize">estimate the sample size needed</a> when <strong>estimating a proportion</strong>: <span class="math inline">\(\displaystyle n = \frac{1}{(\text{Margin of error})^2}\)</span>.</li>
<li>To <a href="#EstimatingSampleSize">estimate the sample size needed</a> when <strong>estimating a mean</strong>: <span class="math inline">\(\displaystyle n = \left( \frac{2\times s}{\text{Margin of error}}\right)^2\)</span>.</li>
<li>To <a href="#z-scores">calculate <span class="math inline">\(z\)</span>-scores</a>: <span class="math inline">\(\displaystyle z = \frac{x - \mu}{\sigma}\)</span> or, more generally, <span class="math inline">\(\displaystyle z = \frac{\text{specific value of variable} - \text{mean of variable}}{\text{measure of variable&#39;s variation}}\)</span>.</li>
<li>The <a href="#Unstandardising"><strong>unstandardizing formula</strong></a>: <span class="math inline">\(x = \mu + (z\times \sigma)\)</span>.</li>
</ul>
<p><strong>Notes:</strong></p>
<ul>
<li>In <strong>sample size calculations</strong>, always <strong>round up</strong> the sample size found from the above formulas.</li>
</ul>
</div>
<div id="other-symbols-used" class="section level2" number="20.5">
<h2><span class="header-section-number">20.5</span> Other symbols used</h2>
<table>
<caption>
(#tab:OtherSymbols)Some symbols used
</caption>
<thead>
<tr>
<th style="text-align:center;font-weight: bold;">
Symbol
</th>
<th style="text-align:left;font-weight: bold;">
Meaning
</th>
<th style="text-align:center;font-weight: bold;">
Reference
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(H_0\)</span>
</td>
<td style="text-align:left;">
Null hypothesis
</td>
<td style="text-align:center;">
(ref:AboutHypotheses)
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(H_1\)</span>
</td>
<td style="text-align:left;">
Alternative hypothesis
</td>
<td style="text-align:center;">
(ref:AboutHypotheses)
</td>
</tr>
<tr>
<td style="text-align:center;">
df
</td>
<td style="text-align:left;">
Degrees of freedom
</td>
<td style="text-align:center;">
(ref:TestStatObs)
</td>
</tr>
<tr>
<td style="text-align:center;">
CI
</td>
<td style="text-align:left;">
Confidence interval
</td>
<td style="text-align:center;">
(ref:AboutCIs)
</td>
</tr>
<tr>
<td style="text-align:center;">
s.e.
</td>
<td style="text-align:left;">
Standard error
</td>
<td style="text-align:center;">
(ref:StandardError)
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(n\)</span>
</td>
<td style="text-align:left;">
Sample size
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\chi^2\)</span>
</td>
<td style="text-align:left;">
The chi-squared test statistic
</td>
<td style="text-align:center;">
(ref:TestStatObs)
</td>
</tr>
</tbody>
</table>
<!--chapter:end:97-symbols-formulas-statistics-parameters.Rmd-->
</div>
</div>
<div id="appendixdatasets" class="section level1" number="21">
<h1><span class="header-section-number">21</span> Datasets</h1>
<p>This section provides information about the datasets used throughout the course. These datasets come from various R packages and are commonly used in statistical analysis and data science education.</p>
<div id="built-in-r-datasets" class="section level2" number="21.1">
<h2><span class="header-section-number">21.1</span> Built-in R Datasets</h2>
<div id="mtcars---motor-trend-car-road-tests" class="section level3" number="21.1.1">
<h3><span class="header-section-number">21.1.1</span> <code>mtcars</code> - Motor Trend Car Road Tests</h3>
<p><strong>Package</strong>: <code>datasets</code><br />
<strong>Description</strong>: Data extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973‚Äì74 models).</p>
<p><strong>Variables</strong>:
- <code>mpg</code>: Miles/(US) gallon
- <code>cyl</code>: Number of cylinders
- <code>disp</code>: Displacement (cu.in.)
- <code>hp</code>: Gross horsepower
- <code>drat</code>: Rear axle ratio
- <code>wt</code>: Weight (1000 lbs)
- <code>qsec</code>: 1/4 mile time
- <code>vs</code>: Engine (0 = V-shaped, 1 = straight)
- <code>am</code>: Transmission (0 = automatic, 1 = manual)
- <code>gear</code>: Number of forward gears
- <code>carb</code>: Number of carburetors</p>
</div>
<div id="iris---edgar-andersons-iris-data" class="section level3" number="21.1.2">
<h3><span class="header-section-number">21.1.2</span> <code>iris</code> - Edgar Anderson‚Äôs Iris Data</h3>
<p><strong>Package</strong>: <code>datasets</code><br />
<strong>Description</strong>: Famous dataset giving the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris.</p>
<p><strong>Variables</strong>:
- <code>Sepal.Length</code>: Sepal length in cm
- <code>Sepal.Width</code>: Sepal width in cm
- <code>Petal.Length</code>: Petal length in cm
- <code>Petal.Width</code>: Petal width in cm
- <code>Species</code>: Species of iris (setosa, versicolor, virginica)</p>
</div>
<div id="cars---speed-and-stopping-distances-of-cars" class="section level3" number="21.1.3">
<h3><span class="header-section-number">21.1.3</span> <code>cars</code> - Speed and Stopping Distances of Cars</h3>
<p><strong>Package</strong>: <code>datasets</code><br />
<strong>Description</strong>: The data give the speed of cars and the distances taken to stop.</p>
<p><strong>Variables</strong>:
- <code>speed</code>: Speed (mph)
- <code>dist</code>: Stopping distance (ft)</p>
</div>
</div>
<div id="course-specific-datasets" class="section level2" number="21.2">
<h2><span class="header-section-number">21.2</span> Course-Specific Datasets</h2>
<div id="bikeshare.csv---bike-sharing-data" class="section level3" number="21.2.1">
<h3><span class="header-section-number">21.2.1</span> <code>bikeshare.csv</code> - Bike Sharing Data</h3>
<p><strong>File</strong>: <code>data/bikeshare.csv</code><br />
<strong>Description</strong>: Dataset containing bike sharing information with various weather and temporal features.</p>
<p><strong>Variables</strong>:
- <code>datetime</code>: Date and time
- <code>season</code>: Season (1:spring, 2:summer, 3:fall, 4:winter)
- <code>holiday</code>: Whether day is holiday or not
- <code>workingday</code>: If day is neither weekend nor holiday
- <code>weather</code>: Weather situation (1: Clear, 2: Mist, 3: Light Snow/Rain, 4: Heavy Rain)
- <code>temp</code>: Temperature in Celsius
- <code>atemp</code>: ‚ÄúFeels like‚Äù temperature in Celsius
- <code>humidity</code>: Relative humidity
- <code>windspeed</code>: Wind speed
- <code>casual</code>: Count of casual users
- <code>registered</code>: Count of registered users
- <code>count</code>: Count of total rental bikes</p>
</div>
<div id="stroke_data.csv---stroke-prediction-data" class="section level3" number="21.2.2">
<h3><span class="header-section-number">21.2.2</span> <code>stroke_data.csv</code> - Stroke Prediction Data</h3>
<p><strong>File</strong>: <code>data/stroke_data.csv</code><br />
<strong>Description</strong>: Dataset for predicting stroke occurrence based on various health indicators.</p>
<p><strong>Variables</strong>:
- <code>id</code>: Unique identifier
- <code>gender</code>: Gender
- <code>age</code>: Age
- <code>hypertension</code>: Hypertension (0: No, 1: Yes)
- <code>heart_disease</code>: Heart disease (0: No, 1: Yes)
- <code>ever_married</code>: Ever married (No, Yes)
- <code>work_type</code>: Type of work
- <code>Residence_type</code>: Residence type (Rural, Urban)
- <code>avg_glucose_level</code>: Average glucose level
- <code>bmi</code>: Body mass index
- <code>smoking_status</code>: Smoking status
- <code>stroke</code>: Stroke (0: No, 1: Yes)</p>
</div>
<div id="coronary.dta---coronary-heart-disease-data" class="section level3" number="21.2.3">
<h3><span class="header-section-number">21.2.3</span> <code>coronary.dta</code> - Coronary Heart Disease Data</h3>
<p><strong>File</strong>: <code>data/coronary.dta</code><br />
<strong>Description</strong>: Dataset containing information about coronary heart disease patients.</p>
<p><strong>Variables</strong>:
- Various medical and demographic variables related to coronary heart disease
- Used for survival analysis and medical statistics</p>
</div>
</div>
<div id="how-to-access-datasets" class="section level2" number="21.3">
<h2><span class="header-section-number">21.3</span> How to Access Datasets</h2>
<div id="built-in-r-datasets-1" class="section level3" number="21.3.1">
<h3><span class="header-section-number">21.3.1</span> Built-in R Datasets</h3>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" tabindex="-1"></a><span class="co"># Load built-in datasets</span></span>
<span id="cb280-2"><a href="#cb280-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb280-3"><a href="#cb280-3" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb280-4"><a href="#cb280-4" tabindex="-1"></a><span class="fu">data</span>(cars)</span>
<span id="cb280-5"><a href="#cb280-5" tabindex="-1"></a></span>
<span id="cb280-6"><a href="#cb280-6" tabindex="-1"></a><span class="co"># View dataset structure</span></span>
<span id="cb280-7"><a href="#cb280-7" tabindex="-1"></a><span class="fu">str</span>(mtcars)</span>
<span id="cb280-8"><a href="#cb280-8" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span></code></pre></div>
</div>
<div id="course-datasets" class="section level3" number="21.3.2">
<h3><span class="header-section-number">21.3.2</span> Course Datasets</h3>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" tabindex="-1"></a><span class="co"># Load course datasets</span></span>
<span id="cb281-2"><a href="#cb281-2" tabindex="-1"></a>bikeshare <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/bikeshare.csv&quot;</span>)</span>
<span id="cb281-3"><a href="#cb281-3" tabindex="-1"></a>stroke_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/stroke_data.csv&quot;</span>)</span>
<span id="cb281-4"><a href="#cb281-4" tabindex="-1"></a></span>
<span id="cb281-5"><a href="#cb281-5" tabindex="-1"></a><span class="co"># View dataset structure</span></span>
<span id="cb281-6"><a href="#cb281-6" tabindex="-1"></a><span class="fu">str</span>(bikeshare)</span>
<span id="cb281-7"><a href="#cb281-7" tabindex="-1"></a><span class="fu">head</span>(bikeshare)</span></code></pre></div>
</div>
</div>
<div id="dataset-usage-in-course" class="section level2" number="21.4">
<h2><span class="header-section-number">21.4</span> Dataset Usage in Course</h2>
<ul>
<li><strong>mtcars</strong>: Used for linear regression examples and correlation analysis</li>
<li><strong>iris</strong>: Used for classification, clustering, and ANOVA examples</li>
<li><strong>cars</strong>: Used for simple linear regression demonstrations</li>
<li><strong>bikeshare</strong>: Used for time series analysis and multiple regression</li>
<li><strong>stroke_data</strong>: Used for logistic regression and classification examples</li>
<li><strong>coronary</strong>: Used for survival analysis examples</li>
</ul>
</div>
<div id="additional-resources-1" class="section level2" number="21.5">
<h2><span class="header-section-number">21.5</span> Additional Resources</h2>
<p>For more information about these datasets:
- R documentation: <code>?mtcars</code>, <code>?iris</code>, <code>?cars</code>
- Course materials and exercises
- Statistical analysis examples in course chapters</p>
<!--chapter:end:98-datasets.Rmd-->
</div>
</div>
<div id="references-2" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="statistical-methods-and-r-programming" class="section level2" number="21.6">
<h2><span class="header-section-number">21.6</span> Statistical Methods and R Programming</h2>
<ul>
<li><p>Everitt, B., Hothorn, T. (2011). <em>An Introduction to Applied Multivariate Analysis with R</em>. Springer-Verlag.</p></li>
<li><p>James, G., Witten, D., Hastie, T., &amp; Tibshirani, R. (2015). <em>An Introduction to Statistical Learning, with Applications in R</em>. Springer.</p></li>
<li><p>Timbers, T., Campbell, T., &amp; Lee, M. (2022). <em>Data Science: A First Introduction</em>. <a href="https://datasciencebook.ca/">Online version</a></p></li>
<li><p>Wickham, H., &amp; Grolemund, G. (2018). <em>R for Data Science</em>. O‚ÄôReilly. <a href="https://r4ds.had.co.nz/index.html">Freely available online</a></p></li>
<li><p>Dauber, D. (2022). <em>R for non-programmers</em>. <a href="https://bookdown.org/daniel_dauber_io/r4np_book/starting-your-r-projects.html">Free book</a></p></li>
</ul>
</div>
<div id="advanced-r-programming" class="section level2" number="21.7">
<h2><span class="header-section-number">21.7</span> Advanced R Programming</h2>
<ul>
<li><p>Higgins, P. D. R. (2022). <em>Reproducible Medical Research with R</em>. <a href="https://bookdown.org/pdr_higgins/rmrwr/">Free book</a></p></li>
<li><p>Armstrong, J. K. (2022). <em>Fundamentals of Wrangling Healthcare Data with R</em>. <a href="https://bookdown.org/jkylearmstrong/jeff_data_wrangling/">Free book</a></p></li>
<li><p>Wickham, H. (2015). <em>Advanced R</em>. CRC Press. <a href="https://adv-r.hadley.nz/">Free book</a></p></li>
</ul>
</div>
<div id="statistical-software-and-tools" class="section level2" number="21.8">
<h2><span class="header-section-number">21.8</span> Statistical Software and Tools</h2>
<ul>
<li><p>R Core Team (2024). <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing, Vienna, Austria.</p></li>
<li><p>RStudio Team (2024). <em>RStudio: Integrated Development Environment for R</em>. RStudio, PBC, Boston, MA.</p></li>
<li><p>Xie, Y., Allaire, J. J., &amp; Grolemund, G. (2018). <em>R Markdown: The Definitive Guide</em>. Chapman and Hall/CRC.</p></li>
</ul>
</div>
<div id="course-materials-1" class="section level2" number="21.9">
<h2><span class="header-section-number">21.9</span> Course Materials</h2>
<ul>
<li><p>Salvini, N. (2025). <em>Statistics &amp; Big Data 25-26 Labs</em>. Course website and materials.</p></li>
<li><p>Dabo-Niang, S. (2025). <em>Advanced Modeling Techniques</em>. Intensive session materials.</p></li>
</ul>
</div>
<div id="additional-resources-2" class="section level2" number="21.10">
<h2><span class="header-section-number">21.10</span> Additional Resources</h2>
<ul>
<li><p>CRAN Task Views: <a href="https://cran.r-project.org/web/views/">https://cran.r-project.org/web/views/</a></p></li>
<li><p>R-bloggers: <a href="https://www.r-bloggers.com/">https://www.r-bloggers.com/</a></p></li>
<li><p>Stack Overflow R Tag: <a href="https://stackoverflow.com/questions/tagged/r">https://stackoverflow.com/questions/tagged/r</a></p></li>
<li><p>R Documentation: <a href="https://www.rdocumentation.org/">https://www.rdocumentation.org/</a></p></li>
</ul>
<!--chapter:end:99-references.Rmd-->
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p><strong>Ucsc?</strong><a href="#fnref1" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p><strong>UCSC?</strong><a href="#fnref2" class="footnote-back">‚Ü©Ô∏é</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistics &amp; Big Data 25-26 Labs</strong>" was written by Dr.¬†Niccol√≤ Salvini. It was last built on 2025-12-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
