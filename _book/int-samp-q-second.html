<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 📚 Additional Practice Exercises for Intermediate Exam | Statistics &amp; Big Data 25-26 Labs</title>
<meta name="author" content="Dr. Niccolò Salvini">
<meta name="description" content="This is a comprehensive collection of practice exercises designed to prepare you for the intermediate exam. These exercises cover all major topics from hypothesis testing to advanced regression...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 11 📚 Additional Practice Exercises for Intermediate Exam | Statistics &amp; Big Data 25-26 Labs">
<meta property="og:type" content="book">
<meta property="og:description" content="This is a comprehensive collection of practice exercises designed to prepare you for the intermediate exam. These exercises cover all major topics from hypothesis testing to advanced regression...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 📚 Additional Practice Exercises for Intermediate Exam | Statistics &amp; Big Data 25-26 Labs">
<meta name="twitter:description" content="This is a comprehensive collection of practice exercises designed to prepare you for the intermediate exam. These exercises cover all major topics from hypothesis testing to advanced regression...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="shortcut icon" href="images/cattolica-logo-favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Statistics &amp; Big Data 25-26 Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> 🫶 About</a></li>
<li class="book-part">Get Started</li>
<li><a class="" href="prereq.html"><span class="header-section-number">2</span> ✨Prerequisites</a></li>
<li><a class="" href="r-packages.html"><span class="header-section-number">3</span> 📦 R Packages</a></li>
<li><a class="" href="nice-warm-up.html"><span class="header-section-number">4</span> 🔥 Nice warm-up</a></li>
<li><a class="" href="syllabus.html"><span class="header-section-number">5</span> 🗒️ Syllabus</a></li>
<li class="book-part">Part 1: The Foundations</li>
<li><a class="" href="hypothesis-testing-fundamentals.html"><span class="header-section-number">6</span> 🧪 Hypothesis Testing Fundamentals</a></li>
<li><a class="" href="linear-regression-analysis.html"><span class="header-section-number">7</span> 📈 Linear Regression Analysis</a></li>
<li><a class="" href="advanced-statistical-methods.html"><span class="header-section-number">8</span> 🔬 Advanced Statistical Methods</a></li>
<li class="book-part">Part 2: Advanced Modeling</li>
<li><a class="" href="advanced-modeling-techniques.html"><span class="header-section-number">9</span> 🚀 Advanced Modeling Techniques</a></li>
<li class="book-part">Additional Resources</li>
<li><a class="" href="int-prep.html"><span class="header-section-number">10</span> 💻 Intermediate preparation</a></li>
<li><a class="active" href="int-samp-q-second.html"><span class="header-section-number">11</span> 📚 Additional Practice Exercises for Intermediate Exam</a></li>
<li><a class="" href="int-samp-q.html"><span class="header-section-number">12</span> 💻 Intermediate Sample Questions</a></li>
<li><a class="" href="course-performance.html"><span class="header-section-number">13</span> ⚡ Course Performance</a></li>
<li><a class="" href="frequently-asked-questions.html"><span class="header-section-number">14</span> ❓ Frequently Asked Questions</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="StatisticsAndParameters.html"><span class="header-section-number">15</span> Symbols, formulas, statistics and parameters</a></li>
<li><a class="" href="appendixdatasets.html"><span class="header-section-number">16</span> Datasets</a></li>
<li><a class="" href="references-2.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NiccoloSalvini/sbd_25_26">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="int-samp-q-second" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> 📚 Additional Practice Exercises for Intermediate Exam<a class="anchor" aria-label="anchor" href="#int-samp-q-second"><i class="fas fa-link"></i></a>
</h1>
<p>This is a comprehensive collection of practice exercises designed to prepare you for the intermediate exam. These exercises cover all major topics from hypothesis testing to advanced regression techniques, with a focus on healthcare and biomedical data analysis.</p>
<p><strong>Instructions</strong>: Try to solve all exercises on your own first. Solutions are provided at the end of this chapter.</p>
<div id="part-1-data-wrangling-and-descriptive-statistics" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> 🏥 Part 1: Data Wrangling and Descriptive Statistics<a class="anchor" aria-label="anchor" href="#part-1-data-wrangling-and-descriptive-statistics"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add1" class="exercise"><strong>Exercise 11.1  </strong></span>Load the built-in dataset <code>airquality</code> and remove all rows with missing values. How many complete observations remain?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add63" class="exercise"><strong>Exercise 11.2  </strong></span>Using the <code>chickwts</code> dataset, create a summary table that shows the number of chicks, the mean weight, and the standard deviation of weight for each <code>feed</code> type.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add64" class="exercise"><strong>Exercise 11.3  </strong></span>You are given a <code>blood_pressure</code> dataframe. It contains patient IDs and two separate columns for systolic and diastolic blood pressure readings (<code>systolic</code>, <code>diastolic</code>). Reshape the data into a “long” format with three columns: <code>patient_id</code>, <code>bp_type</code> (containing “systolic” or “diastolic”), and <code>value</code>.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">blood_pressure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  systolic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">135</span>, <span class="fl">122</span>, <span class="fl">140</span>, <span class="fl">130</span><span class="op">)</span>,</span>
<span>  diastolic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">88</span>, <span class="fl">82</span>, <span class="fl">90</span>, <span class="fl">85</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add2" class="exercise"><strong>Exercise 11.4  </strong></span>Using the <code>mtcars</code> dataset, create a new variable called <code>efficiency</code> that categorizes cars as “High” if <code>mpg &gt; 20</code> and “Low” otherwise. How many cars are in the “High” efficiency category?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add3" class="exercise"><strong>Exercise 11.5  </strong></span>Write the R command to calculate the mean, median, and standard deviation of a variable called <code>blood_pressure</code> in a dataset named <code>health_data</code>.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add4" class="exercise"><strong>Exercise 11.6  </strong></span>Given a healthcare dataset, <code>health_data</code>, with variables <code>patient_id</code>, <code>age</code>, <code>treatment</code> (A or B), and <code>recovery_days</code>, write the R command to create a summary table showing the mean recovery days for each treatment group. For reproducibility, first create the <code>health_data</code> dataframe with the following code:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">health_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  recovery_days <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add51" class="exercise"><strong>Exercise 11.7  </strong></span>From a <code>patients</code> dataset with columns <code>patient_id</code>, <code>age</code>, <code>sex</code>, <code>diagnosis_code</code>, and <code>hospital_stay_days</code>, write a <code>dplyr</code> pipeline to find the average hospital stay for male patients over 65 for each diagnosis code, showing only diagnoses with more than 10 such patients.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add65" class="exercise"><strong>Exercise 11.8  </strong></span>A hospital needs to calculate personalized medication dosages. Given a <code>medication_data</code> dataframe with columns <code>patient_id</code>, <code>weight_kg</code>, <code>age</code>, and <code>base_dose_mg</code>, create a new column <code>adjusted_dose</code> that calculates 1.5 mg per kg of body weight, with a maximum dose of 200mg. First create the dataframe:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">medication_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  weight_kg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">75</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">18</span><span class="op">:</span><span class="fl">80</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  base_dose_mg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add66" class="exercise"><strong>Exercise 11.9  </strong></span>You have ICU monitoring data in long format. The <code>icu_data</code> dataframe contains <code>patient_id</code>, <code>measurement_time</code> (with values “admission”, “24h”, “48h”), <code>temperature</code>, and <code>blood_pressure</code>. Reshape this data into wide format so that each patient has one row with separate columns for each measurement time. First create the data:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">321</span><span class="op">)</span></span>
<span><span class="va">icu_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  measurement_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"admission"</span>, <span class="st">"24h"</span>, <span class="st">"48h"</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  temperature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">37</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  blood_pressure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">120</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add67" class="exercise"><strong>Exercise 11.10  </strong></span>From a <code>lab_results</code> dataset with columns <code>patient_id</code>, <code>test_date</code>, <code>cholesterol</code>, <code>glucose</code>, and <code>test_type</code>, filter to include only patients who have had both “fasting” and “non-fasting” tests, and calculate the difference in their glucose levels between these two test types. Write the <code>dplyr</code> pipeline.</p>
</div>
<hr>
</div>
<div id="part-2-hypothesis-testing---single-population" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> 🔬 Part 2: Hypothesis Testing - Single Population<a class="anchor" aria-label="anchor" href="#part-2-hypothesis-testing---single-population"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add5" class="exercise"><strong>Exercise 11.11  </strong></span>A hospital claims that the average waiting time in their emergency room is 45 minutes. A random sample of 50 patients showed a mean waiting time of 52 minutes with a standard deviation of 12 minutes. Test at α = 0.05 if the actual waiting time is significantly different from the claimed 45 minutes. Write the R command to perform this test.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add6" class="exercise"><strong>Exercise 11.12  </strong></span>A pharmaceutical company claims that 75% of patients experience relief from headaches within 30 minutes of taking their new medication. In a sample of 200 patients, 140 reported relief within 30 minutes. Test if the actual proportion is significantly different from 75%. Write the appropriate R command.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add7" class="exercise"><strong>Exercise 11.13  </strong></span>Without using formulas, explain the difference between Type I and Type II errors in hypothesis testing.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add8" class="exercise"><strong>Exercise 11.14  </strong></span>A medical study tests whether the average cholesterol level in a population is greater than 200 mg/dL. The p-value obtained is 0.032. At a significance level of 0.05, what is your decision and conclusion?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add62" class="exercise"><strong>Exercise 11.15  </strong></span>A pharmaceutical company has developed a new drug to increase T-cell count in patients. A clinically significant improvement is defined as a mean increase of at least 150 cells/µL. In a sample of 35 patients, the mean increase was 162 cells/µL with a standard deviation of 40. Write the R code to test if the drug produces a clinically significant improvement. Explain your choice of a one-sided test.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add52" class="exercise"><strong>Exercise 11.16  </strong></span>A new drug is tested to reduce systolic blood pressure. The mean reduction in a sample of 40 patients is 8.5 mmHg with a standard deviation of 10 mmHg. A reduction of at least 10 mmHg is considered clinically significant. Perform a one-sample t-test to check if the mean reduction is less than 10 mmHg. Write the R code and interpret the p-value in the context of clinical significance.</p>
</div>
<hr>
</div>
<div id="part-3-hypothesis-testing---two-populations" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> 👥 Part 3: Hypothesis Testing - Two Populations<a class="anchor" aria-label="anchor" href="#part-3-hypothesis-testing---two-populations"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add9" class="exercise"><strong>Exercise 11.17  </strong></span>A clinical trial compares two different treatments for hypertension. Group A (n=30) has a mean blood pressure reduction of 15 mmHg (sd=5), while Group B (n=35) has a mean reduction of 12 mmHg (sd=6). Assume equal variances. Write the R command to test if there is a significant difference between the two treatments.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add10" class="exercise"><strong>Exercise 11.18  </strong></span>A hospital is testing a new training program for nurses. The same 20 nurses took a competency test before and after the training. The data is as follows:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nurse_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  nurse_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span>
<span>  before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">72</span>, <span class="fl">68</span>, <span class="fl">75</span>, <span class="fl">70</span>, <span class="fl">73</span>, <span class="fl">69</span>, <span class="fl">71</span>, <span class="fl">74</span>, <span class="fl">68</span>, <span class="fl">72</span>, </span>
<span>             <span class="fl">70</span>, <span class="fl">73</span>, <span class="fl">69</span>, <span class="fl">71</span>, <span class="fl">74</span>, <span class="fl">72</span>, <span class="fl">70</span>, <span class="fl">68</span>, <span class="fl">73</span>, <span class="fl">71</span><span class="op">)</span>,</span>
<span>  after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78</span>, <span class="fl">74</span>, <span class="fl">80</span>, <span class="fl">76</span>, <span class="fl">79</span>, <span class="fl">75</span>, <span class="fl">77</span>, <span class="fl">80</span>, <span class="fl">74</span>, <span class="fl">78</span>, </span>
<span>            <span class="fl">76</span>, <span class="fl">79</span>, <span class="fl">75</span>, <span class="fl">77</span>, <span class="fl">80</span>, <span class="fl">78</span>, <span class="fl">76</span>, <span class="fl">74</span>, <span class="fl">79</span>, <span class="fl">77</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Test if the training program significantly improved the test scores. Write the appropriate R command and state whether this should be a paired or unpaired test.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add11" class="exercise"><strong>Exercise 11.19  </strong></span>Two hospitals are comparing their patient satisfaction rates. Hospital A reports that 180 out of 250 patients (72%) were satisfied, while Hospital B reports that 210 out of 280 patients (75%) were satisfied. Write the R command to test if there is a significant difference in satisfaction rates between the two hospitals.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add12" class="exercise"><strong>Exercise 11.20  </strong></span>A researcher wants to compare the effectiveness of three different diets (A, B, and C) on weight loss. Given the following data, can you determine if this requires a t-test or ANOVA? Explain why.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diet_study</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  diet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>  weight_loss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>  <span class="co"># 45 observations total</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add53" class="exercise"><strong>Exercise 11.21  </strong></span>A study compares the cholesterol levels of patients in two different clinics. Before running a t-test, you perform a Levene’s test for equality of variances and get a p-value of 0.02. Which type of two-sample t-test should you use and why? Write the R command for the appropriate t-test, assuming you have a <code>cholesterol_data</code> dataframe with <code>level</code> and <code>clinic</code> columns.</p>
</div>
<hr>
</div>
<div id="part-4-anova---comparing-multiple-groups" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> 📊 Part 4: ANOVA - Comparing Multiple Groups<a class="anchor" aria-label="anchor" href="#part-4-anova---comparing-multiple-groups"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add13" class="exercise"><strong>Exercise 11.22  </strong></span>Using the built-in <code>PlantGrowth</code> dataset in R, test if there is a significant difference in plant weight across the three treatment groups. Write the R command and report the p-value.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add14" class="exercise"><strong>Exercise 11.23  </strong></span>A medical study examines the effect of four different medications on reducing fever. The temperature reduction (in degrees Celsius) for patients in each group is recorded:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fever_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  medication <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Med_A"</span>, <span class="st">"Med_B"</span>, <span class="st">"Med_C"</span>, <span class="st">"Med_D"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  temp_reduction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="fl">1.3</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.4</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span>,  <span class="co"># Med_A</span></span>
<span>    <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">2.1</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>,  <span class="co"># Med_B</span></span>
<span>    <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">1.3</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>,  <span class="co"># Med_C</span></span>
<span>    <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>, <span class="fl">2.6</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>   <span class="co"># Med_D</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Perform an ANOVA test to determine if there are significant differences among the medications. What is the F-statistic?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add15" class="exercise"><strong>Exercise 11.24  </strong></span>After conducting an ANOVA test that shows significant differences among groups, what additional analysis would you perform to identify which specific groups differ from each other?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add54" class="exercise"><strong>Exercise 11.25  </strong></span>After running an ANOVA on the effect of three different physical therapy routines (<code>RoutineA</code>, <code>RoutineB</code>, <code>RoutineC</code>) on recovery time, you get a significant p-value. The subsequent Tukey’s HSD test gives the following output. Which routines are significantly different from each other, and what does the <code>diff</code> column represent?</p>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = recovery_time ~ routine)

$routine
                     diff       lwr       upr     p adj
RoutineB-RoutineA  -5.231 -8.992618 -1.469382 0.0045121
RoutineC-RoutineA   1.543 -2.218618  5.304618 0.5694884
RoutineC-RoutineB   6.774  3.012382 10.535618 0.0002196</code></pre>
</div>
<hr>
</div>
<div id="part-5-simple-and-multiple-linear-regression" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> 📈 Part 5: Simple and Multiple Linear Regression<a class="anchor" aria-label="anchor" href="#part-5-simple-and-multiple-linear-regression"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add16" class="exercise"><strong>Exercise 11.26  </strong></span>Using the <code>mtcars</code> dataset, estimate a simple linear regression model where <code>mpg</code> (miles per gallon) is predicted by <code>wt</code> (weight). What is the interpretation of the slope coefficient?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add17" class="exercise"><strong>Exercise 11.27  </strong></span>A researcher collects data on hospital readmission rates. They want to predict the <code>readmission_rate</code> (percentage) based on <code>bed_count</code>, <code>nurse_ratio</code> (nurses per patient), and <code>avg_stay</code> (average length of stay). Write the R command to estimate this multiple regression model, assuming the data is in a dataframe called <code>hospital_data</code>.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add18" class="exercise"><strong>Exercise 11.28  </strong></span>In a multiple linear regression model predicting patient recovery time based on age, BMI, and exercise hours, you obtain the following VIF values:
- age: VIF = 2.3
- BMI: VIF = 12.5
- exercise: VIF = 2.1</p>
<p>Which variable(s) might be problematic due to multicollinearity, and what would you recommend?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add19" class="exercise"><strong>Exercise 11.29  </strong></span>Using the <code>mtcars</code> dataset, estimate a multiple regression model: <code>mpg ~ wt + hp + cyl</code>. After checking for significance and multicollinearity, you find that <code>cyl</code> has a p-value of 0.85 and high VIF. What should you do next?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add20" class="exercise"><strong>Exercise 11.30  </strong></span>Explain the difference between R-squared and Adjusted R-squared. Why is Adjusted R-squared particularly important in multiple regression?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add21" class="exercise"><strong>Exercise 11.31  </strong></span>Given the following regression output for predicting systolic blood pressure:</p>
<pre><code>Coefficients:
              Estimate  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)   90.234    5.123       17.61    &lt; 2e-16 ***
age           0.652     0.085        7.67    1.2e-11 ***
weight        0.234     0.045        5.20    8.3e-07 ***
exercise     -1.234     0.312       -3.95    0.00015 ***

Residual standard error: 8.5 on 146 degrees of freedom
Multiple R-squared:  0.5234,    Adjusted R-squared:  0.5136
F-statistic: 53.45 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>What is the predicted systolic blood pressure for a 50-year-old person weighing 75 kg who exercises 5 hours per week?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add22" class="exercise"><strong>Exercise 11.32  </strong></span>In the regression output from the previous exercise, which variable has the strongest effect on blood pressure? How did you determine this?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add55" class="exercise"><strong>Exercise 11.33  </strong></span>You are modeling the length of a hospital stay (<code>los</code>) based on <code>age</code> and <code>infection_status</code> (1=yes, 0=no). You suspect that the effect of age on the length of stay is different for patients with and without an infection. How would you specify this in an R model? Write the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> command and explain how to interpret the interaction term’s coefficient if it is significant. Assume you have a <code>hospital_data</code> dataframe with <code>los</code>, <code>age</code>, and <code>infection_status</code>.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add68" class="exercise"><strong>Exercise 11.34  </strong></span>A medical researcher collects data on resting heart rate and wants to predict it based on age, weekly exercise hours, and daily caffeine consumption. The data is as follows:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">heart_rate_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">70</span>, <span class="fl">80</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  exercise_hours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  caffeine_mg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">400</span>, <span class="fl">80</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">heart_rate_data</span><span class="op">$</span><span class="va">heart_rate</span> <span class="op">&lt;-</span> <span class="fl">60</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">heart_rate_data</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> </span>
<span>                               <span class="fl">1.2</span> <span class="op">*</span> <span class="va">heart_rate_data</span><span class="op">$</span><span class="va">exercise_hours</span> <span class="op">+</span> </span>
<span>                               <span class="fl">0.02</span> <span class="op">*</span> <span class="va">heart_rate_data</span><span class="op">$</span><span class="va">caffeine_mg</span> <span class="op">+</span> </span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Fit a multiple linear regression model and predict the heart rate for a 45-year-old person who exercises 3 hours per week and consumes 200mg of caffeine daily.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add69" class="exercise"><strong>Exercise 11.35  </strong></span>You have data on systolic blood pressure and want to model it based on age, BMI, and smoking status (Never, Former, Current). Create the following dataset and fit a multiple regression model:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">654</span><span class="op">)</span></span>
<span><span class="va">bmi_bp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">120</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">55</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  bmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">27</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  smoking <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Never"</span>, <span class="st">"Former"</span>, <span class="st">"Current"</span><span class="op">)</span>, <span class="fl">120</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">systolic_bp</span> <span class="op">&lt;-</span> <span class="fl">90</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">age</span> <span class="op">+</span> </span>
<span>                            <span class="fl">1.8</span> <span class="op">*</span> <span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">bmi</span> <span class="op">+</span></span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">smoking</span> <span class="op">==</span> <span class="st">"Current"</span>, <span class="fl">12</span>,</span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">smoking</span> <span class="op">==</span> <span class="st">"Former"</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p>What is the predicted systolic blood pressure for a 60-year-old patient with BMI of 30 who is a current smoker? How do you interpret the coefficient for smoking status?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add70" class="exercise"><strong>Exercise 11.36  </strong></span>A hospital administrator wants to predict the time until readmission based on initial length of stay, number of comorbidities, and patient age. Create and analyze this dataset:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">987</span><span class="op">)</span></span>
<span><span class="va">readmission_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  initial_los <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  num_comorbidities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">68</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">readmission_data</span><span class="op">$</span><span class="va">readmission_days</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="op">+</span> </span>
<span>                                     <span class="fl">2.5</span> <span class="op">*</span> <span class="va">readmission_data</span><span class="op">$</span><span class="va">initial_los</span> <span class="op">+</span></span>
<span>                                     <span class="fl">3.2</span> <span class="op">*</span> <span class="va">readmission_data</span><span class="op">$</span><span class="va">num_comorbidities</span> <span class="op">+</span></span>
<span>                                     <span class="fl">0.3</span> <span class="op">*</span> <span class="va">readmission_data</span><span class="op">$</span><span class="va">age</span> <span class="op">+</span></span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p>Fit a multiple regression model, check for multicollinearity using VIF, and interpret which variable has the strongest effect on readmission time.</p>
</div>
<hr>
</div>
<div id="part-6-nonlinear-regression-and-transformations" class="section level2" number="11.6">
<h2>
<span class="header-section-number">11.6</span> 🔄 Part 6: Nonlinear Regression and Transformations<a class="anchor" aria-label="anchor" href="#part-6-nonlinear-regression-and-transformations"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add23" class="exercise"><strong>Exercise 11.37  </strong></span>You want to model the relationship between BMI and the risk of diabetes, but the relationship appears to be quadratic. Write the R command to estimate a polynomial regression model with BMI and BMI² as predictors, assuming your data is in a <code>model_data</code> dataframe.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add24" class="exercise"><strong>Exercise 11.38  </strong></span>Given a variable <code>income</code> that is highly right-skewed, what transformation would you typically apply to make it more normally distributed for regression analysis? Write the R command to create this transformed variable.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add25" class="exercise"><strong>Exercise 11.39  </strong></span>Using the <code>mtcars</code> dataset, create a model predicting <code>mpg</code> using both <code>wt</code> and <code>wt²</code> (weight squared). Write the complete R commands needed.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add56" class="exercise"><strong>Exercise 11.40  </strong></span>In a model predicting <code>blood_pressure</code> from <code>log(body_weight)</code>, the coefficient for <code>log(body_weight)</code> is 15.3. How do you interpret this coefficient?</p>
</div>
<hr>
</div>
<div id="part-7-logistic-regression" class="section level2" number="11.7">
<h2>
<span class="header-section-number">11.7</span> 🎯 Part 7: Logistic Regression<a class="anchor" aria-label="anchor" href="#part-7-logistic-regression"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add26" class="exercise"><strong>Exercise 11.41  </strong></span>A study examines factors affecting whether a patient develops a certain disease (yes/no). The predictors are age, BMI, and smoking status (0=non-smoker, 1=smoker). Write the R command to estimate a logistic regression model with <code>disease</code> as the outcome variable, assuming the data is in a dataframe called <code>health_data</code>.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add27" class="exercise"><strong>Exercise 11.42  </strong></span>In logistic regression, what does an odds ratio of 2.5 for the variable “smoking” mean in practical terms?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add28" class="exercise"><strong>Exercise 11.43  </strong></span>You have a dataset with a binary outcome <code>survived</code> (1=yes, 0=no) and predictors <code>age</code>, <code>treatment_type</code>, and <code>severity_score</code>. After fitting a logistic regression model, you get a coefficient of -0.05 for age. What does this negative coefficient indicate?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add29" class="exercise"><strong>Exercise 11.44  </strong></span>What is the key difference between linear regression and logistic regression in terms of what they predict?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add30" class="exercise"><strong>Exercise 11.45  </strong></span>Using the built-in <code>mtcars</code> dataset, create a binary variable <code>high_mpg</code> (1 if mpg &gt; 20, 0 otherwise) and estimate a logistic regression model predicting <code>high_mpg</code> based on <code>wt</code> and <code>hp</code>. Write the R commands.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add57" class="exercise"><strong>Exercise 11.46  </strong></span>Using the logistic regression model from Exercise <a href="int-samp-q-second.html#exr:add30">11.45</a> (<code>high_mpg ~ wt + hp</code>), write the R code to predict the probability of having high MPG for a car with <code>wt = 2.8</code> and <code>hp = 150</code>.</p>
</div>
<hr>
</div>
<div id="part-8-poisson-regression" class="section level2" number="11.8">
<h2>
<span class="header-section-number">11.8</span> 📊 Part 8: Poisson Regression<a class="anchor" aria-label="anchor" href="#part-8-poisson-regression"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add31" class="exercise"><strong>Exercise 11.47  </strong></span>A hospital administrator wants to model the number of emergency room visits per day based on day of the week and weather conditions. What type of regression model is most appropriate for count data like this? Assume the data is in <code>hospital_data</code>.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add32" class="exercise"><strong>Exercise 11.48  </strong></span>You have data on the number of hospital-acquired infections (<code>infection_count</code>) and want to predict it based on <code>bed_occupancy_rate</code> and <code>nurse_staff_ratio</code>. Write the R command to fit a Poisson regression model, assuming the data is in <code>hospital_data</code>.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add33" class="exercise"><strong>Exercise 11.49  </strong></span>What is the primary assumption of Poisson regression regarding the relationship between the mean and variance of the outcome variable?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add58" class="exercise"><strong>Exercise 11.50  </strong></span>You fit a Poisson model to predict the number of asthma-related ER visits. The residual deviance is 150 on 80 degrees of freedom. What does this suggest about your model, and what alternative model should you consider? Write the R command for fitting this alternative model, assuming the data is in <code>hospital_data</code>.</p>
</div>
<hr>
</div>
<div id="part-9-regression-with-dummy-variables" class="section level2" number="11.9">
<h2>
<span class="header-section-number">11.9</span> 🏷️ Part 9: Regression with Dummy Variables<a class="anchor" aria-label="anchor" href="#part-9-regression-with-dummy-variables"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add34" class="exercise"><strong>Exercise 11.51  </strong></span>A dataset contains a variable <code>blood_type</code> with categories: A, B, AB, and O. You want to include this in a regression model predicting cholesterol levels. How many dummy variables do you need to create, and why?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add35" class="exercise"><strong>Exercise 11.52  </strong></span>You have a dataset with the following variables:
- <code>recovery_time</code> (continuous outcome)
- <code>age</code> (continuous)
- <code>treatment</code> (categorical: “Standard”, “Experimental”, “Control”)</p>
<p>Write the R command to create a regression model that includes the categorical treatment variable.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add36" class="exercise"><strong>Exercise 11.53  </strong></span>In a regression model with a categorical variable “hospital_ward” (ICU, Surgery, General), you create dummy variables. The regression output shows:</p>
<pre><code>Coefficients:
                      Estimate  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)           12.5      1.2         10.42    &lt; 2e-16 ***
ward_Surgery          -2.3      0.8         -2.88    0.0045 **
ward_ICU              4.7       0.9          5.22    &lt; 0.0001 ***</code></pre>
<p>If “General” is the reference category, what is the predicted value for a patient in the Surgery ward (assuming no other predictors)?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add37" class="exercise"><strong>Exercise 11.54  </strong></span>Using the <code>mtcars</code> dataset, the variable <code>am</code> is binary (0=automatic, 1=manual). Create a regression model predicting <code>mpg</code> based on <code>wt</code>, <code>hp</code>, and <code>am</code>. Write the R command.</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add38" class="exercise"><strong>Exercise 11.55  </strong></span>In a model with a dummy variable for gender (male=1, female=0) predicting salary, the coefficient for gender is 5000. What does this mean?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add59" class="exercise"><strong>Exercise 11.56  </strong></span>In a model predicting <code>patient_satisfaction</code> (scale 1-100), you include a dummy variable <code>has_private_room</code> (1=yes, 0=no). The intercept of the model is 75.2. How do you interpret this intercept value?</p>
</div>
<hr>
</div>
<div id="part-10-model-diagnostics-and-interpretation" class="section level2" number="11.10">
<h2>
<span class="header-section-number">11.10</span> 🧮 Part 10: Model Diagnostics and Interpretation<a class="anchor" aria-label="anchor" href="#part-10-model-diagnostics-and-interpretation"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:add39" class="exercise"><strong>Exercise 11.57  </strong></span>What are the four main assumptions that should be checked for linear regression models?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add40" class="exercise"><strong>Exercise 11.58  </strong></span>You fit a regression model and obtain an R² of 0.85 and an Adjusted R² of 0.83. You have 100 observations. Approximately how many predictors are in your model? (Hint: use the relationship between R² and Adjusted R²)</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add41" class="exercise"><strong>Exercise 11.59  </strong></span>A researcher finds that in their regression model, the residuals show a clear funnel shape when plotted against fitted values. What problem does this indicate, and what might be a solution?</p>
</div>
<hr>
<div class="exercise">
<p><span id="exr:add42" class="exercise"><strong>Exercise 11.60  </strong></span>Using the <code>mtcars</code> dataset, fit a model <code>mpg ~ wt + hp</code> and create diagnostic plots using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function. Write the R commands.</p>
</div>
<hr>
<hr>
</div>
<div id="solutions-1" class="section level2" number="11.11">
<h2>
<span class="header-section-number">11.11</span> ✅ SOLUTIONS<a class="anchor" aria-label="anchor" href="#solutions-1"><i class="fas fa-link"></i></a>
</h2>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add1">11.1</a>:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span>
<span><span class="va">complete_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">complete_data</span><span class="op">)</span></span></code></pre></div>
<p>Result: <strong>111</strong> complete observations remain.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add63">11.2</a>:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">chickwts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">feed</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">weight</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add64">11.3</a>:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">blood_pressure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  systolic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">135</span>, <span class="fl">122</span>, <span class="fl">140</span>, <span class="fl">130</span><span class="op">)</span>,</span>
<span>  diastolic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">88</span>, <span class="fl">82</span>, <span class="fl">90</span>, <span class="fl">85</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">blood_pressure_long</span> <span class="op">&lt;-</span> <span class="va">blood_pressure</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">systolic</span>, <span class="va">diastolic</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"bp_type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">blood_pressure_long</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add2">11.4</a>:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">efficiency</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&gt;</span> <span class="fl">20</span>, <span class="st">"High"</span>, <span class="st">"Low"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">efficiency</span><span class="op">)</span></span></code></pre></div>
<p>Result: <strong>14</strong> cars are in the “High” efficiency category.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add3">11.5</a>:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, let's create a sample health_data dataframe for the example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">health_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  blood_pressure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">120</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">health_data</span><span class="op">$</span><span class="va">blood_pressure</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">health_data</span><span class="op">$</span><span class="va">blood_pressure</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">health_data</span><span class="op">$</span><span class="va">blood_pressure</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or all at once:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">health_data</span><span class="op">$</span><span class="va">blood_pressure</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add4">11.6</a>:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="co"># Create the dataframe as specified in the exercise</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">health_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  recovery_days <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">health_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_recovery <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">recovery_days</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or base R:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">recovery_days</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">health_data</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add51">11.7</a>:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="co"># First, create sample data for the example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">patients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">200</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">40</span><span class="op">:</span><span class="fl">85</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  diagnosis_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D001"</span>, <span class="st">"D002"</span>, <span class="st">"D003"</span>, <span class="st">"D004"</span>, <span class="st">"D005"</span><span class="op">)</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  hospital_stay_days <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert sex to factor (important for filtering)</span></span>
<span><span class="va">patients</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">patients</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Solution using dplyr pipeline</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">patients</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"M"</span>, <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">65</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">diagnosis_code</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n_patients <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    avg_stay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hospital_stay_days</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n_patients</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p><strong>Key points</strong>:
- Convert categorical variables to factors first for clearer filtering
- Use <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> to select male patients over 65
- Use <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> to calculate statistics by diagnosis
- Filter again to show only diagnoses with more than 10 patients</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add65">11.8</a>:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">medication_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  weight_kg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">75</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">18</span><span class="op">:</span><span class="fl">80</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  base_dose_mg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate adjusted dose with maximum cap</span></span>
<span><span class="va">medication_data</span> <span class="op">&lt;-</span> <span class="va">medication_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>adjusted_dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span><span class="op">(</span><span class="va">weight_kg</span> <span class="op">*</span> <span class="fl">1.5</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">medication_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check that no dose exceeds 200mg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">medication_data</span><span class="op">$</span><span class="va">adjusted_dose</span><span class="op">)</span></span></code></pre></div>
<p><strong>Explanation</strong>: The <code><a href="https://rdrr.io/r/base/Extremes.html">pmin()</a></code> function compares element-wise and returns the minimum value between <code>weight_kg * 1.5</code> and 200, ensuring no dose exceeds the maximum.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add66">11.9</a>:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">321</span><span class="op">)</span></span>
<span><span class="va">icu_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  measurement_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"admission"</span>, <span class="st">"24h"</span>, <span class="st">"48h"</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  temperature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">37</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  blood_pressure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">120</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reshape to wide format</span></span>
<span><span class="va">icu_wide</span> <span class="op">&lt;-</span> <span class="va">icu_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="va">patient_id</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">measurement_time</span>,</span>
<span>    values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">temperature</span>, <span class="va">blood_pressure</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">icu_wide</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">icu_wide</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Should be 30 rows, 7 columns</span></span></code></pre></div>
<p><strong>Explanation</strong>: <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> creates separate columns for each combination of measurement time and variable (temperature/blood_pressure), resulting in columns like <code>temperature_admission</code>, <code>temperature_24h</code>, <code>blood_pressure_admission</code>, etc.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add67">11.10</a>:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First, create sample lab_results data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">654</span><span class="op">)</span></span>
<span><span class="va">lab_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  test_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  test_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fasting"</span>, <span class="st">"non-fasting"</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  cholesterol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  glucose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">95</span>, <span class="fl">10</span><span class="op">)</span>,   <span class="co"># fasting glucose (lower)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">125</span>, <span class="fl">15</span><span class="op">)</span>   <span class="co"># non-fasting glucose (higher)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Solution: Find patients with both test types and calculate glucose difference</span></span>
<span><span class="va">glucose_diff</span> <span class="op">&lt;-</span> <span class="va">lab_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Keep only patients who have both test types</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">patient_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">test_type</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Reshape to wide format to calculate difference</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">patient_id</span>, <span class="va">test_type</span>, <span class="va">glucose</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">test_type</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">glucose</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>glucose_difference <span class="op">=</span> <span class="va">`non-fasting`</span> <span class="op">-</span> <span class="va">fasting</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">glucose_diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternative solution without pivot_wider</span></span>
<span><span class="va">glucose_diff_alt</span> <span class="op">&lt;-</span> <span class="va">lab_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">patient_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">test_type</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    fasting_glucose <span class="op">=</span> <span class="va">glucose</span><span class="op">[</span><span class="va">test_type</span> <span class="op">==</span> <span class="st">"fasting"</span><span class="op">]</span>,</span>
<span>    non_fasting_glucose <span class="op">=</span> <span class="va">glucose</span><span class="op">[</span><span class="va">test_type</span> <span class="op">==</span> <span class="st">"non-fasting"</span><span class="op">]</span>,</span>
<span>    glucose_difference <span class="op">=</span> <span class="va">non_fasting_glucose</span> <span class="op">-</span> <span class="va">fasting_glucose</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">glucose_diff_alt</span><span class="op">)</span></span></code></pre></div>
<p><strong>Explanation</strong>: First filter for patients with both test types using <code><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct()</a></code>, then reshape data or use conditional indexing to calculate the difference between fasting and non-fasting glucose levels.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add5">11.11</a>:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the sample data</span></span>
<span><span class="va">waiting_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">52</span>, sd <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>  <span class="co"># Simulated data</span></span>
<span></span>
<span><span class="co"># Perform one-sample t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">waiting_time</span>, mu <span class="op">=</span> <span class="fl">45</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or if you have the actual data vector:</span></span>
<span><span class="co"># t.test(sample_waiting_times, mu = 45, alternative = "two.sided")</span></span></code></pre></div>
<p>This is a one-sample t-test because we’re comparing the sample mean to a known population value (45 minutes).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add6">11.12</a>:</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Proportion test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">140</span>, n <span class="op">=</span> <span class="fl">200</span>, p <span class="op">=</span> <span class="fl">0.75</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span></code></pre></div>
<p>The null hypothesis is H0: p = 0.75. The sample proportion is 140/200 = 0.70 (70%).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add7">11.13</a>:</p>
<p><strong>Type I Error (α)</strong>: Rejecting the null hypothesis when it is actually true. This is a “false positive” - concluding there is an effect when there isn’t one. The probability of Type I error is the significance level (usually 0.05).</p>
<p><strong>Type II Error (β)</strong>: Failing to reject the null hypothesis when it is actually false. This is a “false negative” - missing a real effect. The probability of Type II error is related to the power of the test (Power = 1 - β).</p>
<p>Example in healthcare: Type I error would be concluding a drug works when it doesn’t; Type II error would be concluding a drug doesn’t work when it actually does.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add8">11.14</a>:</p>
<p><strong>Decision</strong>: Reject the null hypothesis.</p>
<p><strong>Conclusion</strong>: Since p-value (0.032) &lt; α (0.05), we reject H0. There is sufficient evidence to conclude that the average cholesterol level in the population is significantly greater than 200 mg/dL.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add62">11.15</a>:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># H0: mu &lt;= 150 (The mean increase is not clinically significant)</span></span>
<span><span class="co"># Ha: mu &gt; 150 (The mean increase is clinically significant)</span></span>
<span><span class="co"># We simulate data for the example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">t_cell_increase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">35</span>, mean <span class="op">=</span> <span class="fl">162</span>, sd <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">t_cell_increase</span>, mu <span class="op">=</span> <span class="fl">150</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Explanation</strong>: A <strong>one-sided test</strong> (<code>alternative = "greater"</code>) is used because the research question is directional. We are not just interested in whether the T-cell count is <em>different</em> from 150, but specifically whether it is <em>greater than</em> 150. If the p-value is less than our significance level (e.g., 0.05), we would reject the null hypothesis and conclude that there is statistically significant evidence that the drug’s effect meets the clinically significant threshold.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add52">11.16</a>:</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># H0: mu &gt;= 10 (The mean reduction is at least 10 mmHg, clinically significant)</span></span>
<span><span class="co"># Ha: mu &lt; 10 (The mean reduction is less than 10 mmHg, not clinically significant)</span></span>
<span><span class="co"># Simulate the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">bp_reduction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">40</span>, mean <span class="op">=</span> <span class="fl">8.5</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># One-sample t-test with alternative = "less"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">bp_reduction</span>, mu <span class="op">=</span> <span class="fl">10</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Interpretation</strong>: This is a <strong>one-sided test</strong> (<code>alternative = "less"</code>) because we want to test if the mean reduction is <em>less than</em> the clinically significant threshold of 10 mmHg. If the p-value is small (&lt; 0.05), we would reject H0 and conclude that the drug does NOT achieve a clinically significant reduction. If p-value is large, we fail to reject H0, meaning the evidence is not sufficient to say the reduction is below 10 mmHg - the drug may still be clinically effective.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add9">11.17</a>:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample data (in practice, you'd have actual data)</span></span>
<span><span class="va">group_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">group_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">35</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Two-sample t-test assuming equal variances</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">group_A</span>, <span class="va">group_B</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span></code></pre></div>
<p>This is an unpaired (independent samples) t-test with equal variances.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add10">11.18</a>:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nurse_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  nurse_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span>
<span>  before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">72</span>, <span class="fl">68</span>, <span class="fl">75</span>, <span class="fl">70</span>, <span class="fl">73</span>, <span class="fl">69</span>, <span class="fl">71</span>, <span class="fl">74</span>, <span class="fl">68</span>, <span class="fl">72</span>, </span>
<span>             <span class="fl">70</span>, <span class="fl">73</span>, <span class="fl">69</span>, <span class="fl">71</span>, <span class="fl">74</span>, <span class="fl">72</span>, <span class="fl">70</span>, <span class="fl">68</span>, <span class="fl">73</span>, <span class="fl">71</span><span class="op">)</span>,</span>
<span>  after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78</span>, <span class="fl">74</span>, <span class="fl">80</span>, <span class="fl">76</span>, <span class="fl">79</span>, <span class="fl">75</span>, <span class="fl">77</span>, <span class="fl">80</span>, <span class="fl">74</span>, <span class="fl">78</span>, </span>
<span>            <span class="fl">76</span>, <span class="fl">79</span>, <span class="fl">75</span>, <span class="fl">77</span>, <span class="fl">80</span>, <span class="fl">78</span>, <span class="fl">76</span>, <span class="fl">74</span>, <span class="fl">79</span>, <span class="fl">77</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Paired t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">nurse_data</span><span class="op">$</span><span class="va">after</span>, <span class="va">nurse_data</span><span class="op">$</span><span class="va">before</span>, </span>
<span>       paired <span class="op">=</span> <span class="cn">TRUE</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<p>This should be a <strong>PAIRED test</strong> because the same nurses are measured before and after the training (repeated measures on the same subjects).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add11">11.19</a>:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Two-sample proportion test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">180</span>, <span class="fl">210</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">250</span>, <span class="fl">280</span><span class="op">)</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span></code></pre></div>
<p>This tests if the proportions (0.72 vs 0.75) are significantly different between the two hospitals.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add12">11.20</a>:</p>
<p>This requires <strong>ANOVA</strong> (Analysis of Variance), not a t-test.</p>
<p><strong>Reason</strong>: We are comparing means across <strong>three groups</strong> (diets A, B, and C). A t-test can only compare two groups at a time. ANOVA is specifically designed to test if there are significant differences among three or more group means simultaneously.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The appropriate test would be:</span></span>
<span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">weight_loss</span> <span class="op">~</span> <span class="va">diet</span>, data <span class="op">=</span> <span class="va">diet_study</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add53">11.21</a>:</p>
<p>You should use <strong>Welch’s two-sample t-test</strong> (the default in R).
<strong>Reason</strong>: Levene’s test checks if the variances of the two groups are equal. A p-value of 0.02 (&lt; 0.05) indicates that the variances are significantly different. The standard two-sample t-test assumes equal variances, so using it would lead to incorrect results. Welch’s t-test does not assume equal variances and is therefore the appropriate choice.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming 'cholesterol_data' with 'level' and 'clinic' columns</span></span>
<span><span class="co"># The default t.test in R is Welch's t-test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">level</span> <span class="op">~</span> <span class="va">clinic</span>, data <span class="op">=</span> <span class="va">cholesterol_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># You would NOT do this, as var.equal=TRUE is for equal variances:</span></span>
<span><span class="co"># t.test(level ~ clinic, data = cholesterol_data, var.equal = TRUE)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add13">11.22</a>:</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">)</span></span>
<span><span class="va">plant_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">plant_model</span><span class="op">)</span></span></code></pre></div>
<p>The p-value is approximately <strong>0.0159</strong>, indicating significant differences among the groups at α = 0.05.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add14">11.23</a>:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fever_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  medication <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Med_A"</span>, <span class="st">"Med_B"</span>, <span class="st">"Med_C"</span>, <span class="st">"Med_D"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  temp_reduction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="fl">1.3</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.4</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span>,</span>
<span>    <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">2.1</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>,</span>
<span>    <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">1.3</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>,</span>
<span>    <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>, <span class="fl">2.6</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fever_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">temp_reduction</span> <span class="op">~</span> <span class="va">medication</span>, data <span class="op">=</span> <span class="va">fever_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fever_anova</span><span class="op">)</span></span></code></pre></div>
<p>The F-statistic is approximately <strong>167.4</strong>, with a very small p-value (&lt; 2e-16), indicating highly significant differences among medications.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add15">11.24</a>:</p>
<p>After a significant ANOVA, you should perform <strong>post-hoc tests</strong> (pairwise comparisons) such as:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Tukey’s HSD (Honestly Significant Difference)</strong> - most common</li>
<li><strong>Bonferroni correction</strong></li>
<li><strong>Scheffe’s test</strong></li>
</ol>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example using Tukey's HSD:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">anova_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or using the multcomp package:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org">multcomp</a></span><span class="op">)</span></span>
<span><span class="va">post_hoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span><span class="op">(</span><span class="va">anova_model</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp</a></span><span class="op">(</span>group_variable <span class="op">=</span> <span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">post_hoc</span><span class="op">)</span></span></code></pre></div>
<p>These tests identify which specific pairs of groups differ significantly from each other.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add54">11.25</a>:</p>
<p><strong>Interpretation</strong>:
* The <code>diff</code> column shows the difference in mean recovery time between the two routines being compared. For example, <code>RoutineB-RoutineA</code> has a <code>diff</code> of -5.231, meaning Routine B’s average recovery time is 5.231 days shorter than Routine A’s.
* The <code>p adj</code> column shows the p-value adjusted for multiple comparisons.
* <strong>Significant differences (p &lt; 0.05)</strong>:
* <code>RoutineB</code> is significantly different from <code>RoutineA</code> (p = 0.0045).
* <code>RoutineC</code> is significantly different from <code>RoutineB</code> (p = 0.0002).
* <strong>No significant difference</strong>:
* <code>RoutineC</code> is not significantly different from <code>RoutineA</code> (p = 0.569).</p>
<p><strong>Conclusion</strong>: Routine B leads to the fastest recovery, significantly faster than both A and C. There is no statistical difference between routines A and C.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add16">11.26</a>:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">mpg_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mpg_model</span><span class="op">)</span></span></code></pre></div>
<p><strong>Interpretation of slope</strong>: The coefficient for <code>wt</code> is approximately <strong>-5.34</strong>. This means that for every 1,000 lb increase in car weight, the fuel efficiency (mpg) decreases by about 5.34 miles per gallon, on average. The negative sign indicates an inverse relationship: heavier cars have lower fuel efficiency.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add17">11.27</a>:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample hospital_data for the example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">hospital_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  readmission_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  bed_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>,</span>
<span>  nurse_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  avg_stay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">readmission_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">readmission_rate</span> <span class="op">~</span> <span class="va">bed_count</span> <span class="op">+</span> <span class="va">nurse_ratio</span> <span class="op">+</span> <span class="va">avg_stay</span>, </span>
<span>                        data <span class="op">=</span> <span class="va">hospital_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">readmission_model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add18">11.28</a>:</p>
<p><strong>Problem</strong>: The variable <strong>BMI</strong> has a VIF of 12.5, which exceeds the common threshold of 10, indicating problematic multicollinearity. Age and exercise have acceptable VIF values (&lt; 10).</p>
<p><strong>Recommendation</strong>:
1. Consider removing BMI from the model, OR
2. Investigate which other variable(s) BMI is highly correlated with
3. Consider combining correlated variables or using principal component analysis (PCA)
4. Check if the model performance and interpretability are actually affected</p>
<p>The other variables (age and exercise) are fine and should be retained.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add19">11.29</a>:</p>
<p>You should <strong>remove the <code>cyl</code> variable</strong> from the model.</p>
<p><strong>Reasoning</strong>:
1. The p-value of 0.85 is much larger than any reasonable significance level (e.g., 0.05), indicating <code>cyl</code> is not significantly associated with <code>mpg</code> in this model
2. High VIF suggests multicollinearity with other predictors
3. Removing non-significant variables with high VIF improves model parsimony and interpretability</p>
<p><strong>Next step</strong>:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Refit the model without cyl</span></span>
<span><span class="va">improved_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">hp</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">improved_model</span><span class="op">)</span></span>
<span><span class="co"># Check VIF again</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">improved_model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add20">11.30</a>:</p>
<p><strong>R-squared (R²)</strong>: Represents the proportion of variance in the dependent variable that is explained by the independent variable(s). It ranges from 0 to 1. However, R² always increases (or stays the same) when you add more predictors, even if they’re not truly useful.</p>
<p><strong>Adjusted R-squared (R²adj)</strong>: Adjusts R² for the number of predictors in the model and the sample size. It penalizes the addition of unhelpful variables.</p>
<p><strong>Formula</strong>: R²adj = 1 - [(1 - R²)(n - 1)/(n - k - 1)]
where n = sample size, k = number of predictors</p>
<p><strong>Why important in multiple regression</strong>:
- Prevents overfitting
- Allows fair comparison between models with different numbers of predictors
- Can decrease if you add predictors that don’t improve the model enough to justify their inclusion
- More realistic measure of model quality</p>
<p>Use R²adj when comparing models with different numbers of predictors; use R² when evaluating a single model’s goodness of fit.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add21">11.31</a>:</p>
<p>The regression equation is:
Systolic BP = 90.234 + 0.652(age) + 0.234(weight) - 1.234(exercise)</p>
<p>For a 50-year-old, 75 kg person who exercises 5 hours/week:
Systolic BP = 90.234 + 0.652(50) + 0.234(75) - 1.234(5)
Systolic BP = 90.234 + 32.6 + 17.55 - 6.17
<strong>Systolic BP = 134.214 mmHg</strong></p>
<p>Approximately <strong>134.2 mmHg</strong></p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add22">11.32</a>:</p>
<p>The variable with the <strong>strongest effect</strong> appears to be <strong>age</strong>, with a t-value of 7.67 (the highest absolute t-value).</p>
<p><strong>How to determine</strong>:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Compare t-values</strong> (most direct method): Larger absolute t-values indicate stronger effects</p>
<ul>
<li>age: t = 7.67</li>
<li>weight: t = 5.20</li>
<li>exercise: t = -3.95</li>
</ul>
</li>
<li><p><strong>Compare p-values</strong>: All are highly significant, but age has the smallest p-value (1.2e-11)</p></li>
<li><p><strong>Standardized coefficients</strong> would be the most precise method (not shown here), as they account for different scales of measurement</p></li>
</ol>
<p>Note: We cannot simply compare the raw coefficients (0.652, 0.234, -1.234) because the variables are measured in different units (years, kg, hours).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add55">11.33</a>:</p>
<p>You would specify the model with an interaction term using <code>*</code>.</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model with interaction term</span></span>
<span><span class="va">interaction_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">los</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">infection_status</span>, data <span class="op">=</span> <span class="va">hospital_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">interaction_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This is equivalent to:</span></span>
<span><span class="co"># lm(los ~ age + infection_status + age:infection_status, data = hospital_data)</span></span></code></pre></div>
<p><strong>Interpretation of the interaction coefficient (<code>age:infection_status</code>)</strong>:
If the interaction term is significant, it means the effect of age on the length of stay is different depending on infection status. The coefficient for <code>age:infection_status</code> represents the <strong>additional change in the slope of age</strong> for patients with an infection compared to those without. For example, if the coefficient is 1.5, it means that for each one-year increase in age, the length of stay increases by an additional 1.5 days for infected patients, on top of the baseline age effect for non-infected patients.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add68">11.34</a>:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">heart_rate_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">70</span>, <span class="fl">80</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  exercise_hours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  caffeine_mg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">400</span>, <span class="fl">80</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">heart_rate_data</span><span class="op">$</span><span class="va">heart_rate</span> <span class="op">&lt;-</span> <span class="fl">60</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">heart_rate_data</span><span class="op">$</span><span class="va">age</span> <span class="op">-</span> </span>
<span>                               <span class="fl">1.2</span> <span class="op">*</span> <span class="va">heart_rate_data</span><span class="op">$</span><span class="va">exercise_hours</span> <span class="op">+</span> </span>
<span>                               <span class="fl">0.02</span> <span class="op">*</span> <span class="va">heart_rate_data</span><span class="op">$</span><span class="va">caffeine_mg</span> <span class="op">+</span> </span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">heart_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">heart_rate</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">exercise_hours</span> <span class="op">+</span> <span class="va">caffeine_mg</span>, data <span class="op">=</span> <span class="va">heart_rate_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">heart_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict for the specific case</span></span>
<span><span class="va">new_patient</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">45</span>, exercise_hours <span class="op">=</span> <span class="fl">3</span>, caffeine_mg <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">predicted_hr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">heart_model</span>, newdata <span class="op">=</span> <span class="va">new_patient</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Predicted heart rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">predicted_hr</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"bpm"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Interpretation</strong>:
- Age has a positive effect: older individuals tend to have higher resting heart rates
- Exercise hours have a negative effect: more exercise is associated with lower heart rates
- Caffeine has a positive effect: more caffeine consumption increases heart rate
- The predicted heart rate is approximately <strong>73.5 bpm</strong> for the specified patient</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add69">11.35</a>:</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">654</span><span class="op">)</span></span>
<span><span class="va">bmi_bp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">120</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">55</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  bmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">27</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  smoking <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Never"</span>, <span class="st">"Former"</span>, <span class="st">"Current"</span><span class="op">)</span>, <span class="fl">120</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">systolic_bp</span> <span class="op">&lt;-</span> <span class="fl">90</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">age</span> <span class="op">+</span> </span>
<span>                            <span class="fl">1.8</span> <span class="op">*</span> <span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">bmi</span> <span class="op">+</span></span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">smoking</span> <span class="op">==</span> <span class="st">"Current"</span>, <span class="fl">12</span>,</span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">smoking</span> <span class="op">==</span> <span class="st">"Former"</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert smoking to factor with "Current" as reference</span></span>
<span><span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">smoking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">bmi_bp_data</span><span class="op">$</span><span class="va">smoking</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Current"</span>, <span class="st">"Former"</span>, <span class="st">"Never"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">bp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">systolic_bp</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">bmi</span> <span class="op">+</span> <span class="va">smoking</span>, data <span class="op">=</span> <span class="va">bmi_bp_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bp_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict for specific case</span></span>
<span><span class="va">new_patient</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">60</span>, bmi <span class="op">=</span> <span class="fl">30</span>, smoking <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="st">"Current"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Current"</span>, <span class="st">"Former"</span>, <span class="st">"Never"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">predicted_bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bp_model</span>, newdata <span class="op">=</span> <span class="va">new_patient</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Predicted systolic BP:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">predicted_bp</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mmHg"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Interpretation</strong>:
- The predicted systolic blood pressure is approximately <strong>180 mmHg</strong>
- <strong>Smoking coefficients</strong>: With “Current” as the reference category:
- <code>smokingFormer</code>: negative coefficient (about -7 mmHg) means former smokers have lower BP than current smokers
- <code>smokingNever</code>: negative coefficient (about -12 mmHg) means never-smokers have even lower BP than current smokers
- This indicates that current smokers have the highest blood pressure, followed by former smokers, then never-smokers
- Both age and BMI have positive effects on blood pressure, as expected</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add70">11.36</a>:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">987</span><span class="op">)</span></span>
<span><span class="va">readmission_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  initial_los <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  num_comorbidities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">68</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">readmission_data</span><span class="op">$</span><span class="va">readmission_days</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="op">+</span> </span>
<span>                                     <span class="fl">2.5</span> <span class="op">*</span> <span class="va">readmission_data</span><span class="op">$</span><span class="va">initial_los</span> <span class="op">+</span></span>
<span>                                     <span class="fl">3.2</span> <span class="op">*</span> <span class="va">readmission_data</span><span class="op">$</span><span class="va">num_comorbidities</span> <span class="op">+</span></span>
<span>                                     <span class="fl">0.3</span> <span class="op">*</span> <span class="va">readmission_data</span><span class="op">$</span><span class="va">age</span> <span class="op">+</span></span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">readmission_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">readmission_days</span> <span class="op">~</span> <span class="va">initial_los</span> <span class="op">+</span> <span class="va">num_comorbidities</span> <span class="op">+</span> <span class="va">age</span>, </span>
<span>                        data <span class="op">=</span> <span class="va">readmission_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">readmission_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check for multicollinearity</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="va">vif_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">readmission_model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"VIF values:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">vif_values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare effect sizes using t-values</span></span>
<span><span class="va">coef_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">readmission_model</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"\nCoefficient summary:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">coef_summary</span><span class="op">)</span></span></code></pre></div>
<p><strong>Results and Interpretation</strong>:
- <strong>VIF values</strong>: All VIF values are close to 1 (around 1.01), indicating <strong>no multicollinearity</strong> issues. This means the predictors are not highly correlated with each other.</p>
<ul>
<li>
<p><strong>Strongest effect</strong>: Looking at the t-values (absolute values):</p>
<ul>
<li>
<code>initial_los</code>: t ≈ 9.06 (strongest)</li>
<li>
<code>num_comorbidities</code>: t ≈ 7.79 (second strongest)<br>
</li>
<li>
<code>age</code>: t ≈ 2.63 (weakest, but still significant)</li>
</ul>
</li>
<li><p><strong>Initial length of stay</strong> has the strongest effect on readmission time. For each additional day in the initial hospital stay, readmission time increases by approximately 2.84 days.</p></li>
<li><p><strong>Number of comorbidities</strong> is also highly significant: each additional comorbidity increases expected readmission time by about 3.77 days.</p></li>
<li><p><strong>Age</strong> has a smaller but still significant effect: each additional year of age increases readmission time by about 0.24 days.</p></li>
<li><p>The model explains about <strong>59.8%</strong> of the variance in readmission time (R² = 0.5983), indicating a good fit.</p></li>
</ul>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add23">11.37</a>:</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample model_data for the example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">model_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  BMI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">28</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  diabetes_risk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the polynomial term</span></span>
<span><span class="va">model_data</span><span class="op">$</span><span class="va">BMI_squared</span> <span class="op">&lt;-</span> <span class="va">model_data</span><span class="op">$</span><span class="va">BMI</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span><span class="co"># Fit polynomial regression</span></span>
<span><span class="va">poly_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">diabetes_risk</span> <span class="op">~</span> <span class="va">BMI</span> <span class="op">+</span> <span class="va">BMI_squared</span>, data <span class="op">=</span> <span class="va">model_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">poly_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternative using poly() function (creates orthogonal polynomials):</span></span>
<span><span class="va">poly_model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">diabetes_risk</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">BMI</span>, <span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">model_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">poly_model2</span><span class="op">)</span></span></code></pre></div>
<p>The first approach gives more interpretable coefficients; the second is better for avoiding multicollinearity between BMI and BMI².</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add24">11.38</a>:</p>
<p>For a right-skewed variable like income, apply a <strong>logarithmic transformation</strong>:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Natural log transformation</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">log_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">income</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or log base 10</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">log10_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">income</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make sure there are no zero or negative values first:</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">log_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">income</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># Adding 1 if zeros exist</span></span></code></pre></div>
<p><strong>Why log transformation</strong>:
- Reduces right skewness
- Makes the distribution more normal
- Reduces the influence of extreme values
- Often makes relationships more linear</p>
<p>Other options for right-skewed data: square root transformation <code>sqrt(income)</code> or inverse transformation <code>1/income</code>.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add25">11.39</a>:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Method 1: Create the squared term explicitly</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">wt_squared</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">poly_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">wt_squared</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">poly_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Method 2: Using I() function (cleaner)</span></span>
<span><span class="va">poly_model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">wt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">poly_model2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Method 3: Using poly() for orthogonal polynomials</span></span>
<span><span class="va">poly_model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">wt</span>, <span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">poly_model3</span><span class="op">)</span></span></code></pre></div>
<p>Method 2 is recommended for most applications as it’s concise and easy to interpret.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add56">11.40</a>:</p>
<p><strong>Interpretation</strong>: Since the predictor is log-transformed, the interpretation is: a <strong>1% increase in body weight</strong> is associated with a <strong>(15.3 / 100) = 0.153 mmHg increase</strong> in blood pressure, on average.
This type of model (log-lin) is used when the effect of the predictor is not linear but multiplicative.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add26">11.41</a>:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample health_data for the example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">health_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">150</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">55</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  BMI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">27</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  smoking <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">150</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">logistic_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">disease</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">BMI</span> <span class="op">+</span> <span class="va">smoking</span>, </span>
<span>                      data <span class="op">=</span> <span class="va">health_data</span>, </span>
<span>                      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">logistic_model</span><span class="op">)</span></span></code></pre></div>
<p>Key points:
- Use <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> instead of <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>
- Specify <code>family = binomial</code> for logistic regression
- The outcome variable <code>disease</code> should be binary (0/1, or factor with 2 levels)
- Results give log-odds; exponentiate coefficients to get odds ratios: <code>exp(coef(logistic_model))</code></p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add27">11.42</a>:</p>
<p>An odds ratio of <strong>2.5</strong> for smoking means:</p>
<p><strong>The odds of developing the disease are 2.5 times higher for smokers compared to non-smokers</strong>, holding all other variables constant.</p>
<p>More specifically:
- If OR = 2.5, smokers have 150% higher odds of disease than non-smokers
- OR &gt; 1: positive association (increased risk)
- OR = 1: no association
- OR &lt; 1: negative association (protective effect)</p>
<p>Example interpretation: If non-smokers have a 10% probability of disease, smokers might have approximately 22% probability (though exact conversion from odds to probability requires more calculation).</p>
<p><strong>Note</strong>: Odds ratio is NOT the same as relative risk, but for rare diseases (&lt; 10% prevalence), they are approximately equal.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add28">11.43</a>:</p>
<p>The negative coefficient of <strong>-0.05 for age</strong> indicates:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Direction</strong>: As age increases, the log-odds of survival <strong>decrease</strong>
</li>
<li>
<strong>Practical meaning</strong>: Older patients have <strong>lower probability of survival</strong>, holding other factors constant</li>
<li>
<strong>Odds ratio</strong>: exp(-0.05) = 0.951, meaning for each one-year increase in age, the odds of survival multiply by 0.951 (decrease by about 5%)</li>
</ol>
<p>For a 10-year age difference: exp(-0.05 × 10) = exp(-0.5) = 0.606
A patient 10 years older has about 60.6% the odds of survival compared to a younger patient.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add29">11.44</a>:</p>
<p><strong>Linear Regression</strong>:
- Predicts the <strong>actual value</strong> of a continuous outcome variable
- Output: A number on a continuous scale
- Example: Predicting exact blood pressure (135 mmHg), salary ($45,000), temperature (98.6°F)
- Uses normal distribution</p>
<p><strong>Logistic Regression</strong>:
- Predicts the <strong>probability</strong> of belonging to a category (usually binary: yes/no, 0/1)
- Output: A probability between 0 and 1, which can be converted to a category
- Example: Predicting probability of disease (0.75 = 75% chance), probability of survival, probability of clicking an ad
- Uses binomial distribution with logit link function</p>
<p><strong>Technical difference</strong>:
- Linear regression: E(Y) = β₀ + β₁X₁ + β₂X₂ + …
- Logistic regression: log(P/(1-P)) = β₀ + β₁X₁ + β₂X₂ + … (models log-odds)</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add30">11.45</a>:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create binary outcome variable</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">high_mpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&gt;</span> <span class="fl">20</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit logistic regression model</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">high_mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">hp</span>, </span>
<span>                   data <span class="op">=</span> <span class="va">mtcars</span>, </span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get odds ratios</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict probabilities for original data</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">predicted_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">logit_model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add57">11.46</a>:</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, refit the model from Exercise #add30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">high_mpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&gt;</span> <span class="fl">20</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">high_mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">hp</span>, data <span class="op">=</span> <span class="va">mtcars</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a new data frame for the car we want to predict</span></span>
<span><span class="va">new_car</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>wt <span class="op">=</span> <span class="fl">2.8</span>, hp <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict the probability</span></span>
<span><span class="va">predicted_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">logit_model</span>, newdata <span class="op">=</span> <span class="va">new_car</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">predicted_prob</span><span class="op">)</span></span></code></pre></div>
<p>The output <code>predicted_prob</code> will be a value between 0 and 1, representing the model’s estimated probability that a car with these specifications has an MPG over 20.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add31">11.47</a>:</p>
<p><strong>Poisson regression</strong> is most appropriate for count data.</p>
<p><strong>Reasoning</strong>:
- The outcome (number of ER visits per day) is a <strong>count variable</strong> (0, 1, 2, 3, …)
- Count data is discrete and non-negative
- Poisson distribution is designed for modeling count outcomes
- It models the rate of events occurring</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example Poisson regression</span></span>
<span><span class="va">poisson_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">er_visits</span> <span class="op">~</span> <span class="va">day_of_week</span> <span class="op">+</span> <span class="va">weather</span>, </span>
<span>                     data <span class="op">=</span> <span class="va">hospital_data</span>, </span>
<span>                     family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note</strong>: If the variance is much larger than the mean (overdispersion), consider using <strong>negative binomial regression</strong> instead.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add32">11.48</a>:</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample hospital_data for the example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">hospital_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  infection_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  bed_occupancy_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.7</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  nurse_staff_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">poisson_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">infection_count</span> <span class="op">~</span> <span class="va">bed_occupancy_rate</span> <span class="op">+</span> <span class="va">nurse_staff_ratio</span>, </span>
<span>                     data <span class="op">=</span> <span class="va">hospital_data</span>, </span>
<span>                     family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">poisson_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check for overdispersion</span></span>
<span><span class="co"># library(AER)</span></span>
<span><span class="co"># dispersiontest(poisson_model)</span></span>
<span></span>
<span><span class="co"># If overdispersion detected, use negative binomial:</span></span>
<span><span class="co"># library(MASS)</span></span>
<span><span class="co"># nb_model &lt;- glm.nb(infection_count ~ bed_occupancy_rate + nurse_staff_ratio, </span></span>
<span><span class="co">#                    data = hospital_data)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add33">11.49</a>:</p>
<p>The primary assumption of Poisson regression is that <strong>the mean equals the variance</strong> (equidispersion).</p>
<p>Specifically:
- <strong>E(Y) = Var(Y) = λ</strong> (the Poisson parameter)</p>
<p><strong>In practice</strong>:
- If Var(Y) &gt; E(Y): <strong>Overdispersion</strong> - common in real data, violates assumption
- Solution: Use negative binomial regression or quasi-Poisson
- If Var(Y) &lt; E(Y): <strong>Underdispersion</strong> - less common
- May still use Poisson or consider other models</p>
<p><strong>Other important assumptions</strong>:
1. Outcome variable is a count
2. Observations are independent
3. Counts cannot be negative
4. The log of the mean is a linear function of predictors</p>
<p><strong>Check overdispersion</strong>:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Deviance/df should be close to 1</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">deviance</span> <span class="op">/</span> <span class="va">model</span><span class="op">$</span><span class="va">df.residual</span></span></code></pre></div>
<p>If ratio &gt;&gt; 1, overdispersion is present.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add58">11.50</a>:</p>
<p><strong>Problem</strong>: The ratio of residual deviance to degrees of freedom (150 / 80 = 1.875) is much greater than 1. This suggests <strong>overdispersion</strong>, meaning the variance of the data is larger than what the Poisson model assumes (where mean equals variance). This violates a key assumption of Poisson regression.
<strong>Alternative Model</strong>: A <strong>Negative Binomial regression</strong> is the appropriate alternative as it can handle overdispersed count data by including an extra parameter to model the variance.</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample hospital_data for the example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">hospital_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  er_visits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">rnbinom</a></span><span class="op">(</span><span class="fl">100</span>, size <span class="op">=</span> <span class="fl">1.5</span>, mu <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  predictor1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>  predictor2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="co"># Fit a negative binomial model</span></span>
<span><span class="va">nb_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">er_visits</span> <span class="op">~</span> <span class="va">predictor1</span> <span class="op">+</span> <span class="va">predictor2</span>, data <span class="op">=</span> <span class="va">hospital_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nb_model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add34">11.51</a>:</p>
<p>You need to create <strong>3 dummy variables</strong> for a categorical variable with 4 categories.</p>
<p><strong>Rule</strong>: For a categorical variable with k categories, create (k-1) dummy variables.</p>
<p><strong>Why</strong>:
- One category serves as the <strong>reference/baseline</strong> category
- The other k-1 categories are represented by dummy variables
- Including all k categories would cause perfect multicollinearity (dummy variable trap)</p>
<p><strong>Example for blood_type</strong>:</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R does this automatically in regression, but manual creation:</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">type_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">blood_type</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">type_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">blood_type</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">type_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">blood_type</span> <span class="op">==</span> <span class="st">"AB"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># Type O is the reference category (all three dummies = 0)</span></span>
<span></span>
<span><span class="co"># In regression, R handles this automatically:</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">cholesterol</span> <span class="op">~</span> <span class="va">blood_type</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="co"># R will create the dummy variables automatically</span></span></code></pre></div>
<p>If you include type O as well, the model matrix would be singular and inestimable.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add35">11.52</a>:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R automatically creates dummy variables for factors</span></span>
<span><span class="va">recovery_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recovery_time</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">recovery_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To explicitly set the reference category:</span></span>
<span><span class="va">patient_data</span><span class="op">$</span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">treatment</span>, </span>
<span>                                  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Standard"</span>, <span class="st">"Experimental"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Now "Control" is the reference</span></span>
<span></span>
<span><span class="co"># Alternatively, using relevel():</span></span>
<span><span class="va">patient_data</span><span class="op">$</span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span>, ref <span class="op">=</span> <span class="st">"Control"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">recovery_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recovery_time</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">patient_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">recovery_model</span><span class="op">)</span></span></code></pre></div>
<p>R will automatically create 2 dummy variables (treatmentStandard and treatmentExperimental) with “Control” as the reference category.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add36">11.53</a>:</p>
<p>The predicted value for a patient in the Surgery ward is:</p>
<p><strong>Predicted value = 12.5 + (-2.3) = 10.2</strong></p>
<p><strong>Explanation</strong>:
- The intercept (12.5) represents the predicted value for the <strong>reference category</strong> (General ward)
- For Surgery ward: add the Surgery coefficient (-2.3) to the intercept
- For ICU ward: you would add 4.7 to get 12.5 + 4.7 = 17.2
- For General ward (reference): just use the intercept = 12.5</p>
<p><strong>Interpretation</strong>: Compared to the General ward (baseline), patients in Surgery have 2.3 units lower outcome (on average), and ICU patients have 4.7 units higher outcome.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add37">11.54</a>:</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The variable am is already coded as 0/1</span></span>
<span><span class="va">mpg_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">am</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mpg_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To make it more explicit:</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                               labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Automatic"</span>, <span class="st">"Manual"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mpg_model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">transmission</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mpg_model2</span><span class="op">)</span></span></code></pre></div>
<p>The coefficient for <code>am</code> (or <code>transmissionManual</code>) tells you the difference in mpg between manual and automatic transmissions, holding weight and horsepower constant.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add38">11.55</a>:</p>
<p>The coefficient of <strong>5000</strong> means:</p>
<p><strong>Males earn $5,000 more than females on average</strong>, holding all other variables in the model constant.</p>
<p>More precisely:
- When gender = 1 (male), add $5,000 to the predicted salary
- When gender = 0 (female, reference), add $0
- This is the estimated gender pay gap in this model</p>
<p><strong>Example</strong>:
If the model is: Salary = 40,000 + 5,000(gender) + other terms
- Female (gender=0): Predicted base salary = $40,000 + other factors
- Male (gender=1): Predicted base salary = $45,000 + other factors</p>
<p><strong>Important notes</strong>:
- This is correlation, not necessarily causation
- Other factors (education, experience, etc.) should be controlled for
- The coefficient’s statistical significance (p-value) determines if this difference is reliable</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add59">11.56</a>:</p>
<p><strong>Interpretation</strong>: The intercept of 75.2 represents the <strong>predicted average patient satisfaction score for the reference group</strong>. In this case, the reference group is patients for whom <code>has_private_room</code> is 0, i.e., patients <strong>who do not have a private room</strong>.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add39">11.57</a>:</p>
<p>The four main assumptions for linear regression (LINE):</p>
<ol style="list-style-type: decimal">
<li>
<strong>Linearity</strong>: The relationship between predictors and outcome is linear
<ul>
<li>Check: Residuals vs. Fitted plot should show random scatter</li>
</ul>
</li>
<li>
<strong>Independence</strong>: Observations are independent of each other
<ul>
<li>Check: Durbin-Watson test, knowledge of data collection</li>
<li>Violated by: Time series, clustered data, repeated measures</li>
</ul>
</li>
<li>
<strong>Normality</strong>: Residuals are normally distributed
<ul>
<li>Check: Q-Q plot, Shapiro-Wilk test, histogram of residuals</li>
<li>Most important for inference (confidence intervals, p-values)</li>
</ul>
</li>
<li>
<strong>Equal variance (Homoscedasticity)</strong>: Constant variance of residuals across all levels of predictors
<ul>
<li>Check: Scale-Location plot, Breusch-Pagan test</li>
<li>Residuals vs. Fitted should show constant spread</li>
</ul>
</li>
</ol>
<p><strong>Additional assumption often mentioned</strong>:
5. <strong>No multicollinearity</strong> (for multiple regression): Predictors are not highly correlated
- Check: VIF (Variance Inflation Factor)</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check assumptions:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>  <span class="co"># Produces 4 diagnostic plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>  <span class="co"># Check multicollinearity</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add40">11.58</a>:</p>
<p>Using the formula for Adjusted R²:
R²adj = 1 - [(1 - R²)(n - 1)/(n - k - 1)]</p>
<p>Given:
- R² = 0.85
- R²adj = 0.83
- n = 100</p>
<p>Solving for k:
0.83 = 1 - [(1 - 0.85)(100 - 1)/(100 - k - 1)]
0.83 = 1 - [0.15 × 99/(99 - k)]
0.17 = 0.15 × 99/(99 - k)
0.17(99 - k) = 14.85
16.83 - 0.17k = 14.85
-0.17k = -1.98
k ≈ <strong>11.6</strong></p>
<p>So approximately <strong>11 or 12 predictors</strong> are in the model.</p>
<p><strong>Quick approximation</strong>: When R² and R²adj are close, you typically have relatively few predictors. The difference of 0.02 with n=100 suggests around 10-12 predictors.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add41">11.59</a>:</p>
<p><strong>Problem identified</strong>: <strong>Heteroscedasticity</strong> (non-constant variance)</p>
<p>A funnel shape means:
- Variance of residuals increases (or decreases) with fitted values
- Violates the assumption of homoscedasticity (equal variance)</p>
<p><strong>Potential solutions</strong>:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Transform the outcome variable</strong>:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Log transformation</span></span>
<span><span class="va">model_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Square root transformation</span></span>
<span><span class="va">model_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Use weighted least squares (WLS)</strong>:</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Weights inversely proportional to variance</span></span>
<span><span class="va">wls_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">data</span>, weights <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">residuals</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Use robust standard errors</strong>:</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sandwich.R-Forge.R-project.org/">sandwich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">model</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</li>
<li><p><strong>Add or transform predictors</strong>: May indicate missing variable or wrong functional form</p></li>
<li><p><strong>Use generalized linear models (GLM)</strong>: If outcome is count or binary</p></li>
</ol>
<p><strong>Check after solution</strong>:</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">new_model</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">new_model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Should show random scatter, not a pattern</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> <a href="int-samp-q-second.html#exr:add42">11.60</a>:</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">mpg_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">hp</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create diagnostic plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Set up 2x2 plot layout</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg_model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Reset to default</span></span>
<span></span>
<span><span class="co"># Individual plots:</span></span>
<span><span class="co"># 1. Residuals vs Fitted (checks linearity and homoscedasticity)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg_model</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Q-Q plot (checks normality of residuals)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg_model</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Scale-Location (checks homoscedasticity)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg_model</span>, which <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Residuals vs Leverage (identifies influential points)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg_model</span>, which <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Additional useful diagnostics:</span></span>
<span><span class="co"># Histogram of residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mpg_model</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Histogram of Residuals"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Shapiro-Wilk test for normality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mpg_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Interpretation</strong>:
- Plot 1: Should show random scatter around zero
- Plot 2: Points should follow the diagonal line
- Plot 3: Should show horizontal line with equal spread
- Plot 4: Points outside Cook’s distance indicate influential observations</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="int-prep.html"><span class="header-section-number">10</span> 💻 Intermediate preparation</a></div>
<div class="next"><a href="int-samp-q.html"><span class="header-section-number">12</span> 💻 Intermediate Sample Questions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#int-samp-q-second"><span class="header-section-number">11</span> 📚 Additional Practice Exercises for Intermediate Exam</a></li>
<li><a class="nav-link" href="#part-1-data-wrangling-and-descriptive-statistics"><span class="header-section-number">11.1</span> 🏥 Part 1: Data Wrangling and Descriptive Statistics</a></li>
<li><a class="nav-link" href="#part-2-hypothesis-testing---single-population"><span class="header-section-number">11.2</span> 🔬 Part 2: Hypothesis Testing - Single Population</a></li>
<li><a class="nav-link" href="#part-3-hypothesis-testing---two-populations"><span class="header-section-number">11.3</span> 👥 Part 3: Hypothesis Testing - Two Populations</a></li>
<li><a class="nav-link" href="#part-4-anova---comparing-multiple-groups"><span class="header-section-number">11.4</span> 📊 Part 4: ANOVA - Comparing Multiple Groups</a></li>
<li><a class="nav-link" href="#part-5-simple-and-multiple-linear-regression"><span class="header-section-number">11.5</span> 📈 Part 5: Simple and Multiple Linear Regression</a></li>
<li><a class="nav-link" href="#part-6-nonlinear-regression-and-transformations"><span class="header-section-number">11.6</span> 🔄 Part 6: Nonlinear Regression and Transformations</a></li>
<li><a class="nav-link" href="#part-7-logistic-regression"><span class="header-section-number">11.7</span> 🎯 Part 7: Logistic Regression</a></li>
<li><a class="nav-link" href="#part-8-poisson-regression"><span class="header-section-number">11.8</span> 📊 Part 8: Poisson Regression</a></li>
<li><a class="nav-link" href="#part-9-regression-with-dummy-variables"><span class="header-section-number">11.9</span> 🏷️ Part 9: Regression with Dummy Variables</a></li>
<li><a class="nav-link" href="#part-10-model-diagnostics-and-interpretation"><span class="header-section-number">11.10</span> 🧮 Part 10: Model Diagnostics and Interpretation</a></li>
<li><a class="nav-link" href="#solutions-1"><span class="header-section-number">11.11</span> ✅ SOLUTIONS</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NiccoloSalvini/sbd_25_26/blob/master/06oct_2nd_intermed_sample.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NiccoloSalvini/sbd_25_26/edit/master/06oct_2nd_intermed_sample.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistics &amp; Big Data 25-26 Labs</strong>" was written by Dr. Niccolò Salvini. It was last built on 2025-10-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
