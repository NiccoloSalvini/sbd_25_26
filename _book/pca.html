<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 üíª PCA | Statistics &amp; Big Data 25-26 Labs</title>
<meta name="author" content="Dr.¬†Niccol√≤ Salvini">
<meta name="description" content="10.1 17.1 Principal Components Analysis We will use the following packages ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô, ‚ÄòISRL2‚Äô  10.1.1 17.1.1 PCA using ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô library(FactoMineR)...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 10 üíª PCA | Statistics &amp; Big Data 25-26 Labs">
<meta property="og:type" content="book">
<meta property="og:description" content="10.1 17.1 Principal Components Analysis We will use the following packages ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô, ‚ÄòISRL2‚Äô  10.1.1 17.1.1 PCA using ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô library(FactoMineR)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 üíª PCA | Statistics &amp; Big Data 25-26 Labs">
<meta name="twitter:description" content="10.1 17.1 Principal Components Analysis We will use the following packages ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô, ‚ÄòISRL2‚Äô  10.1.1 17.1.1 PCA using ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô library(FactoMineR)...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="shortcut icon" href="images/cattolica-logo-favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Statistics &amp; Big Data 25-26 Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> ü´∂ About</a></li>
<li class="book-part">Get Started</li>
<li><a class="" href="prereq.html"><span class="header-section-number">2</span> ‚ú®Prerequisites</a></li>
<li><a class="" href="r-packages.html"><span class="header-section-number">3</span> üì¶ R Packages</a></li>
<li><a class="" href="nice-warm-up.html"><span class="header-section-number">4</span> üî• Nice warm-up</a></li>
<li><a class="" href="syllabus.html"><span class="header-section-number">5</span> üóíÔ∏è Syllabus</a></li>
<li class="book-part">Part 1: The Foundations</li>
<li><a class="" href="hypothesis-testing-fundamentals.html"><span class="header-section-number">6</span> üß™ Hypothesis Testing Fundamentals</a></li>
<li><a class="" href="linear-regression-analysis.html"><span class="header-section-number">7</span> üìà Linear Regression Analysis</a></li>
<li><a class="" href="advanced-statistical-methods.html"><span class="header-section-number">8</span> üî¨ Advanced Statistical Methods</a></li>
<li class="book-part">Part 2: Advanced Modeling</li>
<li><a class="" href="advanced-modeling-techniques.html"><span class="header-section-number">9</span> üöÄ Advanced Modeling Techniques</a></li>
<li><a class="active" href="pca.html"><span class="header-section-number">10</span> üíª PCA</a></li>
<li><a class="" href="hier-clust.html"><span class="header-section-number">11</span> üíª Hierarchical Clustering</a></li>
<li><a class="" href="k-means.html"><span class="header-section-number">12</span> üíª K-Means Clustering</a></li>
<li class="book-part">Additional Resources</li>
<li><a class="" href="int-prep.html"><span class="header-section-number">13</span> üíª Intermediate preparation</a></li>
<li><a class="" href="int-samp-q-first.html"><span class="header-section-number">14</span> üíª First Intermediate Sample Questions</a></li>
<li><a class="" href="int-samp-q-second.html"><span class="header-section-number">15</span> üíª Second Intermediate Sample Questions</a></li>
<li><a class="" href="exam-sim-intermediate.html"><span class="header-section-number">16</span> üìù Intermediate Exam Simulation - Healthcare Management</a></li>
<li><a class="" href="course-performance.html"><span class="header-section-number">17</span> ‚ö° Course Performance</a></li>
<li><a class="" href="frequently-asked-questions.html"><span class="header-section-number">18</span> ‚ùì Frequently Asked Questions</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="StatisticsAndParameters.html"><span class="header-section-number">19</span> Symbols, formulas, statistics and parameters</a></li>
<li><a class="" href="appendixdatasets.html"><span class="header-section-number">20</span> Datasets</a></li>
<li><a class="" href="references-2.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NiccoloSalvini/sbd_25_26">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="pca" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> üíª PCA<a class="anchor" aria-label="anchor" href="#pca"><i class="fas fa-link"></i></a>
</h1>
<div id="principal-components-analysis" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> 17.1 Principal Components Analysis<a class="anchor" aria-label="anchor" href="#principal-components-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>We will use the following packages ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô, ‚ÄòISRL2‚Äô</p>
<div id="pca-using-factominer-factoextra" class="section level3" number="10.1.1">
<h3>
<span class="header-section-number">10.1.1</span> 17.1.1 PCA using ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô<a class="anchor" aria-label="anchor" href="#pca-using-factominer-factoextra"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.statlearning.com">ISLR2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div id="exercise-1-read-the-data" class="section level3" number="10.1.2">
<h3>
<span class="header-section-number">10.1.2</span> 17.1.2 Exercise 1 : read the data<a class="anchor" aria-label="anchor" href="#exercise-1-read-the-data"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Var1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  Var2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"i1"</span>, <span class="st">"i2"</span>, <span class="st">"i3"</span>, <span class="st">"i4"</span><span class="op">)</span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt;    Var1 Var2</span></span>
<span><span class="co">#&gt; i1    2    2</span></span>
<span><span class="co">#&gt; i2    1   -1</span></span>
<span><span class="co">#&gt; i3   -1    1</span></span>
<span><span class="co">#&gt; i4   -2   -2</span></span></code></pre></div>
<p><strong>Covariance matrix</strong></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># mean of Var1</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="co"># mean of Var2</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="co">##variance and inertia </span></span>
<span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>  <span class="co"># the constant (n-1)/n is have the variance-covariance matrix used in the lecture</span></span>
<span><span class="va">S</span></span>
<span><span class="co">#&gt;      Var1 Var2</span></span>
<span><span class="co">#&gt; Var1  2.5  1.5</span></span>
<span><span class="co">#&gt; Var2  1.5  2.5</span></span>
<span></span>
<span><span class="co">#inertia</span></span>
<span><span class="va">Inertia</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Inertia</span></span>
<span><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<p><strong>## eigen-analysis</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span> <span class="co"># gives the eigen-values and eigen-vectors</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1] 4 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;           [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.7071068 -0.7071068</span></span>
<span><span class="co">#&gt; [2,] 0.7071068  0.7071068</span></span></code></pre></div>
<p><strong>Eigen-analysis on the correlation matrix</strong></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="va">eigenan</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="co">##eigen analysis of R</span></span>
<span><span class="va">eigenan</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1] 1.6 0.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;           [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.7071068 -0.7071068</span></span>
<span><span class="co">#&gt; [2,] 0.7071068  0.7071068</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">eigenan</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span></span>
<span><span class="co">#Inertia is p=2</span></span>
<span><span class="co">#normalized the data</span></span>
<span><span class="va">Z</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co">## is teh correlation matrix </span></span>
<span><span class="co">#&gt;      Var1 Var2</span></span>
<span><span class="co">#&gt; Var1  1.0  0.6</span></span>
<span><span class="co">#&gt; Var2  0.6  1.0</span></span></code></pre></div>
</div>
<div id="pca-function" class="section level3" number="10.1.3">
<h3>
<span class="header-section-number">10.1.3</span> 17.1.3 PCA function<a class="anchor" aria-label="anchor" href="#pca-function"><i class="fas fa-link"></i></a>
</h3>
<p>PCA with the covariance matrix (using only centered data). For PCA on the correlation matrix (normed PCA), use scale.unit = TRUE (default option).</p>
<p><strong>Correlation between two variables</strong> <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>:
<span class="math display">\[\rho = \frac{cov(X_1, X_2)}{\sigma_{X_1} \sigma_{X_2}}\]</span></p>
<p>where <span class="math inline">\(cov(X_1, X_2)\)</span> is the covariance, <span class="math inline">\(\sigma_{X_1} = \sqrt{Var(X_1)}\)</span> is the standard deviation of <span class="math inline">\(X_1\)</span>.</p>
<p><strong>Eigen-analysis on the covariance matrix (‚Äòscale.unit=FALSE‚Äô)</strong></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">X</span>, scale.unit <span class="op">=</span> <span class="cn">FALSE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">res.pca.cov</span><span class="op">)</span></span>
<span><span class="co">#&gt; **Results for the Principal Component Analysis (PCA)**</span></span>
<span><span class="co">#&gt; The analysis was performed on 4 individuals, described by 2 variables</span></span>
<span><span class="co">#&gt; *The results are available in the following objects:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    name               description                          </span></span>
<span><span class="co">#&gt; 1  "$eig"             "eigenvalues"                        </span></span>
<span><span class="co">#&gt; 2  "$var"             "results for the variables"          </span></span>
<span><span class="co">#&gt; 3  "$var$coord"       "coord. for the variables"           </span></span>
<span><span class="co">#&gt; 4  "$var$cor"         "correlations variables - dimensions"</span></span>
<span><span class="co">#&gt; 5  "$var$cos2"        "cos2 for the variables"             </span></span>
<span><span class="co">#&gt; 6  "$var$contrib"     "contributions of the variables"     </span></span>
<span><span class="co">#&gt; 7  "$ind"             "results for the individuals"        </span></span>
<span><span class="co">#&gt; 8  "$ind$coord"       "coord. for the individuals"         </span></span>
<span><span class="co">#&gt; 9  "$ind$cos2"        "cos2 for the individuals"           </span></span>
<span><span class="co">#&gt; 10 "$ind$contrib"     "contributions of the individuals"   </span></span>
<span><span class="co">#&gt; 11 "$call"            "summary statistics"                 </span></span>
<span><span class="co">#&gt; 12 "$call$centre"     "mean of the variables"              </span></span>
<span><span class="co">#&gt; 13 "$call$ecart.type" "standard error of the variables"    </span></span>
<span><span class="co">#&gt; 14 "$call$row.w"      "weights for the individuals"        </span></span>
<span><span class="co">#&gt; 15 "$call$col.w"      "weights for the variables"</span></span></code></pre></div>
</div>
<div id="eigen-values" class="section level3" number="10.1.4">
<h3>
<span class="header-section-number">10.1.4</span> 17.1.4 Eigen-values<a class="anchor" aria-label="anchor" href="#eigen-values"><i class="fas fa-link"></i></a>
</h3>
<p>We have <span class="math inline">\(p = 2 = min(n-1, p) = min(3, 2)\)</span> eigen-values, 4 and 1, <span class="math inline">\(Inertia = 4 + 1 = 4\)</span> is the sum of the variances of the variables.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cov</span><span class="op">$</span><span class="va">eig</span></span>
<span><span class="co">#&gt;        eigenvalue percentage of variance</span></span>
<span><span class="co">#&gt; comp 1          4                     80</span></span>
<span><span class="co">#&gt; comp 2          1                     20</span></span>
<span><span class="co">#&gt;        cumulative percentage of variance</span></span>
<span><span class="co">#&gt; comp 1                                80</span></span>
<span><span class="co">#&gt; comp 2                               100</span></span></code></pre></div>
</div>
<div id="the-variables" class="section level3" number="10.1.5">
<h3>
<span class="header-section-number">10.1.5</span> 17.1.5 The variables<a class="anchor" aria-label="anchor" href="#the-variables"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cov</span><span class="op">$</span><span class="va">var</span></span>
<span><span class="co">#&gt; $coord</span></span>
<span><span class="co">#&gt;         Dim.1      Dim.2</span></span>
<span><span class="co">#&gt; Var1 1.414214 -0.7071068</span></span>
<span><span class="co">#&gt; Var2 1.414214  0.7071068</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cor</span></span>
<span><span class="co">#&gt;          Dim.1      Dim.2</span></span>
<span><span class="co">#&gt; Var1 0.8944272 -0.4472136</span></span>
<span><span class="co">#&gt; Var2 0.8944272  0.4472136</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cos2</span></span>
<span><span class="co">#&gt;      Dim.1 Dim.2</span></span>
<span><span class="co">#&gt; Var1   0.8   0.2</span></span>
<span><span class="co">#&gt; Var2   0.8   0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $contrib</span></span>
<span><span class="co">#&gt;      Dim.1 Dim.2</span></span>
<span><span class="co">#&gt; Var1    50    50</span></span>
<span><span class="co">#&gt; Var2    50    50</span></span></code></pre></div>
</div>
<div id="the-individuals" class="section level3" number="10.1.6">
<h3>
<span class="header-section-number">10.1.6</span> 17.1.6 The individuals<a class="anchor" aria-label="anchor" href="#the-individuals"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cov</span><span class="op">$</span><span class="va">ind</span></span>
<span><span class="co">#&gt; $coord</span></span>
<span><span class="co">#&gt;                         Dim.1                       Dim.2</span></span>
<span><span class="co">#&gt; i1  2.82842712474619073503845 -0.000000000000000006357668</span></span>
<span><span class="co">#&gt; i2  0.00000000000000001271534 -1.414213562373095367519227</span></span>
<span><span class="co">#&gt; i3 -0.00000000000000040992080  1.414213562373094923430017</span></span>
<span><span class="co">#&gt; i4 -2.82842712474619029094924  0.000000000000000204960400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cos2</span></span>
<span><span class="co">#&gt;                                          Dim.1</span></span>
<span><span class="co">#&gt; i1 1.00000000000000044408920985006261616945267</span></span>
<span><span class="co">#&gt; i2 0.00000000000000000000000000000000008083988</span></span>
<span><span class="co">#&gt; i3 0.00000000000000000000000000000008401753104</span></span>
<span><span class="co">#&gt; i4 1.00000000000000022204460492503130808472633</span></span>
<span><span class="co">#&gt;                                           Dim.2</span></span>
<span><span class="co">#&gt; i1 0.000000000000000000000000000000000005052492</span></span>
<span><span class="co">#&gt; i2 1.000000000000000444089209850062616169452667</span></span>
<span><span class="co">#&gt; i3 0.999999999999999777955395074968691915273666</span></span>
<span><span class="co">#&gt; i4 0.000000000000000000000000000000005251095690</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $contrib</span></span>
<span><span class="co">#&gt;                                         Dim.1</span></span>
<span><span class="co">#&gt; i1 50.000000000000021316282072803005576133728</span></span>
<span><span class="co">#&gt; i2  0.000000000000000000000000000000001010498</span></span>
<span><span class="co">#&gt; i3  0.000000000000000000000000000001050219138</span></span>
<span><span class="co">#&gt; i4 50.000000000000014210854715202003717422485</span></span>
<span><span class="co">#&gt;                                         Dim.2</span></span>
<span><span class="co">#&gt; i1  0.000000000000000000000000000000001010498</span></span>
<span><span class="co">#&gt; i2 50.000000000000021316282072803005576133728</span></span>
<span><span class="co">#&gt; i3 49.999999999999985789145284797996282577515</span></span>
<span><span class="co">#&gt; i4  0.000000000000000000000000000001050219138</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dist</span></span>
<span><span class="co">#&gt;       i1       i2       i3       i4 </span></span>
<span><span class="co">#&gt; 2.828427 1.414214 1.414214 2.828427</span></span></code></pre></div>
</div>
<div id="another-example" class="section level3" number="10.1.7">
<h3>
<span class="header-section-number">10.1.7</span> 17.1.7 Another example<a class="anchor" aria-label="anchor" href="#another-example"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">12</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">8</span>,<span class="fl">11</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">11</span>,<span class="fl">13</span>,<span class="fl">8</span>,<span class="fl">3</span>,<span class="fl">15</span>,<span class="fl">10</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">6</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">A</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    9   12   10</span></span>
<span><span class="co">#&gt; [2,]   15    9   10</span></span>
<span><span class="co">#&gt; [3,]    5   10    8</span></span>
<span><span class="co">#&gt; [4,]   11   13   14</span></span>
<span><span class="co">#&gt; [5,]   11   13    8</span></span>
<span><span class="co">#&gt; [6,]    3   15   10</span></span>
<span></span>
<span><span class="va">Nframe</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Alex"</span>, <span class="st">"Bea"</span>, <span class="st">"Claudio"</span>,<span class="st">"Damien"</span>, <span class="st">"Emilie"</span>, <span class="st">"Fran"</span><span class="op">)</span></span>
<span><span class="va">m2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Biostatistics"</span>, <span class="st">"Economics"</span>, <span class="st">"English"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">=</span><span class="va">m1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">=</span><span class="va">m2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Biostatistics Economics English</span></span>
<span><span class="co">#&gt; Alex                9        12      10</span></span>
<span><span class="co">#&gt; Bea                15         9      10</span></span>
<span><span class="co">#&gt; Claudio             5        10       8</span></span>
<span><span class="co">#&gt; Damien             11        13      14</span></span>
<span><span class="co">#&gt; Emilie             11        13       8</span></span>
<span><span class="co">#&gt; Fran                3        15      10</span></span></code></pre></div>
</div>
<div id="pca-on-the-correlation-matrix" class="section level3" number="10.1.8">
<h3>
<span class="header-section-number">10.1.8</span> 17.1.8 PCA on the correlation matrix<a class="anchor" aria-label="anchor" href="#pca-on-the-correlation-matrix"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">A</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">)</span></span>
<span><span class="co">#&gt; **Results for the Principal Component Analysis (PCA)**</span></span>
<span><span class="co">#&gt; The analysis was performed on 6 individuals, described by 3 variables</span></span>
<span><span class="co">#&gt; *The results are available in the following objects:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    name               description                          </span></span>
<span><span class="co">#&gt; 1  "$eig"             "eigenvalues"                        </span></span>
<span><span class="co">#&gt; 2  "$var"             "results for the variables"          </span></span>
<span><span class="co">#&gt; 3  "$var$coord"       "coord. for the variables"           </span></span>
<span><span class="co">#&gt; 4  "$var$cor"         "correlations variables - dimensions"</span></span>
<span><span class="co">#&gt; 5  "$var$cos2"        "cos2 for the variables"             </span></span>
<span><span class="co">#&gt; 6  "$var$contrib"     "contributions of the variables"     </span></span>
<span><span class="co">#&gt; 7  "$ind"             "results for the individuals"        </span></span>
<span><span class="co">#&gt; 8  "$ind$coord"       "coord. for the individuals"         </span></span>
<span><span class="co">#&gt; 9  "$ind$cos2"        "cos2 for the individuals"           </span></span>
<span><span class="co">#&gt; 10 "$ind$contrib"     "contributions of the individuals"   </span></span>
<span><span class="co">#&gt; 11 "$call"            "summary statistics"                 </span></span>
<span><span class="co">#&gt; 12 "$call$centre"     "mean of the variables"              </span></span>
<span><span class="co">#&gt; 13 "$call$ecart.type" "standard error of the variables"    </span></span>
<span><span class="co">#&gt; 14 "$call$row.w"      "weights for the individuals"        </span></span>
<span><span class="co">#&gt; 15 "$call$col.w"      "weights for the variables"</span></span></code></pre></div>
</div>
<div id="eigen-values-1" class="section level3" number="10.1.9">
<h3>
<span class="header-section-number">10.1.9</span> 17.1.9 Eigen-values<a class="anchor" aria-label="anchor" href="#eigen-values-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">eig</span></span>
<span><span class="co">#&gt;        eigenvalue percentage of variance</span></span>
<span><span class="co">#&gt; comp 1  1.5000000               50.00000</span></span>
<span><span class="co">#&gt; comp 2  1.1830127               39.43376</span></span>
<span><span class="co">#&gt; comp 3  0.3169873               10.56624</span></span>
<span><span class="co">#&gt;        cumulative percentage of variance</span></span>
<span><span class="co">#&gt; comp 1                          50.00000</span></span>
<span><span class="co">#&gt; comp 2                          89.43376</span></span>
<span><span class="co">#&gt; comp 3                         100.00000</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">get_eigenvalue</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">)</span></span>
<span><span class="co">#&gt;       eigenvalue variance.percent</span></span>
<span><span class="co">#&gt; Dim.1  1.5000000         50.00000</span></span>
<span><span class="co">#&gt; Dim.2  1.1830127         39.43376</span></span>
<span><span class="co">#&gt; Dim.3  0.3169873         10.56624</span></span>
<span><span class="co">#&gt;       cumulative.variance.percent</span></span>
<span><span class="co">#&gt; Dim.1                    50.00000</span></span>
<span><span class="co">#&gt; Dim.2                    89.43376</span></span>
<span><span class="co">#&gt; Dim.3                   100.00000</span></span></code></pre></div>
<p>Kaiser rule suggests <span class="math inline">\(q = 2\)</span> components because the eigen-value mean is 1 (with 89% of explained variance). The rule of Thumb gives <span class="math inline">\(q = 2\)</span> because the first 2 dimensions explain 89% of the variance/inertia.</p>
</div>
<div id="variables" class="section level3" number="10.1.10">
<h3>
<span class="header-section-number">10.1.10</span> 17.1.10 Variables<a class="anchor" aria-label="anchor" href="#variables"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">var</span></span>
<span><span class="co">#&gt; $coord</span></span>
<span><span class="co">#&gt;                                  Dim.1     Dim.2      Dim.3</span></span>
<span><span class="co">#&gt; Biostatistics -0.866025403784438041477 0.3535534  0.3535534</span></span>
<span><span class="co">#&gt; Economics      0.866025403784439040678 0.3535534  0.3535534</span></span>
<span><span class="co">#&gt; English        0.000000000000001047394 0.9659258 -0.2588190</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cor</span></span>
<span><span class="co">#&gt;                                  Dim.1     Dim.2      Dim.3</span></span>
<span><span class="co">#&gt; Biostatistics -0.866025403784438041477 0.3535534  0.3535534</span></span>
<span><span class="co">#&gt; Economics      0.866025403784439151700 0.3535534  0.3535534</span></span>
<span><span class="co">#&gt; English        0.000000000000001047394 0.9659258 -0.2588190</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cos2</span></span>
<span><span class="co">#&gt;                                                Dim.1</span></span>
<span><span class="co">#&gt; Biostatistics 0.749999999999999000799277837359113619</span></span>
<span><span class="co">#&gt; Economics     0.750000000000000888178419700125232339</span></span>
<span><span class="co">#&gt; English       0.000000000000000000000000000001097035</span></span>
<span><span class="co">#&gt;                   Dim.2     Dim.3</span></span>
<span><span class="co">#&gt; Biostatistics 0.1250000 0.1250000</span></span>
<span><span class="co">#&gt; Economics     0.1250000 0.1250000</span></span>
<span><span class="co">#&gt; English       0.9330127 0.0669873</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $contrib</span></span>
<span><span class="co">#&gt;                                                Dim.1</span></span>
<span><span class="co">#&gt; Biostatistics 49.99999999999993605115378159098327160</span></span>
<span><span class="co">#&gt; Economics     50.00000000000005684341886080801486969</span></span>
<span><span class="co">#&gt; English        0.00000000000000000000000000007313567</span></span>
<span><span class="co">#&gt;                  Dim.2    Dim.3</span></span>
<span><span class="co">#&gt; Biostatistics 10.56624 39.43376</span></span>
<span><span class="co">#&gt; Economics     10.56624 39.43376</span></span>
<span><span class="co">#&gt; English       78.86751 21.13249</span></span></code></pre></div>
</div>
<div id="correlations-of-variables-and-componentsdimensions" class="section level3" number="10.1.11">
<h3>
<span class="header-section-number">10.1.11</span> 17.1.11 Correlations of variables and components/dimensions<a class="anchor" aria-label="anchor" href="#correlations-of-variables-and-componentsdimensions"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">cor</span></span>
<span><span class="co">#&gt;                                  Dim.1     Dim.2      Dim.3</span></span>
<span><span class="co">#&gt; Biostatistics -0.866025403784438041477 0.3535534  0.3535534</span></span>
<span><span class="co">#&gt; Economics      0.866025403784439151700 0.3535534  0.3535534</span></span>
<span><span class="co">#&gt; English        0.000000000000001047394 0.9659258 -0.2588190</span></span></code></pre></div>
<p>The first axis is correlated with Biostatistics (+0.86) and Economics (-0.86). The second axis is correlated to English (0.96).</p>
<p>The two components (or dimensions) are correlated with at least one variable. Then <span class="math inline">\(q = 2\)</span> may be considered to reduce the dimension (<span class="math inline">\(p = 3\)</span>).</p>
</div>
<div id="coordinates-of-variables" class="section level3" number="10.1.12">
<h3>
<span class="header-section-number">10.1.12</span> 17.1.12 Coordinates of variables<a class="anchor" aria-label="anchor" href="#coordinates-of-variables"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span></span>
<span><span class="co">#&gt;                                  Dim.1     Dim.2      Dim.3</span></span>
<span><span class="co">#&gt; Biostatistics -0.866025403784438041477 0.3535534  0.3535534</span></span>
<span><span class="co">#&gt; Economics      0.866025403784439040678 0.3535534  0.3535534</span></span>
<span><span class="co">#&gt; English        0.000000000000001047394 0.9659258 -0.2588190</span></span></code></pre></div>
</div>
<div id="quality-of-representation-of-variables" class="section level3" number="10.1.13">
<h3>
<span class="header-section-number">10.1.13</span> 17.1.13 Quality of representation of variables<a class="anchor" aria-label="anchor" href="#quality-of-representation-of-variables"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">cos2</span></span>
<span><span class="co">#&gt;                                                Dim.1</span></span>
<span><span class="co">#&gt; Biostatistics 0.749999999999999000799277837359113619</span></span>
<span><span class="co">#&gt; Economics     0.750000000000000888178419700125232339</span></span>
<span><span class="co">#&gt; English       0.000000000000000000000000000001097035</span></span>
<span><span class="co">#&gt;                   Dim.2     Dim.3</span></span>
<span><span class="co">#&gt; Biostatistics 0.1250000 0.1250000</span></span>
<span><span class="co">#&gt; Economics     0.1250000 0.1250000</span></span>
<span><span class="co">#&gt; English       0.9330127 0.0669873</span></span></code></pre></div>
<p>Biostatistics and Economics are well represented in the first dimension (75%), while English is very well represented in the second axis (93%). In the first plane (Dim.1 and Dim.2) Biostatistics and Economics are well represented (75%+12.5%=87.5%), English is very represented in the first plane (93%+0%=93%)</p>
</div>
<div id="contributions-of-variables" class="section level3" number="10.1.14">
<h3>
<span class="header-section-number">10.1.14</span> 17.1.14 Contributions of variables<a class="anchor" aria-label="anchor" href="#contributions-of-variables"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span></span>
<span><span class="co">#&gt;                                                Dim.1</span></span>
<span><span class="co">#&gt; Biostatistics 49.99999999999993605115378159098327160</span></span>
<span><span class="co">#&gt; Economics     50.00000000000005684341886080801486969</span></span>
<span><span class="co">#&gt; English        0.00000000000000000000000000007313567</span></span>
<span><span class="co">#&gt;                  Dim.2    Dim.3</span></span>
<span><span class="co">#&gt; Biostatistics 10.56624 39.43376</span></span>
<span><span class="co">#&gt; Economics     10.56624 39.43376</span></span>
<span><span class="co">#&gt; English       78.86751 21.13249</span></span></code></pre></div>
<p>Biostatistics and Economics contribute to the construction of the first dimension (50%), while English contribute highy to the construction of the second axis (78.8%). In the first plane (Dim.1 and Dim.2) the contribution of Biostatistics and Economics is 50%+10.5%=65.5%, that of English is 78.8%.</p>
<p><strong>Description of the first dimension</strong></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc</a></span><span class="op">(</span><span class="va">res.pca.cor</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Dim.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Link between the variable and the continuous variables (R-square)</span></span>
<span><span class="co">#&gt; =================================================================================</span></span>
<span><span class="co">#&gt;               correlation    p.value</span></span>
<span><span class="co">#&gt; Economics       0.8660254 0.02572142</span></span>
<span><span class="co">#&gt; Biostatistics  -0.8660254 0.02572142</span></span></code></pre></div>
</div>
<div id="contributions-of-first-two-variables" class="section level3" number="10.1.15">
<h3>
<span class="header-section-number">10.1.15</span> 17.1.15 Contributions of first two variables<a class="anchor" aria-label="anchor" href="#contributions-of-first-two-variables"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                                Dim.1</span></span>
<span><span class="co">#&gt; Biostatistics 49.99999999999993605115378159098327160</span></span>
<span><span class="co">#&gt; Economics     50.00000000000005684341886080801486969</span></span>
<span><span class="co">#&gt; English        0.00000000000000000000000000007313567</span></span>
<span><span class="co">#&gt;                  Dim.2</span></span>
<span><span class="co">#&gt; Biostatistics 10.56624</span></span>
<span><span class="co">#&gt; Economics     10.56624</span></span>
<span><span class="co">#&gt; English       78.86751</span></span></code></pre></div>
</div>
<div id="representation-of-variables" class="section level3" number="10.1.16">
<h3>
<span class="header-section-number">10.1.16</span> 17.1.16 Representation of variables<a class="anchor" aria-label="anchor" href="#representation-of-variables"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca.cor</span>, col.var <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-vars-1.png" width="100%"></div>
</div>
<div id="with-the-quality-of-representation" class="section level3" number="10.1.17">
<h3>
<span class="header-section-number">10.1.17</span> 17.1.17 With the quality of representation<a class="anchor" aria-label="anchor" href="#with-the-quality-of-representation"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca.cor</span>, col.var <span class="op">=</span> <span class="st">"cos2"</span>,</span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-vars-quality-1.png" width="100%"></div>
</div>
<div id="variables-with-quality-of-representation-larger-than-0.6" class="section level3" number="10.1.18">
<h3>
<span class="header-section-number">10.1.18</span> 17.1.18 Variables with quality of representation larger than 0.6<a class="anchor" aria-label="anchor" href="#variables-with-quality-of-representation-larger-than-0.6"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca.cor</span>, select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cos2 <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-vars-quality-filter-1.png" width="100%"></div>
</div>
<div id="with-contribution" class="section level3" number="10.1.19">
<h3>
<span class="header-section-number">10.1.19</span> 17.1.19 With contribution<a class="anchor" aria-label="anchor" href="#with-contribution"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca.cor</span>, col.var <span class="op">=</span> <span class="st">"contrib"</span>,</span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-vars-contrib-1.png" width="100%"></div>
</div>
<div id="variables-and-individuals-with-largest-quality-of-representation" class="section level3" number="10.1.20">
<h3>
<span class="header-section-number">10.1.20</span> 17.1.20 Variables and individuals with largest quality of representation<a class="anchor" aria-label="anchor" href="#variables-and-individuals-with-largest-quality-of-representation"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span><span class="va">res.pca.cor</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                col.var <span class="op">=</span> <span class="st">"#2E9FDF"</span>, <span class="co"># Variables color</span></span>
<span>                col.ind <span class="op">=</span> <span class="st">"#696969"</span>  <span class="co"># Individuals color</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-biplot-1.png" width="100%"></div>
</div>
<div id="the-individuals-1" class="section level3" number="10.1.21">
<h3>
<span class="header-section-number">10.1.21</span> 17.1.21 The individuals<a class="anchor" aria-label="anchor" href="#the-individuals-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">ind</span></span>
<span><span class="co">#&gt; $coord</span></span>
<span><span class="co">#&gt;                             Dim.1                    Dim.2</span></span>
<span><span class="co">#&gt; Alex     0.0000000000000002653034 -0.000000000000000941663</span></span>
<span><span class="co">#&gt; Bea     -2.1213203435596423851450  0.000000000000001237395</span></span>
<span><span class="co">#&gt; Claudio -0.0000000000000022171779 -1.538189001320852344890</span></span>
<span><span class="co">#&gt; Damien   0.0000000000000026937746  2.101205251626097503248</span></span>
<span><span class="co">#&gt; Emilie   0.0000000000000001895371 -0.563016250305248155961</span></span>
<span><span class="co">#&gt; Fran     2.1213203435596428292342 -0.000000000000002975084</span></span>
<span><span class="co">#&gt;                              Dim.3</span></span>
<span><span class="co">#&gt; Alex    -0.00000000000000007994654</span></span>
<span><span class="co">#&gt; Bea      0.00000000000000015526499</span></span>
<span><span class="co">#&gt; Claudio -0.79622521701812609684623</span></span>
<span><span class="co">#&gt; Damien  -0.29143865656241157990891</span></span>
<span><span class="co">#&gt; Emilie   1.08766387358053817635550</span></span>
<span><span class="co">#&gt; Fran     0.00000000000000002468473</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cos2</span></span>
<span><span class="co">#&gt;                                            Dim.1</span></span>
<span><span class="co">#&gt; Alex    0.07137976857538211317155685264879139140</span></span>
<span><span class="co">#&gt; Bea     1.00000000000000022204460492503130808473</span></span>
<span><span class="co">#&gt; Claudio 0.00000000000000000000000000000163862588</span></span>
<span><span class="co">#&gt; Damien  0.00000000000000000000000000000161253810</span></span>
<span><span class="co">#&gt; Emilie  0.00000000000000000000000000000002394954</span></span>
<span><span class="co">#&gt; Fran    0.99999999999999977795539507496869191527</span></span>
<span><span class="co">#&gt;                                           Dim.2</span></span>
<span><span class="co">#&gt; Alex    0.8992501752497785716400358069222420454</span></span>
<span><span class="co">#&gt; Bea     0.0000000000000000000000000000003402549</span></span>
<span><span class="co">#&gt; Claudio 0.7886751345948129765517364830884616822</span></span>
<span><span class="co">#&gt; Damien  0.9811252243246878501636842884181533009</span></span>
<span><span class="co">#&gt; Emilie  0.2113248654051877173376539076343760826</span></span>
<span><span class="co">#&gt; Fran    0.0000000000000000000000000000019669168</span></span>
<span><span class="co">#&gt;                                             Dim.3</span></span>
<span><span class="co">#&gt; Alex    0.006481699860810073883510273873298501712</span></span>
<span><span class="co">#&gt; Bea     0.000000000000000000000000000000005357159</span></span>
<span><span class="co">#&gt; Claudio 0.211324865405187134470565979427192360163</span></span>
<span><span class="co">#&gt; Damien  0.018874775675311854933324795524640649091</span></span>
<span><span class="co">#&gt; Emilie  0.788675134594813309618643870635423809290</span></span>
<span><span class="co">#&gt; Fran    0.000000000000000000000000000000000135408</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $contrib</span></span>
<span><span class="co">#&gt;                                            Dim.1</span></span>
<span><span class="co">#&gt; Alex     0.0000000000000000000000000000007820654</span></span>
<span><span class="co">#&gt; Bea     50.0000000000000000000000000000000000000</span></span>
<span><span class="co">#&gt; Claudio  0.0000000000000000000000000000546208628</span></span>
<span><span class="co">#&gt; Damien   0.0000000000000000000000000000806269052</span></span>
<span><span class="co">#&gt; Emilie   0.0000000000000000000000000000003991590</span></span>
<span><span class="co">#&gt; Fran    50.0000000000000213162820728030055761337</span></span>
<span><span class="co">#&gt;                                          Dim.2</span></span>
<span><span class="co">#&gt; Alex     0.00000000000000000000000000001249253</span></span>
<span><span class="co">#&gt; Bea      0.00000000000000000000000000002157130</span></span>
<span><span class="co">#&gt; Claudio 33.33333333333337833437326480634510517</span></span>
<span><span class="co">#&gt; Damien  62.20084679281458051036679535172879696</span></span>
<span><span class="co">#&gt; Emilie   4.46581987385206335972043234505690634</span></span>
<span><span class="co">#&gt; Fran     0.00000000000000000000000000012469753</span></span>
<span><span class="co">#&gt;                                             Dim.3</span></span>
<span><span class="co">#&gt; Alex     0.00000000000000000000000000000033605182</span></span>
<span><span class="co">#&gt; Bea      0.00000000000000000000000000000126751744</span></span>
<span><span class="co">#&gt; Claudio 33.33333333333333570180911920033395290375</span></span>
<span><span class="co">#&gt; Damien   4.46581987385203582618942164117470383644</span></span>
<span><span class="co">#&gt; Emilie  62.20084679281465867006772896274924278259</span></span>
<span><span class="co">#&gt; Fran     0.00000000000000000000000000000003203788</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dist</span></span>
<span><span class="co">#&gt;                     Alex                      Bea </span></span>
<span><span class="co">#&gt; 0.0000000000000009930137 2.1213203435596419410558 </span></span>
<span><span class="co">#&gt;                  Claudio                   Damien </span></span>
<span><span class="co">#&gt; 1.7320508075688780813550 2.1213203435596419410558 </span></span>
<span><span class="co">#&gt;                   Emilie                     Fran </span></span>
<span><span class="co">#&gt; 1.2247448713915896068016 2.1213203435596428292342</span></span></code></pre></div>
</div>
<div id="individuals-coordinates" class="section level3" number="10.1.22">
<h3>
<span class="header-section-number">10.1.22</span> 17.1.22 Individuals: coordinates<a class="anchor" aria-label="anchor" href="#individuals-coordinates"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span></span>
<span><span class="co">#&gt;                             Dim.1                    Dim.2</span></span>
<span><span class="co">#&gt; Alex     0.0000000000000002653034 -0.000000000000000941663</span></span>
<span><span class="co">#&gt; Bea     -2.1213203435596423851450  0.000000000000001237395</span></span>
<span><span class="co">#&gt; Claudio -0.0000000000000022171779 -1.538189001320852344890</span></span>
<span><span class="co">#&gt; Damien   0.0000000000000026937746  2.101205251626097503248</span></span>
<span><span class="co">#&gt; Emilie   0.0000000000000001895371 -0.563016250305248155961</span></span>
<span><span class="co">#&gt; Fran     2.1213203435596428292342 -0.000000000000002975084</span></span>
<span><span class="co">#&gt;                              Dim.3</span></span>
<span><span class="co">#&gt; Alex    -0.00000000000000007994654</span></span>
<span><span class="co">#&gt; Bea      0.00000000000000015526499</span></span>
<span><span class="co">#&gt; Claudio -0.79622521701812609684623</span></span>
<span><span class="co">#&gt; Damien  -0.29143865656241157990891</span></span>
<span><span class="co">#&gt; Emilie   1.08766387358053817635550</span></span>
<span><span class="co">#&gt; Fran     0.00000000000000002468473</span></span></code></pre></div>
</div>
<div id="quality-of-representation" class="section level3" number="10.1.23">
<h3>
<span class="header-section-number">10.1.23</span> 17.1.23 Quality of representation<a class="anchor" aria-label="anchor" href="#quality-of-representation"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">cos2</span></span>
<span><span class="co">#&gt;                                            Dim.1</span></span>
<span><span class="co">#&gt; Alex    0.07137976857538211317155685264879139140</span></span>
<span><span class="co">#&gt; Bea     1.00000000000000022204460492503130808473</span></span>
<span><span class="co">#&gt; Claudio 0.00000000000000000000000000000163862588</span></span>
<span><span class="co">#&gt; Damien  0.00000000000000000000000000000161253810</span></span>
<span><span class="co">#&gt; Emilie  0.00000000000000000000000000000002394954</span></span>
<span><span class="co">#&gt; Fran    0.99999999999999977795539507496869191527</span></span>
<span><span class="co">#&gt;                                           Dim.2</span></span>
<span><span class="co">#&gt; Alex    0.8992501752497785716400358069222420454</span></span>
<span><span class="co">#&gt; Bea     0.0000000000000000000000000000003402549</span></span>
<span><span class="co">#&gt; Claudio 0.7886751345948129765517364830884616822</span></span>
<span><span class="co">#&gt; Damien  0.9811252243246878501636842884181533009</span></span>
<span><span class="co">#&gt; Emilie  0.2113248654051877173376539076343760826</span></span>
<span><span class="co">#&gt; Fran    0.0000000000000000000000000000019669168</span></span>
<span><span class="co">#&gt;                                             Dim.3</span></span>
<span><span class="co">#&gt; Alex    0.006481699860810073883510273873298501712</span></span>
<span><span class="co">#&gt; Bea     0.000000000000000000000000000000005357159</span></span>
<span><span class="co">#&gt; Claudio 0.211324865405187134470565979427192360163</span></span>
<span><span class="co">#&gt; Damien  0.018874775675311854933324795524640649091</span></span>
<span><span class="co">#&gt; Emilie  0.788675134594813309618643870635423809290</span></span>
<span><span class="co">#&gt; Fran    0.000000000000000000000000000000000135408</span></span></code></pre></div>
</div>
<div id="contributions" class="section level3" number="10.1.24">
<h3>
<span class="header-section-number">10.1.24</span> 17.1.24 Contributions<a class="anchor" aria-label="anchor" href="#contributions"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">contrib</span></span>
<span><span class="co">#&gt;                                            Dim.1</span></span>
<span><span class="co">#&gt; Alex     0.0000000000000000000000000000007820654</span></span>
<span><span class="co">#&gt; Bea     50.0000000000000000000000000000000000000</span></span>
<span><span class="co">#&gt; Claudio  0.0000000000000000000000000000546208628</span></span>
<span><span class="co">#&gt; Damien   0.0000000000000000000000000000806269052</span></span>
<span><span class="co">#&gt; Emilie   0.0000000000000000000000000000003991590</span></span>
<span><span class="co">#&gt; Fran    50.0000000000000213162820728030055761337</span></span>
<span><span class="co">#&gt;                                          Dim.2</span></span>
<span><span class="co">#&gt; Alex     0.00000000000000000000000000001249253</span></span>
<span><span class="co">#&gt; Bea      0.00000000000000000000000000002157130</span></span>
<span><span class="co">#&gt; Claudio 33.33333333333337833437326480634510517</span></span>
<span><span class="co">#&gt; Damien  62.20084679281458051036679535172879696</span></span>
<span><span class="co">#&gt; Emilie   4.46581987385206335972043234505690634</span></span>
<span><span class="co">#&gt; Fran     0.00000000000000000000000000012469753</span></span>
<span><span class="co">#&gt;                                             Dim.3</span></span>
<span><span class="co">#&gt; Alex     0.00000000000000000000000000000033605182</span></span>
<span><span class="co">#&gt; Bea      0.00000000000000000000000000000126751744</span></span>
<span><span class="co">#&gt; Claudio 33.33333333333333570180911920033395290375</span></span>
<span><span class="co">#&gt; Damien   4.46581987385203582618942164117470383644</span></span>
<span><span class="co">#&gt; Emilie  62.20084679281465867006772896274924278259</span></span>
<span><span class="co">#&gt; Fran     0.00000000000000000000000000000003203788</span></span></code></pre></div>
</div>
<div id="contributions-on-the-first-two-axes" class="section level3" number="10.1.25">
<h3>
<span class="header-section-number">10.1.25</span> 17.1.25 Contributions on the first two axes<a class="anchor" aria-label="anchor" href="#contributions-on-the-first-two-axes"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca.cor</span>, col.ind <span class="op">=</span> <span class="st">"contrib"</span>,</span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-ind-contrib-1.png" width="100%"></div>
</div>
<div id="representation-of-individuals-with-respect-to-quality-of-projection" class="section level3" number="10.1.26">
<h3>
<span class="header-section-number">10.1.26</span> 17.1.26 Representation of individuals with respect to quality of projection<a class="anchor" aria-label="anchor" href="#representation-of-individuals-with-respect-to-quality-of-projection"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca.cor</span>, col.ind <span class="op">=</span> <span class="st">"cos2"</span>,</span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-ind-quality-1.png" width="100%"></div>
</div>
<div id="save-the-figures-in-pdf" class="section level3" number="10.1.27">
<h3>
<span class="header-section-number">10.1.27</span> 17.1.27 Save the figures in pdf<a class="anchor" aria-label="anchor" href="#save-the-figures-in-pdf"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span><span class="st">"PCA.pdf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="save-in-png" class="section level3" number="10.1.28">
<h3>
<span class="header-section-number">10.1.28</span> 17.1.28 Save in png<a class="anchor" aria-label="anchor" href="#save-in-png"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"PCA%03d.png"</span>, width <span class="op">=</span> <span class="fl">800</span>, height <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="export-the-results-in-txt-files" class="section level3" number="10.1.29">
<h3>
<span class="header-section-number">10.1.29</span> 17.1.29 Export the results in txt files<a class="anchor" aria-label="anchor" href="#export-the-results-in-txt-files"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">eig</span>, <span class="st">"eigenvalues.txt"</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span>, <span class="st">"variables_coordinates.txt"</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">res.pca.cor</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span>, <span class="st">"individuals_coordinates.txt"</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="pca-with-prcomp-function-of-the-base-r-package" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> 17.2 PCA with prcomp function of the base R package<a class="anchor" aria-label="anchor" href="#pca-with-prcomp-function-of-the-base-r-package"><i class="fas fa-link"></i></a>
</h2>
<p>Here we perform PCA on the USArrests, the rows of the data set contain the 50 states, in alphabetical order.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ?USArrests  # Commented out - prints documentation examples to output</span></span>
<span><span class="co"># View(USArrests)  # Commented out - requires XQuartz on macOS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span></span>
<span><span class="co">#&gt;            Murder Assault UrbanPop Rape</span></span>
<span><span class="co">#&gt; Alabama      13.2     236       58 21.2</span></span>
<span><span class="co">#&gt; Alaska       10.0     263       48 44.5</span></span>
<span><span class="co">#&gt; Arizona       8.1     294       80 31.0</span></span>
<span><span class="co">#&gt; Arkansas      8.8     190       50 19.5</span></span>
<span><span class="co">#&gt; California    9.0     276       91 40.6</span></span>
<span><span class="co">#&gt; Colorado      7.9     204       78 38.7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Alabama"        "Alaska"         "Arizona"       </span></span>
<span><span class="co">#&gt;  [4] "Arkansas"       "California"     "Colorado"      </span></span>
<span><span class="co">#&gt;  [7] "Connecticut"    "Delaware"       "Florida"       </span></span>
<span><span class="co">#&gt; [10] "Georgia"        "Hawaii"         "Idaho"         </span></span>
<span><span class="co">#&gt; [13] "Illinois"       "Indiana"        "Iowa"          </span></span>
<span><span class="co">#&gt; [16] "Kansas"         "Kentucky"       "Louisiana"     </span></span>
<span><span class="co">#&gt; [19] "Maine"          "Maryland"       "Massachusetts" </span></span>
<span><span class="co">#&gt; [22] "Michigan"       "Minnesota"      "Mississippi"   </span></span>
<span><span class="co">#&gt; [25] "Missouri"       "Montana"        "Nebraska"      </span></span>
<span><span class="co">#&gt; [28] "Nevada"         "New Hampshire"  "New Jersey"    </span></span>
<span><span class="co">#&gt; [31] "New Mexico"     "New York"       "North Carolina"</span></span>
<span><span class="co">#&gt; [34] "North Dakota"   "Ohio"           "Oklahoma"      </span></span>
<span><span class="co">#&gt; [37] "Oregon"         "Pennsylvania"   "Rhode Island"  </span></span>
<span><span class="co">#&gt; [40] "South Carolina" "South Dakota"   "Tennessee"     </span></span>
<span><span class="co">#&gt; [43] "Texas"          "Utah"           "Vermont"       </span></span>
<span><span class="co">#&gt; [46] "Virginia"       "Washington"     "West Virginia" </span></span>
<span><span class="co">#&gt; [49] "Wisconsin"      "Wyoming"</span></span></code></pre></div>
<p>The columns of the data set contain four variables:</p>
<ul>
<li>Murder: Murder arrests (per 100,000)</li>
<li>Assault: Assault arrests (per 100,000)</li>
<li>UrbanPop: Percent urban population</li>
<li>Rape: Rape arrests (per 100,000)</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Murder"   "Assault"  "UrbanPop" "Rape"</span></span></code></pre></div>
<p>Notice that the variables have vastly different means (of variables in columns), with the apply() function. ‚Äòapply(USArrests, 2, mean)‚Äô permits to calculate the means of each column, the option ‚Äò1‚Äô will do the calculation by row</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">USArrests</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Murder  Assault UrbanPop     Rape </span></span>
<span><span class="co">#&gt;    7.788  170.760   65.540   21.232</span></span></code></pre></div>
<p>There are on average three times as many rapes as murders, and more than eight times as many assaults as rapes. Let us also examine the variances of the variables</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">USArrests</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Murder    Assault   UrbanPop       Rape </span></span>
<span><span class="co">#&gt;   18.97047 6945.16571  209.51878   87.72916</span></span></code></pre></div>
<p>The variables have very different variances: the UrbanPop variable measuring the percentage of the population in each state living in an urban area, is not a comparable number to the number of rapes in each state per 100,000 individuals. If we do not scale the variables before performing PCA, then most of the principal components that we observed would be driven by the Assault variable, since it has the largest mean and variance. Here, it is important to standardize the variables to have mean zero and standard deviation one before performing PCA.</p>
<p>The option scale = TRUE, does a scaling of the variables to have standard deviation one.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">USArrests</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">pr.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sdev"     "rotation" "center"   "scale"    "x"</span></span></code></pre></div>
<p>The center and scale components correspond to the means and standard deviations of the variables that were used for scaling prior to implementing PCA.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr.out</span><span class="op">$</span><span class="va">center</span></span>
<span><span class="co">#&gt;   Murder  Assault UrbanPop     Rape </span></span>
<span><span class="co">#&gt;    7.788  170.760   65.540   21.232</span></span>
<span><span class="va">pr.out</span><span class="op">$</span><span class="va">scale</span></span>
<span><span class="co">#&gt;    Murder   Assault  UrbanPop      Rape </span></span>
<span><span class="co">#&gt;  4.355510 83.337661 14.474763  9.366385</span></span></code></pre></div>
<p>The rotation matrix provides the principal component loadings; each column of pr.out$rotation contains the corresponding principal component loading vector.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr.out</span><span class="op">$</span><span class="va">rotation</span></span>
<span><span class="co">#&gt;                 PC1        PC2        PC3         PC4</span></span>
<span><span class="co">#&gt; Murder   -0.5358995  0.4181809 -0.3412327  0.64922780</span></span>
<span><span class="co">#&gt; Assault  -0.5831836  0.1879856 -0.2681484 -0.74340748</span></span>
<span><span class="co">#&gt; UrbanPop -0.2781909 -0.8728062 -0.3780158  0.13387773</span></span>
<span><span class="co">#&gt; Rape     -0.5434321 -0.1673186  0.8177779  0.08902432</span></span></code></pre></div>
<p>We see that there are four distinct principal components. This is to be expected because there are in general <span class="math inline">\(min(n-1, p)\)</span> informative principal components in a data set with <span class="math inline">\(n\)</span> observations and <span class="math inline">\(p\)</span> variables.</p>
<p>Using the pr.out$x we have the <span class="math inline">\(50 \times 4\)</span> matrix x principal component score vectors. That is, the <span class="math inline">\(k\)</span>th column is the <span class="math inline">\(k\)</span>th principal component score vector.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pr.out</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 50  4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pr.out</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   PC1        PC2         PC3          PC4</span></span>
<span><span class="co">#&gt; Alabama    -0.9756604  1.1220012 -0.43980366  0.154696581</span></span>
<span><span class="co">#&gt; Alaska     -1.9305379  1.0624269  2.01950027 -0.434175454</span></span>
<span><span class="co">#&gt; Arizona    -1.7454429 -0.7384595  0.05423025 -0.826264240</span></span>
<span><span class="co">#&gt; Arkansas    0.1399989  1.1085423  0.11342217 -0.180973554</span></span>
<span><span class="co">#&gt; California -2.4986128 -1.5274267  0.59254100 -0.338559240</span></span>
<span><span class="co">#&gt; Colorado   -1.4993407 -0.9776297  1.08400162  0.001450164</span></span></code></pre></div>
<p>We can plot the first two principal components as follows:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">pr.out</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-prcomp-1.png" width="100%"></div>
<p>The scale = 0 argument to biplot() ensures that the arrows are scaled to represent the loadings; other values for scale give slightly different biplots with different interpretations.</p>
<p>The principal components are only unique up to a sign change, so we can reproduce the above figure by making a small changes:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr.out</span><span class="op">$</span><span class="va">rotation</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">pr.out</span><span class="op">$</span><span class="va">rotation</span></span>
<span><span class="va">pr.out</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">pr.out</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">pr.out</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/prcomp-sign-change-1.png" width="100%"></div>
<p>The standard deviation (square root of the corresponding eigen-value) of each principal component is as follows:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr.out</span><span class="op">$</span><span class="va">sdev</span></span>
<span><span class="co">#&gt; [1] 1.5748783 0.9948694 0.5971291 0.4164494</span></span></code></pre></div>
<p>The variance explained by each principal component (corresponding eigen-value) is obtained by squaring these:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr.var</span> <span class="op">&lt;-</span> <span class="va">pr.out</span><span class="op">$</span><span class="va">sdev</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">pr.var</span></span>
<span><span class="co">#&gt; [1] 2.4802416 0.9897652 0.3565632 0.1734301</span></span></code></pre></div>
<p>Compute the proportion of variance explained by each principal component as follows</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pve</span> <span class="op">&lt;-</span> <span class="va">pr.var</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pr.var</span><span class="op">)</span></span>
<span><span class="va">pve</span></span>
<span><span class="co">#&gt; [1] 0.62006039 0.24744129 0.08914080 0.04335752</span></span></code></pre></div>
<p>We see that the first principal component explains <span class="math inline">\(62.0\%\)</span> of the variance in the data, the next principal component explains <span class="math inline">\(24.7\%\)</span> of the variance. Plot the PVE (Proportion of Variance Explained) explained by each component, and the cumulative PVE, as follows:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pve</span>, xlab <span class="op">=</span> <span class="st">"Principal Component"</span>, ylab <span class="op">=</span> <span class="st">"Proportion of Variance Explained"</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">pve</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Principal Component"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Cumulative Proportion of Variance Explained"</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="17-pca_files/figure-html/plot-pve-1.png" width="100%"></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The function cumsum() computes the cumulative sum of the elements of a numeric vector.</p>
</div>
<div id="exercise-1-nutritional-and-marketing-information-on-us-cereals" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> 17.3 Exercise 1: Nutritional and Marketing Information on US Cereals<a class="anchor" aria-label="anchor" href="#exercise-1-nutritional-and-marketing-information-on-us-cereals"><i class="fas fa-link"></i></a>
</h2>
<p>Consider the UScereal data (65 rows and 11 columns, package ‚ÄòMASS‚Äô) from the 1993 ASA Statistical Graphics Exposition and taken from the mandatory F&amp;DA food label. The data have been normalized here to a portion of one American cup.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">UScereal</span><span class="op">)</span></span>
<span><span class="co"># Note: Some variables are not quantitative</span></span>
<span><span class="co"># res.pca.cereal &lt;- PCA(UScereal, scale.unit = TRUE, graph = FALSE)</span></span></code></pre></div>
</div>
<div id="exercise-2" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> 17.4 Exercise 2<a class="anchor" aria-label="anchor" href="#exercise-2"><i class="fas fa-link"></i></a>
</h2>
<p>Consider the NCI cancer cell line microarray data, which consists of <span class="math inline">\(6,830\)</span> gene expression measurements on <span class="math inline">\(64\)</span> cancer cell lines.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.statlearning.com">ISLR2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">NCI60</span><span class="op">)</span></span>
<span><span class="co"># Each cell line is labeled with a cancer type, given in nci.labs.</span></span></code></pre></div>
<div id="exercise-3-wine-quality-analysis" class="section level3" number="10.4.1">
<h3>
<span class="header-section-number">10.4.1</span> 17.4.1 Exercise 3: Wine Quality Analysis<a class="anchor" aria-label="anchor" href="#exercise-3-wine-quality-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the wine dataset available in the gclus package, which contains chemical analyses of wines grown in the same region in Italy but derived from three different cultivars. The dataset has 13 variables and over 170 observations.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gclus</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">wine</span><span class="op">)</span></span></code></pre></div>
<div id="tasks" class="section level4" number="10.4.1.1">
<h4>
<span class="header-section-number">10.4.1.1</span> Tasks:<a class="anchor" aria-label="anchor" href="#tasks"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: lower-alpha">
<li>Perform PCA on the wine dataset. Remember to standardize the variables if necessary, as they might be on different scales.</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example code snippet</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="va">res.pca.wine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">wine</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Interpret the PCA results. Focus on understanding which chemical properties contribute most to the variance in the dataset and if the wines cluster by cultivar.</li>
</ol>
</div>
</div>
<div id="exercise-4-boston-housing-data-analysis" class="section level3" number="10.4.2">
<h3>
<span class="header-section-number">10.4.2</span> 17.4.2 Exercise 4: Boston Housing Data Analysis<a class="anchor" aria-label="anchor" href="#exercise-4-boston-housing-data-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the Boston dataset from the MASS package, which contains information collected by the U.S Census Service concerning housing in the area of Boston Mass. It has 506 rows and 14 columns.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span></span></code></pre></div>
<div id="tasks-1" class="section level4" number="10.4.2.1">
<h4>
<span class="header-section-number">10.4.2.1</span> Tasks:<a class="anchor" aria-label="anchor" href="#tasks-1"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: lower-alpha">
<li>Conduct PCA on the Boston housing dataset. Before performing PCA, assess which variables are most suitable for the analysis and preprocess the data accordingly.</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example code snippet</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="va">res.pca.boston</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">Boston</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Interpret the results of the PCA. Look for patterns that might indicate relationships between different aspects of the housing data, such as crime rates, property tax, and median value of owner-occupied homes.</li>
</ol>
</div>
</div>
<div id="notes-for-solving" class="section level3" number="10.4.3">
<h3>
<span class="header-section-number">10.4.3</span> 17.4.3 Notes for Solving:<a class="anchor" aria-label="anchor" href="#notes-for-solving"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><strong>Data Preprocessing</strong>: Before performing PCA, it‚Äôs crucial to preprocess the data. This may include handling missing values, standardizing the data, and selecting relevant variables.</p></li>
<li><p><strong>PCA Interpretation</strong>: When interpreting the results, focus on the eigenvalues, the proportion of variance explained by the principal components, and the loadings of the variables on the principal components.</p></li>
<li><p><strong>Visualization</strong>: Use plots like scree plots, biplots, or individual component plots to aid in your interpretation, use packages that do that for you!</p></li>
<li><p><strong>Contextual Understanding</strong>: Each dataset has its context. Understanding the domain can significantly help in interpreting the results meaningfully.</p></li>
</ul>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="advanced-modeling-techniques.html"><span class="header-section-number">9</span> üöÄ Advanced Modeling Techniques</a></div>
<div class="next"><a href="hier-clust.html"><span class="header-section-number">11</span> üíª Hierarchical Clustering</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#pca"><span class="header-section-number">10</span> üíª PCA</a></li>
<li>
<a class="nav-link" href="#principal-components-analysis"><span class="header-section-number">10.1</span> 17.1 Principal Components Analysis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pca-using-factominer-factoextra"><span class="header-section-number">10.1.1</span> 17.1.1 PCA using ‚ÄòFactoMineR‚Äô, ‚Äòfactoextra‚Äô</a></li>
<li><a class="nav-link" href="#exercise-1-read-the-data"><span class="header-section-number">10.1.2</span> 17.1.2 Exercise 1 : read the data</a></li>
<li><a class="nav-link" href="#pca-function"><span class="header-section-number">10.1.3</span> 17.1.3 PCA function</a></li>
<li><a class="nav-link" href="#eigen-values"><span class="header-section-number">10.1.4</span> 17.1.4 Eigen-values</a></li>
<li><a class="nav-link" href="#the-variables"><span class="header-section-number">10.1.5</span> 17.1.5 The variables</a></li>
<li><a class="nav-link" href="#the-individuals"><span class="header-section-number">10.1.6</span> 17.1.6 The individuals</a></li>
<li><a class="nav-link" href="#another-example"><span class="header-section-number">10.1.7</span> 17.1.7 Another example</a></li>
<li><a class="nav-link" href="#pca-on-the-correlation-matrix"><span class="header-section-number">10.1.8</span> 17.1.8 PCA on the correlation matrix</a></li>
<li><a class="nav-link" href="#eigen-values-1"><span class="header-section-number">10.1.9</span> 17.1.9 Eigen-values</a></li>
<li><a class="nav-link" href="#variables"><span class="header-section-number">10.1.10</span> 17.1.10 Variables</a></li>
<li><a class="nav-link" href="#correlations-of-variables-and-componentsdimensions"><span class="header-section-number">10.1.11</span> 17.1.11 Correlations of variables and components/dimensions</a></li>
<li><a class="nav-link" href="#coordinates-of-variables"><span class="header-section-number">10.1.12</span> 17.1.12 Coordinates of variables</a></li>
<li><a class="nav-link" href="#quality-of-representation-of-variables"><span class="header-section-number">10.1.13</span> 17.1.13 Quality of representation of variables</a></li>
<li><a class="nav-link" href="#contributions-of-variables"><span class="header-section-number">10.1.14</span> 17.1.14 Contributions of variables</a></li>
<li><a class="nav-link" href="#contributions-of-first-two-variables"><span class="header-section-number">10.1.15</span> 17.1.15 Contributions of first two variables</a></li>
<li><a class="nav-link" href="#representation-of-variables"><span class="header-section-number">10.1.16</span> 17.1.16 Representation of variables</a></li>
<li><a class="nav-link" href="#with-the-quality-of-representation"><span class="header-section-number">10.1.17</span> 17.1.17 With the quality of representation</a></li>
<li><a class="nav-link" href="#variables-with-quality-of-representation-larger-than-0.6"><span class="header-section-number">10.1.18</span> 17.1.18 Variables with quality of representation larger than 0.6</a></li>
<li><a class="nav-link" href="#with-contribution"><span class="header-section-number">10.1.19</span> 17.1.19 With contribution</a></li>
<li><a class="nav-link" href="#variables-and-individuals-with-largest-quality-of-representation"><span class="header-section-number">10.1.20</span> 17.1.20 Variables and individuals with largest quality of representation</a></li>
<li><a class="nav-link" href="#the-individuals-1"><span class="header-section-number">10.1.21</span> 17.1.21 The individuals</a></li>
<li><a class="nav-link" href="#individuals-coordinates"><span class="header-section-number">10.1.22</span> 17.1.22 Individuals: coordinates</a></li>
<li><a class="nav-link" href="#quality-of-representation"><span class="header-section-number">10.1.23</span> 17.1.23 Quality of representation</a></li>
<li><a class="nav-link" href="#contributions"><span class="header-section-number">10.1.24</span> 17.1.24 Contributions</a></li>
<li><a class="nav-link" href="#contributions-on-the-first-two-axes"><span class="header-section-number">10.1.25</span> 17.1.25 Contributions on the first two axes</a></li>
<li><a class="nav-link" href="#representation-of-individuals-with-respect-to-quality-of-projection"><span class="header-section-number">10.1.26</span> 17.1.26 Representation of individuals with respect to quality of projection</a></li>
<li><a class="nav-link" href="#save-the-figures-in-pdf"><span class="header-section-number">10.1.27</span> 17.1.27 Save the figures in pdf</a></li>
<li><a class="nav-link" href="#save-in-png"><span class="header-section-number">10.1.28</span> 17.1.28 Save in png</a></li>
<li><a class="nav-link" href="#export-the-results-in-txt-files"><span class="header-section-number">10.1.29</span> 17.1.29 Export the results in txt files</a></li>
</ul>
</li>
<li><a class="nav-link" href="#pca-with-prcomp-function-of-the-base-r-package"><span class="header-section-number">10.2</span> 17.2 PCA with prcomp function of the base R package</a></li>
<li><a class="nav-link" href="#exercise-1-nutritional-and-marketing-information-on-us-cereals"><span class="header-section-number">10.3</span> 17.3 Exercise 1: Nutritional and Marketing Information on US Cereals</a></li>
<li>
<a class="nav-link" href="#exercise-2"><span class="header-section-number">10.4</span> 17.4 Exercise 2</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercise-3-wine-quality-analysis"><span class="header-section-number">10.4.1</span> 17.4.1 Exercise 3: Wine Quality Analysis</a></li>
<li><a class="nav-link" href="#exercise-4-boston-housing-data-analysis"><span class="header-section-number">10.4.2</span> 17.4.2 Exercise 4: Boston Housing Data Analysis</a></li>
<li><a class="nav-link" href="#notes-for-solving"><span class="header-section-number">10.4.3</span> 17.4.3 Notes for Solving:</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NiccoloSalvini/sbd_25_26/blob/master/17-pca.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NiccoloSalvini/sbd_25_26/edit/master/17-pca.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistics &amp; Big Data 25-26 Labs</strong>" was written by Dr.¬†Niccol√≤ Salvini. It was last built on 2025-11-26.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
