<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 15 💻 Binary Logistic Regression | Statistics &amp; Big Data 24-25 Labs</title>
<meta name="author" content="Dr. Niccolò Salvini">
<meta name="description" content="15.1 Objectives At the end of the chapter, the readers will be to understand the concept of simple and multiple binary logistic regression 15 to perform simple binary logistic regression 15 to...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 15 💻 Binary Logistic Regression | Statistics &amp; Big Data 24-25 Labs">
<meta property="og:type" content="book">
<meta property="og:description" content="15.1 Objectives At the end of the chapter, the readers will be to understand the concept of simple and multiple binary logistic regression 15 to perform simple binary logistic regression 15 to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 15 💻 Binary Logistic Regression | Statistics &amp; Big Data 24-25 Labs">
<meta name="twitter:description" content="15.1 Objectives At the end of the chapter, the readers will be to understand the concept of simple and multiple binary logistic regression 15 to perform simple binary logistic regression 15 to...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="shortcut icon" href="images/cattolica-logo-favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Statistics &amp; Big Data 24-25 Labs</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> 🫶 About</a></li>
<li class="book-part">Get Started</li>
<li><a class="" href="prereq.html"><span class="header-section-number">2</span> ✨Prerequisites</a></li>
<li><a class="" href="r-packages.html"><span class="header-section-number">3</span> 📦 R Packages</a></li>
<li><a class="" href="nice-warm-up.html"><span class="header-section-number">4</span> 🔥 Nice warm-up</a></li>
<li><a class="" href="syllabus.html"><span class="header-section-number">5</span> 🗒️ Syllabus</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">6</span> 💻 Hypothesis Testing</a></li>
<li><a class="" href="essentials-of-data-wrangling-and-basic-statistics.html"><span class="header-section-number">7</span> 💻 Essentials of Data Wrangling and Basic Statistics</a></li>
<li><a class="" href="lin-reg.html"><span class="header-section-number">8</span> Linear Regression</a></li>
<li><a class="" href="lin-reg-class.html"><span class="header-section-number">9</span> 💻 Linear Regression in class</a></li>
<li><a class="" href="int-samp-q-second.html"><span class="header-section-number">10</span> 💻 Second Intermediate Sample Questions</a></li>
<li><a class="" href="int-samp-q.html"><span class="header-section-number">11</span> 💻 Intermediate Sample Questions</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">12</span> 💻 ANOVA</a></li>
<li><a class="" href="dummy-vars.html"><span class="header-section-number">13</span> 💻 Dummy Variables</a></li>
<li><a class="" href="int-prep.html"><span class="header-section-number">14</span> 💻 Intermediate preparation</a></li>
<li><a class="active" href="log-reg.html"><span class="header-section-number">15</span> 💻 Binary Logistic Regression</a></li>
<li><a class="" href="log-reg-ex.html"><span class="header-section-number">16</span> 💻 Binary LogReg exer</a></li>
<li><a class="" href="pca.html"><span class="header-section-number">17</span> 💻 PCA</a></li>
<li><a class="" href="poi-reg-ex.html"><span class="header-section-number">18</span> 💻 Poisson regr exer</a></li>
<li><a class="" href="hier-clust-ex.html"><span class="header-section-number">19</span> 💻 Hierarchical Clustering</a></li>
<li><a class="" href="k-mean-ex.html"><span class="header-section-number">20</span> 💻 K-Means Clustering</a></li>
<li><a class="" href="reg-tree-ex.html"><span class="header-section-number">21</span> 💻 Regression Trees</a></li>
<li><a class="" href="course-performance.html"><span class="header-section-number">22</span> ⚡ course performance</a></li>
<li><a class="" href="how-to-ask-for-help.html"><span class="header-section-number">23</span> ✋ How to ask for help!</a></li>
<li><a class="" href="frequently-asked-questions.html"><span class="header-section-number">24</span> ❓ Frequently Asked Questions</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="StatisticsAndParameters.html"><span class="header-section-number">25</span> Symbols, formulas, statistics and parameters</a></li>
<li><a class="" href="appendixdatasets.html"><span class="header-section-number">26</span> Datasets</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://sbd-labs-22-23.netlify.app">View book source <i class="fab fa-gitlab"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="log-reg" class="section level1" number="15">
<h1>
<span class="header-section-number">15</span> 💻 Binary Logistic Regression<a class="anchor" aria-label="anchor" href="#log-reg"><i class="fas fa-link"></i></a>
</h1>
<div id="objectives-1" class="section level2" number="15.1">
<h2>
<span class="header-section-number">15.1</span> Objectives<a class="anchor" aria-label="anchor" href="#objectives-1"><i class="fas fa-link"></i></a>
</h2>
<p>At the end of the chapter, the readers will be</p>
<ul>
<li>to understand the concept of simple and multiple binary logistic regression <a href="log-reg.html#log-reg">15</a>
</li>
<li>to perform simple binary logistic regression <a href="log-reg.html#log-reg">15</a>
</li>
<li>to perform multiple binary logistic regression <a href="log-reg.html#log-reg">15</a>
</li>
<li>to perform model assessment of binary logistic regression</li>
<li>to present and interpret results from binary logsitic regression</li>
</ul>
</div>
<div id="background-1" class="section level2" number="15.2">
<h2>
<span class="header-section-number">15.2</span> Background<a class="anchor" aria-label="anchor" href="#background-1"><i class="fas fa-link"></i></a>
</h2>
<p>The logistic model (or logit model) is used to model the probability of a certain class or event existing such as pass or fail, win or lose, alive or dead or healthy or sick. More specifically, binary logistic regression is used to model the relationship between a covariate or a set of covariates and an outcome variables which is a binary variable.</p>
<p>A binary variable is a categorical outcome has two categories or levels. In medical and health research, binary outcome variable is very common. Some example where the outcome is binary include:</p>
<ul>
<li>survival status when the status of cancer patients at the end of treatment are coded as either alive or dead</li>
<li>relapse status when the status of a patient is coded as either relapse or not relapse</li>
<li>satisfaction level when patients who come to clinics are asked if they are satisfied or not satisfied with the service</li>
<li>glucose control when patients were categorized as either good control or poor control based on Hba1c</li>
</ul>
<p>In a binary logistic regression model, the dependent variable has two levels (categorical). When the outcome variable has more than two levels or categories, the analysis are modeled by multinomial logistic regression and, if the multiple categories are ordered, by ordinal logistic regression (for example the proportional odds ordinal logistic model).</p>
</div>
<div id="further-readings" class="section level2" number="15.3">
<h2>
<span class="header-section-number">15.3</span> Further readings<a class="anchor" aria-label="anchor" href="#further-readings"><i class="fas fa-link"></i></a>
</h2>
<p>There are a number of good references to help readers understand binary logistic regression better. The references that we list below also contains workflow that will be useful for readers when modelling logistic regression.</p>
<p>We highly recommend readers to read</p>
<ul>
<li>the Applied Logistic Regression book<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;David Hosmer, &lt;em&gt;Applied Logistic Regression&lt;/em&gt; (Hoboken, New Jersey: Wiley, 2013).&lt;/p&gt;"><sup>5</sup></a></span>
</li>
<li>the Logistic Regression: Self Learning Text<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;David Kleinbaum, &lt;em&gt;Logistic Regression : A Self-Learning Text&lt;/em&gt; (New York: Springer, 2010).&lt;/p&gt;"><sup>6</sup></a></span>
</li>
<li>the workflow from A Handbook of Statistical Analyses Using R<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;strong&gt;R-HSAUR?&lt;/strong&gt;&lt;/p&gt;"><sup>7</sup></a></span>
</li>
</ul>
</div>
<div id="dataset-1" class="section level2" number="15.4">
<h2>
<span class="header-section-number">15.4</span> Dataset<a class="anchor" aria-label="anchor" href="#dataset-1"><i class="fas fa-link"></i></a>
</h2>
<p>We will use a dataset named <code>stroke.dta</code> which in STATA format. These data come from a study of hospitalized stroke patients. They original dataset contain 12 variables but our main variables of interest are:</p>
<ul>
<li>status : Status of patient during hospitalization (alive or dead)</li>
<li>gcs : Glasgow Coma Scale on admission (range from 3 to 15)</li>
<li>stroke_type : IS (Ischaemic Stroke) or HS (Haemorrhagic Stroke)</li>
<li>sex : female or male</li>
<li>dm : History of Diabetes (yes or no)</li>
<li>sbp : Systolic Blood Pressure (mmHg)</li>
<li>age : age of patient on admission</li>
</ul>
<p>The outcome variable is variable status. It is labelled as either dead or alive which is the outcome of each patient during hospitalization.</p>
</div>
<div id="logit-and-logistic-models" class="section level2" number="15.5">
<h2>
<span class="header-section-number">15.5</span> logit and logistic models<a class="anchor" aria-label="anchor" href="#logit-and-logistic-models"><i class="fas fa-link"></i></a>
</h2>
<p>The simple binary logit and logistic models refer to a a model with only one covariate (also known as independent variable). For example, if the covariate is gcs (Glasgow Coma Scale), the simple logit model is written as:</p>
<p><span class="math display">\[\hat{g}(x)= ln\left[ \frac{\hat\pi(x)}{1 - {\hat\pi(x)}} \right]\]</span></p>
<p>where <span class="math inline">\(\hat{g}(x)\)</span> is the log odds for death for a given value of gcs. And the odds for death for a given value of GCS is written as <span class="math inline">\(= \hat\beta_0 + \hat\beta_1(gcs)\)</span></p>
<p>And the simple logistic model is also written as:</p>
<p><span class="math display">\[\hat{\pi}(x) = \frac{exp^{\hat{\beta}_{0} + \hat{\beta}_{1}{gcs}}}{1 + exp^{\hat{\beta}_{0} + \hat{\beta}_{1}{gcs}}}\]</span>
The <span class="math inline">\(\pi(x) = E(Y|x)\)</span> represents the conditional mean of <span class="math inline">\(Y\)</span> given <span class="math inline">\(x\)</span> when the logistic distribution is used. This is also simply known as the predicted probability of death for given value of gcs.</p>
<p>If we have decided (based on our clinical expertise and literature review) that a model that could explain death consists of gcs, stroke type, sex, dm, age and sbp, then the logit model can be expanded to:</p>
<p><span class="math display">\[\hat{g}(x)  = \hat\beta_0 + \hat\beta_1(gcs) + \hat\beta_2(stroke type) + \hat\beta_3(sex)+ \hat\beta_4(dm) + \hat\beta_5(sbp) +  \hat\beta_6(age)\]</span>
This is the odds for death given certain value of gcs, sbp and age and certain categories of stroke stype, sex and diabetes. While the probability of deaths is</p>
<p><span class="math display">\[\hat{\pi}(x) = \frac{exp^{\hat\beta_0 + \hat\beta_1(gcs) + \hat\beta_2(stroke type) + \hat\beta_3(sex)+ \hat\beta_4(dm) + \hat\beta_5(sbp) + \hat\beta_6(age)})}{1 + exp^{\hat\beta_0 + \hat\beta_1(gcs) + \hat\beta_2(stroke type) + \hat\beta_3(sex)+ \hat\beta_4(dm) + \hat\beta_5(sbp) + \hat\beta_6(age)}}\]</span></p>
<p>In many datasets, some of the independent variables are discrete, nominal scale variables such as race, sex, treatment group, and so forth. And because of that it is inappropriate to include them in the model as if they were interval scale variables. Though in many software, they are represented by numbers, but these numbers are used merely identifiers.</p>
<p>In this situation, we will use a method called design variables (or dummy variables). Suppose, for example, assuming that one of the independent variables is obesity type, which is now coded as “Class 1”, “Class 2” and “Class 3”. In this case, there are 3 levels or categories, hence two design variables (<span class="math inline">\(D - 1\)</span>) are necessary, let’s say D1 and D2. One possible coding strategy is that when the patient is in “Class 1” then the two design variables, for D1 and D2 would both be set equal to zero. In this example, “Class 1” is the reference category. When the patient is in “Class 2”, then D1 is set as 1 and D2 as 0; when the patient is in “Class 3”, the we will set D1 as 0 and D2 and 1. All these coding assignment can be done automatically in the software. But to interpret, we must know which category is the reference.</p>
</div>
<div id="prepare-environment-for-analysis" class="section level2" number="15.6">
<h2>
<span class="header-section-number">15.6</span> Prepare environment for analysis<a class="anchor" aria-label="anchor" href="#prepare-environment-for-analysis"><i class="fas fa-link"></i></a>
</h2>
<div id="creating-a-rstudio-project" class="section level3" number="15.6.1">
<h3>
<span class="header-section-number">15.6.1</span> Creating a RStudio project<a class="anchor" aria-label="anchor" href="#creating-a-rstudio-project"><i class="fas fa-link"></i></a>
</h3>
<p>Start a new analysis task by creating a new RStudio project. To do this,</p>
<ol style="list-style-type: decimal">
<li>Go to File</li>
<li>Click New Project</li>
<li>Choose New Directory or Existing Directory.</li>
</ol>
<p>This directory points to the folder that usually contains the dataset to be analyzed. This is called as the working directory. Make sure there is a folder named as <code>data</code> in the folder. If there is not, create one. Make sure the dataset <code>stroke.dta</code> is inside the <code>data</code> folder in the working directory.</p>
</div>
<div id="loading-libraries" class="section level3" number="15.6.2">
<h3>
<span class="header-section-number">15.6.2</span> Loading libraries<a class="anchor" aria-label="anchor" href="#loading-libraries"><i class="fas fa-link"></i></a>
</h3>
<p>Next, we will load the necessary packages. We will use 5 packages</p>
<ol style="list-style-type: decimal">
<li>the built in <strong>stat</strong> package - to run Generalized Linear Model. This is already loaded by default.</li>
<li>
<strong>haven</strong> - to read SPSS, STATA and SAS dataset</li>
<li>
<strong>tidyverse</strong> - to perform data transformation</li>
<li>
<strong>gtsummary</strong> - to provide nice results in a table<br>
</li>
<li>
<strong>broom</strong> - to tidy up the results</li>
<li>
<strong>LogisticDx</strong> - to do model assessment</li>
<li>
<strong>here</strong> - to ensure proper directory</li>
</ol>
<p>To load these packages, we will use the function <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>:</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org">haven</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching packages ─────────────────── tidyverse 1.3.2 ──</span></span>
<span><span class="co">#&gt; ✔ ggplot2 3.4.3     ✔ purrr   1.0.2</span></span>
<span><span class="co">#&gt; ✔ tibble  3.2.1     ✔ stringr 1.5.0</span></span>
<span><span class="co">#&gt; ✔ tidyr   1.3.0     ✔ forcats 1.0.0</span></span>
<span><span class="co">#&gt; ✔ readr   2.1.2     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ lubridate::as.difftime() masks base::as.difftime()</span></span>
<span><span class="co">#&gt; ✖ lubridate::date()        masks base::date()</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter()          masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ kableExtra::group_rows() masks dplyr::group_rows()</span></span>
<span><span class="co">#&gt; ✖ lubridate::intersect()   masks base::intersect()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()             masks stats::lag()</span></span>
<span><span class="co">#&gt; ✖ lubridate::setdiff()     masks base::setdiff()</span></span>
<span><span class="co">#&gt; ✖ lubridate::union()       masks base::union()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/gtsummary">gtsummary</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; #BlackLivesMatter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">LogisticDx</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; here() starts at /Users/niccolo/Desktop/r_projects/sbd_24_25</span></span></code></pre></div>
</div>
</div>
<div id="read-data" class="section level2" number="15.7">
<h2>
<span class="header-section-number">15.7</span> Read data<a class="anchor" aria-label="anchor" href="#read-data"><i class="fas fa-link"></i></a>
</h2>
<p>WE will read data in the working directory into our R environment. Remember the dataset is in the STATA format.</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">'data'</span>,<span class="st">'stroke.dta'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Take a peek at data. Check</p>
<ul>
<li>variable names</li>
<li>variable types</li>
</ul>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">fatal</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 226</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; $ sex         &lt;dbl+lbl&gt; 1, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2…</span></span>
<span><span class="co">#&gt; $ status      &lt;dbl+lbl&gt; 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1…</span></span>
<span><span class="co">#&gt; $ gcs         &lt;dbl&gt; 13, 15, 15, 15, 15, 15, 13, 15, 15, 10…</span></span>
<span><span class="co">#&gt; $ sbp         &lt;dbl&gt; 143, 150, 152, 215, 162, 169, 178, 180…</span></span>
<span><span class="co">#&gt; $ dm          &lt;dbl+lbl&gt; 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1…</span></span>
<span><span class="co">#&gt; $ age         &lt;dbl&gt; 50, 58, 64, 50, 65, 78, 66, 72, 61, 64…</span></span>
<span><span class="co">#&gt; $ stroke_type &lt;dbl+lbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span></code></pre></div>
</div>
<div id="explore-data" class="section level2" number="15.8">
<h2>
<span class="header-section-number">15.8</span> Explore data<a class="anchor" aria-label="anchor" href="#explore-data"><i class="fas fa-link"></i></a>
</h2>
<p>Variables sex, status, dm and stroke type are labelled variable. This means eventhough they are coded as numbers but the numbers represent the groups or categories or levels of the variables. Basically, they are categorical variables.</p>
<p>We will transform all of them to factor variables. We can quickly do this using the function <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code>. Below, we will transform all labelled variables to factor variables:</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fatal</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.labelled</span><span class="op">)</span>, <span class="va">as_factor</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now, we can look at the summary statistics</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html">tbl_summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/as_hux_table.html">as_hux_table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-5">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-5">Table 15.1: </span> </caption>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">
<p><strong>Characteristic</strong></p>
</th>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">
<p><strong>N = 226</strong></p>
</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">sex</td>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 15pt; font-weight: normal;">male</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">97 (43%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 15pt; font-weight: normal;">female</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">129 (57%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">alive or dead</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 15pt; font-weight: normal;">alive</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">171 (76%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 15pt; font-weight: normal;">dead</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">55 (24%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">earliest Glasgow Coma Scale</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">15.0 (10.0, 15.0)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">earliest systolic BP (mmHg)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">161 (143, 187)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">diabetes (yes or no)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">138 (61%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">age in years</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">61 (52, 69)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Ischaemic Stroke or Haemorrhagic</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 15pt; font-weight: normal;">Ischaemic Stroke</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">149 (66%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 15pt; font-weight: normal;">Haemorrhagic</td>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">77 (34%)</td>
</tr>
<tr><td colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">n (%); Median (IQR)</td></tr>
</table></div>
<p>or to get summary statistics for each status category:</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html">tbl_summary</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/as_hux_table.html">as_hux_table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-6">
<caption style="caption-side: top; text-align: center;">
<span id="tab:unnamed-chunk-6">Table 15.2: </span> </caption>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">
<p><strong>Characteristic</strong></p>
</th>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">
<p><strong>alive</strong>, N = 171</p>
</th>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">
<p><strong>dead</strong>, N = 55</p>
</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">sex</td>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 15pt; font-weight: normal;">male</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">81 (47%)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">16 (29%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 15pt; font-weight: normal;">female</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">90 (53%)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">39 (71%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">earliest Glasgow Coma Scale</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">15.0 (14.0, 15.0)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8.0 (5.0, 11.0)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">earliest systolic BP (mmHg)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">160 (143, 186)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">162 (140, 199)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">diabetes (yes or no)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">100 (58%)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">38 (69%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">age in years</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">61 (53, 68)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">62 (50, 73)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Ischaemic Stroke or Haemorrhagic</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 15pt; font-weight: normal;">Ischaemic Stroke</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">132 (77%)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">17 (31%)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 15pt; font-weight: normal;">Haemorrhagic</td>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">39 (23%)</td>
<td style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">38 (69%)</td>
</tr>
<tr><td colspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">n (%); Median (IQR)</td></tr>
</table></div>
</div>
<div id="estimate-the-regression-parameters" class="section level2" number="15.9">
<h2>
<span class="header-section-number">15.9</span> Estimate the regression parameters<a class="anchor" aria-label="anchor" href="#estimate-the-regression-parameters"><i class="fas fa-link"></i></a>
</h2>
<p>We now can perform binary logistic regression to estimate the regression parameters <span class="math inline">\(\hat\beta_s\)</span> or the log odds. Usually, we can do this in two steps:</p>
<ol style="list-style-type: decimal">
<li>The simple binary logistic regression or the univariable logistic regression. In this analysis, there is only one independent variable or covariate in the model. This is also known as the crude or unadjusted analysis.</li>
<li>The multiple binary logistic regression or the multivariable logistic regression. Here, we expand our model and include two or more independent variables (covariates). This is a adjusted model and we can obtain the estimate of a particular covariate independent of the other covariates in the model.</li>
</ol>
</div>
<div id="simple-binary-logistic-regression" class="section level2" number="15.10">
<h2>
<span class="header-section-number">15.10</span> Simple binary logistic regression<a class="anchor" aria-label="anchor" href="#simple-binary-logistic-regression"><i class="fas fa-link"></i></a>
</h2>
<p>The simple binary logistic regression has a dependent variable and only one independent (covariate) variable. in our dataset, for example, we can have</p>
<ol style="list-style-type: decimal">
<li>status as the dependent variable.</li>
<li>gcs as the independent variable.</li>
</ol>
<p>The independent variable can be a numerical or a categorical variable. To estimate the log odds (the regression parameters, <span class="math inline">\(\beta\)</span>) for the covariate Glasgow Coma Scale (GCS), we can write the logit model as:</p>
<p><span class="math display">\[log\frac{p(status = dead)}{1 - p(status = dead)}  = \hat\beta_0 + \hat\beta_1(gcs)\]</span></p>
<p>In R, we use the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function to estimate the regression parameters and other parameters of interest. Let’s run the model with gcs as the covariate and name the model as <code>fatal_glm_1</code></p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal_glm_1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">status</span> <span class="op">~</span> <span class="va">gcs</span>, </span>
<span>      data <span class="op">=</span> <span class="va">fatal</span>, </span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">'logit'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To get the summarized result of the model, we will use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function:</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fatal_glm_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = status ~ gcs, family = binomial(link = "logit"), </span></span>
<span><span class="co">#&gt;     data = fatal)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">#&gt; -2.1179  -0.3921  -0.3921  -0.3921   2.2820  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value           Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)  3.29479    0.60432   5.452 0.0000000497803390</span></span>
<span><span class="co">#&gt; gcs         -0.38811    0.05213  -7.446 0.0000000000000964</span></span>
<span><span class="co">#&gt;                </span></span>
<span><span class="co">#&gt; (Intercept) ***</span></span>
<span><span class="co">#&gt; gcs         ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 250.83  on 225  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 170.92  on 224  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 174.92</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
<p>To get the model summary in a data frame format, so we can edit more easily, we can use the <code><a href="https://generics.r-lib.org/reference/tidy.html">tidy()</a></code> function from the <strong>broom</strong> package. The package also contains other functions to provide other parameters useful for us later.</p>
<p>The function <code>conf.int()</code> will provide the confidence intervals (CI). The default is set at the <span class="math inline">\(95%\)</span> level:</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fatal_glm_1</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span><span class="co">#&gt;   term        estimate std.error statistic  p.value conf.low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)    3.29     0.604       5.45 4.98e- 8    2.17 </span></span>
<span><span class="co">#&gt; 2 gcs           -0.388    0.0521     -7.45 9.64e-14   -0.497</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: conf.high &lt;dbl&gt;</span></span></code></pre></div>
<p>The estimates here are the log odds for death for a given value of gcs. In this example, each unit increase in gcs, the crude or unadjusted log odds for death due to stroke change by a factor <span class="math inline">\(-0.388\)</span> with <span class="math inline">\(95%\)</span> CI ranges from <span class="math inline">\(-0.497 and -0.292\)</span>.</p>
<p>Now, let’s use another covariate, <code>stroke_type</code>. Stroke type has 2 levels or categories; Haemorrhagic Stroke (HS) and Ischaemic Stroke (IS). HS is known to cause higher risk for deaths in stroke. We will model stroke type (<code>stroke_type</code>), name the model as <code>fatal_glm_2</code> and show the result using <code><a href="https://generics.r-lib.org/reference/tidy.html">tidy()</a></code></p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal_glm_2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">status</span> <span class="op">~</span> <span class="va">stroke_type</span>, </span>
<span>      data <span class="op">=</span> <span class="va">fatal</span>, </span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">'logit'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fatal_glm_2</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span><span class="co">#&gt;   term        estimate std.error statistic  p.value conf.low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)    -2.05     0.258     -7.95 1.80e-15    -2.59</span></span>
<span><span class="co">#&gt; 2 stroke_typ…     2.02     0.344      5.88 4.05e- 9     1.36</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: conf.high &lt;dbl&gt;</span></span></code></pre></div>
<p>It seems that patients with Haemorrhagic Stroke (HS) had higher log odds for death during admission - by a factor <span class="math inline">\(2.02\)</span> - than patients with Ischaemic Stroke (IS).</p>
</div>
<div id="multiple-binary-logistic-regression" class="section level2" number="15.11">
<h2>
<span class="header-section-number">15.11</span> Multiple binary logistic regression<a class="anchor" aria-label="anchor" href="#multiple-binary-logistic-regression"><i class="fas fa-link"></i></a>
</h2>
<p>The is strong motivation to include other covariates in the model. This is because</p>
<ul>
<li>It is unlikely that only one variable (gcs or stroke type) that is related with stroke. For example, cardiovascular disease has many factors that affect the outcome. So, it makes more sense to consider adding other seemingly important independent variable in the model.</li>
<li>by adding more covariates in the model, we can estimate the adjusted log odds. These are the log odds of a particular covariate independent of other covariates.</li>
<li>we can add other covariate to adjust for the confounding effects</li>
<li>interaction (the product of two covariates) can also be estimated</li>
</ul>
<p>To add or not to add variables is a big subject on its own. Usually it is governed by clinical experience, subject matter experts and some preliminary analysis.</p>
<p>Let’s expand our model and include gcs, stroke type, sex, dm, sbp and age in the model. We will name this model as <code>fatal_mv</code>. To run this model and get the estimates in R:</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal_mv1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">status</span> <span class="op">~</span> <span class="va">gcs</span> <span class="op">+</span> <span class="va">stroke_type</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">dm</span> <span class="op">+</span> <span class="va">sbp</span> <span class="op">+</span> <span class="va">age</span>, </span>
<span>      data <span class="op">=</span> <span class="va">fatal</span>, </span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">'logit'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fatal_mv1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = status ~ gcs + stroke_type + sex + dm + sbp + age, </span></span>
<span><span class="co">#&gt;     family = binomial(link = "logit"), data = fatal)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">#&gt; -2.3715  -0.4687  -0.3280  -0.1921   2.5150  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                           Estimate Std. Error z value</span></span>
<span><span class="co">#&gt; (Intercept)             -0.1588269  1.6174965  -0.098</span></span>
<span><span class="co">#&gt; gcs                     -0.3284640  0.0557574  -5.891</span></span>
<span><span class="co">#&gt; stroke_typeHaemorrhagic  1.2662764  0.4365882   2.900</span></span>
<span><span class="co">#&gt; sexfemale                0.4302901  0.4362742   0.986</span></span>
<span><span class="co">#&gt; dmyes                    0.4736670  0.4362309   1.086</span></span>
<span><span class="co">#&gt; sbp                      0.0008612  0.0060619   0.142</span></span>
<span><span class="co">#&gt; age                      0.0242321  0.0154010   1.573</span></span>
<span><span class="co">#&gt;                              Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)                   0.92178    </span></span>
<span><span class="co">#&gt; gcs                     0.00000000384 ***</span></span>
<span><span class="co">#&gt; stroke_typeHaemorrhagic       0.00373 ** </span></span>
<span><span class="co">#&gt; sexfemale                     0.32399    </span></span>
<span><span class="co">#&gt; dmyes                         0.27756    </span></span>
<span><span class="co">#&gt; sbp                           0.88703    </span></span>
<span><span class="co">#&gt; age                           0.11562    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 250.83  on 225  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 159.34  on 219  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 173.34</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
<p>We could get a cleaner result in a data frame format (and you can edit in spreadsheet easily) by using <code><a href="https://generics.r-lib.org/reference/tidy.html">tidy()</a></code>:</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_odds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fatal_mv1</span>, </span>
<span>                 conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">log_odds</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 7</span></span>
<span><span class="co">#&gt;   term         estimate std.error statistic p.value conf.low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)  -1.59e-1   1.62      -0.0982 9.22e-1 -3.38   </span></span>
<span><span class="co">#&gt; 2 gcs          -3.28e-1   0.0558    -5.89   3.84e-9 -0.444  </span></span>
<span><span class="co">#&gt; 3 stroke_type…  1.27e+0   0.437      2.90   3.73e-3  0.411  </span></span>
<span><span class="co">#&gt; 4 sexfemale     4.30e-1   0.436      0.986  3.24e-1 -0.420  </span></span>
<span><span class="co">#&gt; 5 dmyes         4.74e-1   0.436      1.09   2.78e-1 -0.368  </span></span>
<span><span class="co">#&gt; 6 sbp           8.61e-4   0.00606    0.142  8.87e-1 -0.0110 </span></span>
<span><span class="co">#&gt; 7 age           2.42e-2   0.0154     1.57   1.16e-1 -0.00520</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: conf.high &lt;dbl&gt;</span></span></code></pre></div>
<p>We could see in the multivariable model, that</p>
<ul>
<li>with one unit increase in Glasgow Coma Scale (GCS), the log odds for death during hospitalization equals to <span class="math inline">\(-0.328\)</span>, adjusting for other covariates</li>
<li>patients with HS has <span class="math inline">\(1.266\)</span> times the log odds for death as compared to patients with IS, adjusting for other covariates.</li>
<li>female patients have <span class="math inline">\(0.430\)</span> times the log odds for death as compared to male patients, adjusting for other covariates</li>
<li>patients with diabetes mellitus had <span class="math inline">\(0.474\)</span> times the log odds for deaths as compared to patients with no diabetes mellitus</li>
<li>With one mmHg increase in systolic blood pressure, the log odds for deaths change by a factor of <span class="math inline">\(0.00086\)</span>, when adjusting for other variables.<br>
</li>
<li>with an increase in one year of age, the log odds for deaths change by a factor of <span class="math inline">\(0.024\)</span>, when adjusting for other variables.</li>
</ul>
</div>
<div id="convert-the-log-odds-to-odds-ratio" class="section level2" number="15.12">
<h2>
<span class="header-section-number">15.12</span> Convert the log odds to odds ratio<a class="anchor" aria-label="anchor" href="#convert-the-log-odds-to-odds-ratio"><i class="fas fa-link"></i></a>
</h2>
<p>For lay person, it is difficult to interpret the log odds. It is easier to interpret using the odds ratio. To do this, we can use the argument <code>exponentiate = TRUE</code> in the <code><a href="https://generics.r-lib.org/reference/tidy.html">tidy()</a></code> function. However, we also know that the odds ratio can be easily calculate by <span class="math inline">\(\exp^{\beta_i}\)</span></p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">odds_ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fatal_mv1</span>,</span>
<span>                   exponentiate <span class="op">=</span> <span class="cn">TRUE</span>,  </span>
<span>                   conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">odds_ratio</span></span>
<span><span class="co">#&gt; # A tibble: 7 × 7</span></span>
<span><span class="co">#&gt;   term         estimate std.error statistic p.value conf.low</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)     0.853   1.62      -0.0982 9.22e-1   0.0341</span></span>
<span><span class="co">#&gt; 2 gcs             0.720   0.0558    -5.89   3.84e-9   0.641 </span></span>
<span><span class="co">#&gt; 3 stroke_type…    3.55    0.437      2.90   3.73e-3   1.51  </span></span>
<span><span class="co">#&gt; 4 sexfemale       1.54    0.436      0.986  3.24e-1   0.657 </span></span>
<span><span class="co">#&gt; 5 dmyes           1.61    0.436      1.09   2.78e-1   0.692 </span></span>
<span><span class="co">#&gt; 6 sbp             1.00    0.00606    0.142  8.87e-1   0.989 </span></span>
<span><span class="co">#&gt; 7 age             1.02    0.0154     1.57   1.16e-1   0.995 </span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: conf.high &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div id="making-inference" class="section level2" number="15.13">
<h2>
<span class="header-section-number">15.13</span> Making inference<a class="anchor" aria-label="anchor" href="#making-inference"><i class="fas fa-link"></i></a>
</h2>
<p>Let us combine the results from the log odds and the odds ratio and rename the table properly.</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_logistic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">log_odds</span>, <span class="va">odds_ratio</span><span class="op">)</span> </span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; • `term` -&gt; `term...1`</span></span>
<span><span class="co">#&gt; • `estimate` -&gt; `estimate...2`</span></span>
<span><span class="co">#&gt; • `std.error` -&gt; `std.error...3`</span></span>
<span><span class="co">#&gt; • `statistic` -&gt; `statistic...4`</span></span>
<span><span class="co">#&gt; • `p.value` -&gt; `p.value...5`</span></span>
<span><span class="co">#&gt; • `conf.low` -&gt; `conf.low...6`</span></span>
<span><span class="co">#&gt; • `conf.high` -&gt; `conf.high...7`</span></span>
<span><span class="co">#&gt; • `term` -&gt; `term...8`</span></span>
<span><span class="co">#&gt; • `estimate` -&gt; `estimate...9`</span></span>
<span><span class="co">#&gt; • `std.error` -&gt; `std.error...10`</span></span>
<span><span class="co">#&gt; • `statistic` -&gt; `statistic...11`</span></span>
<span><span class="co">#&gt; • `p.value` -&gt; `p.value...12`</span></span>
<span><span class="co">#&gt; • `conf.low` -&gt; `conf.low...13`</span></span>
<span><span class="co">#&gt; • `conf.high` -&gt; `conf.high...14`</span></span>
<span><span class="va">tab_logistic</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">term...1</span>, <span class="va">estimate...2</span>, <span class="va">std.error...3</span>, </span>
<span>         <span class="va">estimate...9</span>, <span class="va">conf.low...13</span>, <span class="va">conf.high...14</span> ,<span class="va">p.value...5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>covariate <span class="op">=</span> <span class="va">term...1</span>, </span>
<span>         log_odds <span class="op">=</span> <span class="va">estimate...2</span>,</span>
<span>         SE <span class="op">=</span> <span class="va">std.error...3</span>,</span>
<span>         odds_ratio <span class="op">=</span> <span class="va">estimate...9</span>,</span>
<span>         lower_OR <span class="op">=</span> <span class="va">conf.low...13</span>, </span>
<span>         upper_OR <span class="op">=</span> <span class="va">conf.high...14</span>,</span>
<span>         p.val <span class="op">=</span> <span class="va">p.value...5</span><span class="op">)</span> </span>
<span><span class="co">#&gt; # A tibble: 7 × 7</span></span>
<span><span class="co">#&gt;   covariate    log_odds      SE odds_ratio lower_OR upper_OR</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)  -1.59e-1 1.62         0.853   0.0341   20.3  </span></span>
<span><span class="co">#&gt; 2 gcs          -3.28e-1 0.0558       0.720   0.641     0.799</span></span>
<span><span class="co">#&gt; 3 stroke_type…  1.27e+0 0.437        3.55    1.51      8.45 </span></span>
<span><span class="co">#&gt; 4 sexfemale     4.30e-1 0.436        1.54    0.657     3.69 </span></span>
<span><span class="co">#&gt; 5 dmyes         4.74e-1 0.436        1.61    0.692     3.87 </span></span>
<span><span class="co">#&gt; 6 sbp           8.61e-4 0.00606      1.00    0.989     1.01 </span></span>
<span><span class="co">#&gt; 7 age           2.42e-2 0.0154       1.02    0.995     1.06 </span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: p.val &lt;dbl&gt;</span></span></code></pre></div>
<p>In the model, it means that:</p>
<ul>
<li>if <strong>gcs</strong> increases by 1 unit (when <em>stroke type</em> is adjusted), the log odds for death changes by a factor <span class="math inline">\(-0.32\)</span> or the odds for death changes by a factor <span class="math inline">\(0.72\)</span> (odds for death reduces for <span class="math inline">\(28\%\)</span>). The the <span class="math inline">\(95\%CI\)</span> are between <span class="math inline">\(21\%,36\%\)</span>, adjusting for other covariates.</li>
<li>patients with HS has <span class="math inline">\(3.55\%\)</span> times higher odds for stroke deaths - with <span class="math inline">\(95\%CI : 17\%, 85\%\)</span> - as compared to patients with HS, adjusting for other independent variables.</li>
<li>female patients have <span class="math inline">\(53\%\)</span> higher odds for death as compared to female patients (<span class="math inline">\(p = 0.154\)</span>), adjusting for other covariates</li>
<li>patients with diabetes mellitus had <span class="math inline">\(60.6\%\)</span> higher odds for deaths compared to patients with no diabetes mellitus though the p value is above <span class="math inline">\(5\%\)</span> (<span class="math inline">\(p = 0.642\%\)</span>)</li>
<li>With one mmHg increase in systolic blood pressure, the odds for death change by a factor <span class="math inline">\(1.00086\)</span>, when adjusting for other variables. The p value is also larger than <span class="math inline">\(5\%\)</span>.<br>
</li>
<li>with an increase in one year of age, the odds for deaths increase by a factor of <span class="math inline">\(1.025\)</span>, when adjusting for other variables. However, the p value is <span class="math inline">\(0.115\)</span>
</li>
</ul>
</div>
<div id="model-comparison" class="section level2" number="15.14">
<h2>
<span class="header-section-number">15.14</span> Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"><i class="fas fa-link"></i></a>
</h2>
<p>It is not advisable to assess the important of variables based on their p-values or the Wald statistics. The better way is to use likelihood ratio to compare models and assess the importance of variables.</p>
<p>For example, is there any statistical difference between model 1 (<code>fatal_mv</code>) and model 2 (<code>fatal_glm_1</code>) if we set the level of significance at <span class="math inline">\(5\%\)</span>?</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span> <span class="va">fatal_glm_1</span>, <span class="va">fatal_mv1</span>, test <span class="op">=</span> <span class="st">'Chisq'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: status ~ gcs</span></span>
<span><span class="co">#&gt; Model 2: status ~ gcs + stroke_type + sex + dm + sbp + age</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  </span></span>
<span><span class="co">#&gt; 1       224     170.92                       </span></span>
<span><span class="co">#&gt; 2       219     159.34  5   11.582  0.04098 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Both models are different statistically (at <span class="math inline">\(5\%\)</span> level). Hence, we prefer to keep model <code>fatal_mv1</code>.</p>
<p>Now let’s be economical, and just keep gcs, stroke type and age in the model. And let’s name this model as <code>fatal_mv2</code></p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal_mv2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">status</span> <span class="op">~</span> <span class="va">gcs</span> <span class="op">+</span> <span class="va">stroke_type</span> <span class="op">+</span> <span class="va">age</span>, </span>
<span>      data <span class="op">=</span> <span class="va">fatal</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">'logit'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And perform model comparison again</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span> <span class="va">fatal_mv1</span>, </span>
<span>       <span class="va">fatal_mv2</span>, test <span class="op">=</span> <span class="st">'Chisq'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: status ~ gcs + stroke_type + sex + dm + sbp + age</span></span>
<span><span class="co">#&gt; Model 2: status ~ gcs + stroke_type + age</span></span>
<span><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span>
<span><span class="co">#&gt; 1       219     159.34                     </span></span>
<span><span class="co">#&gt; 2       222     161.51 -3  -2.1743    0.537</span></span></code></pre></div>
<p>The p-value is above the threshold of <span class="math inline">\(5\%\)</span>, so we can not reject the null hypothesis that say both models are not statistically different. So by obeying the Occam’s razor principle, we will choose a simpler model that is model <code>fatal_mv2</code> for further exploration.</p>
</div>
<div id="adding-an-interaction-term" class="section level2" number="15.15">
<h2>
<span class="header-section-number">15.15</span> Adding an interaction term<a class="anchor" aria-label="anchor" href="#adding-an-interaction-term"><i class="fas fa-link"></i></a>
</h2>
<p>Interaction effects occur when the effect of one variable depends on the value of another variable. Interaction effects are common in regression analysis, ANOVA, and designed experiments.</p>
<p>Interaction involves two risk factors (and their effect on one disease outcome). If the effect of one risk factor is the same within strata defined by the other, then there is NO interaction. When the effect of one risk factor is different within strata defined by the other, then there is an interaction (biological)</p>
<p>(Statistical) interaction can be measured based on the ways that risks are calculated (modeling). The presence of interaction based on measurements is called statistical interaction, and inherently it may not reflect the true biological interaction.</p>
<p>Let’s add an interaction between stroke type and diabetes:</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fatal_mv2_ia</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">status</span> <span class="op">~</span> <span class="va">gcs</span> <span class="op">+</span> <span class="va">stroke_type</span> <span class="op">+</span> <span class="va">stroke_type</span><span class="op">:</span><span class="va">gcs</span> <span class="op">+</span> <span class="va">age</span>, </span>
<span>      data <span class="op">=</span> <span class="va">fatal</span>, </span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">'logit'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fatal_mv2_ia</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 5</span></span>
<span><span class="co">#&gt;   term                  estimate std.error statistic p.value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)             0.508     1.37       0.371 7.10e-1</span></span>
<span><span class="co">#&gt; 2 gcs                    -0.320     0.0800    -4.01  6.19e-5</span></span>
<span><span class="co">#&gt; 3 stroke_typeHaemorrha…   1.61      1.30       1.24  2.17e-1</span></span>
<span><span class="co">#&gt; 4 age                     0.0236    0.0147     1.60  1.09e-1</span></span>
<span><span class="co">#&gt; 5 gcs:stroke_typeHaemo…  -0.0347    0.111     -0.312 7.55e-1</span></span></code></pre></div>
<p><span class="math display">\[\hat{g}(x)  = \hat\beta_0 + \hat\beta_1(gcs) + \hat\beta_2(stroke type) + \hat\beta_3(age)+ \hat\beta_4(gcs \times stroke_type)\]</span></p>
<p>To decide if an interaction term should stay in the model, we suggest you to consider the biological and statistical significance. If you think the interaction justifies both reasons, then it is preferred you keep the interaction term in the model. For example, for our model:</p>
<ul>
<li>the coefficient for the interaction term for stroke type and gcs is not significant at %5%$ level.</li>
<li>after getting further advice from the stroke experts, we believe that the effect of gcs on stroke death is not largely different between different stroke type</li>
</ul>
<p>And because of both reasons, we have decided not to keep the interaction for gcs and stroke type in the model.</p>
</div>
<div id="prediction-from-binary-logistic-regression" class="section level2" number="15.16">
<h2>
<span class="header-section-number">15.16</span> Prediction from binary logistic regression<a class="anchor" aria-label="anchor" href="#prediction-from-binary-logistic-regression"><i class="fas fa-link"></i></a>
</h2>
<p>We can use the <code><a href="https://generics.r-lib.org/reference/augment.html">broom::augment()</a></code> function to calculate the</p>
<ol style="list-style-type: decimal">
<li>log odds</li>
<li>probability</li>
<li>residuals</li>
<li>hat values</li>
<li>Cooks distance</li>
<li>standardized residuals</li>
</ol>
<div id="predict-the-log-odds" class="section level3" number="15.16.1">
<h3>
<span class="header-section-number">15.16.1</span> Predict the log odds<a class="anchor" aria-label="anchor" href="#predict-the-log-odds"><i class="fas fa-link"></i></a>
</h3>
<p>To obtain the <code>.fitted</code> column (representing the estimated log odds for death) for each patient, we can run:</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_odds_mv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">fatal_mv2</span><span class="op">)</span></span>
<span><span class="va">log_odds_mv2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 10</span></span>
<span><span class="co">#&gt;    status   gcs stroke_type    age .fitted .resid .std.resid</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 alive     13 Ischaemic S…    50   -2.49 -0.398     -0.400</span></span>
<span><span class="co">#&gt;  2 alive     15 Ischaemic S…    58   -2.98 -0.314     -0.315</span></span>
<span><span class="co">#&gt;  3 alive     15 Ischaemic S…    64   -2.84 -0.337     -0.338</span></span>
<span><span class="co">#&gt;  4 alive     15 Ischaemic S…    50   -3.17 -0.287     -0.288</span></span>
<span><span class="co">#&gt;  5 alive     15 Ischaemic S…    65   -2.82 -0.341     -0.342</span></span>
<span><span class="co">#&gt;  6 alive     15 Ischaemic S…    78   -2.51 -0.395     -0.397</span></span>
<span><span class="co">#&gt;  7 dead      13 Ischaemic S…    66   -2.12  2.11       2.12 </span></span>
<span><span class="co">#&gt;  8 alive     15 Ischaemic S…    72   -2.65 -0.369     -0.370</span></span>
<span><span class="co">#&gt;  9 alive     15 Ischaemic S…    61   -2.91 -0.325     -0.326</span></span>
<span><span class="co">#&gt; 10 dead      10 Ischaemic S…    64   -1.15  1.69       1.70 </span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: .hat &lt;dbl&gt;, .sigma &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   .cooksd &lt;dbl&gt;</span></span></code></pre></div>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice()</a></code> gives the snapshot of the data. In this case, we choose the first 10 patients.</p>
</div>
<div id="predict-the-probabilities" class="section level3" number="15.16.2">
<h3>
<span class="header-section-number">15.16.2</span> Predict the probabilities<a class="anchor" aria-label="anchor" href="#predict-the-probabilities"><i class="fas fa-link"></i></a>
</h3>
<p>To obtain the <code>.fitted</code> column (representing the estimated probabilities for death) for each patient, we can run:</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prob_mv2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">fatal_mv2</span>, </span>
<span>          type.predict <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">prob_mv2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 10</span></span>
<span><span class="co">#&gt;    status   gcs stroke_type    age .fitted .resid .std.resid</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 alive     13 Ischaemic S…    50  0.0763 -0.398     -0.400</span></span>
<span><span class="co">#&gt;  2 alive     15 Ischaemic S…    58  0.0482 -0.314     -0.315</span></span>
<span><span class="co">#&gt;  3 alive     15 Ischaemic S…    64  0.0551 -0.337     -0.338</span></span>
<span><span class="co">#&gt;  4 alive     15 Ischaemic S…    50  0.0403 -0.287     -0.288</span></span>
<span><span class="co">#&gt;  5 alive     15 Ischaemic S…    65  0.0564 -0.341     -0.342</span></span>
<span><span class="co">#&gt;  6 alive     15 Ischaemic S…    78  0.0750 -0.395     -0.397</span></span>
<span><span class="co">#&gt;  7 dead      13 Ischaemic S…    66  0.107   2.11       2.12 </span></span>
<span><span class="co">#&gt;  8 alive     15 Ischaemic S…    72  0.0658 -0.369     -0.370</span></span>
<span><span class="co">#&gt;  9 alive     15 Ischaemic S…    61  0.0516 -0.325     -0.326</span></span>
<span><span class="co">#&gt; 10 dead      10 Ischaemic S…    64  0.241   1.69       1.70 </span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: .hat &lt;dbl&gt;, .sigma &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   .cooksd &lt;dbl&gt;</span></span></code></pre></div>
</div>
</div>
<div id="model-fitness" class="section level2" number="15.17">
<h2>
<span class="header-section-number">15.17</span> Model fitness<a class="anchor" aria-label="anchor" href="#model-fitness"><i class="fas fa-link"></i></a>
</h2>
<p>We will assess the overall model fitness by checking the</p>
<ul>
<li>the area under the curve</li>
<li>the Hosmer-Lemeshow test</li>
<li>the modidied Hosmer-Lemeshow test</li>
<li>the Oseo Rojek test</li>
</ul>
<p>The p-values of bigger than 0.05 indicates that there is no significant difference between the observed data and the predicted data (from our model). That supports the good fit of the model.</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/LogisticDx/man/gof.html">gof</a></span><span class="op">(</span><span class="va">fatal_mv2</span>, </span>
<span>             g <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<p><img src="07-lab-logisticregr_files/figure-html/unnamed-chunk-21-1.png" width="100%">
The area under the curve is <span class="math inline">\(87.2\%\)</span>. The values of above 80 are considered to have good discriminating effect.</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_m</span><span class="op">$</span><span class="va">gof</span></span>
<span><span class="co">#&gt;          test  stat       val df      pVal</span></span>
<span><span class="co">#&gt; 1:         HL chiSq  4.622183  6 0.5930997</span></span>
<span><span class="co">#&gt; 2:        mHL     F  1.071882  7 0.3844230</span></span>
<span><span class="co">#&gt; 3:       OsRo     Z -0.501724 NA 0.6158617</span></span>
<span><span class="co">#&gt; 4: SstPgeq0.5     Z  1.348843 NA 0.1773873</span></span>
<span><span class="co">#&gt; 5:   SstPl0.5     Z  1.516578 NA 0.1293733</span></span>
<span><span class="co">#&gt; 6:    SstBoth chiSq  4.119387  2 0.1274931</span></span>
<span><span class="co">#&gt; 7: SllPgeq0.5 chiSq  1.579811  1 0.2087879</span></span>
<span><span class="co">#&gt; 8:   SllPl0.5 chiSq  2.311910  1 0.1283862</span></span>
<span><span class="co">#&gt; 9:    SllBoth chiSq  2.341198  2 0.3101811</span></span></code></pre></div>
<p>The Hosmer Lemeshow, modified Hosmer Lemeshow and Oseo Rojek are all above <span class="math inline">\(5\%\)</span> values which are supportive of good fit of the model.</p>
</div>
<div id="presentation" class="section level2" number="15.18">
<h2>
<span class="header-section-number">15.18</span> Presentation<a class="anchor" aria-label="anchor" href="#presentation"><i class="fas fa-link"></i></a>
</h2>
<p>The <strong>gtsummary</strong> package has a useful function <code>tbld_regression()</code> to produce a formatted table suitable for publication.</p>
<p>This is the table for adjusted log odds ratio:</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html">tbl_regression</a></span><span class="op">(</span><span class="va">fatal_mv2</span><span class="op">)</span></span></code></pre></div>
<div id="apastfeyai" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#apastfeyai table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#apastfeyai thead, #apastfeyai tbody, #apastfeyai tfoot, #apastfeyai tr, #apastfeyai td, #apastfeyai th {
  border-style: none;
}

#apastfeyai p {
  margin: 0;
  padding: 0;
}

#apastfeyai .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#apastfeyai .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#apastfeyai .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#apastfeyai .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#apastfeyai .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#apastfeyai .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apastfeyai .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#apastfeyai .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#apastfeyai .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#apastfeyai .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#apastfeyai .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#apastfeyai .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#apastfeyai .gt_spanner_row {
  border-bottom-style: hidden;
}

#apastfeyai .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#apastfeyai .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#apastfeyai .gt_from_md > :first-child {
  margin-top: 0;
}

#apastfeyai .gt_from_md > :last-child {
  margin-bottom: 0;
}

#apastfeyai .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#apastfeyai .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#apastfeyai .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#apastfeyai .gt_row_group_first td {
  border-top-width: 2px;
}

#apastfeyai .gt_row_group_first th {
  border-top-width: 2px;
}

#apastfeyai .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#apastfeyai .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#apastfeyai .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#apastfeyai .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apastfeyai .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#apastfeyai .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#apastfeyai .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#apastfeyai .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#apastfeyai .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apastfeyai .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#apastfeyai .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#apastfeyai .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#apastfeyai .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#apastfeyai .gt_left {
  text-align: left;
}

#apastfeyai .gt_center {
  text-align: center;
}

#apastfeyai .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#apastfeyai .gt_font_normal {
  font-weight: normal;
}

#apastfeyai .gt_font_bold {
  font-weight: bold;
}

#apastfeyai .gt_font_italic {
  font-style: italic;
}

#apastfeyai .gt_super {
  font-size: 65%;
}

#apastfeyai .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#apastfeyai .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#apastfeyai .gt_indent_1 {
  text-indent: 5px;
}

#apastfeyai .gt_indent_2 {
  text-indent: 10px;
}

#apastfeyai .gt_indent_3 {
  text-indent: 15px;
}

#apastfeyai .gt_indent_4 {
  text-indent: 20px;
}

#apastfeyai .gt_indent_5 {
  text-indent: 25px;
}
</style>
<div class="inline-table"><table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id='&lt;strong&gt;log(OR)&lt;/strong&gt;&lt;span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;'>
<strong>log(OR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id='&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;'>
<strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-value&lt;/strong&gt;"><strong>p-value</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">earliest Glasgow Coma Scale</td>
<td headers="estimate" class="gt_row gt_center">-0.34</td>
<td headers="ci" class="gt_row gt_center">-0.45, -0.24</td>
<td headers="p.value" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Ischaemic Stroke or Haemorrhagic</td>
<td headers="estimate" class="gt_row gt_center"><br></td>
<td headers="ci" class="gt_row gt_center"><br></td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Ischaemic Stroke</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Haemorrhagic</td>
<td headers="estimate" class="gt_row gt_center">1.2</td>
<td headers="ci" class="gt_row gt_center">0.38, 2.1</td>
<td headers="p.value" class="gt_row gt_center">0.004</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">age in years</td>
<td headers="estimate" class="gt_row gt_center">0.02</td>
<td headers="ci" class="gt_row gt_center">0.00, 0.05</td>
<td headers="p.value" class="gt_row gt_center">0.11</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="4">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> OR = Odds Ratio, CI = Confidence Interval</td>
    </tr></tfoot>
</table></div>
</div>
<p>And this is the table for adjusted odds ratio:</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html">tbl_regression</a></span><span class="op">(</span><span class="va">fatal_mv2</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div id="svmnepaqap" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#svmnepaqap table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#svmnepaqap thead, #svmnepaqap tbody, #svmnepaqap tfoot, #svmnepaqap tr, #svmnepaqap td, #svmnepaqap th {
  border-style: none;
}

#svmnepaqap p {
  margin: 0;
  padding: 0;
}

#svmnepaqap .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#svmnepaqap .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#svmnepaqap .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#svmnepaqap .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#svmnepaqap .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#svmnepaqap .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#svmnepaqap .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#svmnepaqap .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#svmnepaqap .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#svmnepaqap .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#svmnepaqap .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#svmnepaqap .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#svmnepaqap .gt_spanner_row {
  border-bottom-style: hidden;
}

#svmnepaqap .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#svmnepaqap .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#svmnepaqap .gt_from_md > :first-child {
  margin-top: 0;
}

#svmnepaqap .gt_from_md > :last-child {
  margin-bottom: 0;
}

#svmnepaqap .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#svmnepaqap .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#svmnepaqap .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#svmnepaqap .gt_row_group_first td {
  border-top-width: 2px;
}

#svmnepaqap .gt_row_group_first th {
  border-top-width: 2px;
}

#svmnepaqap .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#svmnepaqap .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#svmnepaqap .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#svmnepaqap .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#svmnepaqap .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#svmnepaqap .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#svmnepaqap .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#svmnepaqap .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#svmnepaqap .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#svmnepaqap .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#svmnepaqap .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#svmnepaqap .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#svmnepaqap .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#svmnepaqap .gt_left {
  text-align: left;
}

#svmnepaqap .gt_center {
  text-align: center;
}

#svmnepaqap .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#svmnepaqap .gt_font_normal {
  font-weight: normal;
}

#svmnepaqap .gt_font_bold {
  font-weight: bold;
}

#svmnepaqap .gt_font_italic {
  font-style: italic;
}

#svmnepaqap .gt_super {
  font-size: 65%;
}

#svmnepaqap .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#svmnepaqap .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#svmnepaqap .gt_indent_1 {
  text-indent: 5px;
}

#svmnepaqap .gt_indent_2 {
  text-indent: 10px;
}

#svmnepaqap .gt_indent_3 {
  text-indent: 15px;
}

#svmnepaqap .gt_indent_4 {
  text-indent: 20px;
}

#svmnepaqap .gt_indent_5 {
  text-indent: 25px;
}
</style>
<div class="inline-table"><table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id='&lt;strong&gt;OR&lt;/strong&gt;&lt;span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;'>
<strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id='&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;'>
<strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-value&lt;/strong&gt;"><strong>p-value</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">earliest Glasgow Coma Scale</td>
<td headers="estimate" class="gt_row gt_center">0.71</td>
<td headers="ci" class="gt_row gt_center">0.64, 0.79</td>
<td headers="p.value" class="gt_row gt_center"></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Ischaemic Stroke or Haemorrhagic</td>
<td headers="estimate" class="gt_row gt_center"><br></td>
<td headers="ci" class="gt_row gt_center"><br></td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Ischaemic Stroke</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Haemorrhagic</td>
<td headers="estimate" class="gt_row gt_center">3.40</td>
<td headers="ci" class="gt_row gt_center">1.46, 7.97</td>
<td headers="p.value" class="gt_row gt_center">0.004</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">age in years</td>
<td headers="estimate" class="gt_row gt_center">1.02</td>
<td headers="ci" class="gt_row gt_center">1.00, 1.05</td>
<td headers="p.value" class="gt_row gt_center">0.11</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="4">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> OR = Odds Ratio, CI = Confidence Interval</td>
    </tr></tfoot>
</table></div>
</div>
</div>
<div id="resources" class="section level2" number="15.19">
<h2>
<span class="header-section-number">15.19</span> Resources<a class="anchor" aria-label="anchor" href="#resources"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="int-prep.html"><span class="header-section-number">14</span> 💻 Intermediate preparation</a></div>
<div class="next"><a href="log-reg-ex.html"><span class="header-section-number">16</span> 💻 Binary LogReg exer</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#log-reg"><span class="header-section-number">15</span> 💻 Binary Logistic Regression</a></li>
<li><a class="nav-link" href="#objectives-1"><span class="header-section-number">15.1</span> Objectives</a></li>
<li><a class="nav-link" href="#background-1"><span class="header-section-number">15.2</span> Background</a></li>
<li><a class="nav-link" href="#further-readings"><span class="header-section-number">15.3</span> Further readings</a></li>
<li><a class="nav-link" href="#dataset-1"><span class="header-section-number">15.4</span> Dataset</a></li>
<li><a class="nav-link" href="#logit-and-logistic-models"><span class="header-section-number">15.5</span> logit and logistic models</a></li>
<li>
<a class="nav-link" href="#prepare-environment-for-analysis"><span class="header-section-number">15.6</span> Prepare environment for analysis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#creating-a-rstudio-project"><span class="header-section-number">15.6.1</span> Creating a RStudio project</a></li>
<li><a class="nav-link" href="#loading-libraries"><span class="header-section-number">15.6.2</span> Loading libraries</a></li>
</ul>
</li>
<li><a class="nav-link" href="#read-data"><span class="header-section-number">15.7</span> Read data</a></li>
<li><a class="nav-link" href="#explore-data"><span class="header-section-number">15.8</span> Explore data</a></li>
<li><a class="nav-link" href="#estimate-the-regression-parameters"><span class="header-section-number">15.9</span> Estimate the regression parameters</a></li>
<li><a class="nav-link" href="#simple-binary-logistic-regression"><span class="header-section-number">15.10</span> Simple binary logistic regression</a></li>
<li><a class="nav-link" href="#multiple-binary-logistic-regression"><span class="header-section-number">15.11</span> Multiple binary logistic regression</a></li>
<li><a class="nav-link" href="#convert-the-log-odds-to-odds-ratio"><span class="header-section-number">15.12</span> Convert the log odds to odds ratio</a></li>
<li><a class="nav-link" href="#making-inference"><span class="header-section-number">15.13</span> Making inference</a></li>
<li><a class="nav-link" href="#model-comparison"><span class="header-section-number">15.14</span> Model comparison</a></li>
<li><a class="nav-link" href="#adding-an-interaction-term"><span class="header-section-number">15.15</span> Adding an interaction term</a></li>
<li>
<a class="nav-link" href="#prediction-from-binary-logistic-regression"><span class="header-section-number">15.16</span> Prediction from binary logistic regression</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#predict-the-log-odds"><span class="header-section-number">15.16.1</span> Predict the log odds</a></li>
<li><a class="nav-link" href="#predict-the-probabilities"><span class="header-section-number">15.16.2</span> Predict the probabilities</a></li>
</ul>
</li>
<li><a class="nav-link" href="#model-fitness"><span class="header-section-number">15.17</span> Model fitness</a></li>
<li><a class="nav-link" href="#presentation"><span class="header-section-number">15.18</span> Presentation</a></li>
<li><a class="nav-link" href="#resources"><span class="header-section-number">15.19</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://sbd-labs-22-23.netlify.app/blob/master/07-lab-logisticregr.Rmd">View source <i class="fab fa-gitlab"></i></a></li>
          <li><a id="book-edit" href="https://sbd-labs-22-23.netlify.app/edit/master/07-lab-logisticregr.Rmd">Edit this page <i class="fab fa-gitlab"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistics &amp; Big Data 24-25 Labs</strong>" was written by Dr. Niccolò Salvini. It was last built on 2024-10-26.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
