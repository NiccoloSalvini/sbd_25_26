<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>06oct_2nd_intermed_sample.knit</title>

  
   
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="06oct_2nd_intermed_sample.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="06oct_2nd_intermed_sample.knit" />
  
  
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.5.1/transition.js"></script>
    <script src="libs/bs3compat-0.5.1/tabs.js"></script>
    <script src="libs/bs3compat-0.5.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <link rel="shortcut icon" href="images/cattolica-logo-favicon.png" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title=""></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="int-samp-q-second" class="section level1" number="1">
<h1><span class="header-section-number">1</span> üìö Additional Practice Exercises for Intermediate Exam</h1>
<p>This is a comprehensive collection of practice exercises designed to prepare you for the intermediate exam. These exercises cover all major topics from hypothesis testing to advanced regression techniques, with a focus on healthcare and biomedical data analysis.</p>
<p><strong>Instructions</strong>: Try to solve all exercises on your own first. Solutions are provided at the end of this chapter.</p>
<div id="part-1-data-wrangling-and-descriptive-statistics" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> üè• Part 1: Data Wrangling and Descriptive Statistics</h2>
<div class="exercise">
<p><span id="exr:add1" class="exercise"><strong>(#exr:add1) </strong></span>Load the built-in dataset <code>airquality</code> and remove all rows with missing values. How many complete observations remain?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add2" class="exercise"><strong>(#exr:add2) </strong></span>Using the <code>mtcars</code> dataset, create a new variable called <code>efficiency</code> that categorizes cars as ‚ÄúHigh‚Äù if <code>mpg &gt; 20</code> and ‚ÄúLow‚Äù otherwise. How many cars are in the ‚ÄúHigh‚Äù efficiency category?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add3" class="exercise"><strong>(#exr:add3) </strong></span>Write the R command to calculate the mean, median, and standard deviation of a variable called <code>blood_pressure</code> in a dataset named <code>health_data</code>.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add4" class="exercise"><strong>(#exr:add4) </strong></span>Given a healthcare dataset with variables <code>patient_id</code>, <code>age</code>, <code>treatment</code> (A or B), and <code>recovery_days</code>, write the R command to create a summary table showing the mean recovery days for each treatment group.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add51" class="exercise"><strong>(#exr:add51) </strong></span>From a <code>patients</code> dataset with columns <code>patient_id</code>, <code>age</code>, <code>sex</code>, <code>diagnosis_code</code>, and <code>hospital_stay_days</code>, write a <code>dplyr</code> pipeline to find the average hospital stay for male patients over 65 for each diagnosis code, showing only diagnoses with more than 10 such patients.</p>
</div>
<hr />
</div>
<div id="part-2-hypothesis-testing---single-population" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> üî¨ Part 2: Hypothesis Testing - Single Population</h2>
<div class="exercise">
<p><span id="exr:add5" class="exercise"><strong>(#exr:add5) </strong></span>A hospital claims that the average waiting time in their emergency room is 45 minutes. A random sample of 50 patients showed a mean waiting time of 52 minutes with a standard deviation of 12 minutes. Test at Œ± = 0.05 if the actual waiting time is significantly different from the claimed 45 minutes. Write the R command to perform this test.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add6" class="exercise"><strong>(#exr:add6) </strong></span>A pharmaceutical company claims that 75% of patients experience relief from headaches within 30 minutes of taking their new medication. In a sample of 200 patients, 140 reported relief within 30 minutes. Test if the actual proportion is significantly different from 75%. Write the appropriate R command.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add7" class="exercise"><strong>(#exr:add7) </strong></span>Without using formulas, explain the difference between Type I and Type II errors in hypothesis testing.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add8" class="exercise"><strong>(#exr:add8) </strong></span>A medical study tests whether the average cholesterol level in a population is greater than 200 mg/dL. The p-value obtained is 0.032. At a significance level of 0.05, what is your decision and conclusion?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add52" class="exercise"><strong>(#exr:add52) </strong></span>A new drug is tested to reduce systolic blood pressure. The mean reduction in a sample of 40 patients is 8.5 mmHg with a standard deviation of 10 mmHg. A reduction of at least 10 mmHg is considered clinically significant. Perform a one-sample t-test to check if the mean reduction is less than 10 mmHg. Write the R code and interpret the p-value in the context of clinical significance.</p>
</div>
<hr />
</div>
<div id="part-3-hypothesis-testing---two-populations" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> üë• Part 3: Hypothesis Testing - Two Populations</h2>
<div class="exercise">
<p><span id="exr:add9" class="exercise"><strong>(#exr:add9) </strong></span>A clinical trial compares two different treatments for hypertension. Group A (n=30) has a mean blood pressure reduction of 15 mmHg (sd=5), while Group B (n=35) has a mean reduction of 12 mmHg (sd=6). Assume equal variances. Write the R command to test if there is a significant difference between the two treatments.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add10" class="exercise"><strong>(#exr:add10) </strong></span>A hospital is testing a new training program for nurses. The same 20 nurses took a competency test before and after the training. The data is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>nurse_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="at">nurse_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">c</span>(<span class="dv">72</span>, <span class="dv">68</span>, <span class="dv">75</span>, <span class="dv">70</span>, <span class="dv">73</span>, <span class="dv">69</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">72</span>, </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>             <span class="dv">70</span>, <span class="dv">73</span>, <span class="dv">69</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">72</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">73</span>, <span class="dv">71</span>),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">after =</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">80</span>, <span class="dv">76</span>, <span class="dv">79</span>, <span class="dv">75</span>, <span class="dv">77</span>, <span class="dv">80</span>, <span class="dv">74</span>, <span class="dv">78</span>, </span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>            <span class="dv">76</span>, <span class="dv">79</span>, <span class="dv">75</span>, <span class="dv">77</span>, <span class="dv">80</span>, <span class="dv">78</span>, <span class="dv">76</span>, <span class="dv">74</span>, <span class="dv">79</span>, <span class="dv">77</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>)</span></code></pre></div>
<p>Test if the training program significantly improved the test scores. Write the appropriate R command and state whether this should be a paired or unpaired test.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add11" class="exercise"><strong>(#exr:add11) </strong></span>Two hospitals are comparing their patient satisfaction rates. Hospital A reports that 180 out of 250 patients (72%) were satisfied, while Hospital B reports that 210 out of 280 patients (75%) were satisfied. Write the R command to test if there is a significant difference in satisfaction rates between the two hospitals.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add12" class="exercise"><strong>(#exr:add12) </strong></span>A researcher wants to compare the effectiveness of three different diets (A, B, and C) on weight loss. Given the following data, can you determine if this requires a t-test or ANOVA? Explain why.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>diet_study <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">diet =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">each =</span> <span class="dv">15</span>),</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">weight_loss =</span> <span class="fu">c</span>(...)  <span class="co"># 45 observations total</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add53" class="exercise"><strong>(#exr:add53) </strong></span>A study compares the cholesterol levels of patients in two different clinics. Before running a t-test, you perform a Levene‚Äôs test for equality of variances and get a p-value of 0.02. Which type of two-sample t-test should you use and why? Write the R command for the appropriate t-test.</p>
</div>
<hr />
</div>
<div id="part-4-anova---comparing-multiple-groups" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> üìä Part 4: ANOVA - Comparing Multiple Groups</h2>
<div class="exercise">
<p><span id="exr:add13" class="exercise"><strong>(#exr:add13) </strong></span>Using the built-in <code>PlantGrowth</code> dataset in R, test if there is a significant difference in plant weight across the three treatment groups. Write the R command and report the p-value.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add14" class="exercise"><strong>(#exr:add14) </strong></span>A medical study examines the effect of four different medications on reducing fever. The temperature reduction (in degrees Celsius) for patients in each group is recorded:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>fever_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">medication =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Med_A&quot;</span>, <span class="st">&quot;Med_B&quot;</span>, <span class="st">&quot;Med_C&quot;</span>, <span class="st">&quot;Med_D&quot;</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">temp_reduction =</span> <span class="fu">c</span>(</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="fl">1.3</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.4</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span>,  <span class="co"># Med_A</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">2.1</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>,  <span class="co"># Med_B</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">1.3</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>,  <span class="co"># Med_C</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>, <span class="fl">2.6</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>   <span class="co"># Med_D</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  )</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>)</span></code></pre></div>
<p>Perform an ANOVA test to determine if there are significant differences among the medications. What is the F-statistic?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add15" class="exercise"><strong>(#exr:add15) </strong></span>After conducting an ANOVA test that shows significant differences among groups, what additional analysis would you perform to identify which specific groups differ from each other?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add54" class="exercise"><strong>(#exr:add54) </strong></span>After running an ANOVA on the effect of three different physical therapy routines (<code>RoutineA</code>, <code>RoutineB</code>, <code>RoutineC</code>) on recovery time, you get a significant p-value. The subsequent Tukey‚Äôs HSD test gives the following output. Which routines are significantly different from each other, and what does the <code>diff</code> column represent?</p>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = recovery_time ~ routine)

$routine
                     diff       lwr       upr     p adj
RoutineB-RoutineA  -5.231 -8.992618 -1.469382 0.0045121
RoutineC-RoutineA   1.543 -2.218618  5.304618 0.5694884
RoutineC-RoutineB   6.774  3.012382 10.535618 0.0002196</code></pre>
</div>
<hr />
</div>
<div id="part-5-simple-and-multiple-linear-regression" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> üìà Part 5: Simple and Multiple Linear Regression</h2>
<div class="exercise">
<p><span id="exr:add16" class="exercise"><strong>(#exr:add16) </strong></span>Using the <code>mtcars</code> dataset, estimate a simple linear regression model where <code>mpg</code> (miles per gallon) is predicted by <code>wt</code> (weight). What is the interpretation of the slope coefficient?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add17" class="exercise"><strong>(#exr:add17) </strong></span>A researcher collects data on hospital readmission rates. They want to predict the <code>readmission_rate</code> (percentage) based on <code>bed_count</code>, <code>nurse_ratio</code> (nurses per patient), and <code>avg_stay</code> (average length of stay). Write the R command to estimate this multiple regression model.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add18" class="exercise"><strong>(#exr:add18) </strong></span>In a multiple linear regression model predicting patient recovery time based on age, BMI, and exercise hours, you obtain the following VIF values:
- age: VIF = 2.3
- BMI: VIF = 12.5
- exercise: VIF = 2.1</p>
<p>Which variable(s) might be problematic due to multicollinearity, and what would you recommend?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add19" class="exercise"><strong>(#exr:add19) </strong></span>Using the <code>mtcars</code> dataset, estimate a multiple regression model: <code>mpg ~ wt + hp + cyl</code>. After checking for significance and multicollinearity, you find that <code>cyl</code> has a p-value of 0.85 and high VIF. What should you do next?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add20" class="exercise"><strong>(#exr:add20) </strong></span>Explain the difference between R-squared and Adjusted R-squared. Why is Adjusted R-squared particularly important in multiple regression?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add21" class="exercise"><strong>(#exr:add21) </strong></span>Given the following regression output for predicting systolic blood pressure:</p>
<pre><code>Coefficients:
              Estimate  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)   90.234    5.123       17.61    &lt; 2e-16 ***
age           0.652     0.085        7.67    1.2e-11 ***
weight        0.234     0.045        5.20    8.3e-07 ***
exercise     -1.234     0.312       -3.95    0.00015 ***

Residual standard error: 8.5 on 146 degrees of freedom
Multiple R-squared:  0.5234,    Adjusted R-squared:  0.5136
F-statistic: 53.45 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>What is the predicted systolic blood pressure for a 50-year-old person weighing 75 kg who exercises 5 hours per week?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add22" class="exercise"><strong>(#exr:add22) </strong></span>In the regression output from the previous exercise, which variable has the strongest effect on blood pressure? How did you determine this?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add55" class="exercise"><strong>(#exr:add55) </strong></span>You are modeling the length of a hospital stay (<code>los</code>) based on <code>age</code> and <code>infection_status</code> (1=yes, 0=no). You suspect that the effect of age on the length of stay is different for patients with and without an infection. How would you specify this in an R model? Write the <code>lm()</code> command and explain how to interpret the interaction term‚Äôs coefficient if it is significant.</p>
</div>
<hr />
</div>
<div id="part-6-nonlinear-regression-and-transformations" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> üîÑ Part 6: Nonlinear Regression and Transformations</h2>
<div class="exercise">
<p><span id="exr:add23" class="exercise"><strong>(#exr:add23) </strong></span>You want to model the relationship between BMI and the risk of diabetes, but the relationship appears to be quadratic. Write the R command to estimate a polynomial regression model with BMI and BMI¬≤ as predictors.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add24" class="exercise"><strong>(#exr:add24) </strong></span>Given a variable <code>income</code> that is highly right-skewed, what transformation would you typically apply to make it more normally distributed for regression analysis? Write the R command to create this transformed variable.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add25" class="exercise"><strong>(#exr:add25) </strong></span>Using the <code>mtcars</code> dataset, create a model predicting <code>mpg</code> using both <code>wt</code> and <code>wt¬≤</code> (weight squared). Write the complete R commands needed.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add56" class="exercise"><strong>(#exr:add56) </strong></span>In a model predicting <code>blood_pressure</code> from <code>log(body_weight)</code>, the coefficient for <code>log(body_weight)</code> is 15.3. How do you interpret this coefficient?</p>
</div>
<hr />
</div>
<div id="part-7-logistic-regression" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> üéØ Part 7: Logistic Regression</h2>
<div class="exercise">
<p><span id="exr:add26" class="exercise"><strong>(#exr:add26) </strong></span>A study examines factors affecting whether a patient develops a certain disease (yes/no). The predictors are age, BMI, and smoking status (0=non-smoker, 1=smoker). Write the R command to estimate a logistic regression model with <code>disease</code> as the outcome variable.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add27" class="exercise"><strong>(#exr:add27) </strong></span>In logistic regression, what does an odds ratio of 2.5 for the variable ‚Äúsmoking‚Äù mean in practical terms?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add28" class="exercise"><strong>(#exr:add28) </strong></span>You have a dataset with a binary outcome <code>survived</code> (1=yes, 0=no) and predictors <code>age</code>, <code>treatment_type</code>, and <code>severity_score</code>. After fitting a logistic regression model, you get a coefficient of -0.05 for age. What does this negative coefficient indicate?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add29" class="exercise"><strong>(#exr:add29) </strong></span>What is the key difference between linear regression and logistic regression in terms of what they predict?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add30" class="exercise"><strong>(#exr:add30) </strong></span>Using the built-in <code>mtcars</code> dataset, create a binary variable <code>high_mpg</code> (1 if mpg &gt; 20, 0 otherwise) and estimate a logistic regression model predicting <code>high_mpg</code> based on <code>wt</code> and <code>hp</code>. Write the R commands.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add57" class="exercise"><strong>(#exr:add57) </strong></span>Using the logistic regression model from Exercise @ref(exr:add30) (<code>high_mpg ~ wt + hp</code>), write the R code to predict the probability of having high MPG for a car with <code>wt = 2.8</code> and <code>hp = 150</code>.</p>
</div>
<hr />
</div>
<div id="part-8-poisson-regression" class="section level2" number="1.8">
<h2><span class="header-section-number">1.8</span> üìä Part 8: Poisson Regression</h2>
<div class="exercise">
<p><span id="exr:add31" class="exercise"><strong>(#exr:add31) </strong></span>A hospital administrator wants to model the number of emergency room visits per day based on day of the week and weather conditions. What type of regression model is most appropriate for count data like this?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add32" class="exercise"><strong>(#exr:add32) </strong></span>You have data on the number of hospital-acquired infections (<code>infection_count</code>) and want to predict it based on <code>bed_occupancy_rate</code> and <code>nurse_staff_ratio</code>. Write the R command to fit a Poisson regression model.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add33" class="exercise"><strong>(#exr:add33) </strong></span>What is the primary assumption of Poisson regression regarding the relationship between the mean and variance of the outcome variable?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add58" class="exercise"><strong>(#exr:add58) </strong></span>You fit a Poisson model to predict the number of asthma-related ER visits. The residual deviance is 150 on 80 degrees of freedom. What does this suggest about your model, and what alternative model should you consider? Write the R command for fitting this alternative model.</p>
</div>
<hr />
</div>
<div id="part-9-regression-with-dummy-variables" class="section level2" number="1.9">
<h2><span class="header-section-number">1.9</span> üè∑Ô∏è Part 9: Regression with Dummy Variables</h2>
<div class="exercise">
<p><span id="exr:add34" class="exercise"><strong>(#exr:add34) </strong></span>A dataset contains a variable <code>blood_type</code> with categories: A, B, AB, and O. You want to include this in a regression model predicting cholesterol levels. How many dummy variables do you need to create, and why?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add35" class="exercise"><strong>(#exr:add35) </strong></span>You have a dataset with the following variables:
- <code>recovery_time</code> (continuous outcome)
- <code>age</code> (continuous)
- <code>treatment</code> (categorical: ‚ÄúStandard‚Äù, ‚ÄúExperimental‚Äù, ‚ÄúControl‚Äù)</p>
<p>Write the R command to create a regression model that includes the categorical treatment variable.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add36" class="exercise"><strong>(#exr:add36) </strong></span>In a regression model with a categorical variable ‚Äúhospital_ward‚Äù (ICU, Surgery, General), you create dummy variables. The regression output shows:</p>
<pre><code>Coefficients:
                      Estimate  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)           12.5      1.2         10.42    &lt; 2e-16 ***
ward_Surgery          -2.3      0.8         -2.88    0.0045 **
ward_ICU              4.7       0.9          5.22    &lt; 0.0001 ***</code></pre>
<p>If ‚ÄúGeneral‚Äù is the reference category, what is the predicted value for a patient in the Surgery ward (assuming no other predictors)?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add37" class="exercise"><strong>(#exr:add37) </strong></span>Using the <code>mtcars</code> dataset, the variable <code>am</code> is binary (0=automatic, 1=manual). Create a regression model predicting <code>mpg</code> based on <code>wt</code>, <code>hp</code>, and <code>am</code>. Write the R command.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add38" class="exercise"><strong>(#exr:add38) </strong></span>In a model with a dummy variable for gender (male=1, female=0) predicting salary, the coefficient for gender is 5000. What does this mean?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add59" class="exercise"><strong>(#exr:add59) </strong></span>In a model predicting <code>patient_satisfaction</code> (scale 1-100), you include a dummy variable <code>has_private_room</code> (1=yes, 0=no). The intercept of the model is 75.2. How do you interpret this intercept value?</p>
</div>
<hr />
</div>
<div id="part-10-model-diagnostics-and-interpretation" class="section level2" number="1.10">
<h2><span class="header-section-number">1.10</span> üßÆ Part 10: Model Diagnostics and Interpretation</h2>
<div class="exercise">
<p><span id="exr:add39" class="exercise"><strong>(#exr:add39) </strong></span>What are the four main assumptions that should be checked for linear regression models?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add40" class="exercise"><strong>(#exr:add40) </strong></span>You fit a regression model and obtain an R¬≤ of 0.85 and an Adjusted R¬≤ of 0.83. You have 100 observations. Approximately how many predictors are in your model? (Hint: use the relationship between R¬≤ and Adjusted R¬≤)</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add41" class="exercise"><strong>(#exr:add41) </strong></span>A researcher finds that in their regression model, the residuals show a clear funnel shape when plotted against fitted values. What problem does this indicate, and what might be a solution?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add42" class="exercise"><strong>(#exr:add42) </strong></span>Using the <code>mtcars</code> dataset, fit a model <code>mpg ~ wt + hp</code> and create diagnostic plots using the <code>plot()</code> function. Write the R commands.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add60" class="exercise"><strong>(#exr:add60) </strong></span>You run diagnostic plots for a linear model and notice that observation #45 has a Cook‚Äôs distance value much larger than 1. What does this indicate, and what are two potential next steps to address this issue?</p>
</div>
<hr />
</div>
<div id="part-11-big-data-concepts-and-data-collection" class="section level2" number="1.11">
<h2><span class="header-section-number">1.11</span> üî¢ Part 11: Big Data Concepts and Data Collection</h2>
<div class="exercise">
<p><span id="exr:add43" class="exercise"><strong>(#exr:add43) </strong></span>Explain in your own words why correct data collection is particularly important in the era of Big Data, even though we have more data than ever before.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add44" class="exercise"><strong>(#exr:add44) </strong></span>What is the difference between structured and unstructured data? Give one example of each in a healthcare context.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add45" class="exercise"><strong>(#exr:add45) </strong></span>Name at least three potential sources of bias in data collection that could affect the validity of statistical analyses in healthcare research.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add46" class="exercise"><strong>(#exr:add46) </strong></span>A hospital collects data on patient satisfaction through a voluntary online survey. What type of bias might this introduce, and why?</p>
</div>
<hr />
</div>
<div id="part-12-mixed-practical-exercises" class="section level2" number="1.12">
<h2><span class="header-section-number">1.12</span> üíª Part 12: Mixed Practical Exercises</h2>
<div class="exercise">
<p><span id="exr:add47" class="exercise"><strong>(#exr:add47) </strong></span>Create a simulated dataset with 100 observations containing:
- <code>patient_id</code>: sequential numbers 1 to 100
- <code>age</code>: random values from a normal distribution with mean 50 and sd 15
- <code>treatment</code>: randomly assign ‚ÄúA‚Äù or ‚ÄúB‚Äù to each patient
- <code>outcome</code>: random values from a normal distribution with mean 100 and sd 20</p>
<p>Write the R commands to create this dataset.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add48" class="exercise"><strong>(#exr:add48) </strong></span>Using the dataset created in the previous exercise, perform the following:
1. Calculate the mean age for each treatment group
2. Test if there‚Äôs a significant difference in outcome between treatment groups
3. Create a linear model predicting outcome from age and treatment</p>
<p>Write all necessary R commands.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add49" class="exercise"><strong>(#exr:add49) </strong></span>Load the <code>iris</code> dataset and:
1. Filter only the ‚Äúsetosa‚Äù and ‚Äúversicolor‚Äù species
2. Create a logistic regression model predicting species based on <code>Sepal.Length</code> and <code>Petal.Length</code>
3. Report the coefficients</p>
<p>Write the R commands using <code>dplyr</code> for filtering.</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add50" class="exercise"><strong>(#exr:add50) </strong></span>A pharmaceutical company tests a new drug on 500 patients. They record:
- Patient demographics (age, gender, BMI)
- Baseline health metrics (blood pressure, cholesterol, glucose)
- Treatment assignment (drug vs.¬†placebo)
- Outcome after 6 months (improved=1, not improved=0)</p>
<p>Describe the complete analytical workflow you would follow, from data cleaning to final model interpretation. What types of analyses would you perform?</p>
</div>
<hr />
<div class="exercise">
<p><span id="exr:add61" class="exercise"><strong>(#exr:add61) </strong></span>You are given a dataset <code>stroke_data</code> with the following variables: <code>age</code>, <code>hypertension</code> (1/0), <code>heart_disease</code> (1/0), <code>avg_glucose_level</code>, and <code>stroke</code> (1/0). Outline the steps you would take to build and evaluate a logistic regression model to predict the likelihood of a stroke. Include R commands for:
1. Splitting the data into training and testing sets.
2. Fitting the logistic regression model on the training data.
3. Evaluating the model‚Äôs performance on the testing data using a confusion matrix and AUC.</p>
</div>
<hr />
<hr />
</div>
<div id="solutions" class="section level2" number="1.13">
<h2><span class="header-section-number">1.13</span> ‚úÖ SOLUTIONS</h2>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add1):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">data</span>(airquality)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(airquality)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">nrow</span>(complete_data)</span></code></pre></div>
<p>Result: <strong>111</strong> complete observations remain.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add2):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>mtcars<span class="sc">$</span>efficiency <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">table</span>(mtcars<span class="sc">$</span>efficiency)</span></code></pre></div>
<p>Result: <strong>14</strong> cars are in the ‚ÄúHigh‚Äù efficiency category.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add3):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">mean</span>(health_data<span class="sc">$</span>blood_pressure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">median</span>(health_data<span class="sc">$</span>blood_pressure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">sd</span>(health_data<span class="sc">$</span>blood_pressure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># Or all at once:</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">summary</span>(health_data<span class="sc">$</span>blood_pressure)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add4):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>health_data <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_recovery =</span> <span class="fu">mean</span>(recovery_days, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># Or base R:</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="fu">aggregate</span>(recovery_days <span class="sc">~</span> treatment, <span class="at">data =</span> health_data, <span class="at">FUN =</span> mean)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add5):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Create the sample data</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>waiting_time <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">52</span>, <span class="at">sd =</span> <span class="dv">12</span>)  <span class="co"># Simulated data</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># Perform one-sample t-test</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">t.test</span>(waiting_time, <span class="at">mu =</span> <span class="dv">45</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co"># Or if you have the actual data vector:</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># t.test(sample_waiting_times, mu = 45, alternative = &quot;two.sided&quot;)</span></span></code></pre></div>
<p>This is a one-sample t-test because we‚Äôre comparing the sample mean to a known population value (45 minutes).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add6):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Proportion test</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">140</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">p =</span> <span class="fl">0.75</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<p>The null hypothesis is H0: p = 0.75. The sample proportion is 140/200 = 0.70 (70%).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add7):</p>
<p><strong>Type I Error (Œ±)</strong>: Rejecting the null hypothesis when it is actually true. This is a ‚Äúfalse positive‚Äù - concluding there is an effect when there isn‚Äôt one. The probability of Type I error is the significance level (usually 0.05).</p>
<p><strong>Type II Error (Œ≤)</strong>: Failing to reject the null hypothesis when it is actually false. This is a ‚Äúfalse negative‚Äù - missing a real effect. The probability of Type II error is related to the power of the test (Power = 1 - Œ≤).</p>
<p>Example in healthcare: Type I error would be concluding a drug works when it doesn‚Äôt; Type II error would be concluding a drug doesn‚Äôt work when it actually does.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add8):</p>
<p><strong>Decision</strong>: Reject the null hypothesis.</p>
<p><strong>Conclusion</strong>: Since p-value (0.032) &lt; Œ± (0.05), we reject H0. There is sufficient evidence to conclude that the average cholesterol level in the population is significantly greater than 200 mg/dL.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add9):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Create sample data (in practice, you&#39;d have actual data)</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>group_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>group_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="at">mean =</span> <span class="dv">12</span>, <span class="at">sd =</span> <span class="dv">6</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Two-sample t-test assuming equal variances</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">t.test</span>(group_A, group_B, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<p>This is an unpaired (independent samples) t-test with equal variances.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add10):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>nurse_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="at">nurse_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">c</span>(<span class="dv">72</span>, <span class="dv">68</span>, <span class="dv">75</span>, <span class="dv">70</span>, <span class="dv">73</span>, <span class="dv">69</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">72</span>, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>             <span class="dv">70</span>, <span class="dv">73</span>, <span class="dv">69</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">72</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">73</span>, <span class="dv">71</span>),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">after =</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">80</span>, <span class="dv">76</span>, <span class="dv">79</span>, <span class="dv">75</span>, <span class="dv">77</span>, <span class="dv">80</span>, <span class="dv">74</span>, <span class="dv">78</span>, </span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>            <span class="dv">76</span>, <span class="dv">79</span>, <span class="dv">75</span>, <span class="dv">77</span>, <span class="dv">80</span>, <span class="dv">78</span>, <span class="dv">76</span>, <span class="dv">74</span>, <span class="dv">79</span>, <span class="dv">77</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># Paired t-test</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="fu">t.test</span>(nurse_data<span class="sc">$</span>after, nurse_data<span class="sc">$</span>before, </span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<p>This should be a <strong>PAIRED test</strong> because the same nurses are measured before and after the training (repeated measures on the same subjects).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add11):</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Two-sample proportion test</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">180</span>, <span class="dv">210</span>), <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">250</span>, <span class="dv">280</span>), <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<p>This tests if the proportions (0.72 vs 0.75) are significantly different between the two hospitals.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add12):</p>
<p>This requires <strong>ANOVA</strong> (Analysis of Variance), not a t-test.</p>
<p><strong>Reason</strong>: We are comparing means across <strong>three groups</strong> (diets A, B, and C). A t-test can only compare two groups at a time. ANOVA is specifically designed to test if there are significant differences among three or more group means simultaneously.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># The appropriate test would be:</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight_loss <span class="sc">~</span> diet, <span class="at">data =</span> diet_study)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add53):</p>
<p>You should use <strong>Welch‚Äôs two-sample t-test</strong> (the default in R).
<strong>Reason</strong>: Levene‚Äôs test checks if the variances of the two groups are equal. A p-value of 0.02 (&lt; 0.05) indicates that the variances are significantly different. The standard two-sample t-test assumes equal variances, so using it would lead to incorrect results. Welch‚Äôs t-test does not assume equal variances and is therefore the appropriate choice.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Assuming &#39;cholesterol_data&#39; with &#39;level&#39; and &#39;clinic&#39; columns</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># The default t.test in R is Welch&#39;s t-test</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">t.test</span>(level <span class="sc">~</span> clinic, <span class="at">data =</span> cholesterol_data)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co"># You would NOT do this, as var.equal=TRUE is for equal variances:</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co"># t.test(level ~ clinic, data = cholesterol_data, var.equal = TRUE)</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add13):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">data</span>(PlantGrowth)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>plant_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">summary</span>(plant_model)</span></code></pre></div>
<p>The p-value is approximately <strong>0.0159</strong>, indicating significant differences among the groups at Œ± = 0.05.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add14):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>fever_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="at">medication =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Med_A&quot;</span>, <span class="st">&quot;Med_B&quot;</span>, <span class="st">&quot;Med_C&quot;</span>, <span class="st">&quot;Med_D&quot;</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="at">temp_reduction =</span> <span class="fu">c</span>(</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>    <span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="fl">1.3</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.4</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">2.1</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>, <span class="fl">1.8</span>, <span class="fl">2.0</span>, <span class="fl">1.9</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>    <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">1.3</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>, <span class="fl">2.6</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.4</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  )</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>fever_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(temp_reduction <span class="sc">~</span> medication, <span class="at">data =</span> fever_data)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="fu">summary</span>(fever_anova)</span></code></pre></div>
<p>The F-statistic is approximately <strong>167.4</strong>, with a very small p-value (&lt; 2e-16), indicating highly significant differences among medications.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add15):</p>
<p>After a significant ANOVA, you should perform <strong>post-hoc tests</strong> (pairwise comparisons) such as:</p>
<ol style="list-style-type: decimal">
<li><strong>Tukey‚Äôs HSD (Honestly Significant Difference)</strong> - most common</li>
<li><strong>Bonferroni correction</strong></li>
<li><strong>Scheffe‚Äôs test</strong></li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Example using Tukey&#39;s HSD:</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">TukeyHSD</span>(anova_model)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># Or using the multcomp package:</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>post_hoc <span class="ot">&lt;-</span> <span class="fu">glht</span>(anova_model, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">group_variable =</span> <span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">summary</span>(post_hoc)</span></code></pre></div>
<p>These tests identify which specific pairs of groups differ significantly from each other.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add54):</p>
<p><strong>Interpretation</strong>:
* The <code>diff</code> column shows the difference in mean recovery time between the two routines being compared. For example, <code>RoutineB-RoutineA</code> has a <code>diff</code> of -5.231, meaning Routine B‚Äôs average recovery time is 5.231 days shorter than Routine A‚Äôs.
* The <code>p adj</code> column shows the p-value adjusted for multiple comparisons.
* <strong>Significant differences (p &lt; 0.05)</strong>:
* <code>RoutineB</code> is significantly different from <code>RoutineA</code> (p = 0.0045).
* <code>RoutineC</code> is significantly different from <code>RoutineB</code> (p = 0.0002).
* <strong>No significant difference</strong>:
* <code>RoutineC</code> is not significantly different from <code>RoutineA</code> (p = 0.569).</p>
<p><strong>Conclusion</strong>: Routine B leads to the fastest recovery, significantly faster than both A and C. There is no statistical difference between routines A and C.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add16):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>mpg_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">summary</span>(mpg_model)</span></code></pre></div>
<p><strong>Interpretation of slope</strong>: The coefficient for <code>wt</code> is approximately <strong>-5.34</strong>. This means that for every 1,000 lb increase in car weight, the fuel efficiency (mpg) decreases by about 5.34 miles per gallon, on average. The negative sign indicates an inverse relationship: heavier cars have lower fuel efficiency.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add17):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>readmission_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(readmission_rate <span class="sc">~</span> bed_count <span class="sc">+</span> nurse_ratio <span class="sc">+</span> avg_stay, </span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>                        <span class="at">data =</span> hospital_data)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">summary</span>(readmission_model)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add18):</p>
<p><strong>Problem</strong>: The variable <strong>BMI</strong> has a VIF of 12.5, which exceeds the common threshold of 10, indicating problematic multicollinearity. Age and exercise have acceptable VIF values (&lt; 10).</p>
<p><strong>Recommendation</strong>:
1. Consider removing BMI from the model, OR
2. Investigate which other variable(s) BMI is highly correlated with
3. Consider combining correlated variables or using principal component analysis (PCA)
4. Check if the model performance and interpretability are actually affected</p>
<p>The other variables (age and exercise) are fine and should be retained.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add19):</p>
<p>You should <strong>remove the <code>cyl</code> variable</strong> from the model.</p>
<p><strong>Reasoning</strong>:
1. The p-value of 0.85 is much larger than any reasonable significance level (e.g., 0.05), indicating <code>cyl</code> is not significantly associated with <code>mpg</code> in this model
2. High VIF suggests multicollinearity with other predictors
3. Removing non-significant variables with high VIF improves model parsimony and interpretability</p>
<p><strong>Next step</strong>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Refit the model without cyl</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>improved_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> hp, <span class="at">data =</span> mtcars)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">summary</span>(improved_model)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co"># Check VIF again</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="fu">vif</span>(improved_model)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add20):</p>
<p><strong>R-squared (R¬≤)</strong>: Represents the proportion of variance in the dependent variable that is explained by the independent variable(s). It ranges from 0 to 1. However, R¬≤ always increases (or stays the same) when you add more predictors, even if they‚Äôre not truly useful.</p>
<p><strong>Adjusted R-squared (R¬≤adj)</strong>: Adjusts R¬≤ for the number of predictors in the model and the sample size. It penalizes the addition of unhelpful variables.</p>
<p><strong>Formula</strong>: R¬≤adj = 1 - [(1 - R¬≤)(n - 1)/(n - k - 1)]
where n = sample size, k = number of predictors</p>
<p><strong>Why important in multiple regression</strong>:
- Prevents overfitting
- Allows fair comparison between models with different numbers of predictors
- Can decrease if you add predictors that don‚Äôt improve the model enough to justify their inclusion
- More realistic measure of model quality</p>
<p>Use R¬≤adj when comparing models with different numbers of predictors; use R¬≤ when evaluating a single model‚Äôs goodness of fit.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add21):</p>
<p>The regression equation is:
Systolic BP = 90.234 + 0.652(age) + 0.234(weight) - 1.234(exercise)</p>
<p>For a 50-year-old, 75 kg person who exercises 5 hours/week:
Systolic BP = 90.234 + 0.652(50) + 0.234(75) - 1.234(5)
Systolic BP = 90.234 + 32.6 + 17.55 - 6.17
<strong>Systolic BP = 134.214 mmHg</strong></p>
<p>Approximately <strong>134.2 mmHg</strong></p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add22):</p>
<p>The variable with the <strong>strongest effect</strong> appears to be <strong>age</strong>, with a t-value of 7.67 (the highest absolute t-value).</p>
<p><strong>How to determine</strong>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Compare t-values</strong> (most direct method): Larger absolute t-values indicate stronger effects</p>
<ul>
<li>age: t = 7.67</li>
<li>weight: t = 5.20</li>
<li>exercise: t = -3.95</li>
</ul></li>
<li><p><strong>Compare p-values</strong>: All are highly significant, but age has the smallest p-value (1.2e-11)</p></li>
<li><p><strong>Standardized coefficients</strong> would be the most precise method (not shown here), as they account for different scales of measurement</p></li>
</ol>
<p>Note: We cannot simply compare the raw coefficients (0.652, 0.234, -1.234) because the variables are measured in different units (years, kg, hours).</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add55):</p>
<p>You would specify the model with an interaction term using <code>*</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Fit model with interaction term</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>interaction_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(los <span class="sc">~</span> age <span class="sc">*</span> infection_status, <span class="at">data =</span> hospital_data)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="fu">summary</span>(interaction_model)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co"># This is equivalent to:</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co"># lm(los ~ age + infection_status + age:infection_status, data = hospital_data)</span></span></code></pre></div>
<p><strong>Interpretation of the interaction coefficient (<code>age:infection_status</code>)</strong>:
If the interaction term is significant, it means the effect of age on the length of stay is different depending on infection status. The coefficient for <code>age:infection_status</code> represents the <strong>additional change in the slope of age</strong> for patients with an infection compared to those without. For example, if the coefficient is 1.5, it means that for each one-year increase in age, the length of stay increases by an additional 1.5 days for infected patients, on top of the baseline age effect for non-infected patients.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add23):</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Create the polynomial term</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>model_data<span class="sc">$</span>BMI_squared <span class="ot">&lt;-</span> model_data<span class="sc">$</span>BMI<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co"># Fit polynomial regression</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>poly_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(diabetes_risk <span class="sc">~</span> BMI <span class="sc">+</span> BMI_squared, <span class="at">data =</span> model_data)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="fu">summary</span>(poly_model)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co"># Alternative using poly() function (creates orthogonal polynomials):</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>poly_model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diabetes_risk <span class="sc">~</span> <span class="fu">poly</span>(BMI, <span class="dv">2</span>), <span class="at">data =</span> model_data)</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="fu">summary</span>(poly_model2)</span></code></pre></div>
<p>The first approach gives more interpretable coefficients; the second is better for avoiding multicollinearity between BMI and BMI¬≤.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add24):</p>
<p>For a right-skewed variable like income, apply a <strong>logarithmic transformation</strong>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Natural log transformation</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>data<span class="sc">$</span>log_income <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>income)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># Or log base 10</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>data<span class="sc">$</span>log10_income <span class="ot">&lt;-</span> <span class="fu">log10</span>(data<span class="sc">$</span>income)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co"># Make sure there are no zero or negative values first:</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>data<span class="sc">$</span>log_income <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>income <span class="sc">+</span> <span class="dv">1</span>)  <span class="co"># Adding 1 if zeros exist</span></span></code></pre></div>
<p><strong>Why log transformation</strong>:
- Reduces right skewness
- Makes the distribution more normal
- Reduces the influence of extreme values
- Often makes relationships more linear</p>
<p>Other options for right-skewed data: square root transformation <code>sqrt(income)</code> or inverse transformation <code>1/income</code>.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add25):</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co"># Method 1: Create the squared term explicitly</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>mtcars<span class="sc">$</span>wt_squared <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>wt<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>poly_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> wt_squared, <span class="at">data =</span> mtcars)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="fu">summary</span>(poly_model)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co"># Method 2: Using I() function (cleaner)</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>poly_model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> <span class="fu">I</span>(wt<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> mtcars)</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="fu">summary</span>(poly_model2)</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co"># Method 3: Using poly() for orthogonal polynomials</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>poly_model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(wt, <span class="dv">2</span>), <span class="at">data =</span> mtcars)</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="fu">summary</span>(poly_model3)</span></code></pre></div>
<p>Method 2 is recommended for most applications as it‚Äôs concise and easy to interpret.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add56):</p>
<p><strong>Interpretation</strong>: Since the predictor is log-transformed, the interpretation is: a <strong>1% increase in body weight</strong> is associated with a <strong>(15.3 / 100) = 0.153 mmHg increase</strong> in blood pressure, on average.
This type of model (log-lin) is used when the effect of the predictor is not linear but multiplicative.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add26):</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>logistic_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(disease <span class="sc">~</span> age <span class="sc">+</span> BMI <span class="sc">+</span> smoking, </span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>                      <span class="at">data =</span> health_data, </span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="fu">summary</span>(logistic_model)</span></code></pre></div>
<p>Key points:
- Use <code>glm()</code> instead of <code>lm()</code>
- Specify <code>family = binomial</code> for logistic regression
- The outcome variable <code>disease</code> should be binary (0/1, or factor with 2 levels)
- Results give log-odds; exponentiate coefficients to get odds ratios: <code>exp(coef(logistic_model))</code></p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add27):</p>
<p>An odds ratio of <strong>2.5</strong> for smoking means:</p>
<p><strong>The odds of developing the disease are 2.5 times higher for smokers compared to non-smokers</strong>, holding all other variables constant.</p>
<p>More specifically:
- If OR = 2.5, smokers have 150% higher odds of disease than non-smokers
- OR &gt; 1: positive association (increased risk)
- OR = 1: no association
- OR &lt; 1: negative association (protective effect)</p>
<p>Example interpretation: If non-smokers have a 10% probability of disease, smokers might have approximately 22% probability (though exact conversion from odds to probability requires more calculation).</p>
<p><strong>Note</strong>: Odds ratio is NOT the same as relative risk, but for rare diseases (&lt; 10% prevalence), they are approximately equal.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add28):</p>
<p>The negative coefficient of <strong>-0.05 for age</strong> indicates:</p>
<ol style="list-style-type: decimal">
<li><strong>Direction</strong>: As age increases, the log-odds of survival <strong>decrease</strong></li>
<li><strong>Practical meaning</strong>: Older patients have <strong>lower probability of survival</strong>, holding other factors constant</li>
<li><strong>Odds ratio</strong>: exp(-0.05) = 0.951, meaning for each one-year increase in age, the odds of survival multiply by 0.951 (decrease by about 5%)</li>
</ol>
<p>For a 10-year age difference: exp(-0.05 √ó 10) = exp(-0.5) = 0.606
A patient 10 years older has about 60.6% the odds of survival compared to a younger patient.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add29):</p>
<p><strong>Linear Regression</strong>:
- Predicts the <strong>actual value</strong> of a continuous outcome variable
- Output: A number on a continuous scale
- Example: Predicting exact blood pressure (135 mmHg), salary ($45,000), temperature (98.6¬∞F)
- Uses normal distribution</p>
<p><strong>Logistic Regression</strong>:
- Predicts the <strong>probability</strong> of belonging to a category (usually binary: yes/no, 0/1)
- Output: A probability between 0 and 1, which can be converted to a category
- Example: Predicting probability of disease (0.75 = 75% chance), probability of survival, probability of clicking an ad
- Uses binomial distribution with logit link function</p>
<p><strong>Technical difference</strong>:
- Linear regression: E(Y) = Œ≤‚ÇÄ + Œ≤‚ÇÅX‚ÇÅ + Œ≤‚ÇÇX‚ÇÇ + ‚Ä¶
- Logistic regression: log(P/(1-P)) = Œ≤‚ÇÄ + Œ≤‚ÇÅX‚ÇÅ + Œ≤‚ÇÇX‚ÇÇ + ‚Ä¶ (models log-odds)</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add30):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co"># Create binary outcome variable</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>mtcars<span class="sc">$</span>high_mpg <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co"># Fit logistic regression model</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(high_mpg <span class="sc">~</span> wt <span class="sc">+</span> hp, </span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>                   <span class="at">data =</span> mtcars, </span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="co"># View results</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co"># Get odds ratios</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a><span class="co"># Predict probabilities for original data</span></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>mtcars<span class="sc">$</span>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add57):</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># First, refit the model from Exercise #add30</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>mtcars<span class="sc">$</span>high_mpg <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(high_mpg <span class="sc">~</span> wt <span class="sc">+</span> hp, <span class="at">data =</span> mtcars, <span class="at">family =</span> binomial)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co"># Create a new data frame for the car we want to predict</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>new_car <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">wt =</span> <span class="fl">2.8</span>, <span class="at">hp =</span> <span class="dv">150</span>)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co"># Predict the probability</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> new_car, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="fu">print</span>(predicted_prob)</span></code></pre></div>
<p>The output <code>predicted_prob</code> will be a value between 0 and 1, representing the model‚Äôs estimated probability that a car with these specifications has an MPG over 20.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add31):</p>
<p><strong>Poisson regression</strong> is most appropriate for count data.</p>
<p><strong>Reasoning</strong>:
- The outcome (number of ER visits per day) is a <strong>count variable</strong> (0, 1, 2, 3, ‚Ä¶)
- Count data is discrete and non-negative
- Poisson distribution is designed for modeling count outcomes
- It models the rate of events occurring</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># Example Poisson regression</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>poisson_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(er_visits <span class="sc">~</span> day_of_week <span class="sc">+</span> weather, </span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>                     <span class="at">data =</span> hospital_data, </span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span></code></pre></div>
<p><strong>Note</strong>: If the variance is much larger than the mean (overdispersion), consider using <strong>negative binomial regression</strong> instead.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add32):</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>poisson_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(infection_count <span class="sc">~</span> bed_occupancy_rate <span class="sc">+</span> nurse_staff_ratio, </span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>                     <span class="at">data =</span> hospital_data, </span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="fu">summary</span>(poisson_model)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co"># Check for overdispersion</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="fu">dispersiontest</span>(poisson_model)</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co"># If overdispersion detected, use negative binomial:</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>nb_model <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(infection_count <span class="sc">~</span> bed_occupancy_rate <span class="sc">+</span> nurse_staff_ratio, </span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>                   <span class="at">data =</span> hospital_data)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add33):</p>
<p>The primary assumption of Poisson regression is that <strong>the mean equals the variance</strong> (equidispersion).</p>
<p>Specifically:
- <strong>E(Y) = Var(Y) = Œª</strong> (the Poisson parameter)</p>
<p><strong>In practice</strong>:
- If Var(Y) &gt; E(Y): <strong>Overdispersion</strong> - common in real data, violates assumption
- Solution: Use negative binomial regression or quasi-Poisson
- If Var(Y) &lt; E(Y): <strong>Underdispersion</strong> - less common
- May still use Poisson or consider other models</p>
<p><strong>Other important assumptions</strong>:
1. Outcome variable is a count
2. Observations are independent
3. Counts cannot be negative
4. The log of the mean is a linear function of predictors</p>
<p><strong>Check overdispersion</strong>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># Deviance/df should be close to 1</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>model<span class="sc">$</span>deviance <span class="sc">/</span> model<span class="sc">$</span>df.residual</span></code></pre></div>
<p>If ratio &gt;&gt; 1, overdispersion is present.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add58):</p>
<p><strong>Problem</strong>: The ratio of residual deviance to degrees of freedom (150 / 80 = 1.875) is much greater than 1. This suggests <strong>overdispersion</strong>, meaning the variance of the data is larger than what the Poisson model assumes (where mean equals variance). This violates a key assumption of Poisson regression.
<strong>Alternative Model</strong>: A <strong>Negative Binomial regression</strong> is the appropriate alternative as it can handle overdispersed count data by including an extra parameter to model the variance.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="co"># Fit a negative binomial model</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>nb_model <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(er_visits <span class="sc">~</span> predictor1 <span class="sc">+</span> predictor2, <span class="at">data =</span> hospital_data)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="fu">summary</span>(nb_model)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add34):</p>
<p>You need to create <strong>3 dummy variables</strong> for a categorical variable with 4 categories.</p>
<p><strong>Rule</strong>: For a categorical variable with k categories, create (k-1) dummy variables.</p>
<p><strong>Why</strong>:
- One category serves as the <strong>reference/baseline</strong> category
- The other k-1 categories are represented by dummy variables
- Including all k categories would cause perfect multicollinearity (dummy variable trap)</p>
<p><strong>Example for blood_type</strong>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># R does this automatically in regression, but manual creation:</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>data<span class="sc">$</span>type_A <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>blood_type <span class="sc">==</span> <span class="st">&quot;A&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>data<span class="sc">$</span>type_B <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>blood_type <span class="sc">==</span> <span class="st">&quot;B&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>data<span class="sc">$</span>type_AB <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>blood_type <span class="sc">==</span> <span class="st">&quot;AB&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="co"># Type O is the reference category (all three dummies = 0)</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="co"># In regression, R handles this automatically:</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(cholesterol <span class="sc">~</span> blood_type, <span class="at">data =</span> data)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="co"># R will create the dummy variables automatically</span></span></code></pre></div>
<p>If you include type O as well, the model matrix would be singular and inestimable.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add35):</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># R automatically creates dummy variables for factors</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>recovery_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(recovery_time <span class="sc">~</span> age <span class="sc">+</span> treatment, <span class="at">data =</span> patient_data)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="fu">summary</span>(recovery_model)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="co"># To explicitly set the reference category:</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>patient_data<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(patient_data<span class="sc">$</span>treatment, </span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Standard&quot;</span>, <span class="st">&quot;Experimental&quot;</span>))</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="co"># Now &quot;Control&quot; is the reference</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="co"># Alternatively, using relevel():</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>patient_data<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(patient_data<span class="sc">$</span>treatment), <span class="at">ref =</span> <span class="st">&quot;Control&quot;</span>)</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>recovery_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(recovery_time <span class="sc">~</span> age <span class="sc">+</span> treatment, <span class="at">data =</span> patient_data)</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="fu">summary</span>(recovery_model)</span></code></pre></div>
<p>R will automatically create 2 dummy variables (treatmentStandard and treatmentExperimental) with ‚ÄúControl‚Äù as the reference category.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add36):</p>
<p>The predicted value for a patient in the Surgery ward is:</p>
<p><strong>Predicted value = 12.5 + (-2.3) = 10.2</strong></p>
<p><strong>Explanation</strong>:
- The intercept (12.5) represents the predicted value for the <strong>reference category</strong> (General ward)
- For Surgery ward: add the Surgery coefficient (-2.3) to the intercept
- For ICU ward: you would add 4.7 to get 12.5 + 4.7 = 17.2
- For General ward (reference): just use the intercept = 12.5</p>
<p><strong>Interpretation</strong>: Compared to the General ward (baseline), patients in Surgery have 2.3 units lower outcome (on average), and ICU patients have 4.7 units higher outcome.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add37):</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="co"># The variable am is already coded as 0/1</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>mpg_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> hp <span class="sc">+</span> am, <span class="at">data =</span> mtcars)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="fu">summary</span>(mpg_model)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="co"># To make it more explicit:</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>mtcars<span class="sc">$</span>transmission <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span>am, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Automatic&quot;</span>, <span class="st">&quot;Manual&quot;</span>))</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>mpg_model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> hp <span class="sc">+</span> transmission, <span class="at">data =</span> mtcars)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="fu">summary</span>(mpg_model2)</span></code></pre></div>
<p>The coefficient for <code>am</code> (or <code>transmissionManual</code>) tells you the difference in mpg between manual and automatic transmissions, holding weight and horsepower constant.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add38):</p>
<p>The coefficient of <strong>5000</strong> means:</p>
<p><strong>Males earn $5,000 more than females on average</strong>, holding all other variables in the model constant.</p>
<p>More precisely:
- When gender = 1 (male), add $5,000 to the predicted salary
- When gender = 0 (female, reference), add $0
- This is the estimated gender pay gap in this model</p>
<p><strong>Example</strong>:
If the model is: Salary = 40,000 + 5,000(gender) + other terms
- Female (gender=0): Predicted base salary = $40,000 + other factors
- Male (gender=1): Predicted base salary = $45,000 + other factors</p>
<p><strong>Important notes</strong>:
- This is correlation, not necessarily causation
- Other factors (education, experience, etc.) should be controlled for
- The coefficient‚Äôs statistical significance (p-value) determines if this difference is reliable</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add59):</p>
<p><strong>Interpretation</strong>: The intercept of 75.2 represents the <strong>predicted average patient satisfaction score for the reference group</strong>. In this case, the reference group is patients for whom <code>has_private_room</code> is 0, i.e., patients <strong>who do not have a private room</strong>.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add39):</p>
<p>The four main assumptions for linear regression (LINE):</p>
<ol style="list-style-type: decimal">
<li><strong>Linearity</strong>: The relationship between predictors and outcome is linear
<ul>
<li>Check: Residuals vs.¬†Fitted plot should show random scatter</li>
</ul></li>
<li><strong>Independence</strong>: Observations are independent of each other
<ul>
<li>Check: Durbin-Watson test, knowledge of data collection</li>
<li>Violated by: Time series, clustered data, repeated measures</li>
</ul></li>
<li><strong>Normality</strong>: Residuals are normally distributed
<ul>
<li>Check: Q-Q plot, Shapiro-Wilk test, histogram of residuals</li>
<li>Most important for inference (confidence intervals, p-values)</li>
</ul></li>
<li><strong>Equal variance (Homoscedasticity)</strong>: Constant variance of residuals across all levels of predictors
<ul>
<li>Check: Scale-Location plot, Breusch-Pagan test</li>
<li>Residuals vs.¬†Fitted should show constant spread</li>
</ul></li>
</ol>
<p><strong>Additional assumption often mentioned</strong>:
5. <strong>No multicollinearity</strong> (for multiple regression): Predictors are not highly correlated
- Check: VIF (Variance Inflation Factor)</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Check assumptions:</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">plot</span>(model)  <span class="co"># Produces 4 diagnostic plots</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="fu">vif</span>(model)  <span class="co"># Check multicollinearity</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add40):</p>
<p>Using the formula for Adjusted R¬≤:
R¬≤adj = 1 - [(1 - R¬≤)(n - 1)/(n - k - 1)]</p>
<p>Given:
- R¬≤ = 0.85
- R¬≤adj = 0.83
- n = 100</p>
<p>Solving for k:
0.83 = 1 - [(1 - 0.85)(100 - 1)/(100 - k - 1)]
0.83 = 1 - [0.15 √ó 99/(99 - k)]
0.17 = 0.15 √ó 99/(99 - k)
0.17(99 - k) = 14.85
16.83 - 0.17k = 14.85
-0.17k = -1.98
k ‚âà <strong>11.6</strong></p>
<p>So approximately <strong>11 or 12 predictors</strong> are in the model.</p>
<p><strong>Quick approximation</strong>: When R¬≤ and R¬≤adj are close, you typically have relatively few predictors. The difference of 0.02 with n=100 suggests around 10-12 predictors.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add41):</p>
<p><strong>Problem identified</strong>: <strong>Heteroscedasticity</strong> (non-constant variance)</p>
<p>A funnel shape means:
- Variance of residuals increases (or decreases) with fitted values
- Violates the assumption of homoscedasticity (equal variance)</p>
<p><strong>Potential solutions</strong>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Transform the outcome variable</strong>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># Log transformation</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> data)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co"># Square root transformation</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>model_sqrt <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">sqrt</span>(y) <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> data)</span></code></pre></div></li>
<li><p><strong>Use weighted least squares (WLS)</strong>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># Weights inversely proportional to variance</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>wls_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> data, <span class="at">weights =</span> <span class="dv">1</span><span class="sc">/</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div></li>
<li><p><strong>Use robust standard errors</strong>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="fu">coeftest</span>(model, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div></li>
<li><p><strong>Add or transform predictors</strong>: May indicate missing variable or wrong functional form</p></li>
<li><p><strong>Use generalized linear models (GLM)</strong>: If outcome is count or binary</p></li>
</ol>
<p><strong>Check after solution</strong>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(new_model), <span class="fu">residuals</span>(new_model))</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="co"># Should show random scatter, not a pattern</span></span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add42):</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>mpg_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> hp, <span class="at">data =</span> mtcars)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a><span class="co"># Create diagnostic plots</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># Set up 2x2 plot layout</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="fu">plot</span>(mpg_model)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># Reset to default</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a><span class="co"># Individual plots:</span></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a><span class="co"># 1. Residuals vs Fitted (checks linearity and homoscedasticity)</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a><span class="fu">plot</span>(mpg_model, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a><span class="co"># 2. Q-Q plot (checks normality of residuals)</span></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a><span class="fu">plot</span>(mpg_model, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a><span class="co"># 3. Scale-Location (checks homoscedasticity)</span></span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a><span class="fu">plot</span>(mpg_model, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a><span class="co"># 4. Residuals vs Leverage (identifies influential points)</span></span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a><span class="fu">plot</span>(mpg_model, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a><span class="co"># Additional useful diagnostics:</span></span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a><span class="co"># Histogram of residuals</span></span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(mpg_model), <span class="at">main =</span> <span class="st">&quot;Histogram of Residuals&quot;</span>)</span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality</span></span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mpg_model))</span></code></pre></div>
<p><strong>Interpretation</strong>:
- Plot 1: Should show random scatter around zero
- Plot 2: Points should follow the diagonal line
- Plot 3: Should show horizontal line with equal spread
- Plot 4: Points outside Cook‚Äôs distance indicate influential observations</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add60):</p>
<p><strong>Indication</strong>: A Cook‚Äôs distance &gt; 1 indicates that observation #45 is a <strong>highly influential point</strong>. This means that its presence in the dataset has a substantial impact on the estimated regression coefficients. The model fitted with this point is likely very different from the model fitted without it.
<strong>Next steps</strong>:
1. <strong>Investigate the data point</strong>: Check observation #45 for data entry errors or determine if it represents a truly unusual case (e.g., a patient with a rare condition). If it‚Äôs an error, correct it.
2. <strong>Perform sensitivity analysis</strong>: Rerun the regression model after removing observation #45. If the model‚Äôs coefficients or conclusions change dramatically, you must report this sensitivity and be cautious about interpreting the original model. You might report the results of both models. Simply deleting the point without justification is generally not recommended.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add43):</p>
<p>Correct data collection is crucial in Big Data for several reasons:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Volume doesn‚Äôt equal quality</strong>: Having more data doesn‚Äôt automatically make it better. Garbage in, garbage out - if data collection is flawed, you just have more bad data, leading to confident but wrong conclusions.</p></li>
<li><p><strong>Bias amplification</strong>: Systematic errors in data collection are amplified with large datasets. A small sampling bias becomes a huge problem when scaled up, potentially affecting millions of decisions.</p></li>
<li><p><strong>Representativeness</strong>: Big data often comes from convenience samples (e.g., social media users, app users) that may not represent the target population. Just because you have millions of data points doesn‚Äôt mean they represent everyone.</p></li>
<li><p><strong>Missing data patterns</strong>: In healthcare, missing data is rarely random. If data is systematically missing for certain groups (e.g., disadvantaged populations less likely to have electronic health records), analyses will be biased no matter how much data you have.</p></li>
<li><p><strong>Measurement validity</strong>: Ensuring that variables actually measure what you think they measure is critical. In healthcare, if diagnostic codes are inconsistently applied or symptoms are differently reported, analyses will be unreliable.</p></li>
<li><p><strong>Ethical considerations</strong>: Poor data collection can perpetuate discrimination and inequity, especially in healthcare where decisions affect lives.</p></li>
</ol>
<p>Example: A hospital with excellent electronic records for insured patients but poor documentation for uninsured patients will produce biased analyses about treatment effectiveness, potentially harming vulnerable populations.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add44):</p>
<p><strong>Structured Data</strong>:
- Organized in a predefined format (rows and columns)
- Easily searchable and analyzable with standard statistical tools
- Stored in relational databases or spreadsheets
- <strong>Healthcare example</strong>:
- Electronic Health Records (EHRs) with fields like patient ID, age, blood pressure readings, lab test results
- Billing codes (ICD-10 diagnosis codes)
- Appointment dates and times</p>
<p><strong>Unstructured Data</strong>:
- No predefined format or organization
- Not easily searchable without special tools (NLP, text mining)
- Can include text, images, audio, video
- <strong>Healthcare example</strong>:
- Physician clinical notes (free text)
- Medical imaging (X-rays, MRIs, CT scans)
- Patient feedback and survey comments
- Audio recordings of patient-doctor consultations</p>
<p><strong>Semi-structured data</strong> (middle ground):
- Has some organizational properties but doesn‚Äôt fit strict relational model
- Healthcare example: XML or JSON formatted health information exchange documents</p>
<p><strong>Challenge</strong>: Most healthcare data (estimated 80%) is unstructured, requiring advanced techniques to extract value from it.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add45):</p>
<p>Three major sources of bias in healthcare data collection:</p>
<ol style="list-style-type: decimal">
<li><strong>Selection Bias / Sampling Bias</strong>:
<ul>
<li><strong>Problem</strong>: The sample doesn‚Äôt represent the target population</li>
<li><strong>Examples</strong>:
<ul>
<li>Clinical trials that exclude elderly patients, pregnant women, or those with comorbidities</li>
<li>Studies recruiting only from academic medical centers (sicker, more complex patients)</li>
<li>Online health surveys that only capture tech-savvy, engaged patients</li>
</ul></li>
<li><strong>Impact</strong>: Results don‚Äôt generalize to broader populations</li>
</ul></li>
<li><strong>Measurement Bias / Information Bias</strong>:
<ul>
<li><strong>Problem</strong>: Systematic errors in how variables are measured or recorded</li>
<li><strong>Examples</strong>:
<ul>
<li>Recall bias: Patients with disease remember exposures better than healthy patients</li>
<li>Observer bias: Researchers‚Äô expectations influence how they record observations</li>
<li>Diagnostic bias: Patients under closer surveillance more likely to have conditions detected</li>
</ul></li>
<li><strong>Impact</strong>: Distorted associations between variables</li>
</ul></li>
<li><strong>Non-Response Bias / Attrition Bias</strong>:
<ul>
<li><strong>Problem</strong>: Systematic differences between responders and non-responders</li>
<li><strong>Examples</strong>:
<ul>
<li>Healthier patients more likely to complete follow-up studies</li>
<li>Patients experiencing side effects drop out of clinical trials</li>
<li>Lower response rates in disadvantaged communities</li>
</ul></li>
<li><strong>Impact</strong>: Results don‚Äôt reflect the full population, often overestimating positive outcomes</li>
</ul></li>
</ol>
<p><strong>Other important biases</strong>:
- <strong>Confounding bias</strong>: Third variables influence both exposure and outcome
- <strong>Survival bias</strong>: Only analyzing survivors excludes those who died
- <strong>Temporal bias</strong>: Changes in diagnostic criteria or treatment over time</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add46):</p>
<p>This introduces <strong>non-response bias</strong> (also called self-selection bias).</p>
<p><strong>Why it‚Äôs problematic</strong>:</p>
<ol style="list-style-type: decimal">
<li><strong>Voluntary participation</strong>: Only motivated patients respond
<ul>
<li>Very satisfied patients may be more likely to respond (positive bias)</li>
<li>Very dissatisfied patients may be more likely to respond (negative bias)</li>
<li>The ‚Äúmoderately satisfied‚Äù majority may not participate</li>
</ul></li>
<li><strong>Digital divide</strong>:
<ul>
<li>Excludes patients without internet access (often elderly, low-income, less educated)</li>
<li>These groups may have different satisfaction levels</li>
<li>Typically underrepresents vulnerable populations</li>
</ul></li>
<li><strong>Health status</strong>:
<ul>
<li>Sicker patients in hospital may not complete surveys</li>
<li>Healthier, discharged patients more likely to respond</li>
<li>Creates systematic difference between responders and non-responders</li>
</ul></li>
<li><strong>Timing</strong>: Only captures patients actively seeking care, missing those who avoid the hospital due to poor past experiences</li>
</ol>
<p><strong>Consequence</strong>: The survey results will not accurately reflect true patient satisfaction across all patient groups. Conclusions drawn will be biased and policy decisions based on this data could be misguided.</p>
<p><strong>Better approach</strong>:
- Random sampling of all patients
- Multiple contact methods (phone, mail, in-person)
- Follow-up with non-responders
- Weight responses to match population demographics</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add47):</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="co"># Create simulated dataset</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">15</span>),</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>)</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a><span class="co"># View first few rows</span></span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a><span class="fu">head</span>(simulated_data)</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a><span class="co"># Check structure</span></span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a><span class="fu">str</span>(simulated_data)</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a><span class="fu">summary</span>(simulated_data)</span></code></pre></div>
<p><strong>Alternative with more control</strong>:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="co"># Ensure exactly 50 patients in each treatment group</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>simulated_data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">15</span>),</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each =</span> <span class="dv">50</span>),</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add48):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># Using the simulated_data from previous exercise</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">15</span>),</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>)</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a><span class="co"># 1. Calculate mean age for each treatment group</span></span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>age_by_treatment <span class="ot">&lt;-</span> simulated_data <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age),</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>    <span class="at">sd_age =</span> <span class="fu">sd</span>(age),</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>  )</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a><span class="fu">print</span>(age_by_treatment)</span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a><span class="co"># Base R alternative:</span></span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a><span class="fu">aggregate</span>(age <span class="sc">~</span> treatment, <span class="at">data =</span> simulated_data, <span class="at">FUN =</span> mean)</span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a><span class="co"># 2. Test if there&#39;s significant difference in outcome between treatments</span></span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a>outcome_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(outcome <span class="sc">~</span> treatment, <span class="at">data =</span> simulated_data)</span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a><span class="fu">print</span>(outcome_test)</span>
<span id="cb46-27"><a href="#cb46-27" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" tabindex="-1"></a><span class="co"># 3. Create linear model predicting outcome from age and treatment</span></span>
<span id="cb46-29"><a href="#cb46-29" tabindex="-1"></a>outcome_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> age <span class="sc">+</span> treatment, <span class="at">data =</span> simulated_data)</span>
<span id="cb46-30"><a href="#cb46-30" tabindex="-1"></a><span class="fu">summary</span>(outcome_model)</span>
<span id="cb46-31"><a href="#cb46-31" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" tabindex="-1"></a><span class="co"># Additional useful analyses:</span></span>
<span id="cb46-33"><a href="#cb46-33" tabindex="-1"></a><span class="co"># Check assumptions</span></span>
<span id="cb46-34"><a href="#cb46-34" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb46-35"><a href="#cb46-35" tabindex="-1"></a><span class="fu">plot</span>(outcome_model)</span>
<span id="cb46-36"><a href="#cb46-36" tabindex="-1"></a></span>
<span id="cb46-37"><a href="#cb46-37" tabindex="-1"></a><span class="co"># Get confidence intervals</span></span>
<span id="cb46-38"><a href="#cb46-38" tabindex="-1"></a><span class="fu">confint</span>(outcome_model)</span></code></pre></div>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add49):</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="co"># Load iris dataset</span></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a><span class="co"># 1. Filter only setosa and versicolor species</span></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>iris_filtered <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;versicolor&quot;</span>))</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a><span class="co"># Alternative base R:</span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>iris_filtered <span class="ot">&lt;-</span> iris[iris<span class="sc">$</span>Species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;versicolor&quot;</span>), ]</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a><span class="co"># Create binary outcome (0/1)</span></span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>iris_filtered<span class="sc">$</span>species_binary <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(iris_filtered<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;versicolor&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a><span class="co"># 2. Fit logistic regression model</span></span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(species_binary <span class="sc">~</span> Sepal.Length <span class="sc">+</span> Petal.Length, </span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>                   <span class="at">data =</span> iris_filtered, </span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a><span class="co"># 3. Report coefficients</span></span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a><span class="fu">coef</span>(logit_model)</span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a><span class="co"># Get odds ratios</span></span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a><span class="co"># Predictions</span></span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a>iris_filtered<span class="sc">$</span>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a>iris_filtered<span class="sc">$</span>predicted_species <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(iris_filtered<span class="sc">$</span>predicted_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, </span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a>                                           <span class="st">&quot;versicolor&quot;</span>, <span class="st">&quot;setosa&quot;</span>)</span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" tabindex="-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb47-35"><a href="#cb47-35" tabindex="-1"></a><span class="fu">table</span>(<span class="at">Predicted =</span> iris_filtered<span class="sc">$</span>predicted_species, </span>
<span id="cb47-36"><a href="#cb47-36" tabindex="-1"></a>      <span class="at">Actual =</span> iris_filtered<span class="sc">$</span>Species)</span></code></pre></div>
<p><strong>Interpretation</strong>: The model will likely show that Petal.Length is a very strong predictor (high coefficient) for distinguishing between setosa and versicolor.</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add50):</p>
<p><strong>Complete Analytical Workflow</strong>:</p>
<p><strong>1. Data Cleaning &amp; Preparation (Exploratory Phase)</strong></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># Load and inspect data</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">summary</span>(pharma_data)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="fu">str</span>(pharma_data)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(pharma_data))</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a><span class="fu">vis_miss</span>(pharma_data)</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a><span class="co"># Handle missing data</span></span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a><span class="co"># - Document patterns of missingness</span></span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a><span class="co"># - Decide on imputation vs. deletion</span></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a><span class="co"># - Use multiple imputation if appropriate</span></span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a><span class="co"># Check for outliers</span></span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a><span class="fu">boxplot</span>(pharma_data[, <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;BMI&quot;</span>, <span class="st">&quot;blood_pressure&quot;</span>)])</span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a><span class="co"># Create derived variables if needed</span></span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a>pharma_data<span class="sc">$</span>age_group <span class="ot">&lt;-</span> <span class="fu">cut</span>(pharma_data<span class="sc">$</span>age, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">100</span>))</span></code></pre></div>
<p><strong>2. Descriptive Statistics &amp; Initial Exploration</strong></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># Demographics summary</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">table</span>(pharma_data<span class="sc">$</span>gender, pharma_data<span class="sc">$</span>treatment)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="co"># Baseline characteristics by treatment group</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>pharma_data <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age),</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>    <span class="at">mean_BP =</span> <span class="fu">mean</span>(blood_pressure),</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>    <span class="at">mean_cholesterol =</span> <span class="fu">mean</span>(cholesterol)</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  )</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a><span class="co"># Check randomization success</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a><span class="fu">t.test</span>(age <span class="sc">~</span> treatment, <span class="at">data =</span> pharma_data)</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a><span class="fu">t.test</span>(BMI <span class="sc">~</span> treatment, <span class="at">data =</span> pharma_data)</span></code></pre></div>
<p><strong>3. Primary Analysis - Treatment Effect</strong></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Crude comparison of outcome</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(pharma_data<span class="sc">$</span>treatment, pharma_data<span class="sc">$</span>improved), <span class="dv">1</span>)</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a><span class="co"># Chi-square test</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a><span class="fu">chisq.test</span>(pharma_data<span class="sc">$</span>treatment, pharma_data<span class="sc">$</span>improved)</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a><span class="co"># Logistic regression - unadjusted</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>model_crude <span class="ot">&lt;-</span> <span class="fu">glm</span>(improved <span class="sc">~</span> treatment, </span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>                   <span class="at">data =</span> pharma_data, </span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>                   <span class="at">family =</span> binomial)</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a><span class="fu">summary</span>(model_crude)</span></code></pre></div>
<p><strong>4. Adjusted Analysis - Control for Confounders</strong></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># Multivariable logistic regression</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>model_adjusted <span class="ot">&lt;-</span> <span class="fu">glm</span>(improved <span class="sc">~</span> treatment <span class="sc">+</span> age <span class="sc">+</span> gender <span class="sc">+</span> BMI <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>                                 blood_pressure <span class="sc">+</span> cholesterol <span class="sc">+</span> glucose, </span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>                     <span class="at">data =</span> pharma_data, </span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>                     <span class="at">family =</span> binomial)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a><span class="fu">summary</span>(model_adjusted)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a><span class="co"># Check for multicollinearity</span></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a><span class="fu">vif</span>(model_adjusted)</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a><span class="co"># Model selection if needed</span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>model_final <span class="ot">&lt;-</span> <span class="fu">step</span>(model_adjusted, <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<p><strong>5. Subgroup Analyses</strong></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># Test for interaction with gender</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">glm</span>(improved <span class="sc">~</span> treatment <span class="sc">*</span> gender <span class="sc">+</span> age <span class="sc">+</span> BMI, </span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>                         <span class="at">data =</span> pharma_data, </span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>                         <span class="at">family =</span> binomial)</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a><span class="co"># Stratified analyses</span></span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a><span class="co"># By age group</span></span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>pharma_data <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  <span class="fu">filter</span>(age_group <span class="sc">==</span> <span class="st">&quot;young&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>  <span class="fu">glm</span>(improved <span class="sc">~</span> treatment, <span class="at">data =</span> ., <span class="at">family =</span> binomial) <span class="sc">%&gt;%</span></span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<p><strong>6. Model Diagnostics</strong></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># Check assumptions</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="fu">plot</span>(model_final)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a><span class="co"># Assess model fit</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a><span class="fu">hoslem.test</span>(model_final<span class="sc">$</span>y, <span class="fu">fitted</span>(model_final))</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a><span class="co"># Calculate AUC</span></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(pharma_data<span class="sc">$</span>improved, </span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>                 <span class="fu">fitted</span>(model_final))</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a><span class="fu">auc</span>(roc_curve)</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a><span class="fu">plot</span>(roc_curve)</span></code></pre></div>
<p><strong>7. Sensitivity Analyses</strong></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Complete case vs. multiple imputation</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="co"># Different model specifications</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a><span class="co"># Exclude influential outliers</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a><span class="co"># Alternative statistical methods</span></span></code></pre></div>
<p><strong>8. Results Interpretation &amp; Reporting</strong></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># Calculate odds ratios with 95% CI</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(model_final), <span class="fu">confint</span>(model_final)))</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a><span class="co"># Number needed to treat (NNT)</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a><span class="co"># Predicted probabilities for typical patients</span></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a><span class="co"># Clinical significance vs. statistical significance</span></span></code></pre></div>
<p><strong>Key Analyses to Perform</strong>:
1. ‚úì Descriptive statistics (demographics, baseline characteristics)
2. ‚úì Balance check (treatment groups comparable at baseline?)
3. ‚úì Crude association (treatment vs.¬†outcome)
4. ‚úì Adjusted association (control for confounders)
5. ‚úì Interaction testing (effect modification)
6. ‚úì Subgroup analyses
7. ‚úì Model diagnostics and validation
8. ‚úì Sensitivity analyses</p>
<p><strong>Final Deliverables</strong>:
- Table 1: Baseline characteristics by treatment group
- Table 2: Crude and adjusted odds ratios
- Figure 1: Forest plot of effect estimates
- Figure 2: ROC curve
- Supplementary: Sensitivity analyses results</p>
</div>
<div class="answer">
<p><strong>Answer to Exercise</strong> @ref(exr:add61):</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">library</span>(caTools)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a><span class="co"># Create a sample dataset for demonstration</span></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>stroke_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">65</span>, <span class="dv">10</span>),</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  <span class="at">hypertension =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">500</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>)),</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  <span class="at">heart_disease =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">500</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>)),</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  <span class="at">avg_glucose_level =</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">110</span>, <span class="dv">30</span>),</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  <span class="at">stroke =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">500</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>))</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>)</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a><span class="co"># 1. Split data into training and testing sets (75% train, 25% test)</span></span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(stroke_data<span class="sc">$</span>stroke, <span class="at">SplitRatio =</span> <span class="fl">0.75</span>)</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(stroke_data, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(stroke_data, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a><span class="co"># 2. Fit the logistic regression model on training data</span></span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>stroke_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(stroke <span class="sc">~</span> age <span class="sc">+</span> hypertension <span class="sc">+</span> heart_disease <span class="sc">+</span> avg_glucose_level,</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>                    <span class="at">data =</span> train_data,</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>                    <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a><span class="fu">summary</span>(stroke_model)</span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a><span class="co"># 3. Evaluate model performance on testing data</span></span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a><span class="co"># Predict probabilities on the test set</span></span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>test_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(stroke_model, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a></span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a><span class="co"># Convert probabilities to class predictions (0 or 1) using a 0.5 threshold</span></span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a>test_preds <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(test_probs <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a></span>
<span id="cb56-33"><a href="#cb56-33" tabindex="-1"></a><span class="co"># Create the confusion matrix</span></span>
<span id="cb56-34"><a href="#cb56-34" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> test_preds, <span class="at">Actual =</span> test_data<span class="sc">$</span>stroke)</span>
<span id="cb56-35"><a href="#cb56-35" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb56-36"><a href="#cb56-36" tabindex="-1"></a><span class="fu">print</span>(conf_matrix)</span>
<span id="cb56-37"><a href="#cb56-37" tabindex="-1"></a></span>
<span id="cb56-38"><a href="#cb56-38" tabindex="-1"></a><span class="co"># Calculate accuracy</span></span>
<span id="cb56-39"><a href="#cb56-39" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(conf_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(conf_matrix)</span>
<span id="cb56-40"><a href="#cb56-40" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy))</span>
<span id="cb56-41"><a href="#cb56-41" tabindex="-1"></a></span>
<span id="cb56-42"><a href="#cb56-42" tabindex="-1"></a><span class="co"># Calculate AUC</span></span>
<span id="cb56-43"><a href="#cb56-43" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(test_data<span class="sc">$</span>stroke, test_probs)</span>
<span id="cb56-44"><a href="#cb56-44" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;AUC (Area Under Curve):&quot;</span>)</span>
<span id="cb56-45"><a href="#cb56-45" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">auc</span>(roc_obj))</span>
<span id="cb56-46"><a href="#cb56-46" tabindex="-1"></a></span>
<span id="cb56-47"><a href="#cb56-47" tabindex="-1"></a><span class="co"># Plot ROC curve</span></span>
<span id="cb56-48"><a href="#cb56-48" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">main=</span><span class="st">&quot;ROC Curve&quot;</span>, <span class="at">print.auc=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
</div>
<!--bookdown:body:end-->
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong></strong>" was written by . </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


</body>

</html>
